commit 5d94ff751379c9922ce5e197516a915f471b298a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 30 03:09:24 2017 +0000

    DBRev 17.05.00.000

commit 0aeec57eba5077c56830734b24631d3906a9f3fe
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 30 03:08:18 2017 +0000

    Add release notes for Koha 17.05

commit ee1223228329ee296d42e6646a1f76281f9d2cd8
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Fri May 19 14:26:48 2017 -0300

    Translation updates for Koha 17.05

commit 8ed599113c7592ec2e2227e3a7265a7e9cc9ca0e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed May 24 01:54:02 2017 -0400

    Bug 5395: Update C4::Acquisition::SearchOrders POD
    
    Comparing the perldoc to the function:
    - basketname
    - basketgroupname
    - budget_id
    Were missing. This adds them.
    
    Also, a description of ordernumber and search were
    added, as they are not self-evident by their name
    alone.
    
    There are no code changes, so all tests should pass
    or fail identically before and after patch.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Fixed typo basetgroupname
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9026169a235aa8133660ef649d98d8cedc5a4692
Author: David Cook <dcook@prosentient.com.au>
Date:   Thu May 25 14:37:21 2017 +1000

    Bug 18669 - RewriteCond affecting wrong rule in koha-httpd.conf
    
    One of the RewriteCond directives in koha-httpd.conf was affecting
    the wrong RewriteRule after its original RewriteRule was commented out
    years ago.
    
    _TEST PLAN_
    0) Before applying patch, build Koha from source
        *) make
        *) make install (or make upgrade)
        *) Copy or symlink etc/koha-httpd.conf to your Apache vhost directory
            (and enable if you're on a Debian based system)
        *) Restart Apache
    1) Make sure that you have at least 1 bibliographic record in Koha
    (URL like this http://server:port/cgi-bin/koha/opac-detail.pl?biblionumber=1)
    2) Go to http://server:port/bib/1
    3) Note that you get a 404 error
    4) Apply the patch
    5) Rebuild Koha from source as per step 0
    6) Go to http://server:port/bib/1
    7) Note that you now see the same page as you would if you went to
    http://server:port/cgi-bin/koha/opac-detail.pl?biblionumber=1
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 59b58513fe4370e69fd3edb69a9976f4bc41a796
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 23 16:33:17 2017 -0300

    Bug 18664: Make IssueSlip returns if params are not valid
    
    Problem raised by bug 17762: IssueSlip should return if the params are
    not valid.
    The tests contain 2 FIXME to highlight this problem already, it's time
    to fix them.
    
    Note that, theoretically, this change may produce software error. Indeed
    the caller expecting a hashref (letter) will access the "content" key.
    But that should not happen.
    
    Test plan:
    Tests must return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a80366439e13fe3682d815c910d2efd7adafe840
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 18 17:42:02 2017 -0300

    Bug 18632: Remove 'CGI::param called in list context' warnings
    
    Once again, after bug 16154 and bug 16259 we need to remove more
    occurrence of CGi->param called in list context.
    Refer to bug 15809 for more information.
    
    Test plan:
    Make sure you do not see the error on the modified scripts.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01e7523dfb1ec9789f38dd6d7819cb5e3d7d7cc2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 26 10:25:10 2017 +0200

    Bug 18611: [QA Follow-up] Add unit test for GetItemNumbersFromImportBatch
    
    Test plan:
    Run t/db_dependent/ImportBatch.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b37df275b85114ccd23986d94af7ed21544269e6
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 26 10:20:00 2017 +0200

    Bug 18611: [QA Follow-up] Make SQL query more readable
    
    Make it more explicit by adding join statements.
    
    Test plan:
    See next patch for adding a unit test.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 092f02d227417ac9786e23651ab13fbd566589c8
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue May 23 11:03:04 2017 +0000

    Bug 18611 - Followup, remove tabs to make qa tools happy
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7249351f120f3bd02d7f7829af10bd89cae490dc
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue May 16 05:40:28 2017 -0400

    Bug 18611 - Create labels action fails in manage-marc-import.pl if an item has been deleted from the import batch.
    
    To test:
    1 - Import a batch with some items
    2 - Delete one of the imported items
    3 - Browse to Tools->Staged MARC record management
    4 - Click (Create label batch) for the batch you imported
    5 - Recieve an error
    6 - Apply patch
    7 - Click (Create label batch)
    8 - Batch is created with remaning items from the import
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2764251be318c4b1c2a86c11fc7e8ba9cfb466bf
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Sun May 28 22:21:16 2017 -0400

    Bug 18600 - DBRev 16.12.00.039
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ec4b976289d68b4122f081f05ff7a7a023a32580
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 23 16:16:39 2017 -0300

    Bug 18600: Add pref TalkingTechItivaPhoneNotification if missing
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 30ca02aee836fcb1933b2c671638937c503af31e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 26 11:20:42 2017 +0200

    Bug 18620: [QA Follow-up] Move the final rollback to the very end
    
    The new subtest in Reserves.t does not need its own transaction.
    Move the original rollback to the very end of the test.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    https://bugs.koha-community.org/show_bug.cgi?id=18478
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8f726ae06d05951bb33540d122a47f1637b39f20
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue May 23 16:11:06 2017 -0400

    Bug 18478 - QA Followup
    
    Make sure to build necessary letters
    Fix awkward construction
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e704be99dcd0b162cb02d5c0e547953ab9f31eac
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue May 16 11:01:02 2017 -0400

    Bug 18478 - Additional unit tests
    
    This method was not previously covered, we don't change it , but
    no reason to throw away these tests to ensure messages are created
    as expected
    
    To test:
    1 - Apply this patch first
    2 - Prove t/db_dependent/Reserves.t
    3 - Last tests fail
    4 - Apply other patch
    5 - All tests should pass
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b1e78d530a38d3edc04168d22671624589d6bbcc
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed May 17 12:58:09 2017 -0400

    Bug 18478 - Unit tests
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4fa3df9462eaa4a6a2399af4d7036d2f3ee990ce
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed May 17 12:54:44 2017 -0400

    Bug 18478 - Some notices sent via SMS gateway fail
    
    It seems that for HOLD and DUE (and maybe more) notices we rely on
    C4::Letters::SendQueuedMessages
    to populate the correct address.
    
    This patch adjust that subroutine to correctly populate the field and/or
    fail messages if no SMS provider available
    
    To test:
     1 - Define a messaging prefs for a patron to recieve hold notices via
     SMS
     2 - Ensure you have defined an SMS message for 'HOLD' letter
     3 - Set an SMS alert number for patron
     4 - Set the SMS::Send driver to 'Email'
     5 - Fill a hold for the patron
     6 - Check the db and note the address is null
     7 - run process_message_queue.pl
     8 - Check db - address is null and message pending
     9 - Apply patch
    10 - run process_message_queue
    11 - Message to_address should be populated and message sent
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4f3dfd23ea12c3de64761b9e3a20e75e4e6a06c8
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed May 17 11:34:58 2017 -0400

    Bug 18620 - t/db_dependent/Letters.t failing on master
    
    To test:
    1 - Set SMSSenDriver to 'Email'
    2 - prove t/db_dependent/Letters.t
    3 - Tests fail
    4 - Apply patch
    5 - prove t/db_dependent/Letters.t
    6 - Less tests fail (should be 2 sms test failures)
    7 - Set SMSSendDriver to another value or blank
    8 - prove t/db_dependent/Letters.t
    9 - Tests pass
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d4e3e6af9fd054dc64844be49e8d1a0f28b545bd
Author: Leire Diez <leire@scanbit.net>
Date:   Thu May 11 17:09:22 2017 +0200

    Bug 18204 - Authority searches are not saved in Search history
    
    When you search an authority in Authority search, this search is not saved in Search history.
    
    EnableOpacSearchHistory is enabled
    
    Steps to test:
     1- Login your account (opac)
     2- Search an authority in Authority search
     3- Go to Search history -> Authority
     4- It says "Your authority search history is empty"
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d046474805b065f7419fefb06902d6ae18a0cd29
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 23 14:10:20 2017 -0300

    Bug 16295: Fix access to MMT admin page
    
    There was a typo in the permission code
    
    Test plan:
    Try to access the marc modification templates admin page with the
    marc_modification_templates permission (and not all tools permissions)
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1d7ecebfd2a4a7152656ae39db18efcdd3abe3f9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Sun May 28 22:05:48 2017 -0400

    Bug 18663 - DBRev 16.12.00.038
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6f29c775d92d72bd03188efea4a41b3fbb49e928
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 23 16:16:17 2017 -0300

    Bug 18663: Add pref ExportRemoveFields if missing
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f0eda04ddf5b879b2c2a2d10745beda58e239e05
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 23 13:02:30 2017 -0300

    Bug 18662: Fix currency deletion
    
    Sounds like it is caused by bug 13726.
    It is not possible to delete a currency, even if not used by any vendors
    
    Test plan:
    Try and delete currencies used or not by vendors.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0b7c517bfe9c76b0e40f25f1fa5b1f3cf7a00dd3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 26 11:45:31 2017 -0300

    Bug 15465: Fix typo in bugs.k-c.org

commit 803c36a6ffd5b21ffbbdcdb22a0bb7c0bf24350c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 24 12:27:47 2017 -0300

    Bug 16344: Fix test in GetHardDueDate.t

commit d2ed4fadc59260372baedab038d16bd7cb169b1c
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri May 5 10:23:23 2017 +0000

    Bug 18548: Print usage when missing instance name in koha-create script
    
    Test plan:
    1. Run: debian/scripts/koha-create --request-db
    -> Without patch you see the getent error message
    -> With patch you see usage and "Missing instance name" message
    
    Signed-off-by: Dilan Johnpulle <dilan@calyx.net.au>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e609679eb278383f573eda78048f8fa107ae159b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri May 12 09:38:37 2017 -0400

    Bug 18569 - Quick add patron will not copy over details from cities and towns pull down into patron details
    
    Followed test plan and the city value updates in the quick add form correctly.
    Signed-off-by: Dilan Johnpulle <dilan@calyx.net.au>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c762cd827e0a80960f3b23513981a382025b3bee
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 18 22:00:44 2017 -0400

    Bug 18598 - Quick add form doesn't clear values when switching
    
    To test:
    1 - Fill out some fields in quick add
    2 - Switch to full form and clear fields
    3 - Switch back and fields are still populated
    4 - Fill a field in long form
    5 - Switch to quick add and clear it
    6 - Save
    7 - Value set in 4 is saved
    8 - Apply patch
    9 - Repeat 1-6 - values should be cleared and not saved
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3e5dbef9ef18e0eaadfff9c7d7b5838aec75fb36
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri May 12 09:18:45 2017 -0400

    Bug 18596 - Quick add form duplicating password confirm
    
    To test:
    1 - Add password to BorrowerMandatoryField
    2 - View quick add form
    3 - See confirm password twice
    4 - Apply patch
    5 - See confirm password once
    6 - Add password to QuickAddFields
    7 - Confirm one confirm field
    8 - Remove password form BorrowerMandatory field
    9 - Confirm there is one confirm field and password fields are not
    required
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 31630ab0e4898f99251222f750492dad43bc3b38
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Mon May 22 10:38:02 2017 +0000

    Bug 18642: Remove debug messages
    
    Test plan:
    0) Apply the patch
    1) git grep Data::Printer
        -> should return no results
    2) Go to Reports -> Use saved - should work fine
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87bb59304e53755d7b4565c517578a838e1f0041
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue May 23 14:31:01 2017 +0200

    Bug 18647: Resolve internal server error on category_type
    
    See bug 18552. When we resolved the housebound_role bug, the hash got
    filled correctly again. And this revealed that the (second) call to
    Koha::Patrons->find was not appropriate. It can be removed, as Jonathan
    explained on the report.
    
    Note: Commit 95429af6855e8ed37945b681dc466bf360deffb added this call, but
    it was hidden until the template variable hash got fixed.
    
    Test plan:
    Restart Plack and go to patron details again.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1882805533a39df64e3380fbb50b591b1d5054a8
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Jan 13 16:01:13 2017 +0000

    Bug 17898: Followup - udpate templates for bootstrap 3
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f22d2e7200ee8b35aff66b26acc3e2daa49f9f0d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 13 15:48:57 2017 +0100

    Bug 17898: Automagically convert SQL reports
    
    Bug 17196 move the marcxml out of the biblioitems table.
    That will break SQL reports using it.
    It would be handy to propose an automagically way to convert the SQL
    reports.
    
    We do not want to update the reports automatically without user inputs,
    it will be too hasardous.
    However we can lead the user to convert them.
    
    In this patchset I suggest to warn the user if a report is subject to be
    updated.
    
    TODO: Add a way to mark this job done (using a pref?) to remove the
    check and not to display false positives.
    
    Test plan:
    - Create some SQL reports (see https://wiki.koha-community.org/wiki/SQL_Reports_Library)
    - Go on the report list page (/reports/guided_reports.pl?phase=Use saved)
    - For the reports using biblioitems.marcxml you will see a new column
    warning you that it is obsolete
    - Click on update link
    => that will open a modal with the converted SQL query
    - Click on the update button
    => you will be informed that the query has been updated
    
    If all the reports are updated, the new column "Update" will no longer
    be displayed.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9719284622e2c3027ef615286ef417f920238c9f
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue May 9 13:33:52 2017 +0000

    Bug 18551: followup - hide advanced filters in header, move hidding to css file
    
    Test plan:
    The same as first patch, but also with advanced search form in header hidden
    on page load - see comment 4
    
    Issue with advanced search form is gone.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Philippe <philippe.audet-fortin@inlibro.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5cc536c68b221823f4335b5b5db1108521f88a71
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri May 5 15:00:05 2017 +0200

    Bug 18551 - Hide with CSS dynamic elements in member search
    
    In member search page, the result table is in Ajax so fully managed by Javascript. There is also a yellow dialog message prepared in HTML.
    
    Thoses elements are hidden by JS code : ie $("#patron_list_dialog").hide().
    
    The problem is that the static page is first loaded an displayed then the JS code runs an hides the elements.
    On a low performance computer, this action is visible and looks like there is a blinking yellow message.
    
    I propose to hide with CSS so that thoses elements are not displayed in static page and are there shown in dynamic JS code.
    
    Test plan :
    Check display is unchanged :
    - Go to home page /cgi-bin/koha/members/members-home.pl
    - Perform patron search from header search box
    - Perform patron search by clicking on a letter
    - Perform patron search from filters (left of results table)
    - Select a patron and add it to a list => you see the yellow message
    
    Yellow message does no longer appear with this patch.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Philippe <philippe.audet-fortin@inlibro.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c9de665c294f0e4416a9f1ea751e2859eb065a9c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu May 11 09:10:50 2017 +0200

    Bug 18578: Use subdirectory in /tmp for session storage during installation
    
    Apply the change from bug 15553 to InstallAuth.pm too.
    
    Test plan:
    [1] Remove all cgisess_* files from your /tmp directory.
    [2] Remove directory /tmp/cgisess_koha_[your instance], if there.
    [3] Run the webinstaller
        /cgi-bin/koha/installer/install.pl?step=1&op=updatestructure
    [4] Check if you have cgisess_ files in /tmp/cgisess_koha_[your instance].
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 63c6eaca8d649cb7864b90e5e1ee9ac019daffdf
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 19 11:39:24 2017 +0200

    Bug 18536: [QA Follow-up] Tiny regex simplification
    
    Simplify regex for removing table name.
    No need to escape a dot between the square brackets. No need to specify a
    number of 1 between parentheses.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b8f9d7e14a8b93143185e814464393ef275631d
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu May 4 08:54:30 2017 +0000

    Bug 18536: Generating CSV using profile in serials late issues doesn't work as described
    
    Description on editing csv profiles says:
    
    "You can also use your own headers (instead of the ones from Koha) by
    prefixing the field name with an header, followed by the equal sign."
    
    So the header should be optional, but in fact it's mandatory. Also the
    regular expression to cut table name from beginning of db column is not
    right.
    
    Test plan:
    
    0. Don't apply the patch
    1. Make two CSV profiles for exporting late issues
        a) SUPPLIER=aqbooksellers.name|TITLE=subscription.title|ISSUENUMBER=serial.serialseq|LATE SINCE=serial.planneddate
        b) aqbooksellers.name|TITLE=subscription.title|ISSUE NUMBER=serial.serialseq|LATE SINCE=serial.planneddate
    2. Export late issues, profile a) works as expected, profile b) doesn't
    3. Apply the patch
    4. Both profiles should work
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 48c87a19a68bf1157c471b8355f5eafe9ec305c1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri May 12 10:00:29 2017 -0400

    Bug 18597 - Quick add form does not transfer patron attributes values when switching forms/saving
    
    The function that switches between quick add/fulll form assumes labels
    are followed by values - patron_attr don't follow this pattern. This
    patch just moves the hidden input field
    
    To test:
    1 - Have some patron attributes (with/without auth values set)
    2 - Add them to QuickAddFields (patron_attr2 for example)
    3 - view quick add form and set some values
    4 - Switch to full form, values not transferred
    5 - Switch to quick add, view values, save
    6 - Values are not saved :-(
    7 - Apply patch
    8 - Repeat 3 - 5
    9 - Values are transferred and saved :-)
    
    Signed-off-by: Peggy Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 49253ace12e6cd1350680f3b9b3ee3f904067767
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 19 12:22:03 2017 +0200

    Bug 18552: [QA Follow-up] Resolve warnings
    
    Like:
    Problem = a value of AutoResumeSuspendedHolds has been passed to param without key at /usr/share/koha/masterclone/C4/Templates.pm line 137.
    Problem = a value of relatives_borrowernumbers has been passed to param without key at /usr/share/koha/masterclone/C4/Templates.pm line 137.
    
    Problem is functions returning undef in list context (in this case
    housebound_role).
    No need to call Patrons::find a second time.
    
    Note: The call of GetDebarments in the first patch suffered from this too.
    It is in a fine place now too. But strictly speaking, should not have been
    moved.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f2dee024a7e503132fd0c82a4f47d8c5353613e4
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu May 18 23:10:13 2017 +0000

    Bug 18552: Borrower debarments not showing on member detail page
    
    To test:
    1) Go to a borrowers details page and create a manual restriction
    2) Notice the restriction shows at the top of the page but the
    restriction tab says the member is currently unrestricted
    3) Apply patch and refresh page
    4) Restrictions tab should now correctly show debarments and correct
    number is shown
    5) Confirming deleting and adding restrictions still works as expected
    
    Sponsored-by: Catalyst IT
    
    Followed test plan, works as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 90575b64d5c4ed63e1eeded043865796bbcde244
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed May 3 15:21:40 2017 -0400

    Bug 18534 - When IndependentBranches is enabled the pickup location displayed incorrectly on request.pl
    
    To recreate:
    1 - Place a hold for pickup at Midway
    2 - Enable independentbranches
    3 - Login to staff interface as admin without superlibrarian status from
    a different branch
    4 - View the holds for the title you placed a hold on
    5 - The hold placed in step 1 should show a dropdown with current branch
    as pickup location, current branch is the only in that dropdown
    6 - Verify it displays correctly for superlibrarian
    7 - Apply patch
    8 - The correct pickup location should show and not be editable
    9 - Verify it is a dropdown
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 37de20b23603bc7552f1296edec065fcfe7b4422
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Nov 21 18:54:40 2016 +0000

    Bug 17665 - SIP2 Item Information Response returns incorrect circulation status of '08' ( waiting on hold shelf ) if record has any holds
    
    If a record has any holds on it, the SIP2 item information response will
    return a value of 08 "waiting on hold shelf" even if the item is not
    actually a waiting hold. This is clearly a bug.
    
    Test Plan:
    1) Find an item that is not a waiting hold, but whose record has one or
       more holds.
    2) Issue a SIP2 item information request
    3) Note in the response, the circulation status field is '08'
    4) Apply this patch
    5) Repeat the item informationr request
    6) Note the code is now '03' ( available )
    7) Check the item in to fill the hold
    8) Repeat the item information request
    9) Verify the circulation status is now '08'
    
    Followed test plan, works as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 86678bbc26954e5e4eddf8b11b652b4c83e80425
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon May 23 14:05:58 2016 +0000

    Bug 16568 - Talking Tech generates phone notifications for all overdue actions
    
    Regardless of whether the phone transport has been selected for a given
    overdue action or not, the Talking Tech outbound script generates and
    sends a line for that action.
    
    Test Plan:
    1) Enable Talking Tech
    2) Create one or more overdue actions without a phone transport selected
       and one or more with the phone transport selected
    3) Generate the overdues csv file to send to Itive
    4) Note the csv file has lines for actions that do not have the phone
       transport selected
    5) Apply this patch
    6) Repeat step 3
    7) Note the csv file now only has lines for actions that have the phone
       transport selected
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bbef5c4c3afadeebfe645048bb48ec81f21e0b59
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Wed Apr 19 14:01:30 2017 +1200

    Bug 18438 - Implemented data-dismiss="modal" in returns.tt so that any warning messages hidden by a hold modal are displayed after it is dismissed
    
    Test plan:
    1. Check out an item to one patron whilst having that item also being on
    hold to another patron
    
    2. Check the item back in
    
    3. Notice a modal box appears greying out the background with three
    buttons 'Confirm hold', 'Print and confirm' and 'Ignore'. Click confirm
    and notice that the page refreshes and no yellow warning messages are
    able to be displayed
    
    4. Now that you have checked the item in. Try checking it in a second
    time by clicking on the Checkin tab and writing in the barcode.
    
    5. The modal box will appear again, this time with three buttons
    'Confirm', 'Print and confirm' and 'Cancel hold'
    
    6. Click the 'Confirm' button and the page refreshes again and the
    yellow warning message hidden by the modal box is not properly displayed
    to the user. Notice that the focus is on the barcode input box.
    
    7. Apply patch
    
    8. Try checking in the item again, and this time after clicking the
    'confirm' button on the modal box notice that the yellow warning message
    is displayed telling the user the item was "Not checked out". Also
    notice the focus is in the barcode inputbox.
    
    9. Drop the hold on the item and make sure it is not checked out.
    
    10. Repeat steps 1 and 2 and notice after clicking the 'Confirm hold'
    button the page refreshes and the item is successfully checked back in.
    With the focus on the barcode input.
    
    11. View koha-tmpl/intranet-tmpl/prog/en/modules/circ/returns.tt and
    notice that the button on line 345 does not use an onclick parameter
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Amended-patch: remove spaces
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 285dd883564eaf96737b2be153bbe6d30e1b64f7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 18 16:40:42 2017 -0300

    Bug 18376: Do not need to prepare a single statement, use do
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6a82ff4b8907f17fb17af3201ab6e96320a995bf
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Apr 4 14:17:15 2017 +0200

    Bug 18376 - authority framework creation fails under Plack
    
    With plack, when creating a new authority framework from another, you get the error :
    Can't call method "prepare" on an undefined value at (...)/src/admin/auth_tag_structure.pl line 267.
    
    Looks like plack does not like when the var $dbh from the script is called inside a sub.
    
    This patch adds a local var $dbh inside sub duplicate_auth_framework(), like in sub StringSearch().
    
    Also correctes a redefine of my $sth.
    
    Test plan:
    - Go to Administration > Authority types
    - Create a new type
    - On this new type click on Actions > MARC Structure
    - Select another type and click OK
    => You must get a table filled with the tag structure
    Check with and without plack
    You may not be able to reproduce the error with plack.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4c631a0824a38177279475f77e9246087fa97515
Author: Oliver Bock <oliver.bock@aei.mpg.de>
Date:   Mon Nov 30 13:57:58 2015 +0100

    Bug 14625 - LDAP: skip extended patron attributes in 'borrowers' attribute update
    
    * Any extended patron attributes will cause the update to fail as those attributes don't exist in the 'borrowers' table
    * The update of the extended patron attributes is already dealt with in checkpw_ldap()
    * Ergo: just skip those attributes here
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    I did not test this patch but code looks good
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cf3212cc7f443e539c9bdbfcc25d2537c83bd5b8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu May 18 08:41:34 2017 -0700

    Bug 18627 - Items created via MarcItemFieldsToOrder are not linked to orders
    
    If using MarcItemFieldsToOrder with AcqCreateItem = Create,
    the order and the items will be created, but they will not be linked via aqorders_items!
    
    Test Plan:
    1) Enable creation of items when ordering
    2) Set up MarcItemFieldsToOrder
    3) Upload an order record that uses the fields in step 2
    4) Create a basket and add the records from the file
    5) Note the order and items are created, but no rows in aqorders_items are created
    6) Apply this patch
    7) Repeat steps 3-4
    8) Note the rows in aqorders_items are created!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marci Chen <mchen@mckinneytexas.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2855107383db654e92e219d7d2d88fa88a73d36e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed May 10 16:04:36 2017 -0300

    Bug 18571: Add default ES configuration to koha-conf-site.xml.in
    
    This patch adds a default configuration entry for elasticsearch. It will
    add localhost:9200 to the server subsection, and koha_instance (replacing instance
    for the corresponding instance name) for the namespace.
    
    To test:
    - Apply the patch
    - Copy the file to the /etc/koha dir:
      $ sudo cp kohaclone/debian/templates/koha-conf-site.xml.in /etc/koha
    - Create a new instance:
      $ sudo koha-create --create-db test
    => SUCCESS: /etc/koha/sites/test/koha-conf.xml includes the mentioned section:
    
     <elasticsearch>
         <server>localhost:9200</server>
         <index_name>koha_test</index_name>
     </elasticsearch>
    
    - Sign off :-D
    
    Note: As the use of ES is syspref driven, this default entry doesn't have any use
    until ES is installed and SearchEngine set to Elasticsearch. So it doesn't hurt
    but will help end users test the ES integration. Advanced users will take care of
    this config entry manually (pointing to external servers/clusters, etc).
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af89df12e72ea51010039a2206bb942bcc4c4b50
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Apr 12 16:06:29 2017 +0200

    Bug 14399: Results form also needs a few interface changes
    
    Currently, the value of compareinv2barcd is used to determine if the
    Seen column, the Select/Clear all buttons and the Mark seen buttons are
    displayed. But if we scanned barcodes, we already marked items as seen.
    So we should only display these buttons when we did not upload barcodes.
    
    Test plan:
    [1] Upload a barcode file. Check that the result form does not show
        the buttons.
    [2] Generate an inventory list, so do not upload a barcode file. Verify
        that you still see the buttons.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 35b73aa3c6fb163f1389d30f0c175bec19696698
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Apr 5 15:12:31 2017 +0200

    Bug 14399: Interface changes
    
    A part of the confusion around the inventory script may arise from the
    fact that the form offers several options that are only used under
    certain conditions. This patch hopefully rearranges a few options more
    logically and only offers options when appropriate.
    
    The barcode fieldset now also contains Compare barcodes and Do not check in
    checkboxes. These are meaningful when a barcode file is uploaded.
    
    The fieldset Item location filters (new name) contains fields that are
    always used. Same for tne only control left under Additional options,
    Export to CSV.
    
    The fieldset Optional filters depends on the status of the barcode file
    and the Compare checkbox. It is now shown or hidden depending on what
    you select: if you do not upload a file, it is shown; or if you upload
    a file and check Compare, it is shown. Otherwise we hide it, since the
    script will not look at these values. Under this fieldset last inventory
    date and Skip items on loan are added, since their behavior is the same
    as the various item statuses.
    
    Test plan:
    In this test plan we test both the script changes from the previous patch
    and the interface changes here. We follow the three main scenario's as
    mentioned in the previous patch.
    
    [1] First we prepare a few test items.
        Pick two biblios A, B and create five items say A1,A2,B1,B2,B3.
        Pick a not-existing callnumber range you want to test and move these
        five items there. Add barcodes too (say A1..B3).
        Edit one item A1 to a not-existing notforloan status (doing this on
        the mysql command line is fastest).
        Like: update items set notforloan = '9' where barcode='A1';
        Now simulate that we did not add/edit these items today:
        update items set datelastseen='2017-01-01' where barcode in ('A1','A2','B1','B2','B3');
        Note: We need this when comparing with last inventory date in the last
        scenario.
    
    Scenario 1 (no barcodes uploaded)
    [2] Enter the callnumber range on inventory form.
        Verify that "Set inventory date", Compare barcodes and "Do not check
        in" are disabled on the form. Check that you see the Optional filters
        box.
        Submit the form. Verify that you see all five items.
        Do the same. Check Export to CSV. Check result file contents.
    
    Scenario 2 (upload barcodes, do not compare)
    [3] Create a barcode file with the barcodes of A1, A2 and B1. Add another
        existing barcode outside the test callnumber range.
        After uploading this file, verify that "Set inventory date", Compare and
        "Do not check in" are enabled. The Optional filters should be hidden.
        Leave "Set inventory date" to today. Enter the callnumber range again.
        Submit the form.
        What do we expect? Four items should have been updated (alert). We
        should see barcode A1 with problem Unknown status. We should see
        also the barcode from the other range (Found in wrong place).
        Repeat this step with the same file. But now export to CSV. Verify that
        you see two barcodes with problems again in the csv file.
    
    Scenario 3 (upload barcodes, compare)
    [4] Create another barcode file with barcodes of B2 and one existing barcode
        outside the test callnumber range.
        After uploading this file, check the Compare checkbox. Verify now that
        the Optional filters box is displayed again.
        Leave "Set inventory date" to today. Enter the callnumber range again.
        Also set "Last inventory date" to today (important!).
        Submit the form.
        What do we expect now? Two items should be updated (see alert).
        We should see barcode B3 with problem Missing. We should also see the
        barcode from the other range (wrong place).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6da97c7c8713bb16cbf6cf079df18534c3661414
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Apr 3 15:16:42 2017 +0200

    Bug 14399: Numerous small refinements to the inventory script
    
    This patch contains the following changes:
    
    [01] Label "Inventory date" reworded to "Last inventory date", adding a
    small explanation for its purpose.
    [02] Restructured the results: it was an array with items and possible
    error messages. Multiple messages duplicated individual items. Now the
    results are in a hash, pulling all error messages for one item together.
    At the end of the script they are copied to an array. (A helper sub
    additemtoresults is added in this regard.) We no longer use array
    @items_with_problems.
    [03] Both datepickers are no longer connected to the same class. This
    prevents changing the set date by filling the last inventory date.
    [04] Input markseen in the template and $markseen in the script are
    no longer needed.
    [05] The paragraph before the detail link in the results table in the
    Title column has been removed. Same for problems column. This makes
    vertical spacing consistent.
    [06] Problem status 'missingitem' is no longer used; the missing items
    are marked as 'not_scanned'. Two additional statuses are: no_barcode and
    checkedout.
    [07] Removed unused $itemtype, $totalrecords and $count. We use variable
    $moddatecount to report a count to the template.
    [08] The script updated scanned items twice. The first time with ModItem
    and the second time with ModDateLastSeen. The second call is removed.
    [09] If a book is checked in, we do no longer return an error message when
    the checkin is successful (ERR_ONLOAN_RET). The updated datelastseen is
    passed to the results.
    [10] $wrongplacelist is renamed to $rightplacelist. It is only built when
    we need it. (Same for inventorylist now.)
    [11] Datelastseen (last inventory date) is always used for building the
    inventory list. It allows you to process partial barcode lists or make
    a list of items not seen after some date. We do no longer use variable
    $paramdatelastseen.
    [12] The section where items.datelastseen was compared with the inventory
    date has been removed. Scanned items were already updated; to get items
    seen before some date, you can now use last inventory date without passing
    barcodes.
    
    The form can mainly be used for the following three cases:
    [1] Prepare an inventory list or csv file; we do not upload barcodes.
    [2] Update items for uploaded barcodes without comparing to inventory.
        Last inventory date is useless in this case.
        Errors wrongplace, checkedout and changestatus are reported.
        Use this scenario for partial scanned barcode lists (all but last).
    [3] Update items for uploaded barcodes and compare to inventory, filtered
        by an optional last inventory date.
        Apart from the errors mentioned under [2], this also reports
        not_scanned ("missing") and no_barcode.
        Use this scenario too for the last partial barcode file (together with
        inventory date).
    
    Test plan:
    See next patch ("Interface changes").
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e162c4d526e042c4b382629a7aec880dcfced346
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Apr 3 13:05:13 2017 +0200

    Bug 14399: Prevent display of double zero notforloan status
    
    On bug 12913 a zero status is added on the inventory form. This prevents
    a lot of false warnings for a wrong notforloan status. The zero status
    is not included in the default setup. But if you would add one, the
    status will display here twice now.
    
    This patch checks if the status already exists.
    
    Test plan:
    [1] Add a zero NOTFORLOAN status if it does not yet exist in Authorized
        values.
    [2] Check that you do not see two "For loan" statuses on inventory form.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 24313d2b8a9bfb06b2281af11f1721f0a5fc75e8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 15 14:43:33 2017 -0300

    Bug 17762 - (follow-up) DBRev 16.12.00.033

commit 0c5905843dfc55e422c667f9d0aa6f243f56f1a8
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Sat Nov 12 08:50:04 2016 +0100

    Bug 17618: perl-modules Debian package name change
    
    Newer versios of perl-modules have a version number in the package name.
    This patch makes Koha aware of perl-modules-5.22 and perl-modules-5.24
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 765c7edc8db27d6c34593b29564cbfdc82e1e8bc
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue May 2 06:25:06 2017 -0400

    Bug 18350 (QA Followup) Add classes to elements
    
    Provide classes for easy access in case library wishes to make further
    chnages
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fbc072d7a588d5309d4af065ee6512be3f54e7a1
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Mar 30 02:01:38 2017 +0000

    Bug 18350: Moving call number in subscriptions tab in OPAC biblio detail
    
    This patches moves the call number up to be under the library name, so
    it is equivalent to the staff client
    
    To test:
    1) Go to the detail page of a biblio with subscriptions in the staff
    client
    2) Notice callnumber sits under the library name
    3) Go to the detail page of the same biblio in OPAC
    4) Notice callnumber is not in the same order
    5) Apply patch, refresh page
    6) Notice callnumber is now in same order
    
    Sponsored-by: Catalyst IT
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b8b59892920935adb817167bc49631bcdcc3c023
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 9 21:25:46 2017 +0000

    Bug 18314 - DBRev 16.12.00.037
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1f77e2aa35a9e865840da090291214b5dc08340a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 28 16:48:30 2017 -0400

    Bug 18314 (QA Followup) Use OpacBaseURL for password reset link
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 70dac3513698aaa7ff20f2ba121a9f650045b171
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 28 17:15:40 2017 -0300

    Bug 18314: Add link to 'reset your password' from staff
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a5e84d45c07a62d682c25251d2f3fcc9577c6d97
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 28 17:14:53 2017 -0300

    Bug 18314: Fix reset number of login attempts on login success
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f4dd6fb0a239e13b35d3af03473b05766f2b96f4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 21:18:17 2017 -0300

    Bug 18314: Add tests
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ce41be3dfc303a999ab28e10b1e051aa36fc0e4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 21:18:10 2017 -0300

    Bug 18314: Resetting the password removes the lock
    
    When a password is changed (updated by a staff member or using the
    "recover password via email" feature, the counter/flag needs to be
    reset.
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cfc484b173120dfe14616424c1ec279bb74cf2a9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 18:48:41 2017 -0300

    Bug 18314: Account lockout
    
    To prevent brute force attacks on Koha accounts, staff and opac, we need to
    implement an account lockout process to Koha.
    
    After a number of failed login attempts a users account would become locked.
    The user would then need to use the reset password functionality to send a reset
    token to their email account. After a successful password reset the lockout flag
    would be removed.
    
    The number of failed login attempts before lockout is configurable using a new
    system preference 'FailedLoginAttempts'.
    
    How does it work?
    When a patron enter an invalid password, the borrowers.login_attempts value
    for this patron is incremented. When this value reach the value of the
    pref FailedLoginAttempts, the password comparison is not done and the
    authentication is rejected.
    This login_attempts field is reset when a patron correctly logs in. When
    the account is locked the patron has to reset his/her password using
    the OpacResetPassword feature or ask a staff member to generate a new
    password.
    If the pref is not set (0, or '') the feature is considered as disabled,
    but the failed login attempts are stored anyway.
    
    Test plan:
    0/ Apply patch and execute the update DB entry
    1/ Switch on the feature by setting FailedLoginAttempts to 3
    2/ Use an invalid password to login at the staff or OPAC interface
    3/ After the third consecutive failures, you will be asked to reset your
    password if OpacResetPassword is set, or contact a staff member
    4/ Switch on OpacResetPassword and reset your password
    5/ Confirm that you are able to login
    6/ Play with the different combinations
    
    QA details: The trick happens in C4::Auth::checkpw, to make things clear
    I had to create a return value (note the awesome name: @return) and
    replace the 3 successives if statements with elsif. Indeed if one of
    the condition is reached, it will return inside the given block.
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1e9f3e721d839270a682fdc842f9d3f217200e60
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 17:20:00 2017 -0300

    Bug 18314: Add pref FailedLoginAttempts and columns borrowers.login_attempts
    
    And of course deletedborrowers.login_attempts
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e7a197a5e80af89f01fbfd15f8daeb8fa2fd7e03
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 9 21:20:40 2017 +0000

    Bug 17465 - DBRev 16.12.00.036
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 23a2cd5214f8c5f234cd80783c3021281e5a6846
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Apr 5 04:41:03 2017 +0000

    Bug 17465: NumSavedReports syspref
    
    To test:
    1) Apply patch and update database
    2) Go to system preferences. Default value should be 20 reports.
    3) Go to Reports -> Use saved. Confirm 20 results are showing
    4) Change value in syspref to any integer (i.e. 50)
    5) Go back to Reports -> Use saved. Confirm the number of results shown
    is based on the value in the syspref.
    
    Sponsored-by: Catalyst IT
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c6367282dab65b788951d9bf10075503e8d12901
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 9 21:16:05 2017 +0000

    Bug 15705 - DBRev 16.12.00.035
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 10b94f676d8150c8071d2c6593ece951a40257da
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 4 13:22:29 2017 -0400

    Bug 15705 (QA Followup) Remove unused variable, fix typo and add due date to notice
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1bc3fe4d916bce19bf3b604fc3352d18e42751a9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 4 13:21:17 2017 -0400

    Bug 15705: DB Changes - Add [old_]issues.auto_renew_error and the AUTO_RENEWALS notice
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7fd8f44d71d8ba235fc3ca02847321895c76c887
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 3 04:17:30 2017 -0300

    Bug 15705: Add --send-notices to the cronjob script
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6580be29637ea51c399bcc7697c0037738082aad
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 3 04:17:12 2017 -0300

    Bug 15705: DBIC Schema changes
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 97b43e633d658fee6020756d7e068415940a68cb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 30 13:55:36 2017 -0300

    Bug 15705: Reset the last error when an auto renew successes
    
    The auto_renew_error has to be reset when an auto renew successes,
    otherwise the patron is not going to receive the correct notice.
    
    Test plan;
    - Checkin an item and mark it as auto renewal (specify a due date in the past to allow auto renewals)
    - Set OPACFineNoRenewalsBlockAutoRenew to 'Block' and 'OPACFineNoRenewals' to '1'
    - Execute the script
    => Auto renewed, column auto_renew_error is null
    - Add a fine of '2' to the patron
    - Execute the script
    => Not auto renewed, column auto_renew_error is 'auto_too_much_oweing'
    => On the interface youo see the correct message "Automatic renewal failed, patron has unpaid fines"
    - Pay the fine
    - Execute the script
    
    Without this patch the auto_renew_error is not reset and the patron is going to
    receive a letter telling him he own too much money to the library
    With this patch the patron will receive a letter to inform him the renew has been done!
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ee53560da63af149815c876369b747f932ba397b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 24 11:43:31 2016 +0000

    Bug 15705: Add specific warning messages for auto_too_much_oweing
    
    Signed-off-by: Janet McGowan <janet.mcgowan@ptfs-europe.com>
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 14fb70aa01b59020f6d610d6b72c21f5a4d01c1b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 29 16:57:21 2016 +0000

    Bug 15705: Notify the user on auto renewing
    
    When an issue is auto renewed, a notice will be sent to the patron.
    The notice will tell if the renewed has been successfully done.
    
    Note that this patch is not ready to be pushed yet, as it has some
    defects:
    - 1 notice per issue
    - no way to disable the notice generation
    - no way to specify patron categories to enable/disable the
      notifications
    
    Test plan:
    Use the automatic_renewals.pl script to auto renew issues.
    If the auto renew has failed or succeeded, a notice will be generated in the
    message_queue table.
    If the error is "too_soon" or is the same as the previous error, the
    notice won't be generated (we do not want to spam the patron).
    
    Signed-off-by: Janet McGowan <janet.mcgowan@ptfs-europe.com>
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 115d4f7d2fd8a3550eb6272d50f91f1d05a513a2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 9 21:08:06 2017 +0000

    Bug 15582 - DBRev 16.12.00.034
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 61f26926aabce194d4f72da6a9216dff0e1b53e7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 12 09:32:39 2016 +0100

    Bug 15582: Fix grammar in syspref description
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    Signed-off-by: Janet McGowan <janet.mcgowan@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d08a0bc68505307da187b3b0b215cddd2b0ee742
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 14 14:52:06 2016 +0000

    Bug 15582: Ability to block auto renewals if OPACFineNoRenewals is reached
    
    If a patron owes more than the OPACFineNoRenewals value, the issue won't
    be auto renewed anymore (driven by the new pref OPACFineNoRenewalsBlockAutoRenew).
    
    Test plan:
    Note: You will have to manually change data in your DB, make sure you
    have access to the sql cli.
    1/ Set the OPACFineNoRenewals to 5 (for instance)
    2/ Set OPACFineNoRenewalsBlockAutoRenew to block
    3/ Check an item out to a patron and mark is as an auto renewal
    4/ Make sure the patron does not have any fees or charges.
    5/ Execute the automatic renewals cronjob script (misc/cronjobs/automatic_renewals.pl)
    Confirm that the issue has been renewed
    6/ Create an invoice for this patron with a amount > OPACFineNoRenewals (6
    for instance)
    7/ Execute the automatic renewals cronjob script (misc/cronjobs/automatic_renewals.pl)
    Confirm that the issue has not been renewed.
    8/ Set OPACFineNoRenewalsBlockAutoRenew to allow
    9/ Execute the automatic renewals cronjob script (misc/cronjobs/automatic_renewals.pl)
    Confirm that the issue has been renewed
    
    Sponsored-by: University of the Arts London
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    Signed-off-by: Janet McGowan <janet.mcgowan@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8924f1e23650565bd2317ff10c7c07450098251d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 14 15:03:27 2016 +0000

    Bug 15582: DB changes - add new pref OPACFineNoRenewalsBlockAutoRenew
    
    Sponsored-by: University of the Arts London
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    Signed-off-by: Janet McGowan <janet.mcgowan@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0c2cfc8ac12537929636ebd87b79fd894b38e849
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 28 16:10:01 2017 -0400

    Bug 15179 (QA Followup) Fix comments to 'other classification'
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e021bb48a0e7e3ee10c6584cb1d892e40f6d300a
Author: Karen Jen <karenliang.student@wegc.school.nz>
Date:   Wed Jan 18 02:19:18 2017 +0000

    Bug 15179 -Field 084 doesnt show on bibliographic record
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4e31223aa031266f9b6cbdd33451e0deaa7691ad
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon May 8 12:08:43 2017 +0200

    Bug 18554: Adjust a few typos including responsability
    
    typo responsability
    typo defautl in authorities.pref
    typo reveived in t/db_dependent/Acquisition.t
    typo ;; in advance_notices.pl
    typo Stopping in restart_indexer (koha-indexer)
    typo instutitional in moremember.pl
    typo Corretly (Biblio.t)
    typo periodicy in help serials
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 66ec5909ed87ab1fcbf811caa58c1c29015f5708
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 9 21:00:43 2017 +0000

    Bug 17762 - DBRev 16.12.00.033
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dbf4d50f732e50cea14d8aafccf020a009027fb4
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri May 5 16:20:01 2017 -0400

    Bug 17762 (QA Followup) Fix Letters.t - add lang to fixtures
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c33b3b1342928f046b17383993dc5337e8cc022a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri May 5 16:09:13 2017 -0400

    Bug 17762 (QA Followup) Use default lang if pref disabled
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4308e38fbf3e578ebf0a3e6d90ae2d522945f946
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 24 13:28:50 2017 -0300

    Bug 17762: DBIC Schema changes
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b4254a7ce309617009d0175f06579ea48d7401fa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 23 21:28:56 2017 -0300

    Bug 17762: Fix test for NewsChannels.t
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e76db7e18009882448a605b600e8c4fdd36ace98
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 29 10:31:38 2016 +0000

    Bug 17762: Fix sql fields insertion
    
    The "Insert ->" buttons used to copy the sql field to the textarea was
    based on the id of the fieldset.
    This id has to be unique to work as expected. It is now composed of mtt
    + lang instead of mtt only
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c49bdc3a8d8e5a9389a27a8dca90544ff5c42f95
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 8 17:51:44 2016 +0100

    Bug 17762: Add the lang parameter to C4::Letters::getletter
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f7b11f38e8c779685662be9dbd43e5eb30339e4d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 8 16:11:21 2016 +0100

    Bug 17762: Send lang to GetPreparedLetter
    
    This patch set the lang parameter when C4::Letters::GetPreparedLetter is
    called to generate the notice.
    Note that we do not need to pass it if want_librarian is set.
    
    TODO: I do not know what to do with TransferSlip
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c99fc9d7c29193936b2686db97670a6444f98288
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 8 15:01:37 2016 +0000

    Bug 17762: Update the letter form interface
    
    If the pref is on, the notice template will be translatable in different
    languages
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f244dd38597b0e270b5233ca7b5454f2c669371c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 8 15:24:11 2016 +0100

    Bug 17762: Add lang to the PK of letter
    
    We need to enlarge the PK of the letter table.
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0137e49d6fa77bc57e8db16ad0314b6207cd89ac
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 8 15:20:24 2016 +0100

    Bug 17762: Remove FK on message_transports
    
    I don't really understand where does come from this foreign key but at first glance it does not make sense.
    
    Note that it seems we could also remove message_transports.branchcode
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 40cd76882e3eba0abff81fecdb765a7820b49052
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 8 10:52:30 2016 +0000

    Bug 17762: Add the lang attribute to the patron form
    
    Not the opac because we do not want the patron to modify it, they won't
    be necessary translated.
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2b35e37d7f6c53ddc1c8f3c459288e2d502cba8e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 8 11:27:11 2016 +0100

    Bug 17762: Add the new TranslateNotices syspref
    
    This whole patch set adds the ability to translate notices in different
    languages.
    That way, if a library has patrons from different countries, they will
    not have to send the notices in only one language but they will be able to
    translate them.
    
    Test plan:
    - Switch on TranslateNotices
    - Translate the interface in different languages
    - Edit patron's details
    => You should see a new "prefered language" entry
    That language will be used to send notices to this patron
    - Edit several notice templates
    => You should see different tabs, 1 tab per language translated at the
    opac (which sounds to make sense)
    - Now the notice generated for this patron should be the one translated
    in the language picked for him
    To confirm that, try to generate several notices for this patron.
    If the notice is not translated, the default one should be used.
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 613c6508f0fd52199f3b4d92882d556d1d48a78d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 8 10:16:29 2016 +0000

    Bug 17762: DB changes - Add new 'lang' columns to letter and borrowers tables
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2dc81eb9a1fd7ed104e731c3699209134a00bb6e
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 2 03:44:27 2017 +0000

    Bug 18035: Front-end changes to serials -> numbering patterns
    
    This patch:
    1) Uses datatables functionality on numbering patterns table
    2) Shows breadcrumbs when using the form to add or modify numbering
    patterns
    3) Updates the Save, Reset, and Test Pattern buttons in the form to be
    bootstrap 3 buttons
    
    To test:
    1) Confirm that datatable sorting works on all columns EXCEPT Actions
    column
    2) Click 'New numbering pattern'
    3) Confirm breadcrumbs reads 'New numbering pattern'
    4) Go back to numbering patterns and Edit an existing one
    5) Confirm breadcrumbs reads 'Modifying number pattern '<name of
    numbering pattern>'
    6) Confirm Save, Reset and Test pattern buttons now show as bootstrap3
    buttons
    7) Confirm all buttons work as expected
    
    Sponsored-by: Catalyst IT
    
    Followed test plan works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1832b315e7dc35a755975d0bd635430ba865c84b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sat Apr 29 09:27:01 2017 +0000

    Bug 17942 [Follow-up] Update style of the web installer with Bootstrap 3
    
    This patch makes changes following QA comments:
    
    - Login error messages now have a style
    - Select all/Select none links should now be translatable
    - Date format hint now correctly detects date format preference
    - Unused JS is removed from onboarding.js
    
    This patch also modifies the 'category_code_check' validation method to
    allow numbers as well as letters.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f5fc081265c4398f046484b495356ef11405b71d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 2 18:24:23 2017 -0300

    Bug 17942: Remove type for messages
    
    It it no longer in used by the templates.
    
    Also add the include files for step5 (if the circ rule is not inserted)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1a7d664714b8d8e7f92e07f02fe3a8fc966c0c98
Author: Kyle M Hall <kyle@kylehall.info>
Date:   Fri Apr 28 12:20:06 2017 +0000

    Bug 17942 - Add anti-clickjack code to installer doc head close
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6596513d4b5e0d20ee6b68fadbee2e5841997115
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Apr 27 15:20:20 2017 +0000

    Bug 17942 - Update style of the web installer with Bootstrap 3
    
    This patch makes style and markup changes to the web installer and new
    onboarding tool (Bug 17855).
    
    - Markup has been corrected, improved, and in many places reindented.
    - Some page titles have been made more specific.
    - Some JavaScript and CSS have been moved to separate files.
    
    In the onboarding tool I have removed form validation from the markup
    and JavaScript in many cases where the requirements were not matched
    elsewhere in Koha. For instance, we shouldn't limit item type
    descriptions to only letters because the database doesn't require such a
    limit.
    
    To test, apply the patch and run the web installer with an empty
    database. Confirm that the installation process completes correctly and
    that each page looks good and works correctly.
    
    Works as advertised
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ca50a65cb8ca6dcc61fcdd46428e45e967d4ea87
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri May 12 09:18:04 2017 -0400

    Bug 17936 [Generated CSS] Search bar not aligned on right in small screen sizes
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e94709cd7efaf3151ef1bde9278bc063a6ddcac1
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sat Apr 29 17:45:48 2017 +0000

    Bug 17936 - Search bar not aligned on right in small screen sizes
    
    This patch tweaks the OPAC's CSS so that the main search form's fields
    have consistent width at small screen sizes.
    
    To test, apply the patch and process the LESS files. View the OPAC main
    page at a very narrow browser width and confirm that the text field
    width matches that of the dropdown and button.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e739fecbc83ff0ee32f155ae7e74c4780a5201c2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 17 16:49:40 2017 +0100

    Bug 17925: Disable debugging in reports/bor_issues_top.pl
    
    Remove setting $debug to 1. This prevents creation of file
    tmp/bor_issues_top.debug.log.
    Enable warnings pragma.
    Resolve a uninitialized warning on $sep like:
    Use of uninitialized value $CGI::Compile::ROOT::usr_share_koha_masterclone_reports_bor_issues_top_2epl::sep in string eq at /usr/share/koha/masterclone/reports/bor_issues_top.pl line 66.
    
    Test plan:
    Restart Plack (as you always do when testing).
    Remove file /tmp/bor_issues_top.debug.log.
    Open Reports/Patrons with the most checkouts.
    Check if the file in /tmp has not been created again.
    Check the log for warnings after you restarted Plack.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6da7ed1d8c17960e1e90b8f197fe948d4ed25bad
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Apr 27 15:39:35 2017 -0400

    Bug 18504 - Amount owed on fines tab should be formatted as price if <10 or credit
    
    To test:
    1 - Give a patron a fine of 1
    2 - View opac fines tab, it shows as '1'
    3 - Give patron a credit of '1'
    4 - View opac fines tab, it shows as '1'
    5 - Apply patch
    6 - Both now show as '1.00'
    
    Signed-off-by: Lisa Gugliotti <lisa@hchlibrary.org>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e3141c6fff2b80f10b536411cefa64152cfb99da
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sat Apr 29 18:48:05 2017 +0000

    Bug 16515 [Generated CSS] Did you mean? links don't wrap on smaller screens
    
    Processed and minified CSS.
    
    Works as expected and looks much tidier now.
    Signed-off-by: Dilan Johnpulle <dilan@calyx.net.au>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 893ead43f751df78bfdcb23ebb137b7975885ec9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sat Apr 29 18:45:30 2017 +0000

    Bug 16515 - Did you mean? links don't wrap on smaller screens
    
    This patch tweaks some CSS in the OPAC to give the "Did you mean" block
    better layout on smaller screens.
    
    To test, apply the patch and process LESS files. Enable "Did you mean"
    plugins for the OPAC in Administration.
    
    Perform a search in the OPAC and confirm that the "Did you mean" block
    looks correct. Resize your browser to various widths and confirm that
    the block handles all sizes well.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 69a24812eda9c10841d8f20ce4c689305703b6f0
Author: Pongtawat Chippimolchai <pongtawat@punsarn.asia>
Date:   Tue Apr 4 23:06:45 2017 +0700

    Bug 18383 - Correct items.onloan schema comment
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Amended to include items and deleteditems.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 693dde521d33410f785c67a434421b19956e3bb9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sat Apr 29 08:40:26 2017 +0000

    Bug 18529 - Template cleanup of patron clubs pages
    
    This patch addresses template issues with the newly-added patron clubs
    pages.
    
    - Move Clubs tab out of second position in Circulation page tabs.
    - Link patron name in enrollments list to the patron record
    - Make page titles on some pages more specific
    - Correct label "for" attributes so that it matches input id
    - Correst style of buttons: Buttons in tables must be "btn-xs," all
      Bootstrap buttons must have "btn-default."
    - Correct "Edit" icons: Should be "fa-pencil"
    
    This patch also revises the club template editing form to make it more
    consistent with similar interfaces in Koha and (hopefully) make it more
    clear.
    
    To test, apply the patch and test adding clubs and club templates and
    enrolling patrons in clubs via the staff client and OPAC. Confirm that
    everything looks and work okay.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 720071004516ec4e119dc5ec7f9538b56313b186
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 6 10:12:20 2016 +0100

    Bug 17257: Fix add/edit patrons under MySQL 5.7
    
    If no guarantor is defined the patron won't be added/modified and an
    error will be raised:
    
    DBD::mysql::st execute failed: Incorrect integer value: '' for column
    'guarantorid'
    
    Test plan:
    Using MySQL 5.7 (and/or sql_mode=STRICT_TRANS_TABLES)
    Create a patron without guarantor
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Tested with MariaDB 10.0.30 (sql_mode='STRICT_TRANS_TABLES')
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3e1f21ae0ddcef1c351639e228410f8523f5efe4
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Tue Apr 18 12:24:26 2017 +0000

    Bug 18444: Add TalkingTechItivaPhoneNotification to sysprefs.sql
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e10a415ef92f69b2645866720e93fbbdd3c6672a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 12 10:59:11 2017 +0200

    Bug 18400: [QA Follow-up] Move sort outside the loop
    
    GetItemTypesCategorized can return descriptions that are still undef since
    Authorized values does not enforce a description in lib and lib_opac.
    When I add one ITEMTYPECAT auth value without descriptions, I can still
    generate the string comparison warnings on the itemtypes sort.
    In order to prevent the warning, we should add an empty string in the
    assignment on line 229.
    
    We do not need to copy the itemtypes hash if we move the sort outside the
    @advanced_search_types foreach. There is no need to sort it more than once.
    Note that I did not see any reasons btw for corruption of the structure
    inside this loop.
    
    Note: If we use ITEMTYPECAT without descriptions, we should probably leave
    them out. No need to show a checkbox without description on Advanced Search,
    but I would recommend to solve that on its own report. The whole ITEMTYPECAT
    functionality has imo not been designed properly.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 91171650ac980415d9d2976fa6b19365fe545b37
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 7 12:51:49 2017 -0400

    Bug 18400 - Noisy warns in opac-search.pl during itemtype sorting
    
    To fix the warns we use a copy of itemtypes which is not touched by
    other code
    
    To test:
    Apply patches
    Ensure search still works
    
    Followed test plan, search works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ec822b855244cacf36757e9028779ad9d270c370
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 11 12:37:24 2017 -0300

    Bug 18370: Use splice instead of splice
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0a2b14dd16292572e5163e5dfa491432be1660d2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 3 11:50:07 2017 -0300

    Bug 18370: Columns visibility on patron search - Hide the correct column
    
    When a column is hidden by default on the patron search result table,
    if the logged in user does not have the "tools > manage_patron_lists"
    permission, the wrong column will be hidden.
    
    Test plan:
    Edit the column visibility detail for "Patrons > id=memberresultst"
    Set "Fines" hidden by default
    Search for patrons
    => Without this patch, if the logged in user does not have the
    manage_patron_lists permission, the wrong column will be
    hidden/displayed.
    
    Signed-off-by: Séverine Queune <severine.queune@bulac.fr>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e424bd0d84d4aa30ceae5e6cea0ee453413f0ef9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 27 17:18:22 2017 -0300

    Bug 18340: Fix progress bar length
    
    The progress bar (for background jobs) should be fully filled when 100%
    is hit, right? :)
    It has been introduced quite long time ago when the size of the progress
    bar has been changed from 150 to 200px, and the code has been
    refactored.
    
    Test plan:
    Launch a big modification/deletion of records/items in a batch.
    You should see the progress bar progressing to 100 and reach 100!
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ef1c6140e81c370a743e20bdacb4dcec0d3e6e3e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon May 8 21:23:22 2017 +0000

    Bug 18557 [QA Followup] - Use dt_from_string
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1f065a12c21ad8a90cac7ca6d8cdb1f171ffa79c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 9 07:56:53 2017 -0400

    Bug 18557 - Mysqlim CURRENT_DATE in Koha::Clubs::get_enrollable
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/Clubs.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af845c143a4f5a8fb1ea88cac3478ef91a1bdb9c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed May 3 16:43:22 2017 -0400

    Bug 18535 - Clicking 'edit printer profile' in label creator causes software error
    
    1) Go to Tools > Label creator
    2) If you don't have a printer profile defined, create one.
    3) Go to manage > Printer profiles
    4) Click the 'edit' button on any of the profiles.
    5) INTERNAL SERVER ERROR! "Can't use string ("fields") as a HASH ref
    while "strict refs" in use at /usr/share/koha/lib/C4/Creators/Lib.pm
    line 147"
    6) Apply patch
    7) Click the 'edit' button on any of the profiles.
    8) Things work as expected
    
    Bug reproduced, is fixed by this patch
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 463c5a0f25a1e2dfc3331319bd86f17b4114821e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Jun 21 14:49:32 2016 -0400

    Bug 4460: Amazon's AssociateID tag not used in links so referred revenue lost
    
    Reworking based on output of:
    git grep "gp\/reader"
    Additionally, some changes might be in order though gp/reader works.
    https://affiliate-program.amazon.com/help/topic/t64/a1
    suggests using dp
    A dp was discovered, so that part of the URL was left unchanged.
    The "/ref..." part was changed to just an Amazon tag ("?tag={AAT}")
    if defined.
    
    TEST PLAN
    ---------
     1) Added:
         "100 years of Canadian foreign policy /
          edited by Robert Bothwell and Jean Daudelin."
     2) Added a second book with the word foreign in the title.
     3) Waited for reindex
     4) Checked out the Canadian foreign policy book.
     5) Applied patch
     6) Made sure that:
        - AmazonAssocTag was set to TEST (easy to notice)
        - AmazonCoverImages was set to 'Show'
        - OPACAmazonCoverImages was set to 'Show'
     7) Searched intranet for 'foreign' to find the detail page
        -- hovering over picture shows URL with ?tag=TEST in it.
     8) Went to the OPAC Detail page
     9) Toggling OPACURLOpenInNewWindow, confirmed that URL for
        the picture contained ?tag=TEST in it.
    10) Logged into the OPAC
    11) Confirmed the URL in the checked out list on your summary
        page contained ?tag=TEST in it.
    12) Confirmed the URL in the checked out list on your reading
        history page contained ?tag=TEST in it.
    13) Confirmed links worked (went to expected page)
    14) run koha qa test tools
    
    Followed test plan. Works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer.83@web.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9a3ad32e468f2a006a43577031f3aa50b83fb3d8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 2 19:12:49 2017 -0300

    Bug 18525: (bug 14828 follow-up) FIX ordering from suggestion when item-level_itypes = biblio
    
    When ordering from a suggestion with item-level_itypes = biblio the app
    crashes with
    Template process failed: undef error - The method selected is not
    covered by tests! at /home/vagrant/kohaclone/C4/Templates.pm line 121.
    
    C4::ItemTypes->all did not set a selected flag. The item type is only
    display when ordering (and not modifying an order).
    The flag is never set, the test can be removed.
    
    Test plan: Confirm that the error is gone
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit caa4cccfa09cdf5c9816634194000307ac508578
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 8 12:43:43 2017 -0300

    Bug 16758: Use the default cache instance
    
    I do not see a valid reason not to use the default one instead of the
    syspref one.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 84dbc80074b5b1ada05b815cba810e4c5fb10dd2
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Wed Sep 14 15:33:07 2016 +0200

    Bug 16758 - Caching issues in scripts running in daemon mode
    
    As L1 cache does not have expiration mechanism, scripts running
    in daemon mode (rebuild_zebra.pl -daemon, sip server ?, ...) would
    not be aware of any possible changes in the data being cached
    in upstream L2 cache.
    
    This patch adds ->flush_L1_caches() call in rebuild_zebra.pl
    inside daemon mode loop.
    
    To test:
    
    1) apply patch
    2) ensure that rebuild_zebra.pl -daemon is still working properly,
    without any noticeable performance degradation
    3) stop memcached daemon and try to run rebuild_zebra.pl -daemon
    again: there should be a warning emitted stating that the script
    is running in daemon mode but without recommended caching system
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8823b41d17465f667bb41a1c373de4c3002d2957
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 10 13:13:09 2017 -0300

    Bug 18573: (bug 17847 follow-up) Update av-build-dropbox.inc for OPAC
    
    On bug 17847, av-build-dropbox.inc has been updated for the intranet,
    not OPAC
    
    There is only one call to av-build-dropbox.inc at the OPAC, from
    opac-suggestion.tt
    
    Test plan:
    Create a new suggestion, anonymous or with a logged in user
    => Without this patch you got
      Template process failed: undef error - The method default is not
      covered by tests! at /home/vagrant/kohaclone/C4/Templates.pm line 121.
    => With this patch applied you should see the item type dropdown list
    correctly filled
    
    Reproduced without patch, OK with patch
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f3167a5259a5adb5cc00455bb81a269e29081742
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue May 9 00:15:23 2017 -0400

    Bug 18560: RSS link in opac shelves is broken
    
    TEST PLAN
    ---------
    1) have books entered
    2) log in create a list
    3) add books to list
    4) display list
    5) click the RSS link button.
       -- bad HASH error.
    6) apply patch
    7) repeat steps 4&5
       -- readble junk without error messages.
    8) run koha qa test tools
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 61ca4deee3f94bb30183a7f68a6ccc8e349ee0b9
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri May 12 09:25:23 2017 +0200

    Bug 18579: Fix call to append_fields, fix tests
    
    MARC::Record::append_fields takes a list of MARC::Field (not an arrayref)
    
    Use $record->subfield() instead of $record->field()->subfield() to avoid errors
    when field doesn't exist
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 542ac21b94a8eec05b3f194f5ffbe4e19f511738
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 11 13:07:37 2017 -0300

    Bug 18579: Make EmbedItemsAvailability handle control fields correctly
    
    This patch makes the EmbedItemsAvailability filter handle the biblio.biblionumber > control field mapping gracefully.
    Right now, it was assuming a regular data field was used, and such is not the case for UNIMARC (001).
    
    To test:
    - Apply the tests patch
    - Run:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ prove t/db_dependent/Koha/Filter/EmbedItemsAvailability.t
    => FAIL: Tests fail to run
    - Apply this patch
    - Run:
     k$ prove t/db_dependent/Koha/Filter/EmbedItemsAvailability.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3e1d76dbc0e98bb8a0d66c99a9c9b1afa936e62e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 11 13:04:18 2017 -0300

    Bug 18579: Regression tests
    
    This patch makes sure the tests have the biblio.biblionumber mapping mocked
    so we test the case where the mapping is to a control field instead of just
    regular data fields (in the case of UNIMARC).
    
    To test:
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Koha/Filter/EmbedItemsAvailability.t
    => FAIL: Tests fail due to an attemp to access a subfield on a control field.
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7a4f3c17a8fe518534658009d075dcdc1d537b62
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed May 10 11:46:36 2017 -0400

    Bug 18574 - Clean Patron Records tool doesn't limit to the selected library
    
    The library selector simply does nothing because at some point the
    javascript that powers it was removed. This is very bad because
    the librarian may batch delete patrons assuming it is limiting by
    branch correctly and instead delete patrons for all the libraries!
    
    Test Plan:
    1) Note that the library pulldown on tools/cleanborrowers.pl does nothing
    2) Apply this patch
    3) Note that chaning the value in the pulldown now refreshed the page and sets the library correctly!
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7130d554584b7ab4f4480399f5d29a90d0aef3d6
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 9 09:16:49 2017 -0400

    Bug 12063 - DBRev 16.12.00.032
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 07de44bcd1e42bfb82f1da89758783b26e79cbf8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu May 4 14:15:51 2017 +0200

    Bug 12063: [QA Follow-up] Small change of two test scripts
    
    Removing dbh from one script, changing rollback in the other.
    Schema is leading now.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2144fecdf06a484cb1047d3bbdd84b66d16e1805
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu May 4 12:53:03 2017 +0200

    Bug 12063: [QA Follow-up] Adjustments to db revision
    
    Replace use by require.
    Add require Koha::Calendar (seriously needed to prevent crashing).
    Base expirationdate on today not on waitingdate (just as in Reserves).
    Remove if ( waitingdate ) construction. Not needed anymore.
    Remove $cancel_on_holidays. Not used. Note that the if construction around
    the new pref is not strictly needed at upgrade time (pref still zero).
    Fill the dbrev description.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a08b309c4f7fc9714a660e4422fdf1f2b7f65dd6
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu May 4 08:54:16 2017 +0000

    Bug 12063 - Remove checking of ExpireReservesMaxPickUpDelay in CancelExpiredReserves(). Koha::Hold::set_waiting calculate expiration date from today instead of hold's waiting date.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 342baadde51494a39c020715e83777838a933485
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Apr 20 14:22:25 2017 +0000

    Bug 12063 - make perl atomic update follow skeleton.perl
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 26634151dbce0bf39ff6c9eda5b58bb993996a2d
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Mar 30 09:53:10 2017 +0000

    Bug 12063 - Fix QA failures
    
      - Remove expiration date calculation in C4::Letter since it's done
        when setting the reserve waiting,
      - remove expiration date calculation in circ/waitingreserves.pl. Use
        the one in DB,
      - add a new atomic update that calculate expiration date for
        waiting reserves,
      - add tests for days_foward function and fix the infinite loop.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6add80083b1f8596496d13569347818ed8ce71a9
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Mar 22 12:55:49 2017 +0000

    Bug 12063 - Fix unit tests
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8fc77442585d28b11dc0ed2fd4f99e190db47c35
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Jan 18 14:13:33 2017 +0000

    Bug 12063 - Keep patron's requested expiration date if it is prior to the calculated one
    
    Signed-off-by: Andreas Hedström Mace <andreas.hedstrom.mace@sub.su.se>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d477cc24f66938abf2503f871043378b10460475
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Jun 30 10:00:26 2016 +0200

    Bug 12063 - Remove Koha::Hold::waiting_expires_on since dateexpiration is set on database
    
    Signed-off-by: sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7cf3c12f5bd2a4a4acb7162e7b3297dbe492350e
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Mon Jun 20 11:52:37 2016 +0200

    Bug 12063: Change date calculation for reserve expiration to skip all holiday
    
    This patch makes koha automatically set expiration date when reserves become
    waitting. Also it adds a new syspref "ExcludeHolidaysFromMaxPickUpDelay" that allows to
    take holidays into account while calculating expiration date.
    
    Test plan:
    
      - Install this patch and run updatedatabase.pl script,
      - allow ExpireReservesMaxPickUpDelay in system preferences,
      - set ReservesMaxPickUpDelay to 5.
    
      - Place an hold on a checked out item and check in this item:
        The hold's expiration date should be today + 5.
    
      - Allow ExcludeHolidaysFromMaxPickUpDelay in system preferences,
      - add holiday during this pickup delay period,
      - Create a new hold and make it comes waitting:
        The hold's expiration date should be today + 5 + number of closed
        day(s).
    
    Also:
      - Check that ExpireReservesOnHolidays syspref works again
        without ExcludeHolidaysFromMaxPickUpDelay.
      - Check that cancel fees apply again if wanted.
    
    Signed-off-by: sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 89c0ecef47e34f151e10ebfb2e3cc927ecaa93f3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 8 12:54:51 2017 -0300

    Bug 18553 - Incorrect Loading... tag on circulation.tt when no clubs defined
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3c344c20cf8837d294a47ff81dc2a4cac66473cf
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri May 5 17:20:09 2017 -0400

    Bug 18553 - Incorrect "Loading..." tag on moremember.tt when no clubs defined
    
    To test:
    1 - Have no clubs
    2 - View Details tab for a patron
    3 - Note the 'Loading' tag near the tabs
    4 - Apply patch
    5 - Load patron details and notice 'Loading' is gone
    6 - Add a club and verify tab shows as expected
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 94e09b6a186a4a8f1a2a470c41493ad228d0be20
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 28 08:48:50 2017 +0100

    BUG 18505: opac-search-history does not respect opacPublic
    
    The opac-search-history page was available regardless of the opacPublic setting, this
    patch corrects that.
    
    Test plan, set opacPublic to 'No', test whether opac-search-history page is available
    when not logged in, note that it is.
    Apply patch, test whether opac-search-history is still available when not logged in,
    note that you should be redirected to the login page.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5da5910cf1fb69810b11de1fd4362fc2128d1e46
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon May 1 12:46:20 2017 -0400

    Bug 18494: Pass a code, not hash & Fix double commas
    
    TEST PLAN
    ---------
    1) prove -v t/db_dependent/Letters.t
       -- fails at test 5 or so.
    2) apply patch
    3) run step 1
       -- success
    4) run koha qa test tools
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ffa361c241118d0ee58b14ae749e6ee8f3284349
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon May 8 09:29:38 2017 -0400

    Bug 15108 - DBRev 16.12.00.031
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5fbd65513329eb8962d10221e0c60417b9cfe726
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri May 5 11:38:31 2017 -0300

    Bug 15108: (QA followup) Fix atomic update file
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c22e18d5a097ce9ece52f68e3fd9a2bb77a772a2
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Thu Feb 23 14:44:09 2017 +0200

    Bug 15108: (followup) OAI-PMH provider improvements
    
    Fixed OAI-PMH Server tests to delete any existing issues before deleting biblios,
    to delete oai_sets to avoid sets in the responses and to work with UNIMARC and
    NORMARC as well as MARC21.
    
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9356c050b2fa2453912581f15938e4bc16b2cc32
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Wed Feb 15 15:20:27 2017 +0200

    Bug 15108: OAI-PMH provider improvements
    
    - Fixed date handling to use UTC as specs require.
    
    - Added support for second precision in time stamps.
    
    - Added support for marc21 metadata prefix as recommended in the
      guidelines (synonym for marcxml).
    
    - Improved performance of database queries especially for large
      collections.
    
    - Unified functionality of ListRecords and ListIdentifiers to a common
      base class.
    
    - If items are included in the records, their timestamps are taken into
      account everywhere so that whichever is the most recent (timestamp of
      biblioitem or any of its items) is considered the record's timestamp.
    
    - Fixed OAI.xslt to show correct record range.
    
    - Incorporated extended tests from Bug 17493 and their tweaks from Bug 15108.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 56bbec4a4ea441ed9d96f6a721cb0f8db2c2550a
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Tue May 2 13:52:25 2017 +0000

    Bug 18299 - Removed unused env_tz_test.pl based on user testing feedback
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fac7ba914d7f3071102563109ce843f1e97bc46f
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Wed Mar 8 18:12:59 2017 +0200

    Bug 18233 - t/db_dependent/00-strict.t has non-existant resetversion.pl
    
    Removes a warning.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5ef1b6710e7520b844e145e248da0deeee707fde
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 3 18:32:06 2017 -0300

    Bug 18098: Add an index with the count of not onloan items
    
    This patch adds a numeric index 'not-onloan-count' containing the value
    of 999$x. This subfield is filled by 'rebuild_zebra.pl' by making use of
    (bug's 18208) 'EmbedItemsAvailability' filter.
    
    bib1.att and indexes definitions are updated accordingly.
    
    To test:
    - Apply the patch
    - Pick the right biblio-zebra-indexdefs.xsl file for your setup and
      replace the one your Zebra uses [1]
    - Replace your bib1.att
    - Replace your ccl.properties
    - Have at least one record with more than one item, checkout some
      item(s) from that record(s).
    - Rebuild zebra's indexes:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ misc/migration_tools/rebuild_zebra.pl -r -b -v -k
     (notice the dump directory is kept, you can try the XSLT yourself
      running:
        $ xsltproc \
           etc/zebradb/marc_defs/marc21/biblios/biblio-zebra-indexdefs.xsl \
           /tmp/the_dump_dir/biblios/exported_records | less
    => SUCCESS: There are records with the not-onloan-count index, and the
                value is correct!
    - Check Zebra yourself:
      $ yaz-client unix:/var/run/koha/kohadev/bibliosocket
     Z> base biblios
     Z> find @attr 1=9013 @attr 2=5 @attr 4=109 0
    => SUCCESS: The search matches the amount of records with not-onloan
                items.
     Z> s 1+1
    => SUCCESS: Records with 999$x having a value higher than 0 are rendered
    - Sign off :-D
    
    Note: While this work is complete on its purpose, it is part of an
    attempt to create a better way of filtering by availability.
    
    Sponsored-by: ByWater Solutions
    
     [1] In kohadevbox this would be
    /etc/koha/zebradb/marc_defs/marc21/biblios/biblio-zebra-indexdefs.xsl
    
    Edit: Added the missing XSLT changes for UNIMARC and NORMARC
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d16bcb70e7066b6e4c908f560affb281018e788e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jan 3 15:08:32 2017 +0000

    Bug 17812 - Return focus to barcode field after toggling on-site checkouts
    
    This patch changes the behavior of the checkout form so that after
    checking boxes in the "checkout settings" panel the cursor focus is
    automatically moved to the barcode field.
    
    To test, apply the patch and enable OnSiteCheckouts and
    decreaseLoanHighHolds system preferences.
    
    - Open any patron account in circulation.
    - Expand the "Checkout settings" panel.
    - Click the label or checkbox for "Automatic renewal", "Don't
      decrease checkout length based on holds" and "On-site checkout"
    - Confirm that the focus has moved to the barcode field.
    
    Works as advertised.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marjorie Barry-Vila <marjorie.barry-vila@ccsr.qc.ca>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a900a434d50ae232af81c74c98020af3f13bf0e5
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Sun Mar 19 12:00:48 2017 +0000

    Bug 17190 - Marked REST API as mandatory (require = 1) in PerlDependencies.pm
    
    For testing I went in Staff client to Home > About Koha > tab  Perl modules
    and verified that both Mojolicious (6.0) and Swagger2 (0.59) are marked
    as mandatory.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4259ae2836822cfa656500be75c3fec770ef9788
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Apr 11 11:22:13 2017 -0400

    Bug 18415 - Advanced Editor - Rancor - return focus to editor after successful macro
    
    After running a macro we should return focus to the editor screen so
    editing can continue from keyboard
    
    To test:
    1 - Create a macro
       007=vd cvaizq
    2 - Run it and note focus is not on editor
    3 - Apply patch
    4 - Reload page
    5 - Run macro
    6 - Note focus is returned to editor
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f71e3a78b9ad35e7839271de80d89c9044c268c6
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Mar 27 15:19:24 2017 +0200

    Bug 17993 - Do not use modal authentication with CAS - tags bis
    
    Bug 12046 corrected the fact that modal dialog does not allow to use the
    CAS authentication in main authentication link. This must also be
    corrected in link for tags in detail tags page: "Log in to see your own
    saved tags."
    
    Test plan :
    - Enable syspref casAuthentication
    - Go to OPAC, not authenticated
    - Click on "Tag cloud"
    - Click on "Log in to see your own saved tags"
    => Without patch you get the modal login popup
    => With patch you go to the login page opac-user.pl
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 34e813c8d053382313a804c8b2682f138f166926
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Jan 25 14:47:02 2017 +0100

    Bug 17993 - Do not use modal authentication with CAS - tags
    
    Bug 12046 corrected the fact that modal dialog does not allow to use the CAS authentication in main authentication link.
    This must also be corrected in link for tags in detail page : "Log in to add tags"
    
    Test plan :
    - Enable syspref casAuthentication
    - Go to OPAC
    - Go to a record detail page opac-detail.pl
    - Click on "Log in to add tags"
    => Without patch you get the modal login popup
    => With patch you go to the login page opac-user.pl
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dc2a6e5d32fef1f57b03b2119b583d99356931f4
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Jan 25 14:19:16 2017 +0100

    Bug 17993 - Do not use modal authentication with CAS - lists
    
    Bug 12046 corrected the fact that modal dialog does not allow to use the CAS authentication in main authentication link.
    This must also be corrected in link of lists popup : "Log in to create your own lists"
    
    Test plan :
    - Enable syspref casAuthentication
    - Go to OPAC
    - Click on Lists > Log in to create your own lists
    => Without patch you get the modal login popup
    => With patch you go to the login page opac-user.pl
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a0cc3703bfb15f3f94a6eb66cb58e257cd89cf81
Author: Marc Véron <veron@veron.ch>
Date:   Sun Apr 9 16:58:21 2017 +0200

    Bug 18405: Self checkout: Fix broken silent printing
    
    Fix broken 'silent printing' (without printer dialog) in self checkout.
    
    To reproduce:
    Set up silent printing to slip printers as described in:
    https://wiki.koha-community.org/wiki/Setting_up_slip_printer_to_print_silently
    
    Verify that it works for check-outs in staff client.
    Verify that it does not work in Self checkout.
    
    To test:
    Apply patch
    Verify that silent printing works on SCO
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e96f39ab522512fe828940e93ba3737d5f25a16f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon May 1 14:15:58 2017 +0200

    Bug 7550: [QA Follow-up] Resolve param warning from sco-patron-image
    
    Resolve this warning:
      CGI::param called in list context from package C4::Service line 212, this can lead to vulnerabilities. See the warning in "Fetching the value or values of a single named parameter" at /usr/share/perl5/CGI.pm line 436.
    
    It comes from the require_params call in sco-patron-image.pl.
    
    Git grepping on require_params tells me this:
      members/default_messageprefs.pl:my ($categorycode) = C4::Service->require_params('categorycode');
      opac/sco/sco-patron-image.pl:my ($borrowernumber) = C4::Service->require_params('borrowernumber');
      opac/sco/sco-patron-image.pl:my ($csrf_token) = C4::Service->require_params('csrf_token');
      svc/cataloguing/metasearch:my ( $query_string, $servers ) = C4::Service->require_params( 'q', 'servers' );
    
    The only candidate for multi_param seems to be 'servers', but as we can see
    this variable is a scalar. Additional servers returned by require_params are
    lost. This should be solved on its own report.
    So, we can safely add scalar to the params call, resolve the warning and
    keep the same behavior.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 57f28f9ee44a6c8f19dc1411971a7ca397557acd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 19 14:09:12 2017 -0300

    Bug 7550: SCO - Restrict access of patron's image
    
    With this patch if SelfCheckoutByLogin is set to 'username and
    password', only the logged in user will be able to see the image linked
    to his/her logged in account.
    If set to "barcode" we generate a token but it can be easily generated.
    You should add a warning in the about page if
    SelfCheckoutByLogin="barcode" and ShowPatronImageInWebBasedSelfCheck="Show".
    
    How I tested:
    - Go to SCO
    - Log - Enable self checkout, go to [Your
      Server]//cgi-bin/koha/sco/sco-main.pl
    - Log in with a user 'A' who has a patron image
    - Copy the address of the patron image into an other browser window
    - Change the borrowernumber to on of an other user 'B' having a patron
      image
    - Verify that the patron image is NOT displayed
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3ef6d2d5153772cd1701005eef7e9a94bf901c32
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jan 20 14:43:24 2017 +0000

    Bug 17952 - Lost items not skipped by overdue_notices.pl
    
    If a library does not use --mark-returned when running longoverdue.pl,
    all those lost item checkouts are selected by overdue_notices.pl.
    This causes much unnecessary overhead. In addition Koha::Calendar is
    instantiated many times for each branchcode which is not necessary.
    
    Test Plan:
    1) Run overdue_notices.pl, note output
    2) Apply this patch
    3) Run overdue_notices.pl again, note output is the same
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jane Leven <jleven@camdencountylibrary.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0e0897a7e6d2940a496168485e2219d8efa37913
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 2 17:27:48 2017 -0300

    Bug 18512: Add tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62c337065590a0eca51db37d286bcb04fa7971ff
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 28 14:11:00 2017 -0400

    Bug 18512 - GetAuthorisedValues.GetByCode Template plguin should return code (not empty string) if value not found
    
    To test:
    1 - Create or edit a borrower with info in Sort1 and Sort2 field, not
    mapped to authorized values
    2 - Note this info does not display on moremember.tt
    3 - Apply patch
    4 - Note value is passed through
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a807d7199ea025aa507e0ca7e3ff2330902844f8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 3 15:30:14 2017 -0300

    Bug 18152: Add tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bf551a07222a7b9beffd7ca6cba38c675aa3ab28
Author: Stéphane Delaune <stephane.delaune@biblibre.com>
Date:   Wed Feb 22 12:25:33 2017 +0100

    Bug 18152 : fix unimarc label in SetMarcUnicodeFlag
    
    The standard UNIMARC requires than the 9th character (starting from 0) in
    labels must be blank (while it may be 'a' in marc21)
    
    the problem is that C4::Charset::SetMarcUnicodeFlag (called in particular when
    we import a record) always add 'a' char in the 9th label'pos whereas it should
    do it just for MARC21 and NORMARC (not for UNIMARC) :
    
    C4::Charset::SetMarcUnicodeFlag add 'a' char in the 9th label character for
    MARC21 and NORMARC (it's normal), but just before doing this it call
    "$marc_record->encoding('UTF-8')" which is a MARC::Record function which, when
    called with 'UTF-8' parameter, do only one thing : add 'a' char in the 9th
    label character
    
    This patch only removes this incorrect function call, so, when we import a bib
    record in UNIMARC : it no longer adds erroneous character (this does not change
    anything for MARC21 and NORMARC because SetMarcUnicodeFlag explicitly adds 'a'
    char in the 9th label for them)
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9bf8142ee77dbacceca0cb17ed5f56ec07b3771c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 21 18:44:05 2017 -0300

    Bug 18442: Add a test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 416029ff2f3c9c689a5ea24372f4d940ccc71817
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Thu Apr 20 11:29:28 2017 +1200

    Bug 18442: Fix DB user loggin
    
    Test plan:
    1. Drop and recreate your db
    
    2. Clear memcached
    
    3. Go through the installer (to speed up this test plan install all
    sample data so you dont have to create libraries, patron categories etc. later)
    
    4. On the installer page login as the database user and notice that it
    does not work on the first attempt ( you get 'Error: You do not have
    permission to access this page')
    
    5. Try logging in as database user for a second time and notice you are
    logged in successfully this time
    
    4. In staff interface create a patron account with superlibrarian permissions
    
    5. Logout of the staff interface
    
    6. Login as database user
    
    7. Notice you cant log in. You get the 'Error:: You do not have permission to access this
    page' error
    
    8. Try a second attempt and notice you get the same error
    
    9. Open the URL in a new tab and notice the staff interface appears
    showing that you are logged in
    
    10. log out and log back in as the superlibrarian user you created and
    notice it works on first login attempt
    
    11. Apply patch
    
    12. Log out and try logging back in as database user and notice that you
    can login successfully on first attempt
    
    13. Repeat steps 1,2,3 and login as database user and notice the login
    works on first attempt
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4d941f36c72cedd1f006025393b194a8d695e298
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Apr 27 11:37:27 2017 -0300

    Bug 18502: Make koha-shell set the right PERL5LIB on dev installs
    
    Bug 16749 introduced a nice way to have flexible paths. During the discussion on how to do it, we moved from having it contain the path to the git dir to just a boolean. The 'koha-shell' script didn't get attention it seems, and it is broken on dev installs.
    
    This was hidden by the fact that many of us run dev installs on kohadevbox, which sets a .bashrc file for de instance's user, containing the right path when opening the new shell.
    
    This patch changes the logic so on a dev install, intranetdir is picked as the right path. This is how it is handled in koha-functions.sh
    
    To test:
    - On kohadevbox, run:
      $ sudo koha-shell kohadev -c "perl misc4dev/populate_db.pl"
    => FAIL: C4/Installer.pm not found on PERL5LIB error.
    - Apply this patch
    - Replace /usr/bin/koha-shell with debian/scripts/koha-shell
      $ sudo cp kohaclone/debian/scripts/koha-shell /usr/bin/koha-shell
    - Run:
      $ sudo koha-shell kohadev -c "perl misc4dev/populate_db.pl"
    => SUCCESS: No warning about missing libs is raised.
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 1f007ca2e93aa05abdeb8ae78a59b313074abaf0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 28 12:49:05 2017 -0400

    Revert "Bug 18179: Forbid list context calls for Koha::Objects->find"
    
    This reverts commit a1fcf1818c8d9f23d9c870e93c41c67a27faf603.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c1d9a7dab7d57cca9059e4ccf72b3bfc41bfad5a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 28 12:48:56 2017 -0400

    Revert "Bug 18179: Update existing calls"
    
    This reverts commit 2a2b9739117e74232c9a7abde516b1c436d4bad3.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8c1b551b38f1fb26ce4c946d59c8a3cfa83f7a69
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 28 09:28:33 2017 -0400

    Bug 16344 - DBRev 16.12.00.030
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 868ecdbbb33136bad96857da288d9bc060360444
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Apr 27 19:21:11 2017 +0000

    Bug 16344 - Update Schema
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 09fe525003e9412b10bb74dfc5b2f386e1389ebf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 26 16:58:49 2016 +0100

    Bug 16344: Fix alignment between top and bottom columns
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    Signed-off-by: Janet McGowan <janet.mcgowan@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d3e459289f9e9b2ee4a138693d855e829a9b0a82
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 25 21:52:27 2016 +0100

    Bug 16344: Add a circ rule to limit the auto renewals given a specific
    
    This patch adds a new circulation rule (no_auto_renewal_after_hard_limit) to block/allow
    auto renewals after a given date.
    The idea is to stop renewals at a given date. That way the library will have
    time to send overdues and get the books back before the students do on holiday.
    
    Test plan:
    0/ Execute the update DB entry
    1/ Define a rule with no_auto_renewal_after_hard_limit set to tomorrow
    2/ Modify the issues.issuedate, to simulate a checkout in the past:
        UPDATE issues
        SET issuedate = "yyyy-mm-dd hh:mm:ss"
        WHERE itemnumber = YOUR_ITEMNUMBER;
    with issuedate = 2 days before for instance
    3/ Execute the automatic renewals cronjob script (misc/cronjobs/automatic_renewals.pl)
    Confirm that the issue has been renewed
    4/ Modify the no_auto_renewal_after_hard_limit and set it to yesterday
    5/ Execute the automatic renewals cronjob script (misc/cronjobs/automatic_renewals.pl)
    Confirm that the issue has not been renewed
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    Signed-off-by: Janet McGowan <janet.mcgowan@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b492182b69e353f4f08d227b1ec7525a23bd6fe0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Apr 27 19:10:47 2017 +0000

    Bug 14224 - DBRev 16.12.00.029
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6dd7fb7b19ba9417ff8939ed01618ef3d328d825
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 20 13:46:35 2017 -0300

    Bug 14424: DBIC Schema changes
    
    https://bugs.koha-community.org/show_bug.cgi?id=14224
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f5b1154e704d97b63edf6fc9e699ca114c8603ba
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 20 13:42:02 2017 -0300

    Bug 14224: Use encode_json instead of to_json
    
    To handle unicode characters properly
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0fa07cce329e52abea601c75b1d05f9ee915b530
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 1 15:53:06 2017 +0100

    Bug 14224: Check if the columns do not exist before creating them
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e54152a90b0770c240232bc27363f77fed910a8d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 1 17:01:00 2017 +0100

    Bug 14224: Improve escaped characters
    
    To recreate the problem, submit a note like
      doh"doh
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ba658d5919b898c71d21380c9b302818a636c090
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 1 16:56:46 2017 +0100

    Bug 14224: Update Copyright
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c4dd097d20040cc2786ca062d306b8eee1f005e2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 2 11:37:54 2017 +0100

    Bug 14224: Replace AllowIssueNotes with AllowCheckoutNotes
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 88852ffbb0de4a3b06df50921d555cec9b525957
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 1 16:38:37 2017 +0100

    Bug 14224: Make strings translatable
    
    The strings should be translatable.
    This patch also removes the error as it appears that we only have 1
    error.
    To improve we could surround the store with an eval.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a7df1afe60e10f991a017559c9057c40ae20eadb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 2 11:10:30 2017 +0100

    Bug 14224: Fix prevent submit
    
    That did not work, the form was submitted anyway
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8c0ff71ff0f08f6700ca87a75bb8a7c9a046ab88
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 2 11:10:28 2017 +0100

    Bug 14224: Remove SQL query in svc script
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 93e04a9925aa90cfeb5c0ede5b2528dc28848844
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 2 10:49:18 2017 +0100

    Bug 14224: Reintroduce previous copyright
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a56690d3a441abb9e911598865cc68e07e598487
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 1 15:56:34 2017 +0100

    Bug 14224: Do not reintroduce GetItemIssue, it's dying
    
    Bug 17680 is removing it.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0159908ca144bca599ed9a0ff51fd3f0ab2ad0ab
Author: Aleisha Amohia <aleisha@catalyst.net.nz>
Date:   Sun Aug 23 18:22:50 2015 +0200

    Bug 14224: Allow patron notes about item shown at check in
    
    This patch adds a "Note" input field to checked out items in the "your summary"
    section. The field allows patrons to write notes about the item checked out,
    such as "this DVD is scratched", "the binding was torn", etc. The note will be
    emailed to the library and displayed on item check in.
    
    Patch adds two fields to the "issues" table - "note" and "notedate".
    Patch adds syspref "AllowIssueNotes" - default off.
    
    Test Plan:
    1) Apply this patch
    2) Update database
    3) Rebuild schema
    4) Turn on 'AllowIssueNote' syspref
    5) Check out three different items to a borrower (may be easiest to check
        out to yourself)
    6) Log in as that borrower (or yourself) on the OPAC side and go to your
    summary
    7) Confirm text field shows under Note column for all checkouts. Set a
    note for each issue, confirm all save.
    8) Check the message_queue in mysql for the entries for ALL THREE issue
    notes.
    9) Disable javascript in your browser
    10) Refresh your summary page. Confirm that you can no longer edit the
    notes in the text field. Click the 'Create/edit note' button and confirm
    you are redirected to a new page.
    11) Confirm that the correct title and author show for the note button
    you clicked.
    12) Set the note and click Submit -> confirm you are redirected
    back to summary page and note is saved
    13) Confirm there is a new entry in message_queue
    14) Enable javascript and go back to the your checkouts page in the
    staff client for the borrower you issued the items to
    15) Check in TWO items
    16) Confirm that the issue notes show under the "Date due" column for
    the two items you checked in, and are accurate to the item (i.e. the
    right issue note under the right item)
    17) Go to circ/returns.pl and check in the final item using the barcode.
    Confirm the issue note shows and the date is formatted correctly.
    
    Sponsored-by: Region Halland
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Marc Véron <veron@veron.ch>

commit 6f334aab06fd6e07f2ab8b399fbe50168d5818f4
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Apr 24 14:21:00 2017 +0000

    Bug 18484 - opac-advsearch.tt missing closing div tag for .container-fluid
    
    This patch corrects HTML validation errors by adding back a missing
    </div> which was removed accidentally by Bug 9043 (2014!).
    
    This patch also removes "border" attributes from <img> tags because the
    attribute is obsolete.
    
    To test, apply the patch and test the validity of the OPAC's advanced
    search page. The only error should be one about 'Bad value
    "api-server,"' which isn't really resolvable.
    
    Signed-off-by: Barton Chittenden <barton@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a067af7fe2e1a1f0beefadbb319a2bf2e9b9884f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 5 16:42:35 2017 -0300

    Bug 18402: Add the Koha::Item->checkout method
    
    Return the current checkout for a given item.
    Note it may not exist.
    
    Test plan:
      prove t/db_dependent/Koha/Items.t
    should return green
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 02dffe16081fdcf35b50824d963d2420546a95eb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 5 16:42:26 2017 -0300

    Bug 18401: Add new method Koha::Checkout->patron
    
    Return the patron related to a given checkout
    
    Test plan:
      prove t/db_dependent/Koha/Checkouts.t
    should return green
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e3d8fb0b845f50f6debc9a246a09a22f3f88c406
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 28 08:53:00 2017 -0400

    Bug 18110 - DBRev 16.12.00.028
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fbcb0e6505bb74abc131b6e1626ad6976fb40239
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 26 15:41:35 2017 -0300

    Bug 18110: Do not update value for existing installs
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 892527495ad57e98a725d946e182538515cfab2d
Author: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
Date:   Mon Apr 3 13:40:44 2017 +0000

    Bug 18110: Update addressFormat in atomicupdate
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ed61b56f50b7dd4d3cc29a5ada93c25212a7e39
Author: Marc Véron <veron@veron.ch>
Date:   Tue Mar 28 09:20:47 2017 +0200

    Bug 18110: Folllowup to fix alternative address and add missing class
    
    This patch fixes the display of alternative address (streetnumber, streettype
    and address on same line, see comment #22, and it adds missing class
    patronaddress1 to main address display.
    
    To test:
    - Create / edit a customer to have streetnumber, streettype and address in
      both main address and alternate address
    - Switch syspref addressformat ot French style
    - Verify that both main address and alternate address display as expected
      on patron's detail page (street number, street type and address on same
      line)
    
    Signed-off-by: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4c8580b1bbfa01e1fd0c7980ceafc0ffc8ad3148
Author: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
Date:   Mon Mar 27 07:32:06 2017 +0000

    Bug 18110: Removed unwanted spaces
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 54bb284a60dab066d7ad0b08005ada576d0f31f1
Author: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
Date:   Fri Mar 24 12:47:42 2017 +0000

    Bug 18110: Corrected display address format
    
    - minor changes on address format
    - corrected member-password so that steetnumber is given to the template
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62b2e505d4c6f967f72cb4d8969f0cde8e678722
Author: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
Date:   Mon Feb 27 09:32:24 2017 +0000

    Bug 18110: Add a field FR to the syspref AddressFormat
    
    Add a field FR to the syspref AddressFormat
    
    Testplan
    1 - Apply patch
    2 - Check if there is a field FR in the syspref AddressFormat, enable it
    3 - Create a new borrower and check the order of the fields for the address
    4 - Check if it's address appears in a propper manner
    
    27/02/17 : Fixed the display
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 368670cda7c7456d6701c3602846a6b5d4c605ec
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 28 08:46:59 2017 -0400

    Bug 12461 - DBRev 16.12.00.027
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b5c632d9e254aac419b0576508ea6296b7b03a2
Author: Marc Véron <veron@veron.ch>
Date:   Mon May 4 23:29:29 2015 +0200

    Bug 14143 - Patron cards: Crash (confusion between table names creator_templates and club_template_enrollment_fields)
    
    To reproduce:
    Go to Home > Tools > Patron card creator
    Click on 'Manage profiles'
    Result:
    Can't use string ("1") as an ARRAY ref while "strict refs" in use at /usr/share/kohaclone/C4/Creators/Lib.pm line 564.
    
    Reason:
    Select statment to get field 'template code' from table 'club_template_enrollment_fields' (!) instead of 'table creator_templates'.
    
    To test:
    Apply patch
    Try to reproduce issue.
    
    Amended because of typo (_ instead of -)
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 709358e0c98a583b48f0fee13adb45c00f51b5ff
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 28 06:43:44 2017 -0400

    Bug 12461 - (QA Followup)
    
        Club enrollments should only list active enrollments
        Confirms should warn of cascading delete
        Branch limited clubs should only be available to members of that
        branch
        Fix breadcrumbs
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 589aa069915c001792a71d900e26a20526d6b9d0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Apr 27 08:24:29 2017 -0400

    Bug 12461 [QA Followup]
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 95429af6855e8ed37945b681dc466bf360deffb2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri May 23 11:54:26 2014 -0400

    Bug 12461 - Add patron clubs feature
    
    This features would add the ability to create clubs which patrons may be
    enrolled in. It would be particularly useful for tracking summer reading
    programs, book clubs and other such clubs.
    
    Test Plan:
    1) Apply this patch
    2) Run updatedatabase.pl
    3) Ensure your staff user has the new 'Patron clubs' permissions
    4) Under the tools menu, click the "Patron clubs" link
    5) Create a new club template
       * Here you can add fields that can be filled out at the time
         a new club is created based on the template, or a new enrollment
         is created for a given club based on the template.
    6) Create a new club based on that template
    7) Attempt to enroll a patron in that club
    8) Create a club with email required set
    9) Attempt to enroll a patron without an email address in that club
    10) Create a club that is enrollable from the OPAC
    11) Attempt to enroll a patron in that club
    12) Attempt to cancel a club enrollment from the OPAC
    13) Attempt to cancel a club enrollment from the staff interface
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 45a35f1ecc7c41073c3cb3f3ea56f496dcd0171c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 17 15:42:35 2017 -0300

    Bug 17855: Simplify the onboarding tool
    
    This patch should not modify a lot the behaviours of the onboarding
    tool.
    Its goal is mainly to remove duplicated as well as useless (because
    copy/pasted from existing script files) code.
    
    It assumes that the onboarding tool will be done on an empty database
    and will skip steps that are not needed. For instance if a library
    already exists, the first step will be skipped.
    
    One of the main problem was the lack of feedback messages sent to the
    user when something wrong/ok happened.
    
    Explanation on main changes:
    1. Use checkauth first, then get_template_and_user
    => As we do not know the template to use, it's better to use checkauth
    first to know if the user is logged in, then retrieve the template we
    need, depending on the success or the failure of the action
    2. Create a @messages variables
    Pushing messages to this variable and handling the messages via an
    include files (onboarding_messages.inc) simplify error handling. Note
    that we could remove this include file if we merge all the
    onboardingstepX.tt files altogether
    3. Simplify creation of the admnistrator user
    This patch removes some unecessary checks done on the user's info
    (passwd to short, mandatory fields
    
    Todo (minor): Add style to feedback messages
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 02b3816656c779e803b7e91bdeb1aedbfdb7ac67
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 17 12:18:31 2017 -0300

    Bug 17855: No need to resend the library list to the template
    
    This has been done at the beginning of the script
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2e7832782966a9c4b673fb23097ffce46fa19c55
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 17 12:16:17 2017 -0300

    Bug 17855: Redirect to the installer if installation process is not done yet
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 883a7d21e1c3477fa547b02b1a32936a673ddef4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 17 12:13:45 2017 -0300

    Bug 17855: Do not create a new dbh, get it from C4::Context->dbh
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 262f2dd48b6fee61cbe6e04e4781833d291ea4c6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 17 12:05:21 2017 -0300

    Bug 17855: perltidy onboarding.pl
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a8935fdea2c72c89e7064c123a0782d9ecb8e44e
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Sun Apr 9 05:30:05 2017 +0000

    Bug 17855 - Followup patch following requests in comments 176 and 177
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3d80ca1758c135042b0ca4d261d1198a40a35197
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Sat Mar 18 18:19:17 2017 +0000

    Bug 17855 - Reverted back to original step 3 in the web installer so there is no basic and advanced setup mode and consequently no need for SQL files to be moved to a 'default' directory for all languages.
    
    Onboarding tool and the rest of the web installer still exists in this
    commit
    
    How I tested in my VM (Current master):
    - Dropped database
    - Recreated database
    - Went through installer
    - Language en, Marc21
    - Installed mandatory data only
    - Went through Onboarding tool
    - After finishing, logged in as superlibrarian
      that was created by onboarding tool
    Everything worked fine.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0492fcf87f170846d1e6c8683916a56cb67ce9a7
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Thu Feb 9 17:32:29 2017 +0100

    Bug 17855: Onboarding tool
    
    Tested 3 patches together on current master
    - Dropped database
    - Recreated database
    - Went through installer
    - Language en, Marc21
    - Installed mandatory data only
    - Went through Onboarding tool
    - After finishing, logged in as superlibrarian
      that was created by onboarding tool
    Everything worked fine.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9a9b0aab879d1decbdeb9bac02ae198a21a46afb
Author: Marc Véron <veron@veron.ch>
Date:   Fri Apr 21 21:22:44 2017 +0200

    Bug 13835: Popup with searches: results hidden by language menu in footer
    
    Language menus in pop up windows are not necessary and can hide the contents
    (especially search results) on a narrow screen.
    
    For an example, see screenshot in comment #3
    
    This patch allows to mark pop p menus not to display the language footer.
    
    To test:
    
    - Reproduce issue from comment #3
    - Apply patch
    - Try to reproduce issue from comment #3
      -> language menu should no longer display
    - Verify that language menu is suppresed in 'Add to ist' as well
      (from catalog search results, select an item, Add to:...)
    
    Note: There will be more pop-ups with unwnated language selector.
          That can be resolved in follow up bugs.
    
    Followed test plan which worked as intended
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0677f26772029066f0e4e5a5b0273556f44c72c3
Author: Zeno Tajoli <z.tajoli@cineca.it>
Date:   Wed Apr 19 14:51:19 2017 +0200

    Update Italian installer sample files for 17.05
    
    Update and translate sample SQL file of the Italian installer.
    
    To test:
    - Start with an empty database
    - Install it-IT
    - Run the web installer in it-IT/Italian
    - Verify all files, especially sample notices, sample_frequencies,
      sample_numberpatterns load without any problems.
    
    https://bugs.koha-community.org/show_bug.cgi?id=18456
    
    While applying I got a 3-way-merge. Verified in staff client places
    mentioned above, notices, frequencies, sample_numberpatterns, HSBND_FREQ
    Works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fdc6b033a55e917647f8f099902f2750e79cc740
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Apr 24 12:36:58 2017 +0000

    Bug 18479 - Holds 'Placed on' column in opac-user.pl not sorting correctly
    
    Two columns in the user's holds table in the OPAC do not sort correctly
    because they are not marked up correctly to enable date sorting: 'Placed
    on' and 'Expires on.' This patch corrects it.
    
    This patch also removes a stray </td> which was causing validation
    errors.
    
    To test, apply the patch and log into the OPAC with an account which has
    multiple holds with differnt hold dates and expiration dates. Confirm
    that sorting on these columns works correctly.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 15ccc7b1e60241ed25bb43bb070a7e6154f2be1c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 19 12:32:06 2017 -0300

    Bug 18453: Remove exports_enabled in circulation_batch_checkouts.tt
    
    This is a c/p from circulation.tt, this variable is not needed in this
    template
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5de92c26a4239b41a9e495ec060b205f19d97523
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 19 12:29:26 2017 -0300

    Bug 18453: Hide the export column when needed
    
    If exports_enabled is equal to "0" it will be evaluated to true.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>

commit 3fddc0d73724c6c5f1aafe6842c488304b79f306
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Apr 25 13:15:13 2017 +0000

    Bug 17916 - "Delete MARC modification template" fails to actually delete it
    
    The MARC modification templates' 'Delete' button fails because the event
    handler has a "preventDefault" but the outcome of the confirmation
    function must return true or false.
    
    This patch removes the "preventDefault" from the .delete_template click
    handler as well as a redundant onclick attribute from the delete link
    itself.
    
    To test, apply the patch and go to Tools -> MARC modification templates.
    Clicking the delete button for any existing template should work
    correctly.
    
    Followed test plan, worked as intended
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dddd2691e704654fd656c5d519e029c5dfc3ecc9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Apr 25 16:16:49 2017 +0000

    Bug 18419 - Broken patron-blank image in viewlog.tt
    
    Because of a variable name collision the blank patron image doesn't
    display in viewlog.tt. This patch moves the image from the template to
    the stylesheet to avoid this problem.
    
    This patch also replaces the blank patron image PNG file with an SVG
    file. SVG support is wide enough to begin using whereever possible.
    
    This patch also removes some inline CSS from circ-menu.inc and puts it
    in the global stylesheet.
    
    To test, apply the patch and clear your browser cache if necessary.
    
    - Enable the patronimages system preference.
    - View a patron account which lacks a patron image. All views (details,
      fines, notices, etc) should show the "blank" patron image, including
      the modification log view.
    - View a patron account which has a patron image and check that it still
      displays correctly in all views.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac2e6b1b2658405db63a17527895d3d7d46ec811
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Jan 5 02:01:57 2017 +0000

    Bug 15738: Show rental fees on OPAC summary page
    
    This patch adds a few lines that check for a rental fee on an item. If
    yes, it will show in brackets as a rental fee on the OPAC summary page.
    
    To test:
    1) Have a borrower with an overdue item accruing fines, a lost item and
    an item with a rental fee. Confirm the Fines column on the OPAC summary
    page now shows you what you may expect to see for each item.
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2ca5866866576f0e84041704b0156bc8288334bc
Author: Olivier Crouzet <kohateam@univ-lyon3.fr>
Date:   Sat Apr 22 18:20:48 2017 +0200

    Bug 18482 False duplicates detected on adding a batch from a stage file
    
    When adding a batch from a stage file with defaut matching on
    title/author, if a duplicate is detected, all following records
    treated in the batch are discarded from import even if they are not duplicates
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2a2b9739117e74232c9a7abde516b1c436d4bad3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 18 13:50:36 2017 -0300

    Bug 18179: Update existing calls
    
    This patch updates the existing occurrences of ->find called in a list
    context.
    There are certainly others that are not easy to catch with git grep.
    Test plan:
    Confirm that the 4 modified scripts still works as expected.
    
    We need this one ASAP in master to make sure we will not get other
    side-effects of this kind and to catch possible uncaught occurrences
    before the release.
    
    Tested scripts changed by this patch, they work as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a1fcf1818c8d9f23d9c870e93c41c67a27faf603
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 18 13:49:18 2017 -0300

    Bug 18179: Forbid list context calls for Koha::Objects->find
    
    Reading https://perlmaven.com/how-to-return-undef-from-a-function
    this sound like the more correct behaviour.
    
    Considering:
    $template->param(
        stuff => Koha::Stuffs->find( $id ),
        foo   => 1,
    );
    without this patch, if the $id does not represent any rows in the DB,
    stuff will be assigned to 'foo' and $foo will be undef in the template.
    That can lead to very bad side-effects.
    
    With this patch we make sure that it will never happen again.
    
    Test plan:
      prove t/db_dependent/Koha/Objects.t
    should return green
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 21bddb399d7f88a33c6dff474d07190a09e627dc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 21 13:05:47 2017 -0300

    Bug 18467: Handle orders with deleted biblio when viewing a basket
    
    If the bibliographic record of an order has been removed, $order->{bibionumber}
    is undefined. We need to handle this specific case correctly.
    
    To test:
    1 - Create a basket
    2 - Order a bib
    3 - Cancel order and delete record
    4 - You cannot view basket
    5 - Apply patch
    6 - View basket
    7 - There should not be an error
    r calling count on undefined bib in basket.pl if order cancelled and
    record deleted
    
    Followed test plan, works as intended
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 21992c7eca3442e868b14cbbd55a5c8b5d59c102
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 21 10:10:37 2017 -0400

    Bug 18471 - Receiving order with unitprice greater than 1000 processing incorrectly
    
    Receiving orders process the comma as a decimal point
    Invoices are displaying incorrectly when formatting total
    
    Test Plan:
    1. Open a basket
    2. Place an order for an item with price > 1000, $4367.00 for example
    3. Close basket
    4. Receive order
    5. Note on orderreceive.pl the price is populate as "4,367.00"
    6. Receive/Save
    7. Note the 'Actual Cost' is now $4.00, verify db contains 4 as well
    8. Cancel receipt
    9. Receive again, this time enter price as "4367"
    10. Receive/save
    11. Note actual cost is correct
    12. Finish receiving
    13. Note invoice reads total as $4.00
    14. Check db. price in aqorders is correct but displaying incorrectly
    15. Apply this patch
    16. Repeat step2 1. 14, note errors are fixed
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 475c294b292eadcc7e8d20307c16591fdf8b9b71
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 24 13:53:00 2017 -0300

    Bug 18461: (bug 13757 follow-up) Do not mix decode_json and to_json
    
    Internal server error while approving OPAC-edited patron attributes
    containing umlauts (äöü)
    
    If a OPAC user enters text containing umlauts (äöü) in a patron atribute
    and saves it, the Staff client will get an inernal server error in
    members-update.pl (approving).
    
    E.g. a text like 111ä222 leads to the following in plack error log:
    
    malformed UTF-8 character in JSON string, at character offset 14
    
    To test:
    - Reproduce problem above
    - Apply patch
    - Verify that Home > Patron > Update records displays without error
    and 'New value' displays properly
    - Approve!
    
    Also, run the tests:
    - Run:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ prove t/db_dependent/Koha/Patron/Modifications.t
    => FAIL: Tests explode due to encoding problems in JSON handling
    - Apply the patch
    - Run the tests again:
     k$ prove t/db_dependent/Koha/Patron/Modifications.t
    => SUCCESS: Tests pass!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 11d4ad19aa765fdc22488a07eaca48cb4c965e4e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 24 15:45:17 2017 -0300

    Bug 18461: Make tests break on wrong UTF8 data handilng
    
    This patch makes the tests fail if extended attributes handling fails due to
    wrong UTF-8 data handling.
    
    To test:
    - Run:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ prove t/db_dependent/Koha/Patron/Modifications.t
    => FAIL: Tests explode
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bcc04652762ff097623630432946ca9203f7519f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 24 16:26:31 2017 -0300

    Bug 18066: Remove warnings from translate script
    
    This patch removes the following warnings:
    Use of uninitialized value $pref_name in concatenation (.) or string at
    LangInstaller.pm

commit 82943de12ca5170b9504044c20462542ae0e5397
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Apr 19 01:03:15 2017 +0000

    Bug 18452: Correcting 'url' to say 'URL' in catalog detail
    
    To test:
    1) Edit a record, put a URL in 856u and hit save
    2) Confirm that url shows as URL in OPAC and staff client
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ac0aab9bb8418a355e1f692e6b505500c96e0dd
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Apr 18 23:18:31 2017 +0000

    Bug 15815: Reword confirm message when removing patrons from card batch
    
    This patch rewords the confirm message when removing patrons from a card
    batch.
    From: "Are you sure you want to remove card number(s):1 from this
    batch?"
    To: "Are you sure you want to remove the selected patron(s) from this
    batch?"
    
    To test:
    1) Go to Tools -> Patron Card Creator -> Manage batches
    2) Edit a batch
    3) Select one or more patrons and click 'Remove selected patrons' (not
    individual Delete buttons)
    4) Confirm the message is worded better and easier to understand
    5) Click OK and confirm the patrons are deleted as expected
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 736afd6d0119304df3ec61e01e275aea1645e7ac
Author: Eric Phetteplace <phette23@gmail.com>
Date:   Thu Apr 20 17:15:57 2017 -0700

    Bug 18466: article requests box outline in opac
    
    To test:
    1) apply patch
    2) ensure ArticleRequests is set to Enable
    3) sign in as a user with no article requests on the OPAC side
    4) click the 'article requests' tab & see the box & message
    
    Sponsored-By: California College of the Arts
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7fd248f3e9c80b36fb451eb90d2c34242c0cbb61
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Jan 19 21:13:47 2017 -0500

    Bug 15702: Recommended Counter-patch
    
    As per comment #7, this patch affects AddMember and ModMember.
    The test plan should be the same as comment #6.
    Secondary patch with tests still to come.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 31378adbe1add83afd2ac77520a295c18ba70b72
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Apr 21 08:58:03 2017 -0400

    Bug 15702: Add test cases for modified code
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 41669b45a808550088146380d534e4f3629590d9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 24 14:16:34 2017 -0300

    Bug 18457: Add tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c7541091741878d28f648df8681a691cf787334c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 19 09:52:38 2017 -0400

    Bug 18457 - process_message_queue.pl will die if a patron has no sms_provider_id set but sms via email is enabled for that patron
    
    If SMS via Email is enabled, and a patron has opted for SMS messages, but has not selected a service provider, the cronjob will die with the error
    Can't call method "domain" on an undefined value at /usr/share/koha/lib/C4/Letters.pm line 1055.
    This will cause all messages that come after the error to not be sent!
    
    Test Plan:
    1) Enable SMS via Email
    2) Enable SMS for a patron, but don't set a provider
    3) Perform an action that will trigger an sms message to go into
       the holds queue ( item due, item checkout, etc )
    4) Run process_message_queue.pl, note the error
    5) Apply the patch
    4) Run process_message_queue.pl, no error this time!
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 330ecff1de417c40e5a48040a6f7df6436097bc4
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 14 13:07:39 2017 -0400

    Bug 18435 - Language entered in Materials Specified does not display when items are checked out and checked in
    
    This problem stems from bug 17642, if items.materials is not linked to
    an authorized value the contents are being tossed out. We shuold display
    them instead
    
    To test:
    1 - Ensure items.materials 952$3 is not mapped to an authorized value
    2 - Add a value to an item
    3 - Check the item out, note the materials does not display
    4 - Check the item in, note the materials does not display
    5 - Apply patch
    6 - Check the item out, note the materials does display
    7 - Check the item in, note the materials does display
    
    Followed test plan, message about material displays as expected
    whil checking out and in.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c026d9f4e130d0585def4b1deb98e802ad35d258
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Apr 20 21:36:44 2017 -0400

    Bug 18468 - When adding from a staged file order discounts are not passed into C4::Acquisitions::populate_order_with_prices
    
    To test:
    1 - Setup a vendor with a discount
    2 - Stage a file
    3 - Create a basket
    4 - Order from staged file
    5 - Add a price but no discount
    6 - Save order
    7 - Note ecost is not discounted
    8 - Apply patch
    9 - Repeate 2-6
    10 - Note ecost is discounted
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 694c09aa873973c4f55b5d90948b1027adc0f1c1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Apr 21 20:34:00 2017 -0300

    Bug 18409: Make the controller for holds use Koha::Holds
    
    Recently, there's been a major fix on the REST api swagger spec,
    which involved fixing boolean values so they are actually booleans
    and Koha::Object was extended to handle that.
    While the swagger spec for this endpoint got fixed, such is not the case
    with the implementation (the controller class).
    
    This patch fixes this situation by:
    - Specifying boolean properties as boolean in the schema file
    - Fixes the controller so it returns Koha::Hold objects instead of the
      hashref returned by GetReserve, which is wrong.
    - Better (than empty) descriptions are added to 'suspend',
      'suspend_until' and 'lowestPriority' on the spec.
    
    To test:
    - Run:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ prove t/db_dependent/api/v1/holds.t
    => FAIL: Tests fail, mostly due to error 500 results.
    - Apply this patch
    - Run:
     k$ prove t/db_dependent/api/v1/holds.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    This can also be tested using any interface for REST apis.
    
    Note: This endpoint lacks several of the new guidelines and is not
    complete (there's no GET for single holds, etc). It is also missing
    exception handling. There are probably
    other bug reports for that, just thought it was worth mentioning.
    
    Followed test plan and this patch worked as intended
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4eb53eeee9dbf1c4c3a4c6da48148e0a0d27f0fe
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Apr 3 21:43:48 2017 +0200

    Bug 18300: [QA Follow-up] Fix return value inconsistency
    
    As noted on bug report 17669, the return values of delete (both singular
    and plural), delete_missing and delete_temporary should be consistent.
    
    Removed the if-construction around full_path. We do not need it; in the
    very exceptional case that full_path would be empty, we should delete
    the record since the file is missing.
    
    Adjusted POD and unit tests accordingly.
    
    Test plan:
    Run t/db_dependent/Upload.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8c80c9b8e127145e638963eb0eaa8fdb420ff4cd
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Sun Mar 19 17:25:01 2017 +0100

    Bug 18300: Delete missing upload records
    
    If you deleted files from the upload directories manually, or you rebooted
    with files in the temporary upload folder, or for some other reason have
    records without a file, you may want to cleanup your records in the
    uploaded_files table.
    
    This patch adds the method delete_missing to Koha::UploadedFiles. It also
    supports a keep_record parameter to do a dry run (count the missing files
    first).
    
    Also, we add an option --uploads-missing to cleanup_database. If you add
    the flag 1 after this option, you will delete missing files. If you add the
    flag 0 or only use the option, you will count missing files.
    
    A subtest is added to Upload.t for delete_missing tests.
    
    Test plan:
    [1] Run t/db_dependent/Upload.t
    [2] Upload a file and delete the file manually.
    [3] Run cleanup_database.pl --uploads-missing
        It should report at least one missing file now.
        Check that the record has not been deleted.
    [4] Run cleanup_database.pl --uploads-missing 1
        It should report that it removed at least one file.
        Check that the record is gone.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1183cfff75773c4ac2acf8fb3386f2fd7f97d4ff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 12 15:20:10 2017 -0300

    Bug 18182: Fix Koha::RefundLostItemFeeRules
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f762ee4a1bcdd50ab3d4ec908cda7dede4ca6622
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 12 15:19:33 2017 -0300

    Bug 18182: Tests all Koha::Objects-based modules
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Added test description on line 387.
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5841aeb8f20098fd54db6dfee12cc13b8a994851
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 31 13:32:55 2017 +0200

    Bug 18182: [QA Follow-up] Fix a few typos, consistent rollback
    
    Since we here only use one rollback and this test does not care, it is
    more consistent to keep that pattern.
    Additionally, promoting two globals to our.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e2d14666d9762a6742a326b67f4296f6269c4d4c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Feb 28 09:08:38 2017 -0300

    Bug 18182: Make TestBuilder capable of returning Koha::Object
    
    This patch adds a new method to t::lib::TestBuilder so it can return
    Koha::Object-derived objects. The new method is called ->build_object
    and requires the plural of the target class to be passed.
    
    'class' is a mandatory param, and a warning is raised and undef is
    returned if absent.
    
    It accepts 'value' as the original ->build() method, and that is passed as-is
    to ->build().
    
    To test:
    - Apply the patches
    - Run:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ prove t/db_dependent/TestBuilder.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6527b3b67506db0289997eb9bb98647fa1967a55
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Apr 19 17:01:54 2017 +0200

    Bug 18459: Add the Koha::Item->biblioitem method
    
    Test plan:
      prove t/db_dependent/Koha/Items.t
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2ba4a661d38c856ff10c9bcf1680f6619bdab2cd
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Sun Apr 16 18:50:58 2017 +0200

    Bug 18448: Fix a few db_dependent tests
    
    Tests in db_dependent may expect a Koha database, but should not rely on
    hardcoded categories, currencies, branch codes, etc.
    
    This patch fixes a bunch of those. But this is a continuous project. We also
    need QA to closely watch new edits.
    
    Accounts.t: hardcoded category PT replaced
    Acquisition/OrderFromSubscription.t: hardcoded USD
    Acquisition/StandingOrders.t: same
    ArticleRequests.t: create itemtype, branch and category for testing
    AuthorisedValues.t: remove $dbh, add two test branches
    AuthoritiesMarc.t: add hardcoded GEOGR_NAME authtype
    Bookseller.t: add test currency
    Koha.t: add test itemtype instead of hardcoded BK
    UsageStats.t: add test branch and category
    
    Test plan:
    Run the adjusted tests.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    All tests successful (see comment #9)
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d0a37bb8bfdb8f426f83920314179b207be496fd
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 21 14:03:42 2017 -0400

    Bug 18427 - DBRev 16.12.00.026
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0e0f3e49460611c74184ee48d3b66762c55ac181
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Apr 13 13:34:36 2017 +0200

    Bug 18427: Add a primary key to serialitems
    
    We drop the unique index serialitemsidx and add a primary key consisting
    of itemnumber just as the unique key did.
    
    Test plan:
    Run the db revision.
    Apply bug 18182. The TestBuilder.t should no longer fail on serialitems.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb5d44e2f14dd0f74557999987c6942841d2503c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Apr 13 13:53:37 2017 +0200

    Bug 18427: DBIx schema changes
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ccd42eee5b109cb7c935b0779a8321a5a8a872e0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 21 13:59:52 2017 -0400

    Bug 17669 - DBRev 16.12.00.025
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8e99f884cc2eaecc810599fda9ef705f98efc10f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 20 01:10:14 2017 -0300

    Bug 17669: Remove warning 'variable $kohaobj masks earlier declaration in same scope'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit aee0682d60ddf1f21c5802001d8af91b43102e51
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Apr 3 19:14:52 2017 +0200

    Bug 17669: [QA Follow-up] More consistency in return values of delete
    
    See Bugzilla comment36 (QA request).
    
    Koha::UploadedFile->delete
    Returns 1, 0E0 or -1 (unknown).
    
    Koha::UploadedFiles->delete and delete_temporary
    Returns number of deleted records, 0E0 or -1.
    
    POD lines are corrected accordingly. Unit tests adjusted too.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Added a note that Koha::Object->delete itself is not completely consistent
    with Koha::Objects->delete (DBIx). The singular may return 1 when it
    gets 0E0 from DBIx, while the plural one may return 0E0. But should be
    handled somewhere else.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 05e25dbc188d9d6340d03750a47cb1cce130715f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 31 08:31:10 2017 +0200

    Bug 17669: [QA Follow-up] Allow zero in temp-uploads-days
    
    As requested by QA on comment33.
    If the pref is 0 or the overriding command line parameter is 0, all
    temporary files will be deleted. But if the pref is NULL or empty string,
    we will not delete files.
    
    Also adjusted the description of the preference in this regard.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8e7f1dddebb90d30be328d15ed8150517c2df664
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Mar 30 08:51:17 2017 +0200

    Bug 17669: [QA Follow-up] Rename --temp-uploads-override parameter
    
    As requested by QA on comment25.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bab3a204be028cae30d26ad7b05dde4de1e58b76
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Mar 30 08:42:38 2017 +0200

    Bug 17669: [QA Follow-up] Rename preference by removing underscores
    
    Requested by QA on comment25.
    Result of:
    git grep -l Upload_PurgeTemporaryFiles_Days | xargs sed -i -e "s/Upload_PurgeTemporaryFiles_Days/UploadPurgeTemporaryFilesDays/g"
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8042267a7872bebecbb99c4638467c4d1225a06c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Dec 14 13:46:06 2016 +0100

    Bug 17669: Add new switch to crontab example and debian daily cron file
    
    The new switch for deleting temporary uploads in cleanup_database can
    be added to cron.
    
    Note: Since the option --temp-uploads does only purge temporary uploads
    when triggered by the preference Upload_PurgeTemporaryFiles_Days, it can
    be safely added here.
    
    Test plan:
    There is actually nothing to test here if you followed the preceding test
    plans. Just verify that the switch is inserted ocrrectly.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4655cee3664da58a1812c8338130a35ba9d7da60
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Dec 13 16:44:26 2016 +0100

    Bug 17669: Incorporate the changes in cleanup_database
    
    Two command line options are added:
    [1] -temp-uploads to indicate that you want to purge these uploads,
    [2] -temp-uploads-override DAYS to (optionally) tell that you want to
        override the corresponding pref value.
    
    Test plan:
    [1] Check the modified usage statement.
    [2] If needed, backup your temporary uploads :)
        In case you do not have one, add a temporary one with Tools/Upload.
        Note: Do not choose an upload category.
    [3] Set pref to 0, and run cleanup_database with only --temp-uploads.
        No files should be deleted.
    [4] Check number of "old" temp uploads. Set pref to nonzero value.
        Verify that the oldest are gone (depending on the value chosen).
    [5] Set pref to 0 again.
        If all uploads are gone now, add a new one with Tools/Upload.
        Run cleanup_database with --temp-uploads --temp-uploads-override -1
        All temporary files are gone.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 53f5d55ab4938cf827108bef98609ca165ef6cb7
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Dec 13 14:04:29 2016 +0100

    Bug 17669: Add delete_temporary method with unit tests
    
    Test plan:
    Run t/db_dependent/Upload.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 686b7d6a827741da85224b6895d9b1c94cbbdf3c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Mar 20 08:43:32 2017 +0100

    Bug 17669: Small change to sub delete
    
    Instead of looping through _resultset here and wrapping the results,
    we should use a Koha::Objects instance. Since the method may be called
    as a class method, we create an instance if needed.
    
    Test plan:
    Run t/db_dependent/Upload.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fe9a8bf9735c7ea54d39aa1c19f667bf999a902d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Dec 13 14:03:27 2016 +0100

    Bug 17669: Introduce new preference for purging temp uploads
    
    The new preference is: Upload_PurgeTemporaryFiles_Days.
    It controls if the cron job will delete temporary uploaded files and if so,
    how many days should have passed before doing so.
    
    Since the default value is empty, it will not start deleting these uploads
    until you change the pref. No behavior change. But the dbrev will print a
    message if you already have temporary uploads.
    
    Test plan:
    [1] Check Administration, Preferences, Tools for the new pref.
    [2] Run the db rev.
        If you have temporary uploads, check the reported count.
    [3] Bonus: Run sysprefs.sql in a safe environment.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5f3e93c6f5cd7818f53296cf9c4a37c860119970
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 23 22:13:17 2017 -0300

    Bug 17964: Replace next with last
    
    We certainly always want to retrieve the last row of a given search.
    If it not sufficient we will need to rethink this code.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9a8394866fbc76396fcc29086f2a34def47d9b45
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 24 09:05:44 2017 +0100

    Bug 17964: [QA Follow-up] Test descriptions, typo
    
    Typo: have been checkin => checked.
    And five test descriptions ;)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 30bdf6edec8176c68d2ced15cd14cdf0f1e767fd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jan 21 16:02:50 2017 +0100

    Bug 17964: Support date formatting
    
    Using the KohaDates plugin will allow us to format dates as we want,
    using the same filters as the ones defined in the KohaDates TT plugin.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b2b4be996aba9356662b05e4427d00e33dda9081
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jan 21 15:48:57 2017 +0100

    Bug 17964: Add old_issues
    
    If it's a CHECKIN, C4::Circulation::SendCirculationAlert set a
    "old_issues" key instead of "issues".
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 580b8febe32b273471a78917c836d0847ea8fa43
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 16 16:35:18 2017 +0100

    Bug 17964: TT syntax for notices - Prove that CHECKIN and CHECKOUT are compatible
    
    From the CHECKIN and CHECKOUT templates you should be able to access the
    following information: item, biblio, biblioitem, patron and library
    
    Test plan:
    Define CHECKIN and CHECKOUT notice templates.
    You should be able to define them using the TT syntax to produce the
    same generated notice messages as with the historical syntax.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1d7afd30bea01902efa87e68121ef3bfa933be9a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 21 11:01:30 2017 -0400

    Bug 16895 [QA Followup] - Use q{} for empty string as per PBP
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1f45548c91366d04a115c02c0f8d4b40c93f78fc
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Apr 19 16:25:17 2017 +0200

    Bug 16895: [QA Follow-up] Resolve warning on $payment_type_writeoff
    
    Resolves:
      Use of uninitialized value $payment_type_writeoff in string eq at C4/SIP/Sip/MsgType.pm line 1072, <STDIN> line 2.
    Would be raised if this parameter is not found in SIPconfig.xml.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8b528ab09d08eb2c8162d89cb511857520f20c68
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 19 09:29:13 2017 -0400

    Bug 16895 [QA Followup] - Don't require fee payment to be exact full payment
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7e629641070e04dfb480886dc20582974363c0e8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jul 11 13:55:50 2016 +0000

    Bug 16895 - Allow writeoffs via SIP2
    
    Many SIP2 services such as those by Comprise Technologies are able to or
    require that an ILS be able to accept writeoffs via SIP2. The SIP2
    protocol specifies that payment type be a two digit number, but does not
    specify a code for writeoffs. To this end we should allow the write-off
    code to be specified in the SIP2 config on a per-account basis so that
    if different vendors use different fixed codes for write-offs we can
    handle that gracefully.
    
    Test Plan:
    1) Apply this patch
    2) Modify your SIP2 config to include
          payment_type_writeoff="06"
      in the login portion of the account you will be using for the test.
    3) Restart your SIP2 server
    4) Create a fee for a patron
    5) Send a SIP2 fee paid message specifying the payment type code we
       defined earlier, with a payment amount that is *not* equal to the
       amount outstanding for the fee.
    6) Note the fee paid response indicates the payment failed
    7) Repeat step 5, but this time send the amount outstanding as the
       payment amount
    8) Note that the fee paid response indicates a successful payment
    9) Note in Koha that the fee has been written off!
    
    Signed-off-by: Rhonda Kuiper <kuiper@roundrocktexas.gov>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>

commit 039bb200de2507f81cafb88dfe826e74160d2fa2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 18 15:13:18 2017 -0300

    Bug 10357: Do not change the alerttype
    
    Previous patch modified the alerttype from "issue" to "issue_det" or
    "issue_ser". This is wrong, we do not want to modify this value,
    especially because it's used in C4::Letters::SendAlerts
    This patch uses a $referer variable instead, like it is already used in
    other scripts for redirection.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 925734ee781c3d64b8e360c34f7036d335fce67d
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Feb 6 21:26:54 2017 +0000

    Bug 10357: Adding link for email notification for new subscription issues to opac-detail
    
    This patch adds the link to the opac-detail.pl page so it is less hard
    to find.
    Update: Fixing link to look like button, adding span ID around element
    Update: Changing ID to Class
    Update: Comment 14 fixes
    
    To test:
    1) Add a subscription, attach it to a record and select a notice under
    'Patron notification'. Hit Next, fill in some fields and save the
    subscription
    2) Go to that record detail page in the OPAC. Go to the subscriptions
    tab, click 'More details'. Notice how many clicks it takes to see the
    'Subscribe' button
    3) Apply patch and go back to the details page for the record
    4) Notice now there is a 'subscribe' button
    5) Confirm this button works as expected and you are redirected to
    the detail page
    6) Confirm 'Cancel' works and redirect works too
    7) Go down to 'More details' and confirm the buttons work and you are
    redirected back to the serial-issues plage from here
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Re-tested, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7cbd9561271c1ac9ca3ccfd8ef257259a341f464
Author: Marc Véron <veron@veron.ch>
Date:   Tue Apr 18 09:21:45 2017 +0200

    Bug 18443: Get rid of warning 'uninitialized value $user' in C4/Auth.pm
    
    When logging out from OPAC, plack-error.log log and/or opac-error.log
    complain about 'uninitialized value $user' in C4/Auth.pm line 187. The
    warning is not necessary, this patch removes it.
    
    To test:
    - try to trigger warning
    - apply patch
    - verify that warning no longer occurs
    - prove t/db_dependent/Auth.t
    - verifiy that SCO still behaves like before (especially if
      you break out from sco path)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 919030069400a94c89276c0ebc17b9693369e679
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 20 13:00:00 2017 -0300

    Bug 18432: Replace 2 'he or she' with 'they'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit da172a560f7c4c2ba3eab69144ddcac9043b2c3b
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Wed Apr 19 09:32:59 2017 +1200

    Bug 18432 : Follow up - Updating to use they/them
    
    Updating to use they/them and skipping the ones changed to it
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 553ce38225b7334ef9354e7789b5a10e5a569bbf
Author: Eric Phetteplace <phette23@gmail.com>
Date:   Thu Apr 13 14:26:07 2017 -0700

    Bug 18432: code comments assume male gender
    
    Comments throughout the Koha codebase assume that
    all librarians or borrowers are male by using the
    pronoun 'he' universally. This patch changes to
    'he or she' / 'him or hers'.
    
    Testing plan:
    
    - ensuring modifying tests still pass:
            + C4/SIP/t/06patron_enable.t
            + t/db_dependent/Circulation.t
            + t/db_dependent/Koha/Patrons.t
            + t/db_dependent/Reserves.t
    
    Sponsored-By: California College of the Arts
    
    No code changes detected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4cb7119e933009374fad8f192e1f30f819a74f88
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Apr 13 09:55:15 2017 -0400

    Bug 18429 - Receiving an item should update the datelastseen
    
    To test:
    0 - Ensure AcqCreateItem is set to 'placing an order'
    1 - Order some items, note entrydate and datelastseen match
    2 - Alter those dates to be earlier than today (or wait some days)
    3 - Recieve the item and note datelast seen not updated
    4 - Apply patch
    5 - Repeat 1-3
    6 - Date last seen should be updated.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Works as expected.
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1a688ae9e02f36a22890de44fb2ce7cdd0599c2d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Apr 14 12:46:13 2017 +0200

    Bug 18420: Fix HoldFulfillmentPolicy.t and Passwordrecovery.t
    
    We are going out of scope here, but these tests need a branch/item.
    
    Test plan:
    Run the adjusted tests.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eedb9d92336bfe9c0ea276bb41ceb52d8afbcf65
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Apr 13 09:02:55 2017 +0200

    Bug 18420: Replace hardcoded EUR in OrderUsers.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit acd91afd0c623e75ea9f9d7fb3b57a39bdfb1890
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 11 07:48:54 2017 -0300

    Bug 18420: Do not use 'S' as patron category code in other tests
    
    Test plan:
    prove all these tests, they must all pass
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7ad1a5280c76bf955ce29f3610f7a7a8e4b1fb9f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 11 07:33:32 2017 -0300

    Bug 18420: Use TestBuilder to create a patron category in Suggestions.t
    
    No need to do it that way, let's use TestBuilder.
    
    Test plan:
      prove t/db_dependent/Suggestions.t
    should still return green
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1a118ff85456b4b1a82cab28005d435650498ba6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 12 11:10:57 2017 -0300

    Bug 18420: Fix Members.t when no patron category 'S' exists
    
    No need to create Staff users here.
    
    Test plan:
      prove t/db_dependent/Members.t
    should return green, even if no categories.categorycode 'S' exists
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b7a4a64658b3a416c4c51cd1d3deeadb9719e053
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 12 11:06:43 2017 -0300

    Bug 18420: Fix Passwordrecovery.t when no patron category 'S' exists
    
    No need to create Staff users here.
    
    Test plan:
      prove t/db_dependent/Passwordrecovery.t
    should return green, even if no categories.categorycode 'S' exists
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8d749c133998d8c2ebda4a2db8d622085a658331
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 12 11:03:10 2017 -0300

    Bug 18420: Fix Budgets.t when no patron category 'S' exists
    
    No need to create Staff users here.
    
    Test plan:
      prove t/db_dependent/Budgets.t
    should return green, even if no categories.categorycode 'S' exists
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8b0bed34c20b21865d76992b7822bc3874867cbc
Author: Marc Véron <veron@veron.ch>
Date:   Sun Mar 26 17:26:22 2017 +0200

    Bug 18335 - Check in: Make patron info in hold messages obey syspref AddressFormat
    
    When checking in, information about patrons with a hold always display
    in an US style. Address information should opey the system preference
    AddressFormat
    
    To reproduce:
    - Set syspref AddressFormat to German style
    - Check out an item to a patron A
    - Put a hold on this item for patron B
    - Check in item using the Check in field in page header
    - Result: In message 'Hold found', address does not display in German
      style
    
    To test:
    - Apply patch
    - Repeat steps above
    - Verify that address displays as expected
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eab4d43a479c20c3708eb0765c9e92ee6f58e7d9
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Apr 19 12:15:46 2017 -0300

    Bug 18460: Fix undefined itemtype warning in Serials.t
    
    This patch makes the test create an itemtype, and use it for the created item so there's no warning.
    
    To test:
    - Run:
      $ prove t/db_dependent/Serials.t
    => FAIL: item-level_itypes set but no itemtype set... warning raised
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Serials.t
    => SUCCESS: Tests pass and no warning is raised
    - Sign off :-D
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 37836951d38ed57c7ed5ed702aab1433729ffe0d
Author: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
Date:   Tue Apr 1 14:07:59 2014 +0200

    Bug 12021 - SIP2 checkin should alert on transfer and use CT for return branch
    
    This small patch corrects the SIP2 checkin response if branch transfer is needed.
    It depends on bug 7981 and also removes an obsolete alert check in SIP2.
    
    Test plan:
     - apply bug 7981
     - make sure syspref AutomaticItemReturn is false
     - check 'Return policy' in 'Default checkout, hold and return policy'
     - make a SIP2 checkout and checkin from a branch different than item's home branch.
     - verify that SIP2 response gives alert CV04 (=send to different branch)
     - also verify that response field CT gives correct branch according to 'Return policy'
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Followed test plan, works as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 185dc7f45af17bf70ec36125be736286a1f8b86e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Apr 18 14:03:37 2017 -0400

    Bug 18423 - Followup - enable Add child button for institutional borrowers
    
    If they can have guarantors and we shwo the button on one page I think
    we should in fact show it on all.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b81a18ea39e1f360dc0dc4b7a874b614dc67d725
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Apr 18 13:53:54 2017 -0400

    Bug 18423 - Add 'Add child' button to files, housebound, and deletemem pages
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b689c6f9fe31dea49657b65af4f6830af1b17433
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 17 12:32:56 2017 -0400

    Bug 18423 Follow-up - Add 'Add child' button to statistics tab
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d18f30eb3f794a144989970893ef87d673cef8ec
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 12 11:32:11 2017 -0400

    Bug 18423 follow up - fix display off add child on members/notices.pl
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e28f19f0a88e334c99a45fadf96ae504bbb17ebe
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 12 10:23:56 2017 -0400

    Bug 18423 - Add child button not always appearing - problem in template variable
    
    This patch removes the retrieval of the syspref borrowerRelationship
    from the scripts and moves it to a check using the Template Toolkit
    plugin
    
    To test:
    1 - Apply patch
    2 - Ensure 'Add child' button displays appropriately on all member pages.
    
    Tested 3 pateches together, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 46d0be3114785c17e48df8bc31b515599d394789
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Sun Jan 15 23:26:33 2017 -0500

    Bug 17911: Message and timeout mismatch
    
    The installation step 3 has a meta refresh of 10 seconds,
    but the message says 5 seconds. People could get impatient.
    
    TEST PLAN
    ---------
    1) Fresh install
       -- notice the discrepancy on the web installation.
    2) drop and create the DB
    3) apply the patch
    4) run the web install
       -- notice it refreshes faster (5 seconds vs 10 seconds)
    5) run koha qa test tools
    
    Works as intended and passes qa test tool
     OK koha-tmpl/intranet-tmpl/prog/en/modules/installer/step3.tt
      OK    forbidden patterns
      OK     git manipulation
      OK      spelling
      OK   tt_valid
      OK    valid_template
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit afb62d9a6c6cbb65b5149220c5c25bc29adf2d7e
Author: Pongtawat Chippimolchai <pongtawat@punsarn.asia>
Date:   Mon Dec 26 17:50:50 2016 +0700

    Bug 17814: koha-plack --stop should make sure that Plack really stop
    
    koha-plack --stop doesn't ensure that Plack was really stopped before
    returning
    
    So in case that koha-plack --stop was quickly follows by koha-plack
    --start (e.g. logrotate), it could leave Plack in stop state. This is
    due to koha-plack --start think that Plack was already started, while it
    actually is being stopped.
    
    For me I think this is the cause why I got random Plack stop when
    logrotate is run.
    
    It should be similar to the case of Zebra in Bug #16885, and the
    solution might be the same: adding "--retry=TERM/30/KILL/5;" to
    start-stop-daemon command.
    
    TEST PLAN
    ---------
    1) Login to staff client and do something that will hold connection for
    a long time, e.g. a batch import or a slow report.
    2) sudo koha-plack --stop mykoha
    3) ps aux | grep plack   <-- a Plack process will still running work in
    1)
    4) wait for 1) to finish and all Plack processes exit
    5) sudo koha-plack --start mykoha
    6) apply the patch
    7) repeat step 1)-2)
    8) ps aux | grep plack   <-- There should be no Plack process running
    now
    9) Note that work in step 1) might get terminated midway. Since we force
    Plack to stop after some wait.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ea2196c6527c643873fb3161d3e07d23e0202f1d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 19 15:34:17 2017 -0300

    Bug 17502: Add info when throwing the exception
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit de699909c29bf877b6bf37f15127804c1a2abc62
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Mar 23 09:35:57 2017 +0100

    Bug 17502: Throw some exceptions in output_pref
    
    Test plan:
    Run the adjusted t/DateUtils.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    NOTE: This patch is amended in QA. The exceptions are moved from a separate
    module to the general section of Exceptions.pm.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f14d03b5a3d1e953da700c9379c1bd5c9ab79334
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Oct 27 09:11:03 2016 +0200

    Bug 17502: Add type check to output_pref
    
    This patch makes the following changes:
    [1] In Koha/DateUtils.pm, sub output_pref:
        Add a test if $dt is really a DateTime before calling method ymd.
        Preventing a crash like:
        Can't locate object method "ymd" via package "dateonly".
        See also BZ 17502/15822.
    [2] Adds a few unit tests in t/DateUtils.t.
    
    Test plan:
    [1] Run the adjusted unit test t/DateUtils.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d51538cb824387230b3e2cab955d3c16475bedde
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Apr 20 12:52:47 2017 +0200

    Bug 18364: [Follow-up] Also add an environment variable to prevent locking
    
    The test in SendCirculationAlert is extended by adding an env var
    called KOHA_NO_TABLE_LOCKS. If this var is set to a true value,
    the table locking is skipped too.
    
    This is useful when running a test without prove. The variable could be
    set in a shell profile.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b40456f7dd4b8a988f9c6a5718452936101cb8ff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 31 13:43:38 2017 -0300

    Bug 18364: Do not LOCK/UNLOCK tables from tests
    
    From the MySQL doc:
    "LOCK TABLES is not transaction-safe and implicitly commits any active transaction before attempting to lock the tables."
    If the LOCK/UNLOCK statements are executed from tests, the current transaction will be committed.
    To avoid that we need to guess if this code is execute from testsa or not (yes it is a bit hacky)
    
    Better ideas are welcome!
    
    Another fix would have been to revert
      commit be156d9ad9e5bcfadab34d44f90e04fd61e256ad
      Bug 15854: Use a READ and WRITE LOCK on message_queue
    but theorically a race is still possible.
    
    Existing tests seem to be safe, to test this patch you will need new
    tests from bug 17964.
    Test plan:
      prove t/db_dependent/Letters/TemplateToolkit.t
    twice, and notice that changes have been comitted.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ea04798a16ad8c8400030440e21825fc20b03808
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 17 13:22:24 2017 -0400

    Bug 18439 - Resend button for notices being hidden by CSS and never unhidden
    
    Current jQuery is not unhiding resend button, this patch adds an id
    and a toggle command
    
    To test:
    1 - Enable EnhancedMessagingPreferences
    2 - Find a patron with sent or failed messages
    3 - Note you can expand message, but not resend
    4 - Apply patch
    5 - Note that on expanding message a 'Resend' button appears
    6 - Ensure resend button operates as expected
    
    Works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Lari Taskula <lari.taskula@jns.fi>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2a8f748f25e305deca7fce41451fbd78056ba26d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 26 14:31:35 2017 +0000

    Bug 18001 - LocalHoldsPriority can cause multiple holds queue lines for same hold request
    
    If LocalHoldsPriority is enabled, and a record level request has more
    than one item that could fill that hold, there is a possibility that a
    holds queue row will be generated for the request for each of the
    available items!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Joel Sasse <jsasse@plumcreeklibrary.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit aa68e40005928150ac4aa1db8ce00716d7b7fe3f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Apr 18 07:38:42 2017 -0400

    Bug 18001 - Unit Test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 598ee32db330bb8538147c8e162ea2e48ba26ecf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 20 09:56:09 2017 -0300

    Bug 17835: Re-add the use Koha in orderreceive
    
    It is still used for getitemtypeinfo, at least.

commit 07156cf8fd0f11eb43a11ffa7f75d4c95f3766df
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Apr 11 16:45:40 2017 +0000

    Bug 18372 - transits are not created at check in despite user responsing Yes to the prompt
    
    If the AutomaticItemReturn system preference is set to "Don't" and you
    check in an item which belongs to another library, a dialog will ask you
    if you want to transfer. This patch corrects a bug to enable the "Yes"
    buttons to work, triggering the transfer.
    
    To test, apply the patch and check in an item which belongs to another
    library. In the dialog, click the 'Yes' button and confirm that the item
    has been made 'in transit' to the correct library.
    
    Perform the same test with the 'Yes, print slip' and 'No' buttons and
    confirm they are working correctly.
    
    Since this patch changes the behavior of many other popups triggered
    from this template, test other operations which trigger a 'print slip'
    option like:
    
    - Checking in an item which is part of a rotating collection
    - Checking in an item which is on hold for a patron
    
    Signed-off-by: Colin Campbell <colin.campbell@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8e5c9bab4e791fdb6ac8cfc66078f206a169e2f7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Apr 19 11:19:26 2017 -0300

    Bug 17835: (followup) Make TestBuilder skip views
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit f04c5d5a2c549bed54036b726965ccda083def7b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 31 00:24:09 2017 -0300

    Bug 18321: Correctly calculate switch_onsite_checkout
    
    Silly error here, the $switch_onsite_checkout is not correctly
    calculated, it should not only be set to the value of the syspref, but
    meet all the conditions.
    
    Test plan:
    Set a circ rule with number of on-site checkout = 2 and number of
    checkouts = 2.
    Switch on both ConsiderOnSiteCheckoutsAsNormalCheckouts and SwitchOnSiteCheckouts
    
    Do a regular checkout
    Do another regular checkout
    At this point you have reach the maximum number of checkouts allowed.
    Not try another one.
    => Without this patch you will not get the warning
    => With this patch you will see it
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1c7d283aae0952877b871f486c31cd3f04529222
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 31 00:23:19 2017 -0300

    Bug 18321: Add tests
    
    Clean a bit existing tests by adding default values and add a test to
    highlight the issue.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 36fd40468950950c605b82fd918a5e932e2c6734
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Apr 14 08:58:30 2017 +0200

    Bug 17835: [QA Follow-up] Fix opac-search.pl
    
    Resolves:
    Global symbol "$itemtypes_nocategory" requires explicit package name.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested the added line with a debug statement. See itemtype facets in the
    search results.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1a7a27a1c8d5e2960debd72381065cae86c3a715
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 9 09:15:29 2017 +0100

    Bug 17835: Mock language pref value
    
    That way if prefs contain other languages, the test will still pass.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Lari Taskula <lari.taskula@jns.fi>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb0e33f046547c919aff6684c47dcee282ab4d16
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 3 13:35:46 2017 +0100

    Bug 17835: Add an additional LEFT JOIN condition using DBIx::Class
    
    The previous query was wrong. If an item type did not contain the
    translation in the interface's language, the ->search_with_localization
    did not return it at all.
    
    What we need is definitely to add a second condition on the join.
    
    For reference:
    http://search.cpan.org/dist/DBIx-Class/lib/DBIx/Class/Relationship/Base.pm#condition
    https://blog.afoolishmanifesto.com/posts/dbix-class-parameterized-relationships/
    
    That sounds hacky but seems to be the DBIx::Class path to follow.
    
    Bug 17835: follow-up
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Lari Taskula <lari.taskula@jns.fi>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 72dd80fae9acedab5bc9512bbbbfa79e0f57aa99
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 3 11:36:25 2017 +0100

    Bug 17835: Remove the subroutine GetItemTypes
    
    At this point the subroutine is no longer in used.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Lari Taskula <lari.taskula@jns.fi>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8d5b4306e07a594cd102fcce85f912ab3a5661e9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 3 11:05:15 2017 +0100

    Bug 17835: Replace GetItemTypes with Koha::ItemTypes
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Lari Taskula <lari.taskula@jns.fi>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 53ce807f6e6becc1e305d7743b8be9d5605a8c9a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 3 09:22:48 2017 +0100

    Bug 17835: Do not reselect translated_description if comes from search_with_localization
    
    If the Koha::ItemType object has been instanciated from a call to
    Koha::ItemTypes->search_with_localization, we already have the
    translated_description value. So there is no need to fetch it again from
    the DB. This is what this trick does: if the translated_description
    column exist in the DBIx::Class result source's column list, that means
    the value has already been retrieved.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Lari Taskula <lari.taskula@jns.fi>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 80018625cf03ccd00957035f99065ed5793b80e3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 2 17:29:32 2017 +0100

    Bug 17835: Create a ItemtypeLocalization view
    
    To properly move C4::Koha::GetItemTypes to Koha::ItemTypes we need
    DBIx::Class to make a join on the localization table to retrieve the
    possible translated description of the item types.
    To do so there are 2 possibilities. The first one would have been to
    rename the localization table to something like itemtype_localization.
    That way we could have had a relationship between
    itemtype_localization.code and itemtypes.itemtype
    That would have meant to create one table per "entity" (here an entity
    is itemtype) we allow the translability. There are pros and cons for
    this choice, so I opt for another solution.
    The other solution is to create a view on top of this localization
    table. With this new view we can define the missing relationship.
    
    That sounds like a quite clean solution and easy to implement.
    Once we have this relationship, the
    Koha::ItemTypes->search_with_localization will join on this view an
    return the same result as GetItemTypes( style => 'array' ).
    To replace
        GetItemtypes( style => 'hash' )
    which is the default behavior of this subroutine, we can do something like:
        my $itemtypes = Koha::ItemTypes->search_with_localization;
        my %itemtypes = map { $_->{itemtype} => $_ } @{ $itemtypes->unblessed };
    
    This patchset must not introduce big changes but it changes certain
    behaviors (which were wrong) in some scripts. Indeed sometimes the
    descriptions of the item types were not the translated ones. Moreover it
    happens that the item types displayed in a dropdown list were not
    ordered by translated description, but by description of code
    (itemtypes.itemtype value). These 2 behaviors are what we expect.
    
    Test plan:
    Bugs will be hard to catch since these patches change a lot of file, it
    will be easier to read the diff and catch possible typos or logic
    errors.
    However signoffers can focus on modified files and the item types
    values.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Lari Taskula <lari.taskula@jns.fi>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7df47b48ba8a7241f062d14fb9f32770b80694d9
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Dec 28 15:08:42 2016 +0100

    Bug 17821 - due date in intranet search results should use TT date plugin
    
    Intranet search results displays due date from item onloan.
    This should use the TT date plugin.
    
    Test plan :
    - set syspref dateformat not on yyyy-mm-dd, for example dd/mm/yyyy
    - checkout an item
    - at intranet, perform a search where you see the item
    => You must see : "date due : dd/mm/yyyy"
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87eb80136d49451d0a9cc25e68db452a33f1771a
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Sat Apr 8 23:18:23 2017 +0000

    Bug 12930: Web installer does not show login errors
    
    Implemented invalid_username_or_password template
    variable being handed to Auth.tt. Removed indentation
    changes and modification to return value of checkpw
    
    Test plan:
    See comment #2
    
    Alternative test plan:
    - Clear session cookies or close / open your browser
    - Go to  [MY SERVER]/cgi-bin/koha/installer/install.pl
    - Verify that message appears if wrong username/pw provided
    - Verify that you can log in with databas administrator account
    
    Tested with alternative test plan, works as expected. Title and
    description in commit message adapted.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 508147d24443498a2c12a7c55240e70941c49dd6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 3 12:50:27 2017 -0300

    Bug 18373: Re-add UpgradeBackup.pm
    
    Bug 18028 removed the install_misc directory but
    install_misc/UpgradeBackup.pm was still used by the 'upgrade' rule of
    make.
    
    Other files from install_misc were useless to it may be better not to
    reintroduce this directory with only 1 file.
    
    Test plan:
    `make`
    `sudo make install`
    `make upgrade`
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d26b0668af62f0907a58108d4164ed27072317e9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Apr 13 09:14:24 2017 -0400

    Bug 14537 - DBRev 16.12.00.024
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c1a460b5b2716b1fabd46b296117287c9935bbac
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Apr 7 11:14:38 2017 +0200

    Bug 14537: [QA Follow-up] Remove one overdues residue in pref description
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 98398a671544ec21cd099dc62336c1ca1cb81f18
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Apr 5 04:19:18 2017 +0000

    Bug 14537: Renaming OverdueNoticeBcc to NoticeBcc
    
    To test:
    1) Apply patch and update database
    2) Run 'git grep "OverdueNoticeBcc"' and confirm there are no other
    instances
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b5fa49195557e23d027ed9f2db899e0b3970b760
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Apr 13 09:09:05 2017 -0400

    Bug 9988 - DBRev 16.12.00.023
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0868b709811078405a834114e779e0a35184d54d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Apr 11 14:58:41 2017 +0200

    Bug 9988: [QA Follow-up] Satisfy QA issues
    
    [1] See comment102. Moved sub reporting_tag_xml to MergeRequest.pm.
        Adjusted t/db_dependent/Koha/Authorities.t accordingly.
        This resolves the C3 inconsistent hierarchy errors.
    [2] Removed empty POD section Instance Methods from MergeRequests.
        This resolves the POD error in comment102 point 2.
    [3] Include a tag 100 for UNIMARC in reporting_tag_xml to resolve an error
        on encoding in MARC::File::XML. Subtest for oldmarc and subtest for
        reporting_tag_xml adjusted accordingly.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 630896330b0b5249c1a53342cdd1458e5677f7ee
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 23 12:23:36 2017 +0100

    Bug 9988: Add the cronjob and print an upgrade message
    
    The Debian cron file and the misc crontab example are updated.
    A message is printed when upgrading.
    
    Note: At this moment the merge cron job is run once a day. This is imo a
    good starting point. The load for this job greatly depends on the value of
    pref AuthorityMergeLimit. Of course you can schedule the job more often,
    and if this need is felt more globally, we can adjust it later.
    
    Test plan:
    [1] Run the dbrev and see the message.
    [2] Read the changes to the cron files.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dea93375dcc147280e93153b0a7e3b90ce66b4a0
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Feb 22 16:51:58 2017 +0100

    Bug 9988: Refactor the cron script
    
    The cron job is moved from migration tools to cronjobs. And renamed to
    a plural form. The script is now based on Koha objects. It does no longer
    include the code to merge one record. This can be done via the interface,
    and will be added to a maintenance script on bug 18071. Should not be part
    of this cron job.
    
    Adding a cron_cleanup method to MergeRequests; this method is called from
    the cron script to reset older entries still marked in progress and to
    also remove old processed entries. Tested in a separate unit test.
    
    Test plan:
    [1] Run t/db_dependent/Authorities/MergeRequests.t
    [2] Set AuthorityMergeLimit to 0. (All merges are postponed.)
    [3] Modify an authority linked to a few records.
    [4] Delete an authority linked to a few records with batch delete tool.
    [5] And select two auth records with linked records.
        Merge these two records with authority/merge.pl.
        Note: Do not select Default. See also bug 17380.
    [6] Check the need_merge_authorities table for inserted records.
    [7] Run misc/cronjobs/merge_authorities.pl -b and inspect the linked
        records and the record status in need_merge_authorities.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d49e8bd5e22a0b39e5628b24a033badc44a07bba
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 23 12:46:52 2017 +0100

    Bug 9988: Few subtle changes for postponed merge
    
    The fails in the previous test showed that we need the first three
    changes here. Some final polishing in points 4 to 6.
    
    [1] Sub merge: Refine the condition for initializing $tags_new.
        A postponed 'modify'-merge (A to B) makes that $authtypefrom is not
        defined when running merge later. When crossing the type boundary, we
        need a new field too.
    [2] Sub merge: Add condition for an empty @record_to array.
        This indicates also that a field should be removed, since we should
        otherwise only add a $9 subfield.
    [3] Sub merge: Adjust initializing @record_from.
        This change is tested by verifying a cleared subfield in the test.
    [4] DelAuthority: Adding a skipmerge parameter to allow the call from
        authorities/merge.pl to skip an unneeded merge.
        This also prevents that the 'delete-merge' would precede the
        'modify-merge' under a hypothetical race condition.
    [5] DelAuthority: There is actually no need to call GetAuthority.
        The subfields of the old record are not relevant in this case.
    [6] Added a few POD lines to merge.
    [7] Removed a trailing space in a comment line in merge.
    
    Test plan:
    [1] Run t/db_dependent/Authorities/Merge.t.
        The last subtest should no longer fail now.
    [2] See test plan of next patch.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7d536702792e2ff4d6a083b5ce5aa670fc88e0f9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 23 12:46:52 2017 +0100

    Bug 9988: Add a subtest for specific postponed merge issues
    
    This subtest shows that we need a few little tweaks to make merge
    work in some specific postponed merge situations.
    
    Test plan:
    [1] Run t/db_dependent/Authorities/Merge.t.
        The last subtest should fail.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f953cc26e6e9569f6674e6186efc3e37b5c721b2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Feb 22 10:53:03 2017 +0100

    Bug 9988: Remove further references to dontmerge
    
    [1] The preference was sent to HEA. We can now send both AuthorityMergeMode
        as well as AuthorityMergeLimit.
    [2] A comment in authorities/merge.pl is removed. Note that a subsequent
        patch will modify and test the cron job.
    [3] Script misc/batchRebuildItemsTables.pl temporarily enabled dontmerge.
        This is equivalent to setting the mergelimit to zero.
        The function defnonull is no longer needed. (If the pref was NULL,
        we restore that value. Sub merge won't mind.)
    
    Test plan:
    [1] Run t/db_dependent/UsageStats.t
    [2] Run misc/batchRebuildItemsTables.pl -t
        This just ensures you it still compiles; the changes speak for itself.
    [3] Now git grep on dontmerge.
        You should only find hits in atomicupdate and misc/translator/po.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 04263912c7e413c5dbf13fe61dcdfa4b4912ab56
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 21 11:54:23 2017 +0100

    Bug 9988: Check the merge limit in sub merge
    
    At this point, we are replacing dontmerge functionality by the new
    AuthorityMergeLimit logic. Instead of doing this check before calling
    merge, we just call merge and check it there. In order to let the cron
    job do the larger (postponed) merges, we add a parameter override_limit.
    
    A subtest is added in Merge.t to test the 'postponed merge' feature. Since
    merge now also calls get_usage_count, an additional mock is added. All
    references to dontmerge are removed.
    
    In merge two lines, initializing $dbh and $counteditbiblios, are moved.
    The dontmerge test in DelAuthority and ModAuthority is removed. Since this
    did not leave much in ModAuthority, I fixed the whitespace on the remaining
    lines rightaway (yes, I know).
    A minimal set of changes is applied to the cron script; it will get further
    attention on a next patch.
    
    Test plan:
    [1] Run t/db_dependent/Authorities/Merge.t
    [2] Set AuthorityMergeLimit to 2. Modify an authority with two linked
        biblios. Check that the merge was done immediately.
    [3] Now modify an authority with more than 2 linked records.
        Verify that the merge was postponed; a record must be inserted in
        the need_merge_authorities table.
    [4] Testing of the merge cron job is *postponed* to a next patch.
        Note: I tested a modification, but the script just needs more
        attention.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 06647d29a7c02b6483f27f6c46e9d0e639236d6e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 21 09:22:59 2017 +0100

    Bug 9988: Remove the Zebra code from sub merge
    
    Since we can now call linked_biblionumbers, we can now remove all Zebra
    related code from merge. We also add a parameter biblionumbers; we use it
    in the test now, but it may be handy too later in the maintenance script
    when we want to trigger a merge for specific biblionumber(s). See bug
    report 18071.
    
    All mocks for ZOOM, Context::Zconn, Search::new_record_for_zebra in the
    merge test can now be replaced by one mock for linked_biblionumbers. Note
    that we test the biblionumbers parameter in the last subtest without that
    mock.
    
    Remove unused vars $countunmodifiedbiblio, $counterrors from merge.
    Renamed zebrarecords to linkedrecords in the Merge test.
    
    Test plan:
    [1] Run t/db_dependent/Authorities/Merge.t
    [2] Modify an authority record. Check the linked biblio records.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4c762ba69c0a85f3c5a3add40f8f4c16081965fe
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 21 08:39:24 2017 +0100

    Bug 9988: Merge should have a parameter hash
    
    We will need a few additional parameters for merge later on. This patch
    puts the original parameters in a parameter hash.
    For the same reason DelAuthority gets a parameter hash here.
    
    Note: We remove the second parameter from the DelAuthority call in
    authorities/authorities-home.pl here. It was not used and could have
    presented problems in the future.
    
    Test plan:
    [1] Run t/db_dependent/AuthoritiesMarc.t.
    [2] Run t/db_dependent/Authorities/Merge.t.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2bb870b3f0cadef851497ab1d4ad8783f47ac8f2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Feb 15 15:48:17 2017 +0100

    Bug 9988: Add get_usage_count and linked_biblionumbers to Koha::Authority
    
    When replacing the Zebra code in sub merge, we actually need CountUsage
    as well as the results it gets from SearchEngine.
    
    In order to get count and/or results, we now create:
    
    [1] instance methods get_usage_count and linked_biblionumbers in
        Koha::Authority,
    [2] class methods of the same name in Koha::Authorities.
    
    The instance method calls the class method. The class method can be used
    for deleted authority records, and in 'legacy calls' before refactoring.
    
    Note: On BZ 18149 we will replace all CountUsage calls.
    
    Test plan:
    Run t/db_dependent/Koha/Authorities.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 25c87a754203f38267eba219d34f86b5922be298
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Feb 15 15:48:17 2017 +0100

    Bug 9988: Add extract_biblionumber to Koha/SearchEngine
    
    When we will replace the Zebra code in sub merge, we will call SearchEngine
    to pass records and we need a routine to extract a biblionumber from
    a search result record. A record from Zebra still must be converted to
    MARC::Record. This is no longer needed for a ElasticSearch record.
    
    Test plan:
    Run t/db_dependent/Koha/SearchEngine/Search.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5cc310238558ceee83cb340c0246d47d880ccf57
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Sun Jan 1 11:50:44 2017 +0100

    Bug 9988: Add Koha objects for table need_merge_authorities
    
    This patch adds two Koha objects: MergeRequest(s).
    MergeRequest has a new method and an oldmarc method.
    A class method reporting_tag_xml is added to MergeRequests.pm.
    All new routines are tested in Authorities.t.
    
    Removes a few unneeded modules from Koha::Authority.
    
    Test plan:
    Run t/db_dependent/Koha/Authorities.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a26ec1b47f3834b529b75c79d3975be0d16f2ad4
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 14 09:07:27 2017 +0100

    Bug 9988: DBIx schema changes for need_merge_authorities
    
    As generated by misc/devel/update_dbix_class_files.pl.
    No test plan.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7effc34cd251dd6e3841c365015ba8c9d4e68b46
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 14 08:42:04 2017 +0100

    Bug 9988: Table revision for need_merge_authorities
    
    In order to let merge do exactly the same when called from the merge
    cron job, we need three additional fields in the table. The use of these
    fields will be explained in a follow-up.
    
    Test plan:
    Run the dbrev (updatestructure step in webinstaller).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Also tested running kohastructure.sql for this table.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7d762b1d8f1487a86c96e46e4fa03857ce0f3fa8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 10 11:39:31 2017 +0100

    Bug 9988: Database revision for AuthorityMergeLimit
    
    Introduce the new preference and remove dontmerge.
    If dontmerge was enabled, the new pref will be set to zero and we will
    print a message about raising this value now.
    
    Test plan:
    Run the database revision or a new install.
    In case of an upgrade, check the new pref value. Should be 0 when
    dontmerge was enabled, otherwise 50.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Also tested sysprefs.sql on a new database.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6727a61578ec2b0ed3ebed182715a3f85c0b33d6
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Apr 5 15:37:35 2017 +0200

    Bug 18394: Add an option to item search to export a barcodes file
    
    Test plan:
    1. Go to item search (/cgi-bin/koha/catalogue/itemsearch.pl)
    2. Fill the form with whatever you want
    3. Leave the 'Output' option to 'Screen' and click 'Search'
    4. Verify that the search still works
    5. Click on 'Edit search' and set 'Output' to 'Barcodes file', click 'Search'
    6. You should be able to download a 'barcodes.txt' file, open it and compare it
       to the previous search results
    7. Now click on the 'Export results to barcodes file' button above the results,
       you should have the same result as in step 5
    8. Verify that the CSV export still works
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8d2517411774c82d665fd41446e4de082ff6f6fd
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Apr 6 14:26:08 2017 +0200

    Bug 18394: Remove useless code from item search
    
    The item search was originally designed to work even with JS disabled.
    Since bug 15111, the staff interface does not work at all without JS, so some
    parts of this code are useless and should be removed
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b09ac0a5583afc30622af45af41c43078515b3ec
Author: Marc Véron <veron@veron.ch>
Date:   Tue Apr 4 13:03:04 2017 +0200

    Bug 18375: Better readability of patron category table for zero ages and fees
    
    In patron category table, this patch displays zero / empty values for ages and
    fees with '-' for better readability
    
    To test:
    - Go to Home > Administration > Patron categories
    - Verify that you have 0 years and/or only years in Age required and Uper age limit colums
    - Verify that you have Enrollment and Hold fees of 0.00
    - Apply patch
    - Verify that such values are replaced by - to enhance table readability
    
    Signed-off-by: Luke Honiss <luke.honiss@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5e185f8036c7a0fb381462f3a716c8414278be1f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 15 13:10:16 2017 -0300

    Bug 18274: C4::Items - Remove GetItemStatus
    
    This subroutine is no longer in used.
    It was previously call from serials/serials-recieve.pl, which was not used and has been removed by
        commit 65b7ad030cd5cd0e3148fbbd1496d31b5cf149f7
        Bug 13423: Remove unused serials-recieve
    
    Test plan:
      git grep GetItemStatus
    should not return any used calls (only 1 occurrence in release notes)
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b038bb131082c7c165bc2a71a44e974e15ebd839
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Apr 7 11:56:52 2017 +0200

    Bug 18208: [QA Follow-up] Get count from Koha::Items
    
    Removes the loop by moving the onloan test to the query.
    
    Test plan:
    Run the test again.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b27b77307c24a60a0a49581396f01d19f87ebdb0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 3 15:30:22 2017 -0300

    Bug 18208: Add RecordProcessor filter to inject not onloan count to MARC records
    
    This patch adds a new filter for MARC records to be used with
    Koha::RecordProcessor. It's purpose is to inject the information about
    items not-onloan in a fixed subfield, 999$x.
    
    To test:
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Koha/Filter/EmbedItemsAvailability.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Followed test plan, test passes OK
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 71f34c7b34c355e0b8c0dead9f7ca49b4e1e1dc3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Feb 3 11:49:30 2017 +0100

    Bug 17737: [QA Follow-up] Remove unused reservedfor variable
    
    The changes in this patch set obsolete this variable.
    Remove confusing comment about reserve via host record.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b01fe1a666ee341c56a182ce34a39788d7e15224
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 9 09:13:11 2017 +0100

    Bug 17737: Rename holds_placed_before_today with current_holds
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3ca173fe405d9c786273fca0e372f4f9640224f3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 7 14:04:17 2016 +0100

    Bug 17737: Remove C4::Reserves::GetReservesFromItemnumber
    
    At this point, there should not be any occurrences of
    GetReservesFromItemnumber anymore.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 95c96f823db485b4bdb1611bed303474444f7c99
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 7 13:50:46 2016 +0100

    Bug 17737: Replace GetReservesFromItemnumber with Koha::Item->get_holds_placed_before_today
    
    On the same way of Koha::Biblio->get_holds,
    Koha::Biblio->get_holds_placed_before_today and Koha::Patron->get_holds,
    this new subroutin will permit to retrieve the holds placed on a
    specific item.
    Note that at the moment we do not need a Koha::Item->get_holds method:
    we do not want to display future holds placed in the future.
    
    Test plan:
    I would suggest to test this patch with patches from bug 17736 and bug 17738,
    to place different kind of holds (biblio and item level, future and
    past).
    Then do a whole workflow to detect bug, view a record, delete record,
    order, place a hold on an item which has been ordered, etc.
    The hold's informations should always be the same without or without
    these patches.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2be6625d1a8e537c2046f68990597c9e75e65d81
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Apr 5 15:01:53 2017 +0000

    Bug 18388 - Standardize serials volume information displaying
    
    OPAC: Home > Details for (serial)
    Compared information in tab 'Holdings' col 'Vol info' with
    same information in staff client. With patch it's the same.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 476179a12311b32643087cc8ec10c31409bb1b99
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 10 10:03:36 2017 +0100

    Bug 17872: Fix small error in GetBudgetHierarchy and one of its calls
    
    In aqbudgetperiods.pl a commented line is removed that contains a
    wrong userenv hash key. Should be branch instead of branchcode.
    
    In aqbudgets GetBudgetHierarchy is called with the same wrong userenv
    hash key. Should be userenv->{branch}.
    This made another bug visible: if you call GetBudgetHierarchy with a
    branch and without owner, the where clause should take into account
    that the branchcode can be empty (not null).
    
    Test plan:
    [1] Run Budgets.t
    [2] Run aqbudgets.pl from Administration
    [3] Add the show_mine=1 parameter in the URL
    [4] Change owner of one of the funds and repeat step 2 and 3.
    
    t/Budgets.t returns green. Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 17f4b05d23cb19cebeedb361005bf411a5f25c60
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 11 10:31:49 2017 -0300

    Bug 14932: Do not call can_edit_subscription with an empty value
    
    ref($sub) eq 'ARRAY' should always be true, what we want is to call
    can_edit_subscription if there is at least 1 serial for this
    subscription.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6940aa91a53371ba49528022954a9a349044ab63
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Thu Oct 1 15:23:23 2015 +0300

    Bug 14932 - serials/serials-collection.pl-page is very slow. GetFullSubscription* checks permission for each serial!
    
    Currently we have subscriptions with 300+ serials received.
    It takes a lot of time to show serials-collection.pl (~20s).
    This is especially troublesome when receiving serials, since after receival we get redirected to that page.
    
    We no longer can receive daily serials in the allotted timeframe.
    
    This quick and dirty fix prevents checking the subscription editing for each serial, but instead checks it for the first serial only.
    
    This reduced page load time by ~18s
    
    TEST PLAN:
    1. Receive ~300 serials (or just a bunch :)  )
    2. Observe the gradual slowing of the receival action.
    
    AFTER THIS PATCH:
    1. Receive ~300 serials more (or just a bunch)
    2. Observe a significant performance improvement.
    
    Signed-off-by: Paul POULAIN <paul.poulain@biblibre.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a6c26f009536e831461c1e91f8bafe07ca75d283
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 4 22:30:19 2017 -0300

    Bug 18395: (bug 14610 followup) Remove article requests methods from Koha::Patrons
    
    There is something very wrong with the new subroutines, they have been added to both Koha::Patron and Koha::Patrons:
    
    % git grep 'sub article_request' Koha/Patron*.pm
    Koha/Patron.pm:sub article_requests {
    Koha/Patron.pm:sub article_requests_current {
    Koha/Patron.pm:sub article_requests_finished {
    Koha/Patrons.pm:sub article_requests {
    Koha/Patrons.pm:sub article_requests_current {
    Koha/Patrons.pm:sub article_requests_finished {
    
    The ones in Koha::Patrons are wrong
    
    Test plan:
      prove t/db_dependent/ArticleRequests.t
    should still return green
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87d1d42f525e2430e9a5f574758495fc32947a9f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 15 08:39:23 2017 +0000

    Bug 18121: Replace opac_news.new with opac_news.content in notices templates
    
    Bug 17960 replaces opac_news.new with opac_news.content, we can replace
    the content of the notices' templates automatically.
    
    Test plan:
    Checkout a commit prior to bug 17960. Install a new DB with sample data.
    You should have notices with <<opac_news.new>>
    
    Switch to a branch with this patch, on top of master
    
    Execute the updatedatabase.pl sript
    => The notices with opac_news.new should have been replaced with
    opac_news.content
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 392641ff1ec0cf2b6480af134fd676edf64f4df7
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Apr 7 10:13:00 2017 +0200

    Bug 18349: [QA Follow-up] Add four missing error messages
    
    The error codes come from CanBookBeIssued.
    The warnings speak for themselves. Note that the GNA message is similar
    to the one used in opac-user.tt (gonenoaddress is translated to the patron
    as contact information not up-to-date).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b61f73c48832e0f10ca799aa49682da37f1f44a1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 31 13:25:13 2017 -0300

    Bug 18349: Remove useless info in alert message
    
    Empty tags should be removed, and message id
    Note that not all error codes are covered here.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d28d5a280d590bb19afbea23705802aa46af5e6d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 31 13:22:05 2017 -0300

    Bug 18349: If a confirmation is required, consider as blocker
    
    Only RENEW_ISSUE should not be considered as blocker, others should.
    Note that this code is not robust and the whole script as well as the
    return of CanBookBeIssued should be rewrittent completely.
    We need a small patch to easy backport to stable releases
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b75e5b4783cff1d14816ce363e8095569d67718
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 30 21:51:28 2017 -0300

    Bug 18349: $borrower is a hashref
    
    I guess this code was never called before...
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 85bd15a83ffdab0c2e28eae54e50ce4dee9e608b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 29 18:25:40 2017 -0300

    Bug 18349: SCO - Do not trust the confirmed flag
    
    The "confirmed" flag is used to know if that user confirmed a situation
    that needs a confirmation.
    But if the issue/renew is impossible the CanBookBeIssued and the
    'impossible flags' should be checked.
    
    Otherwise a patron can checkout and renew bypassing the circulation
    rules (Understand 'no limit' here...)
    
    Test plan:
    Want to renew?
    Checkin $barcode, then
    /cgi-bin/koha/sco/sco-main.pl?patronid=$cardnumber&barcode=$barcode&confirmed=1&op=checkout
    
    Want to bypass the checkin?
    Same url...
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2471dab71dff052b546f45690d8a3bea6f1f3811
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Apr 11 14:15:54 2017 +0200

    Bug 18413: Fix Letters.t (following bug 17866)
    
    SendAlert now needs a userenv to find branch email and the fallback
    of KohaAdminEmailAddress if the branch mail is not filled.
    
    Test plan:
    Run t/db_dependent/Letters.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7d35bdf58a0bcebab20df47b50b249cafe12ddb6
Author: David Kuhn <techservspec@gmail.com>
Date:   Wed Dec 14 16:02:26 2016 -0800

    Bug 17309 - Renewing and HomeOrHoldingBranch syspref
    
    The AddRenewal subroutine currently uses the circulation rules for the branch
    stored in the Issues table (which is the holding branch) when calculating the new due date.
    
    This patch replaces using the branch from the Issues table with the branch
    specified by the HomeOrHoldingBranch syspref.
    
    To test:
    1. Set up 2 branches, Branch1 and Branch2
    2. Set up a loan rule in Branch1 for DVDs with a 21 day loan period and a
       21 day renewal period.
    3. Set up a loan rule in Branch2 for DVDs with a 14 day loan period and a
       14 day renewal period.
    4. Checkout a DVD belonging to Branch1 while logged into Branch2. It will
       receive the correct 21 day loan period.
    5. Renewing the same DVD while logged into either Branch1 or Branch2
       will give a 14 day due date, rather than 21 days.
    6. Checkout a DVD belonging to Branch2 while logged into Branch1. It will
       receive the correct 14 day loan period.
    7. Renewing the same DVD while logged into either Branch1 or Branch2
       will give a 21 day due date, rather than 14 days.
    8. Apply the patch and repeat steps 4-7. The correct due date should be given
       when the item is renewed, regardless of where it is checked out or renewed.
    
    This update removes reassignment of $branch variable.
    
    Signed-off-by: Cédric Vita <cedric.vita@dracenie.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2d326177ae9faa6007ea835b1b793c7ec49168df
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 15 18:58:55 2017 -0300

    Bug 18093: Koha::Objects->get_column should not return a DBIC object
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1eab22f71e27675a66e4f91522a0f422a3455e34
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 10 09:45:26 2017 +0100

    Bug 18093: Add Koha::Objects->get_column
    
    Test plan:
      prove t/db_dependent/Koha/Objects.t
    Should return green
    
    Followed test plan, result as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a7f2c450de1142a16df67d04a30d5bd5e2813c52
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Apr 3 09:21:37 2017 +0200

    Bug 17866: [QA Follow-up] Change wording of db revision
    
    As Katrin noted on the report, we should not limit the db rev message to
    the serial claims only. Applies to acquisision claims too.
    Note: Strictly speaking, we could also mention the new ACQORDER notice,
    but this will not yet be widely used.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e410967acfc6538abcef74948743df3e4f575148
Author: Marc Véron <veron@veron.ch>
Date:   Sun Apr 2 18:59:52 2017 +0200

    Bug 18368 - DBversion 16.12.00.022 not set by updatedatabase.pl
    
    Updating to 16.12.00.22 puts the upgrade process in an endless loop because DBversione is not set by updatedatabase.pl
    Missing line:  SetVersion( $DBversion )
    
    This patch inserts the line as appropriate.
    
    To test:
    - Apply patch
    - Verify code change makes sense
    - Verify that upgrade smoothly runs through
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 360949f37927ce87dc4326437c2414fc73bae845
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 31 16:12:48 2017 -0300

    Fix number of tests in Circulation.t

commit 2266733767536ddf47f31821ba87d860c246700f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Dec 29 11:40:57 2016 -0300

    Bug 17825: (followup) Remove unused function AttributeTypeExists
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 60ba1bf5dd26b75d86f31325183eea4359702f84
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Dec 29 11:32:27 2016 -0300

    Bug 17825: Remove the use of AttributeTypeExists from opac-user.pl
    
    With the introducion of Koha::Object-based
    Koha::Patron::Attribute::Type(s) there's no need for using this
    function.
    
    This patch replaces it with a regular ->search + ->count call.
    
    To test:
    - Have a user with checkouts logged into the OPAC on the opac-user.pl
    page
    - Set the SHOW_BCODE attribute to 'no' on the staff interface for the
    user.
    - Reload opac-user.pl
    => SUCCESS: The barcode is not shown for checked out items.
    - Set the SHOW_BCODE atttribute to 'yes' on the staff interface for the
    user.
    - Reload opac-user.pl
    => SUCCESS: The barcode is shown for checked out items.
    - Delete the Patron attribute type SHOW_BCODE
    - Reload opac-user.pl
    => SUCCESS: No barcode is shown for checked out items
    - Sign off :-D
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 36cfb22621c5afa1d1e094a51e9d68937d1bf7d5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 29 16:39:36 2017 -0300

    Bug 17828: return $self to be consistent
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dd54e970a593e758fa7d914e1241b22196cb6f7c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 28 11:39:09 2017 -0300

    Bug 17828: Use Koha::Patron::Attributes instead of _resultset
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e610025babae7efac8415437fa7aee3fad9dce0a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Mar 27 12:47:14 2017 -0300

    Bug 17828: (QA followup) Add ->type and reuse it
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5d6ee0c7a0de306d68a66a23d7c2414d7274de74
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Mar 23 12:07:49 2017 -0300

    Bug 17828: (followup) Add Test::Exception as dependency
    
    Test::Exception is available on Jessie and already installed when
    koha-common gets installed
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d777df6b6f51dc65e6963c4e9ab0ed54b811813a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 30 11:12:32 2016 -0300

    Bug 17828: Overload Koha::Patron::Attribute->store to check for unique_id and repeatable
    
    This patch introduces a Koha::Patron::Attribute->store method that does
    the required check for the corresponding Koha::Patron::Attribute::Type
    and raises an exception if trying to store more than one unique
    attribute code/value combination, and another exception for
    non-repeatable attribute types being stored while already existing on
    the DB.
    
    This patch introduces exception definitions for that purpose.
    
    To test:
    - Apply the unit tests patches
    - Run:
      $ prove t/db_dependent/Koha/Patron/Attributes.t
    => FAIL: Tests fail
    - Apply this patch
    - Run:
      $ prove t/db_dependent/Koha/Patron/Attributes.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 46291a0c9f924f5f73824c18b1ee06c206ae9fb4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 30 11:10:33 2016 -0300

    Bug 17828: Unit tests for Koha::Patron::Attribute->store
    
    Unit tests for an overloaded Koha::Patron::Attribute->store that
    checks attribute type's uniqueness property and raises an exception
    conveniently.
    
    It also tests for repeatable attribute type's property.
    
    Test plan on the implementing patch.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d28c2152abd1ba3b5dfd8af1ceffab094c552bfa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 16:55:37 2017 -0300

    Bug 17014: Simplify some code
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a7bdc6eb3e2fc7de7158d938e37552eb75bd0cc7
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Aug 1 12:33:24 2016 -0400

    Bug 17014 - Remove more event attributes from patron templates
    
    There are many patron-related templates which still use event attributes
    to define events. This patch updates these templates so that events are
    defined in JavaScript.
    
    To test apply the patch and check out to a patron.
    
    - From the Print menu in the toolbar, choose "Print summary." The patron
      summary page should open and the print dialog should be automatically
      triggered.
    
    - From the Print menu in the toolbar, choose "Print slip." The patron
      slip page should open and the print dialog should be automatically
      triggered.
    
    - From the Print menu in the toolbar, choose "Print quick slip." The
      patron quick slip page should open and the print dialog should be
      automatically triggered.
    
    - Click the patron's "Fines" tab in the left-hand sidebar and then
      choose the "Account" tab.
      -- Click the "Print" button for an account payment (the link should
         point to printfeercpt.pl). A print receipt page should open and
         the print dialog should be automatically triggered.
      -- Follow the same procedure for a transaction which is not an account
         payment (the link should point to printinvoice.pl).
    
    - Click the "Create manual invoice" tab.
      -- Select one of the "type" choices. Doing so should automatically
         populate the "Description" field with the corresponding code.
      -- If necessary, define one or more values for the MANUAL_INV
         authorized value and confirm that those invoice types work as well.
    
    - From the patron's "Pay fines" tab, click the "Pay amount" button. In
      the "collect from patron" field, enter any combination of letters,
      numbers, and symbols. When you tab away from that field your text
      should be reformatted to currency format.
    
    - From the patrons home page, change the filter in the left-hand sidebar
      and submit it. The correct results should be returned.
    
    Signed-off-by: EricGosselin <eric.gosselin.5@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 70377b375794dffa4ff18bd9b7a7f37060cf295c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Mar 1 14:30:11 2017 +0000

    Bug 18189 - Elasticsearch sorting broken
    
    To test:
    1 - Have ES enabled and biblios and authorities indexed
    2 - Perform a catalog search
    3 - Try to sort results by author, it will fail
    4 - Perform an authority search with sorting enabled, it will fail
    5 - Apply patch
    6 - Reindex, deleting current indexes
        perl /home/vagrant/kohaclone/misc/search_tools/rebuild_elastic_search.pl
        -d -v
    7 - Repeat 3&4, they should succeed
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 08a9deb1c07c075085b391dff7c573b67dceafc2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 23 14:54:38 2017 +0000

    Bug 12026: [QA Follow-up] Add Tests for autocreate
    
    https://bugs.koha-community.org/show_bug.cgi?id=12026
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f8144691cc47aeb37e976f1d4c6dcb2b75510d26
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Mar 23 11:56:50 2017 +0100

    Bug 12026: [QA Follow-up] Fix a POD line
    
    Still refers to a removed parameter of _autocreate.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit da51c004964ae3b83f1878e3eb523981995773e9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 22 13:54:46 2017 +0000

    Bug 12026: [Rebase Follow-up] - Fix Test
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 22f1f3a26a97a74b4468b875da58c7b4fd1a6409
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Mar 21 10:27:03 2017 +0100

    Bug 12026: [QA Follow-up] POD typo and tiny change in AddMember_Opac
    
    [1] Correct xml error in POD
    Copy-pasting this example from Auth_with_shibboleth.pm into koha-conf.xml
    did not work. We need a closing tag ;)
    [2] If AddMember_Opac calls AddMember_Auto, there is no need to call
    fixup_cardnumber. Adding trivial test for AddMember_Auto in Members.t.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2f4e57b20fb3843d7a4db19dca320e7992e5e03e
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Tue Nov 15 11:36:33 2016 +0100

    Bug 12026: Fix small errors
    
    When running tests I got two errors. Do these changes make sense?
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2ccdbcd0f56ee865c6901d2ec397132f1ef5879a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 12 10:08:31 2016 +0000

    Bug 12026: [Followup] Rebasing
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d0e40439cd0c009ad41dc8770a94cd775c02eafb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jul 30 14:53:27 2014 +0000

    Bug 12026: [Follow up] Added Documentation
    
    Updated to work with match point selection
    
    - The base bug that this patch enhances has added the ability to choose
      your match point in the configuration file. This patch adds code to
      take that change into account.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9b92ce4cd173e8249b02a6b62ad3b95aea1d6c5f
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Wed Apr 2 15:53:03 2014 +0000

    Bug 12026: Adds auto-provisioning to shibboleth
    
    - Adds the option to map shibboleth attributes to koha user columns
      and allows mapping to auto create non-existant users
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2370695fb9efa680251ddd9cb1e0e271fcf4935e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Mar 20 21:58:49 2017 +0100

    Bug 18304: [QA Follow-up] Add id to paragraph tag
    
    See Bugzilla, comment 4.
    
    Note: the id is unique in the Koha codebase (git grepped).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 37550a1d690c91465789920f64800c28bdc9a6ec
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Mar 20 12:58:42 2017 +0100

    Bug 18304: Do not mail cart or list contents to the library
    
    Sometimes we receive mails from patrons, sent from opac-sendbasket or
    opac-sendshelf. Instead of placing a hold on books they send the contents
    of the cart (or even a list).
    
    This patch simply puts a note on both forms saying that they should not
    use the mail to request or renew books. If both options are disabled on
    the OPAC, the message is not shown.
    
    Test plan:
    [1] Enable RequestOnOPAC.
    [2] Put a book in the cart.
    [3] Open the cart, click on Send. Verify presence of the message.
    [4] Open a list.
    [5] Click on Send list. Verify presence of the message.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 9bc62c4e1dca2fba92f63dfcbd472db88dc7ff80
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Mar 20 10:32:14 2017 +0100

    Bug 18302: Release team 17.05
    
    Changes to about.tt in sections release team and development team.
    
    Notes:
    [1] We do not have a QA manager in 17.05 any more.
    [2] Martin Renvoize has been added to the QA team of 16.11 after the
    election; this was not adjusted in about, but has been added in the
    Development team section now.
    
    Test plan:
    Compare about:Koha team with roles for 17.05 page on the wiki.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d455dc31d4f423a154009823b0b8db925c5efe48
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Mar 2 14:24:17 2017 +0100

    Bug 18200: Fix a potential issue with preceding space in GetMarcUrls
    
    Trims the URL in order prevent prefixing a space with http://
    Normally you won't have a preceding space here, but I saw it happening
    one day and it does not cost much to resolve it.
    
    Bonus: Adding few simple tests in t/db_dependent/Biblio.t.
    
    Test plan:
    [1] Run t/db_dependent/Biblio.t
    [2] Add a 856$u with preceding space (MARC21)
    [3] Check opac-detail, Online access with OPACXSLTDetailsDisplay empty.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Followed test plan, works as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cd812cb42136fb0dda895f0af69f8abd4fe07ac0
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 27 10:57:18 2017 +0100

    Bug 18174: Add update to Koha::Object
    
    Since Koha::Objects has a update method, we should allow it too in
    Koha::Object. Note that it is just redirecting to DBIx immediately.
    
    Changed the exception when the method generates an error. The previous
    code suggested that the method was not found, but this is not the case.
    
    Test plan:
    Run t/db_dependent/Koha/Object.t
    
    Followed test plan, tests passes OK.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 512f79b87cb23346a785278d51b3c7a9c3983622
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 07:30:26 2017 -0300

    Bug 18283: 'sql' should be 'SQL'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2ba1e472e6d9b194c2fec4bc7844c673cc967cad
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Mar 16 11:28:29 2017 -0400

    Bug 18283 - Display improvements on report results - hide code and change wording
    
    This patch makes small display improvements to the report results page.
    
    -Add toggle link for SQL code
    -Change results count wording
    -Add 'Notes:' label report notes
    
    To test:
    1 - Apply patch
    2 - Run some reports
    3 - Check that results page makes sense
    4 - Hide and display code and ensure toggle works
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 39bcba540a6c00fc374284dc025297a568befed6
Author: Luke Honiss <luke.honiss@gmail.com>
Date:   Thu Jan 19 22:52:49 2017 +0000

    Bug 17945 - Breadcrumbs broken on opac-serial-issues.pl
    
    ==TEST PLAN==
    1) Make a subscription with a record
    2) Search and view the record in OPAC
    3) Click on the subscription tab and click more details
    4) The breadcrumb will say 'Detals for' without the record name
    5) Apply patch
    6) Refresh the page
    7) The breadcrumb will display the name of the record
    
    (fixed small error)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b88f0846e603b7026f87895b73940c53f2a703c9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 16 15:41:43 2016 +0000

    Bug 16757 - Add support for Fee Paid to SIP cli emulator for testing
    
    Signed-off-by: Rhonda Kuiper <kuiper@roundrocktexas.gov>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5887566f463cf37d56b496d1138935e4c20c0ab8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 16 14:50:44 2016 +0000

    Bug 16757 - Add ability to pay fee by id for SIP2
    
    The SIP protocol allows for a Fee Paid message to specify a fee
    identifier in the CG field. While this field is read and passed to
    C4::SIP::ILS::pay_fee, it is not passed along to
    C4::SIP::ILS::Transaction::FeePayment::pay and is thus not used. We
    should enable this functionality in Koha now that accountlines each have
    a unique identifier that can be passed along to the payment requestor
    via the AV field line items added by bug 14512.
    
    Test Plan:
    1) Create a fee in Koha
    2) Ensure your SIP2 server is running and configured correctly
    3) Send a 37 Fee Paid message to Koha's SIP server with the
       accountlines_id for that fee in the CG fee identifier field,
       along with the other required fields.
    4) Note that specific fee was paid in Koha
    
    Signed-off-by: Rhonda Kuiper <kuiper@roundrocktexas.gov>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a31f6e6171f2e152a15d7738c4d718451e8e7da9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Mar 1 11:24:54 2017 +0000

    Bug 14365 - Change 'Last modified' to 'Last edit' for terseness
    
    Signed-off-by: Cab Vinton <director@plaistowlibrary.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 63fec9c094f419dc38e31f01e52e6d234ac8019d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Feb 7 15:55:30 2017 +0000

    Bug 14365 - SQL Reports Last Edit Date column - Show in interface
    
    Test Plan:
    1) Apply these patches
    2) Modify a saved sql report
    3) Note the "Last modified" column is updated
    4) Run the report
    5) Note the "Last run" column is updated
    
    Signed-off-by: Cab Vinton <director@plaistowlibrary.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c2c3c110053803a486f89cee8cae2a9b24088f7f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Feb 7 16:01:12 2017 +0000

    Bug 14365 - Populate never used saved_sql column last_run when execute_query is called
    
    Signed-off-by: Cab Vinton <director@plaistowlibrary.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 50f402405591ceb77c510f7cacd62749ac9e3b59
Author: David Cook <dcook@prosentient.com.au>
Date:   Tue Jan 19 16:37:09 2016 +1100

    Bug 15541 - Prevent normalization during matching/import process
    
    This patch allows you to use the "qualifier,qualifier" syntax
    in the Record Matching Rules "Search Index" when using the QueryParser.
    While QueryParser doesn't support this syntax, it will now fallback
    correctly to non-QueryParser functionality. Without the patch, your search
    will just fail silently.
    
    This patch also adds a "skip_normalize" option to C4::Search::SimpleSearch(),
    and uses the option during C4::Matcher::get_matches. This prevents
    the s/:/=/g and s/=/:/g normalization. This normalization is heavy-handed,
    and while it is necessary sometimes to generate a valid CCL query or
    QueryParser query, C4::Matcher::get_matches() already produces a valid
    CCL query, so we don't need to do this normalization.
    
    Additionally, this normalization causes problems when you use a
    Zebra register which isn't normalized: namely the "u" register.
    Strings are stored "as is", so http://localhost/koha/resource/1 is
    stored as is during indexing. When you search, you need to pass
    the exact same thing through the query to get a match. Using
    http=//localhost/koha/resource/1 in your query will yield zero results.
    
    _TEST PLAN_
    
    0) Apply patch
    
    1) Create a Record Matching Rule in Koha with the following details:
        Matching rule code: TEST
        Description: Test
        Match threshold: 100
        Record type: Bibliographic
        Match point 1:
            Search index: id-other,st-urx
            Score: 100
            Tag: 024
            Subfields: a
            Normalization rule: None
    2) Create a record in Koha with an indexable URI
        2a) Default framework
        2b) 024 $a http://koha-community.org/test $2 uri
        2c) 040 $c test
        2d) 245 $a This is a test record
        2e) 942 $c Books
        2f) Save (save again if cautioned about missing fields as these should autofill)
    3) Do a full re-index of Zebra
    4) Download your record from Koha as a .mrc file (ie isomarc, binary marc, etc)
    5) Go to "Stage MARC records for import"
        5a) Upload your .marc file.
        5b) Change your "Record matching rule" to "Test"
        5c) Click Stage for import
    9) It should say "1 records with at least one match in catalog per matching rule "Test".
    
    NOTE: For completeness, you can go through this process on a clean master branch,
    and note that it will say '0 records with at least one match in catalog per matching rule "TEST"'
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8bb7769cad1d9be8c2b8b6a3412bb5f5ede171bd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 7 15:52:03 2017 -0300

    Bug 4969: Do not display the new link if we are seeing all baskets of a given vendor
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3c81b82b4b4baf930ff76cb21a041480b1404a6b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 7 15:45:57 2017 -0300

    Bug 4969: Do not jump to the top on click
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8d2d59190a4c07f3f04db8c69ec830acac7c801d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 7 15:44:57 2017 -0300

    Bug 4969: Cursor should be pointer for links
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3f7139d0864b06e5c13ca7529df657d3a2eb3329
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Fri Mar 3 01:32:54 2017 +0000

    Bug 4969: Toggle showing of all/active vendors
    
    This patch provides the functionality to hide inactive vendors from the
    vendor search.
    
    To test:
    1) Make sure at least one vendor is inactive
    2) Do a vendor search
    3) Confirm the link to show only active vendors works, and is replaced
    with a link to show all vendors when clicked
    4) Confirm the link to show all vendors works, and is replaced with a
    link to show only active vendors when clicked
    
    Sponsored-by: Catalyst IT
    
    Followed test plan, works as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 305c804ec95b4c15e12f1bae16f0f4c0b338bcb5
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 28 02:20:01 2017 +0000

    Bug 18181: Can't tell which subscriptions already have a routing list if seeing all subs attached to a biblio
    
    To test:
    1) Go to Serials -> search for a subscription
    2) Add a new routing list for a subscription
    3) After saving, you should be redirected to the subscription detail
    page
    4) Click Serial collection on the left sidebar menu
    5) Notice there is a button that says 'Edit routing list' next to this
    subscription in the first table
    6) Click 'See any subscription attached to this biblio' link
    7) Notice it no longer says edit next to this subscription, it says
    'Create routing list'
    8) Apply patch and refresh page
    9) Should now show 'Edit' button like expected
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 85f52d52e7fc77d6635321523e77a45a69081289
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 16 22:10:34 2017 +0000

    Bug 18134: Updating Preview MARC button in Batch Authority Record Mod
    
    This patch ensures the Preview MARC button when batch modifying
    authority records looks like the Preview MARC button when batch
    modifying biblio records.
    
    To test:
    1) Go to Tools -> Batch record modification
    2) Leave record type as Biblio, Put in a biblionumber, select a template
    and click Continue
    3) Notice the 'Show MARC' button
    4) Click Cancel and change record type to Authority. Put in auth id,
    select template, click Continue
    5) Notice ugly 'Preview MARC' link
    6) Apply patch and refresh page
    7) There should now be a nice 'Show MARC' button like there is for
    biblio mod. Confirm it still works as expected.
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: JMBroust <jean-manuel.broust@univ-lyon2.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 14814bc9a6986ed33da41767afcbf63084e73c9c
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Jan 19 21:54:12 2017 +0000

    Bug 17946: Show number of subscriptions on tab in OPAC record details
    
    This patch removes some duplicate code.
    
    To test:
    1) Edit at least one subscription (or add a new one) to have a record
    2) Find that record on the OPAC
    3) Confirm that the Subscriptions tab reads the correct number of
    subscriptions attached to the record
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: JMBroust <jean-manuel.broust@univ-lyon2.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5693f102204f9685fc4b33c74315b22e1536b241
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Thu Sep 1 21:10:57 2016 +0200

    Bug 17233 - Add 008 value builder plugin for MARC21 classifications
    
    This patch adds 008 cataloguing value builder for MARC21 classifications
    records (LCC, DDC/Dewey, UDC and so on).
    
    For most practical purposes, MARC21 classification records
    (<https://www.loc.gov/marc/classification/>) are quite similar to regular
    MARC21 authority records, so handling them in Koha is (almost) achievable
    by means of the built-in 'regular' MARC21 authority records related
    functionalities, but there are some notable differences - in particular,
    008 field length and format is not the same.
    
    To test:
    
    1) apply patch
    2) link the new plugin (marc21_field_008_classifications.pl) to the 008
    field in the existing (or cloned, ..) authority framework of your choice
    3) try to add, edit, re-edit 008 field using this "authority" framework,
    ensure that the new plugin behaves as it should according to the
    Library of Congress specifications for MARC21 classification records
    008 field format (<https://www.loc.gov/marc/classification/cd008.html>).
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit db467287d174827e52c322cb86d75b8628df52fe
Author: Marc Véron <veron@veron.ch>
Date:   Tue Mar 14 14:29:08 2017 +0100

    Bug 18263: Make use of syspref 'CurrencyFormat' for Account and Pay fines tables
    
    On Home > Patrons > Accounts for... and Home > Patrons > Pay fines for...,
    make the amounts display as defined in syspref 'CurrencyFormat'
    
    To test:
    - Apply patch
    - Give a patron a high fine or credit (e.g. 12345.67)
    - Got to pages Home > Patrons > Accounts for... and
      Home > Patrons > Pay fines
    - Verify that amounts display following syspref 'CurrencyFormat'
      (e.g. 12'345.67 for syspref set to 360'000.00 (CH)
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9a4fd7b27074d7ce923f7b47061d1e6636ecbc56
Author: Grace McKenzie <grace.mcky@gmail.com>
Date:   Tue Jan 17 22:45:28 2017 +0000

    Bug 17290 - Standardize on "Patron Categories"
    
    We need to standardize on terminology, this changes all instances of
    patron types to be patron categories.  To text, just view the patch
    
    Signed-off-by: Cédric Vita <cedric.vita@dracenie.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0595fee148a70110307d743b7ea696ef87a35ff6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 14 11:25:24 2017 -0300

    Bug 7143: Add Patricio Marrone to history.txt
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c6463c258f644ea5a1983680814eb765f1801283
Author: Marc Véron <veron@veron.ch>
Date:   Tue Mar 21 14:52:51 2017 +0100

    Bug 18307 - Branchname is no longer displayed in subscription tab view
    
    This patch restores the branchname in OPAC subscription detail view.
    Additionally, it adds the subscriptons count to the tab title to make
    it consistent with the other tab titles.
    
    To test:
    - Search a subscription in OPAC catalog
    - Go to Subscriptions tab (see screenshot in initial comment)
    - Verify that library name does not display
    - Apply patch
    - Verify that library name displays properly in Subscriptons tab
    - Verify that the tab title displays the subscriptions count
      e.g.: Subscriptions (2)
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f14de0007c47ae66d0276186df073c0375d37610
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 9 11:25:28 2017 -0300

    Bug 18209: Add default, 'Actions' and fix case
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bb1492e9f67439753bf428bd06fa710791e70c74
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Fri Mar 3 16:13:40 2017 -0500

    Bug 18209 - Patron's card manage.pl page is not fully translatable
    
    The headers of the tables displayed in patroncards/manage.tt are hardcoded in the .pl and thus cannot be translated.
    
    This simple fix reuse the translate_card_element tool already in the code to make the strings translatable.
    
    Applied patch and verified that table headers on manage.pl display the same as before.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Re-tested, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 67702891ae6e778836702d1976cc82566f1b344f
Author: Christopher Brannon <cbrannon@cdalibrary.org>
Date:   Tue Mar 7 22:18:49 2017 +0000

    Bug 18219: Remove extra whitespace from returns.tt
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bb5050b5038bb03da3967420fc6b9ef06eef3f83
Author: Christopher Brannon <cbrannon@cdalibrary.org>
Date:   Tue Mar 7 20:01:05 2017 +0000

    Bug 18219: Remove duplicated code in returns.tt
    
    Removed lines of code that were duplicated in bug 16530.
    Fixes alignment of a few lines of code surrounding duplication.
    
    Modifies returns.tt
    
    To test:
    1) Check in items that are not checked out.
    2) Note duplicated problem message (i.e. "Not checked out.")
    3) Apply patch.
    4) Repeat step 1.
    5) Note the problem message is no longer duplicated.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9098a4d3fa7268bf11ab108693192070c44c9eaf
Author: Christopher Brannon <cbrannon@cdalibrary.org>
Date:   Fri Mar 10 19:54:05 2017 +0000

    Bug 17346: Make checkin column hidable
    
    To test:
    1) Go to columns_settings.pl --> Circulation --> issues-table and note that you cannot change the settings for checkin.
    2) Go to columns_settings.pl --> Patrons --> issues-table and note that you cannot change the settings for checkin.
    3) Apply the patch.
    4) Go to both tables again and note that you can now change the settings.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0a0fcd31e039a01c0d7693b58a4d787109161954
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 31 13:22:37 2017 +0000

    Bug 17866 - DBRev 16.12.00.022
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5e8366d77a0c016c5b5a3e045e3e74c5a67da349
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Mar 23 10:01:53 2017 +0100

    Bug 17866: [QA Follow-up] Reword message for missing email address
    
    See BZ, comment 14 from Jonathan.
    
    In the exceptional case that branch email address and fallback, i.e.
    preference KohaAdminEmailAddress, are both empty or not valid, the error
    message should reflect that (of course :)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Removed branch email and KohaAdminEmailAddress.
    Followed the test plan of the first patch and saw the alert.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bc73b938867f95f2a2bfd2d1c5c069ab66a6ea95
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Mar 22 16:50:33 2017 +0100

    Bug 17866: [QA Follow-up] Add notification for changed sender address
    
    See BZ, comment 6, requested by QA.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a5485b65f3e797cef946a0d68419c72fb10eda84
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jan 9 15:10:56 2017 +0100

    Bug 17866: Change sender for serial claim notifications
    
    Currently, the From field uses the emailaddress of the staff client member
    from the user context. This is exceptional in Koha. And might very well be,
    as in our case, the cause of fraud detection warnings.
    We should use branch email address or fallback to KohaAdminEmailAddress,
    as we do (almost) everywhere else.
    
    Test plan:
    Go to subscription detail in Koha.
    Go to Claims.
    Select a missing issue and click Send notification.
    Verify the sender address in the generated notification. (Make sure that
    you receive this mail.)
    
    Signed-off-by: Grace McKenzie <grace.mcky@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d2ee53fb5f90277d47fc56667e71018f5d9b88a9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Mar 30 10:20:30 2017 +0200

    Bug 18019: [QA Follow-up] Also catch the delete from authorities detail
    
    Good catch from Jonathan. See comment11.
    Authorities detail should pass a CSRF token to authorities-home when
    deleting a record without linked biblios.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Passing the token with GET is not a good way to do, but nothing quick to
    replace that.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5a7dc0749f581e4c4bc6ec68d3f3ab6bac12afd5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 7 09:09:33 2017 +0100

    Bug 18019: Add CSRF protection to authorities-home.pl (op==delete)
    
    Without this patch, it is possible to delete authority records with URL
    manipulation.
    Like: /cgi-bin/koha/authorities/authorities-home.pl?op=delete&authid=[XXX]
    
    Test plan:
    [1] Go to Authorities. Search for some authorities (without links).
    [2] Delete an authority. Should work.
    [3] Apply patch.
    [4] Construct an URL like above to delete another authority. Should fail.
        Under Plack this results in an internal server error, the log tells
        you: Wrong CSRF token.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Amended the test plan.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f454013ec9beb8f6e4c382253b76bfac5ca65244
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Mar 3 14:56:31 2017 +0000

    Bug 12972 - Transfer slip and transfer message (blue box) can conflict
    
    Instead of passing the homebranch to the slip, let's pass
    TransferWaitingAt (the value we display)
    
    To test:
    1 - Check in an item that will initiate a transfer (hold or automatic
            item return)
    2 - Note the transfer message and receipt match
    3 - Remove the reason for transfer (bot don't cancel transfer)
        i.e. cancel hold or change homebranch of item to current library
    4 - Check the item in again
    5 - Note the message displays the transfer destination and the slip
    shows the homebranch
    6 - Apply patch
    7 - Repeat 5 but note slip and message match
    8 - Test any edge cases for correctness
    9 - sign off
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 53f2b56fa15fac2f0d2ef0777e95f436d6914ec7
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 17 13:24:41 2017 +0100

    Bug 7728: [QA Follow-up] Fix POD whitespace
    
    Resolves complaints from qa tools.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c26afc2568311a2b7a99f33705cbc35b715563a8
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Jan 11 14:51:43 2017 +0100

    Bug 7728: QA fixes
    
    - Remove useless comments
    - Use Koha::Objects::find instead of Koha::Objects::search
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d79a264b6991d48bda026fc0ccde0607b519423f
Author: Paul Poulain <paul.poulain@biblibre.com>
Date:   Tue Jan 26 14:03:21 2016 +0000

    Bug 7728: Adding unit test ReNewSubscription.t
    
    Test plan:
     * run without the patch, the test will fail
     * run with the patch, the test will pass
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1843ee148b25a904d8baffbbe8f0ea504b539a64
Author: Paul Poulain <paul.poulain@biblibre.com>
Date:   Wed Dec 9 10:25:43 2015 +0000

    Bug 7728: Fix subs history end date consistency
    
    Without this patch, there is an inconsistency in subscriptions:
     * a new subscription has no history end date set (as expected)
     * if you renew it, a date is set.
    
    This patch removes the setting of the history end date during renewal
    
    Test plan:
     * create a subscription, go to subscription-detail.pl page, tab "Summary". No History end date is set
     * renew the subscription => a date has been set
     * apply the patch
     * create another subscription
     * renew it => no history end date has been set
     * sign-off
    
    Signed-off-by: beroud <isabelle.beroud@univ-lyon3.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a723de2ae0c393743fc111955ee81b5e6c5b7f4a
Author: Marc Véron <veron@veron.ch>
Date:   Fri Mar 10 11:22:24 2017 +0100

    Bug 18244: Patron card creator does not take in account fields with underscore (B_address etc.)
    
    Fields with underscore like B_address do not print on patron cards.
    
    To reproduce:
    - Create patron card layout using fields with underscore in their name
      (e.g. <surname><B_address> )
    - Print (export) patron card
    - Verify that fields without underscore are replaced by their value,
      but fields with underscore do not replace but show the field name
    
    To test:
    - Apply patch
    - Try to reproduce and verify that fields with underscore are replace
      as expected
    
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b76eac9ca2c32a5db51b9b8ca32a2cf4fa6397b5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 6 10:29:44 2017 +0100

    Bug 14535: Update the supplier filter too
    
    The combobox on the left side of late orders is filled by sub
    GetBooksellersWithLateOrders. The same change as in the first patch
    must be made here to include suppliers with late orders without a
    price.
    
    Bonus: Sort the list.
    
    Test plan:
    [1] Run t/db_dependent/Bookseller.t.
    [2] Go to late orders. Use the filter on suppliers.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 71f267fd3f3750510e3df5f2819d57ed45dcf919
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 6 10:04:57 2017 +0100

    Bug 14535: Late orders does not show orders with price = 0
    
    This patch removes the filter of unitpricesupplier <> 0 and
    unitpricelib <> 0 from GetLateOrders as used in lateorders.pl.
    This allows you to claim late orders without a price entered.
    
    Test plan:
    [1] Run t/db_dependent/Acquisition.t
    [2] Check if you see an order with no price in lateorders.pl. (If needed,
        remove prices from a few orders.)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c77316db40ca94117c120c54214e0dda0f658228
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 31 12:38:21 2017 +0000

    Bug 17708 - DBRev 16.12.00.021
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8fcb7c11480cf96ffcbd2979aa1e4219337e5de5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 16:03:11 2017 -0300

    Bug 17708: Rename 'RENEW' with 'RENEWAL'
    
    Sounds more appropriate and consistent with existing action logs.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a191bcaf323f7effd66e7b46dfdcbd722ba0a647
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 15:53:26 2017 -0300

    Bug 17708: Fix use statements
    
    For an unknown reason, the use_ok('Circulation') does not work as
    intended (see 3660c451a36d).
    With the new use of C4::Log, the trick does no longer work.
    It does not make sense to add the use_ok('C4::Log') in Circulation.t,
    removing it.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4c2b8358cb4974d1b6b708e1dfe6084cf4049457
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 16:00:19 2017 -0300

    Bug 17708: Add the IGNORE clause
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 53ebb5c33b474ce507d1e7c239dbffb3d1842b1b
Author: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
Date:   Wed Feb 8 08:54:42 2017 +0000

    Bug 17708: Added a logaction function in Addrenewal in order to send renew logs
    
    20/02/17 : added the syspref RenewalLog
    24/20/17 : added a test for the syspref Renewal Log
    
    test plan
    1 - Chose a Borrower and have him renewing an item
    2 - Check the renew logs : they should be empty
    3 - Apply patch and set the syspref RenewalLog to 1
    4 - Have the Borrower renewing a new item
    5 - Check the renew logs : there should be your renew
    
    I called the function logaction, which is in charge of modifying the
    logs, within the function which adds a new renewal at the list.
    
    Signed-off-by: Julien Comte <julien.comte@u-psud.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b041dfa1800249f0179cb6839eda029026d088ca
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 14 01:36:44 2017 +0000

    Bug 8548: Add datatable to circ overdue report, remove sortby filter
    
    This patch adds a datatable to the circ overdue report. Since the
    datatable makes sorting easy, I've also removed the sort by filter on
    the side.
    
    To test:
    1) Go to Circulation -> Overdues
    2) Notice overdues report shows as datatable
    3) Confirm sorting on all columns works
    4) Test the Filters and confirm they all still work as expected
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 72de37e24bd02ffccad3cd1a76e0d74202cf7794
Author: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
Date:   Tue Dec 13 13:38:19 2016 +0100

    Bug 17758 - SIP checkin does not handle holds correctly
    
    This patch updates SIP checkin to use reserve_id as param, to fix regression
    introduced by Bug 14695.
    
    To test:
    
    Given 1 patron and 1 biblio with two items attached:
    
    1) create two record level holds on one biblio on same user
    Using SIP client or telnet:
    2) checkin item x on pickup branch, observe item is waiting and hold 1 is filled
    3) checkin item y on pickup branch, observe item y now is waiting and x is available
    4) apply this patch and repeat 1-3, now expected behaviour should be
       that both holds are filled and both items waiting
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0f32bd99997c82cf7b70eef32818dc817cbff64b
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Mar 24 16:07:16 2017 +0100

    Bug 18329 - Batch record deletion broken
    
    Hie, Tools > Batch record deletion seems broken.
    Any deletion returns error :
    Bibliographic record YYY was not deleted. An error occurred. (The error was: {UNKNOWN}: DBD::mysql::db begin_work failed: Already in a transaction at /usr/share/perl5/DBIx/Class/Storage/DBI.pm line 1560. at /home/koha/src/C4/Biblio.pm line 3468 , see the Koha log file for more information).
    
    Looks like it is because of Bug 18242 which added a transaction  in C4::Biblio::_koha_delete_biblio_metadata : $schema->txn_do.
    The script batch_delete_records created a transaction with $dbh->{AutoCommit} = 0;
    
    This patch fixes by using also Koha::Schema in batch_delete_records to manage transaction.
    It also removes "$dbh->{RaiseError} = 1", this behavior is managed in Koha::Database.
    
    Test plan :
     - Go to Staff interface : Tools > Batch record deletion
     - Enter a few existing biblionumbers
     - Click on "Continue"
     - Click on "Delete selected records"
    => Without patch you get a DB error
    => With patch you get confirmation message
     - Try to get the biblios to confirm they are deleted : /cgi-bin/koha/catalogue/detail.pl?biblionumber=xxx
     - Test with and without Plack
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 664d6534171677455f3cf1467e8726146714133a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Mar 28 16:39:25 2017 +0200

    Bug 12913: [QA Follow-up] Reword 'change item status' and add zero status
    
    The zero status should be added in @notforloans. It is a legitimate status
    for available books. The zero status description can be translated in
    the template.
    The 'Change item status' is confusing. We mean that we saw a notforloan
    status that we do not expect (read: does not exist in the table).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 358fb744c74cc63b7d2ae7d7e406ada205502ea8
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Sep 12 15:21:18 2014 +0200

    Bug 12913 - wrong inventory results when notforloan filter is not used
    
    In inventory tool, there is a test on scanned items notforloan value : if the value is not one of authorized values, the inventory results displays the problem "Change item status".
    The bug is that if notforloan filter is not used, the notforloan values array is not filled and so all scanned items are marked with this problem.
    
    Test plan :
    - Check you have in default framework an item subfield mapped with items.notforloan and with an authorized value catergory, for example 'NOTFORLOAN'
    - Check the authorized value category has at least value '0'
    - Create a new value in this category, for example '9'
    - Create a biblio with default framework
    - Create an item with barcode='000AAA1', callnumber='ZZZAAA1' and notforloan=0
    - Create an item with barcode='000AAA2', callnumber='ZZZAAA2' and notforloan=9
    - Delete new value created above, for example '9'
    - Create a file 'barecodes.txt' containing 2 lines '000AAA1' and '000AAA2'
    - Go to inventory tool : /cgi-bin/koha/tools/inventory.pl
    - Choose file in 'Barcode file'
    - Enter item callnumber between 'ZZZ' and 'ZZZZ'
    - Check 'Compare barcodes list to results'
    - Submit
    => without patch, you get 2 results with problem 'Change item status' even for item with notforloan=0
    => with patch, you get 1 result with 'Change item status' on item with notforloan=9
    
    Signed-off-by: Nick Clemens <nick@quecheelibrary.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 443b2ef4f4a8a99f3369668257be8bd7d147143e
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Tue Nov 15 10:30:16 2016 +0000

    Bug 6979 - Fix Already in a transaction error
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6ddf51573dac1e97f5bd2fc23211d22206a9aa6d
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Tue Nov 15 10:02:05 2016 +0000

    Bug 6979 - Handle multiple branches in non-auth_by_bin
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 68c365ea8ab536a85d92d3769b0bbaa0e1691116
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Tue Nov 15 09:46:52 2016 +0000

    Bug 6979 - Update tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8c3fc47338fed6c35ea21a6524d6c1a109861ebf
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Oct 5 16:47:21 2011 -0400

    Bug #6979
    
    I removed several lines of code in the checkpw_ldap subroutine where
    LDAP authentication takes place, in the "else" part of the conditional
    that checks for the auth_by_bind config parameter. I added several lines
    to check whether the user can log in to LDAP using their DN and the
    password supplied in the login form. If they are able to bind, login
    contiues as normal and the LDAP attributes can be harvested as normal if
    the update options are turned on. The routine that was in place was
    failing because it was trying to check against a non-existent LDAP entry
    attribute called 'userpassword'. Instead of checking against a
    'userpassword' attribute, the routine really should be checking to make
    sure the user can actually bind to LDAP. That's what I set up, and it is
    a safer way to test authentication against LDAP.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 767ede853bbc2d899c0b7c39ad884111d4e93902
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 31 12:12:21 2017 +0000

    Bug 17560 - DBRev 16.12.00.020
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7bbb8be387ee80359261613ebc727a77382d03fe
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 20 11:10:44 2017 -0300

    Bug 17560: Improve wordings
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Amended as per comment33 of Alex Sassmannshausen.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0509d427b9ef7358cc7d044f19c4be2039ccfced
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 10 10:59:41 2017 -0300

    Bug 17560: Improve strenght of hold existence test
    
    This patch is a QA follow-up to fix several issues:
    - 1 call to GetReserveFee was wrong in ModReserveFill
    - Update DB entry was wrong and insufficient
    - Add robustness to the tests in sco-main
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 164db2833e8fb746d50540ae286e0fef97a83a41
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Nov 6 19:41:47 2016 +0000

    Bug 17560: Add a message when a patron checking in using the self checkout
    
    Sponsored-by: Cheshire Libraries
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 20fe28d42cad0088e1d474b2d8249e3a7eec6f7b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Nov 6 18:55:22 2016 +0000

    Bug 17560: Update the wording when a patron places a hold at the OPAC
    
    Sponsored-by: Cheshire Libraries
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 91c087cebcab7b005ced31c6deb9519dad3b3abf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 3 16:12:38 2016 +0000

    Bug 17560: Hold fee placement at point of checkout
    
    Currently, Koha charges all patrons a hold fee in all circumstances, if
    a hold fee is applicable to their patron category.
    This is immediately applied at point of request.
    However, it would be useful to let patrons make requests without a
    charge
    being incurred until they physically have the item in their hands and
    checked out to their cards.
    
    The hold fee will only be added to the account  as soon as the item is
    checked out to the requesting patron.
    With this scenario, we will be certain that patrons have the correct
    item, and they are happy with what has been supplied.
    It also means that patrons can place holds via the OPAC without reaching
    the usage limit that has been selected.
    
    Test plan:
    0/ All the following steps must be done with a patron using a patron category with a hold fee
    1/ Make sure that the existing options for HoldFeeMode work as before
    2/ Select the third option "any time a hold is collected"
    3/ Place a hold on an item
    4/ Note that the patron has not been charged
    5/ Check this item from the staff interface
    6/ Note that the patron has been charged
    7/ Place another hold
    8/ Use the self checkout feature at the OPAC for the checkin
    9/ Note that the patron has been charged and a message is displayed to
    inform about the fee.
    
    Sponsored-by: Cheshire Libraries
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e5d1f6c70835f23465af0a50821888b6211db37d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 3 13:20:17 2016 +0000

    Bug 17560: Update current code
    
    This patch updates the current code to make it works with the new
    option's name of the syspref.
    It also refactor the tests to make them more reusable and robust.
    
    Sponsored-by: Cheshire Libraries
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6bdae255a919fbc7c4e8ae507190ea780a0b9860
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 3 08:16:26 2016 +0000

    Bug 17560: Add a third option to HoldFeeMode
    
    This patch adds a new 'any_time_is_collected' option to the HoldFeeMode
    syspref.
    The existing 'always' option is renamed with 'any_time_is_placed''
    
    Sponsored-by: Cheshire Libraries
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>

commit e83d92a713e2deea3081a4ff8caa0d63ea66d8c8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 3 10:45:13 2017 +0100

    Bug 17736: Fix typo ->new vs ->next
    
    while ->new is terrible, let's call that a typo...
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    opac-detail works again !
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8639a64bdb35cf9b28baceffb22cc81394dd8db2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 6 13:36:35 2017 +0100

    Bug 17736: [QA Follow-up] Script basket.pl is not Plack compliant
    
    Several warnings like:
    Variable "$confirm_pref" is not available at /usr/share/koha/masterclone/acqui/basket.pl line 507.
    
    Primarily caused by sub edi_close_and_order.
    
    Easy fix.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 14a78a8c5201ad2e4306ed0202007820e1409bb3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 6 13:22:07 2017 +0100

    Bug 17736: [QA Follow-up] We do not need GetItemHolds in acqui
    
    The solution of Jonathan can be applied in two other cases, effectively
    making GetItemHolds obsolete.
    
    Test plan:
    [1] Git grep on GetItemHolds
    [2] Add an order, place a hold, delete order.
    [3] Add an order, receive, place hold, delete order.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 703b97f22d62ac7d25981a0449196fbe5b90aec1
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 6 12:21:56 2017 +0100

    Bug 17736: [QA Follow-up] Crashes in basket.pl and parcel.pl
    
    Crash in basket.pl:
    Can't call method "holds" on an undefined value at /usr/share/koha/masterclone/acqui/basket.pl line 466.
    Comes from a biblionumber == NULL in aqorders where I cancelled the order and deleted the biblio.
    
    Crash in parcel.pl:
    Can't call method "holds" on an undefined value at /usr/share/koha/masterclone/acqui/parcel.pl line 246.
    Similar fix.
    
    Trivial fixes indeed.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e1dce7dd5b1d62671d8d59055f832fcae1a26260
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 6 12:03:27 2017 +0100

    Bug 17736: [QA Follow-up] Wrong biblionumber in acqui/parcel
    
    Trivial fix.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac30cc82492b11ab99020bd555b5e20ebb6c2a23
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 6 11:45:17 2017 +0100

    Bug 17736: [QA Follow-up] Solve warning from qa tools on Holds.t
    
    FAIL   t/db_dependent/Holds.t
    "my" variable $hold masks earlier declaration in same scope
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ecf5dcdbfad35dbdf81843274049113907620a10
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 6 11:21:10 2017 +0100

    Bug 17736: [Follow-up] Resolve inherited AUTOLOAD for non-method errors
    
    Like:
    Use of inherited AUTOLOAD for non-method Koha::Biblio::GetMarcBiblio() is deprecated at /usr/share/koha/masterclone/Koha/Biblio.pm line 60.
    Use of inherited AUTOLOAD for non-method Koha::Biblio::GetRecordValue() is deprecated at /usr/share/koha/masterclone/Koha/Biblio.pm line 60.
    
    Resolved by not importing them but fully qualifying them.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 24d6de661af1e414e8deaa1e61cff511d570d2cf
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 6 10:48:48 2017 +0100

    Bug 17736: [Follow-up] Rename to current_holds
    
    It is not about when the hold was 'placed' but if the hold pertains to
    the future or not.
    
    Test plan:
    [1] Git grep on holds_placed_before_today.
    [2] Run t/db_dependent/Koha/Biblios.t
    [3] Run t/db_dependent/Reserves.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 041a04282ae1c7e2a187760265ab639e1139cab7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 7 12:26:53 2016 +0100

    Bug 17736: Remove C4::Reserves::GetReservesFromBiblionumber
    
    At this point, there should not be any occurrences of
    GetReservesFromBiblionumber left in the codebase
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87afa5142bd12c0d5ff630dbf27d8703ca0ea131
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 7 02:29:01 2016 +0000

    Bug 17736: Replace GetReservesFromBiblionumber with Koha::Biblio->holds
    
    The C4::Reserve::GetReservesFromBiblionumber took 3 parameters, the
    biblionumber, an optional itemnumber and a "all_dates" flag.
    If set, the subroutine returned all the holds placed on a given bibliographic
    record, even the ones placed in the future. Almost all of the calls had this
    flag set, they will be replaced with a call to Koha::Biblio->holds.
    
    But 5 did not have it:
    - C4::Biblio::DelBiblio
    -tools/batch_delete_records.pl
    => These 2 were wrong, we want to retrieve the holds to cancel them
    before deleting the record. We need to get all the holds, even the ones
    placed in the future /!\ CHANGE IN THE BEHAVIOR
    
    - acqui/parcel.pl
    => 1 call per item were made to this subroutine. They have been replaced
    with only 1 call to the new method Koha::Biblios->holds_placed_before_today
    Then we filter on the itemnumbers.
    I think this is wrong: we need the number of holds to know if the record
    can be deleted, so even if future holds exist, the deletion should not
    be possible.
    
    - serials/routing-preview.pl
    - C4::ILSDI::Services::GetRecords
    - C4::SIP::ILS::Item->new
    => Seems ok, we just one to display holds placed before today
    
    Test plan:
    I would suggest to test this patch with patches from bug 17737 and bug 17738,
    to place different kind of holds (biblio and item level, future and
    past).
    Then do a whole workflow to detect bug, view a record, delete record,
    order, place a hold on an item which has been ordered, etc.
    The hold's informations should always be the same without or without
    these patches.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 42d110a774b65549241e191882f87a89fc312329
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 7 16:38:38 2016 +0100

    Bug 17736: Add the Koha::Biblio->holds_placed_before_today method
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6831dd5977086ea869516bfdce995a7cd2b921ef
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 31 11:23:43 2017 +0000

    Bug 18173 - DBRev 16.12.00.019
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3be702c1a1ab8c18e5b4a07385d2f8749b172d40
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Mar 7 14:26:51 2017 +0100

    Bug 18173: DBIx schema changes
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9236efdb5727189478f317ab4d1c61fc8556194d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 27 09:41:55 2017 +0000

    Bug 18173: Remove DB field issues.return
    
    The DB field issues.return has never really been used apparently.
    I found the first occurrence of this field in
    commit eac3a7b19a8aa7cda34aac396f5093c213a4aa5a
    CommitDate: Mon Mar 12 22:43:47 2001 +0000
        Database definition file, checked into cvs to make keeping database
        current easier
    
    Since I did not find any use of this field.
    I guess it can be removed safely.
    
    There is no proper test plan here. Just make sure this field has never
    been used.
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    I have not found any use of issues.return or old_issues.return. In
    all my live instances the column is always NULL. Issuing and returning
    seems to work as expected after the columns have been removed.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4bd8b751e396eca594606b988de1fa5dbf3fd73f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 31 09:32:53 2017 +0200

    Bug 18332: [QA Follow-up] Adjust slice call in last method
    
    We should call slice in list context with the correct indexes.
    
    Test plan:
    Run t/db_dependent/Koha/Objects.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 712e67aa7efa032c35103dc90a7243361eebe568
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 23 22:03:19 2017 -0300

    Bug 18332: Add the Koha::Objects->last method
    
    DBIx::Class does not provide such method, but it can be handy in some
    cases.
    
    Test plan:
      prove t/db_dependent/Koha/Objects.t
    should return green
    
    Test returned green.
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0fcfc561adae216d630a7b770440e7d5c315dcd2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 31 11:19:50 2017 +0000

    Bug 15498 - DBRev 16.12.00.018
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2b0b5d68de77f977e894dc69a379b1c8f4034eea
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Feb 17 08:10:43 2017 +0100

    Bug 15498: [QA Follow-up] Additional changes
    
    Adds ExportRemoveFields to sysprefs.sql
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1901af692a97a81daed2c1c6f48232ef862172ef
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 17 10:13:32 2017 +0000

    Bug 15498: Fix conflict with bug 17394
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b7735ed1281e959c3df34581e13e4276e53fd8a3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 2 10:31:43 2016 +0000

    Bug 15498: Fix show/hide csv profile list
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d4c3bbb597f19b5dbdf75227dbd67923bb832d85
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 2 08:42:11 2016 +0000

    Bug 15498: Do not display sql csv profiles
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4fc3ccf61d04f8b04e2dac0527130fe074f863e3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 6 16:36:54 2016 +0000

    Bug 15498: Add ExportCircHistory and remove ExportWithCsvProfile
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b0dc5fc0f32a26c24b6e9da91da6ab2ffda0e2c2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 2 08:28:01 2016 +0000

    Bug 15498: Let the user choose the CSV profile to export circ history
    
    The way the export options are displayed at the bottom of the checkouts table
    was not consistent.
    Prior to this patch set, they are display if ExportRemoveFields or
    ExportWithCsvProfile is set.
    It does not make any sense, the user could want to export the checkouts in
    iso2709 format without having to define a csv profile and fill the pref.
    
    Moreover the behavior of this pref did not match its description: it's used as
    a default CSV profile when exporting records from the export tools or the
    command line.
    
    This patch set adds a new pref ExportCircHistory and remove
    ExportWithCsvProfile. The new pref is set if ExportWithCsvProfile or
    ExportRemoveFields were set.
    A new dropdown list with the CSV profile list will be displayed in the
    export area, at the bottom of the checkouts table.
    
    Note that now --csv_profile_id is mandatory for the export command line
    (misc/export_records.pl) if the export format is csv.
    
    Test plan:
    0/ Do not execute the DB entry
    1/ Clear both ExportWithCsvProfile and ExportRemoveFields prefs
    2/ Execute the DB entry
    3/ ExportCircHistory should not be set and the export options should not
    be displayed at the bottom of the checkouts table.
    4/ Remove the pref
      DELETE FROM systempreferences WHERE variable='ExportCircHistory';
    and reinsert the previous one, with a value:
      INSERT INTO systempreferences (variable, value) VALUES
      ('ExportWithCsvProfile', 'something');
    Execute the DB entry again
    => The now pref should be now set
    5/ Export some checkouts using the CSV entry
    6/ Note that the export tool and commandline script still work using the
    csv format. You have to provide a --csv_profile_id option to make it
    work.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 83a7ab21f320b7f7cfe8b3b6b1ab8f6895fe8180
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Mar 29 16:10:52 2017 -0400

    Bug 17971 (QA Followup) Clarify comment
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 77b72decd41bcdcd642cb9d3f32f86611dcf1566
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 17 16:18:54 2017 +0100

    Bug 17971: Add support for objects represented by fk
    
    For instance an issue is not fetch from its fk but using the fk
    itemnumber.
    We need to support them.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3ee3cf10e61aaad8a47881fdc6cc565e74c847af
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jan 21 14:26:27 2017 +0100

    Bug 17971: TT syntax for notices - Add support for plurals
    
    On of the awesome things we will be able to do with the TT syntax is the support of plurals.
    
    For instance we will be able to send a list of items, checkouts, etc. to the notice template.
    That way we will get rid of our custom syntax like <<items.content>> or <item></item> for instance.
    
    The existing code already has the playground for that but it is not used.
    
    Basically the idea is to add a "loops" key which can contain a list of
    object to retrieve from the DB and send to the template.
    For instance:
        loops => { overdues => [ $itemnumber_1, .., $itemnumber_N ] }
    
    will send a variable "overdues" to the template. It will contain the
    Koha::Checkout objects relative to the id passed.
    
    There is one quite big inconvenient to this approach so far: since we
    are still supporting the historical syntax, the objects can be fetch by
    a script, then the script will send the id to GetPreparedLetter which
    will refetch them.
    This must be improved, but I suggest to do that later.
    
    Test plan:
      prove t/db_dependent/Letters/TemplateToolkit.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d3cb1b0ab33b7070924611fd33e3a1aa3c34aab9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jan 21 14:13:49 2017 +0100

    Bug 17970: Fix GetPreparedLetter behavior if nothing to substitute
    
    From C4::Letters::GetPreparedLetter:
    
        my $tables = $params{tables};
        my $substitute = $params{substitute};
    
        $tables || $substitute || $repeat
           or carp( "ERROR: nothing to substitute - both 'tables' and 'substitute' are empty" ),
              return;
    
    So if the parameter tables or substitute is passed but does not contain anything, it will not warn as expected.
    
    Test plan:
    1/ Apply the patch with tests
    2/ Confirm that they do not pass
    3/ Apply this patch
    4/ Confirm that the tests now pass
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 52d5519743b2108cd01fcce9b9786a3e461f8e76
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jan 21 14:13:36 2017 +0100

    Bug 17970: Add tests to highlight the problem
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 95e6f6a612013bedbb26054295b3336008466aed
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 16 14:46:12 2017 +0100

    Bug 17963: TT syntax for notices - Prove that AR_* are compatible
    
    Nothing new here since bug 17962, the AR_* notice messages are quite
    simple. They send the article_request, patron, biblio, biblioitem, item and
    library linked to the article request.
    
    All the fields from these 6 tables should still be accessible using the
    TT syntax.
    
    Test plan:
    Define TT notice templates for AR_PENDING, AR_PROCESSING, AR_COMPLETED
    or AR_CANCELED.
    
    You should manage to create a template to generate the same result as
    the historical syntax.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit afe3fa1d071aae2078cd3c52ad1b7e242ddcf3ef
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 13 18:17:13 2017 -0300

    Bug 18269: Move field mappings related code to Koha::FieldMapping[s]
    
    The 3 subroutines GetFieldMapping, SetFieldMapping and
    DeleteFieldMapping from the C4::Biblio module were only used from the
    field mappings admin page.
    They can easily replaced with new packages Koha::FieldMappings based on
    Koha::Object[s]
    
    Test plan:
    Add and delete field mappings (admin/fieldmapping.pl, Home ›
    Administration › Keyword to MARC mapping).
    Add an existing mapping > Nothing should be added
    
    Note that this page has not been rewritten and you will not get any
    feedbacks, but it's not the goal of this page to improve it.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 73c83b51c2041bd7eb3653f6395d907f4b51eff1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 14 18:10:08 2017 -0300

    Bug 18269: Add Koha::FieldMapping[s] packages
    
    Tested both patches together, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b7adcf69476a969cda6b8670e8a7e91f4c4af5b2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 31 10:18:35 2017 +0000

    Bug 14146 - DBRev 16.12.00.017
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 66d322d9199782135895e7478b515c5c0eb8b9a9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 12 16:03:01 2016 +0100

    Bug 14146: Add the new pref CumulativeRestrictionPeriods
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 66584e46bd183aa0a2eeaf6e66d62f3d43461539
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 12 16:04:07 2016 +0100

    Bug 14146: Clean a bit and make the code understandable
    
    The code was a bit weird and this patch cleans it a bit by renaming
    variables and adding a variable.
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d09096abaeca2e484839a4ba2cfcb31d603f23dc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 30 19:33:44 2016 +0000

    Bug 14146: Add the ability to cumulate restriction periods
    
    At the moment the default behaviour is not to cumulate the restriction
    periods but to apply the longest one.
    This patch set creates a new syspref CumulativeRestrictionPeriods. If
    on, the behaviour changes and the restriction periods are cumulated: the
    days of the second restriction are added to the actual restriction
    period.
    
    We could add a new circulation rule instead of a syspref, but I am not
    sure it's very useful to have such granularity for this behaviour (can
    be changed if needed).
    
    How it works:
    Let's take 2 items, A and B.
    A is returned with Na days late, and B Nb days late
    The grace period is Ng and there is 1 day of suspension charge per day
    of overdue
    The suspension period is until day D = Na - Ng + Nb - Ng
    
    I would have expected D = Na + Nb - Ng but it's how it worked before
    this patch.
    
    Test plan:
    Create several overdue for a given patron
    Do the checkins and confirm that the period are added if the pref is on.
    If the pref is off, you should not get any changes in the existing behaviour.
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7a5709906bd53a44500e71ce169c67244e6e2e3f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 12 16:04:42 2016 +0100

    Bug 14146: Add tests for AddReturn + CumulativeRestrictionPeriods
    
    Sponsored-by: Orex Digital
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c8c52ba72e90656304e85f2958f3f6f5ff0f3487
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 4 15:41:22 2017 +0100

    Bug 17847: Remove C4::Koha::GetAuthvalueDropbox
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7dad38e88f9440ca42ec95fc0daf26521e3a5f28
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 4 13:43:27 2017 +0100

    Bug 17847: Replace C4::Koha::GetAuthvalueDropbox with Koha::AuthorisedValues
    
    The C4::Koha::GetAuthvalueDropbox subroutine does the same job as
    Koha::AuthorisedValues->search
    We should then replace the different calls to this subroutine to finally
    remove it.
    There were 2 calls to this subroutine:
    - from the AuthorisedValues TT plugin (called from av-build-dropbox.inc
    and members/housebound.tt)
    - from the acqui/ajax-getauthvaluedropbox.pl ajax script
    
    To make sure that this patchset does not introduce regressions, we will have
    to test that the TT plugin and the ajax script still behave as before.
    
    Test plan:
    1/ Test acqui/ajax-getauthvaluedropbox.pl
    - Link a fund to an authorised value category
    - Create a new order
    => When you select a fund linked to AV category, the sort1 (and/or
    sort2, depending on what you set) should be replaced with a dropdown
    list populated with the authorised values
    2/ Test av-build-dropbox.inc
    - Create some authorised values for Bsort1
    - Edit a patron
    => The sort1 should be a dropdown list populated with the Bsort1 AV
    3/ Test members/housebound.tt
    - Enable the housebound module (pref HouseboundModule)
    - On the patron detail page, click on the "Housebound" tab
    => The frequency dropdown list should be populated with the different
    HSBND_FREQ AV
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d420e6ae210294884430d294e6cd97e4cc179fa8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 4 11:38:34 2017 +0100

    Bug 17844: Replace C4::Koha::get_notforloan_label_of with Koha::AuthorisedValues
    
    This patch is more a bugfix than a refactoring.
    Indeed the C4::Koha::get_notforloan_label_of behaviors were buggy:
    1/ It does not display the opac description at the OPAC, but always the
    staff description
    2/ It does not care of the framework of the biblio, but retrieve the
    first row of the marc_subfield_structure mapped with items.notforloan
    
    These 2 bugs can easily be fixed using the
    Koha::AuthorisedValues->search_by_koha_field
    
    Steps to recreate the issues:
    - Create 2 authorised value categories for not for loan (NFL1 and NFL2)
    with the same values. Define a different description for the OPAC.
    - Define link 952$7 to NFL1 for the default framework and to NFL2 for
    the BK framework
    - Create 2 bibliographic records (B1 using NFL1 and B2 using NFL2) with
    2 items each (1 item should have a not for loan value)
    - Go to the "Place a hold" view for this record.
    - In the item list, you should see the not for loan value
    => The staff description of NFL1 will always be used, even for the OPAC
    
    Test plan:
    - Recreate the issues without this patchset
    - Apply this patchset
    - Recreate the steps to recreate the issues
    => The staff description of NFL2 should be displayed for the B2 item
    => The opac description of NFL2 should be displayed for the B2 item at
    the OPAC
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4cc79c77c904e9a8e5ff35ca872b7673b3c005c9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 4 11:53:33 2017 +0100

    Bug 17844: Remove C4::Koha::get_notforloan_label_of
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6a6a71b9d8145fe11e4a01260b50a86b1e2b5c42
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Mar 29 14:50:22 2017 -0300

    Bug 18258: (QA followup) Use Koha::Subscriptions
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5651755e68a7c41d1646fa06e1d96b7bf32de5da
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 13 15:27:06 2017 -0300

    Bug 18258: Add the Koha::Biblio->subscriptions method
    
    Test plan:
      prove t/db_dependent/Koha/Biblios.t
    should return green
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ff4958c80656fcca5c31cb291cef2c3866c86b23
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 15 09:30:19 2017 -0300

    Bug 18270: Do not fetch the MARC record when deleting an item
    
    $record is never used later, the call is superfluous.
    
    Test plan:
    Quick glance at the code should be enough
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dd88c8f710e4915dac6437355c356f0632b776fb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 14 14:39:48 2017 +0000

    Bug 18058: Allow borrower_message_preferences to be truncated
    
    borrower_message_preferences cannot be truncated because of the foreign.
    DBMS fails with
      "Cannot truncate a table referenced in a foreign key constraint"
    
    To avoid that we should remove the FK check and truncate the other table
    as well.
    
    I am wondering if we really need a truncate here
      DELETE FROM borrower_message_preferences;
    should do the job, but leave it as it because of the param name.
    
    Test plan
      perl misc/maintenance/borrowers-force-messaging-defaults --doit --truncate
    Should no longer raise the error message
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ead7d86842d76e4619ebf7a4d9fa28998bad3442
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 12:24:28 2017 -0300

    Bug 18266: Fix internal error when paying fine for lost item without.. item
    
    If a fine is created for a lost item but the itemnumber is not supplied,
    the system will return it.
    The item should not be mark as returned if there is no item linked to
    the fine.
    
    Test plan:
    1. Turn StoreLastBorrower on
    2. Create a manual invoice for a lost item, do not supply a barcode
    3. Pay the fines 'Pay fines > Pay'
    
    => Without this patch applied you get
    Can't call method "last_returned_by" on an undefined value at
    /home/marc/koha/C4/Circulation.pm line 2188.
    
    => With this patch applied, you must not get the error.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 574d48362d32c14920712ae35bdd28101785315c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 15 17:14:13 2017 +0100

    Bug 18124: Change the calls to generate and check CSRF tokens
    
    The parameter change in Koha::Token should be applied to the calling
    scripts.
    
    Test plan:
    Confirm that the different forms of the scripts modified by this patch
    still work correctly.
    
    Test the problematic behavior:
    Open 2 tabs with in same user's session, go on the edit patron page
    (memberentry.pl).
    Log out and log in from the other tab.
    Submit the form
    => Wrong CSRF token should be raised
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7190593d9dd38001c2d101bcad5cddc222a45ebe
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 16 11:59:12 2017 +0100

    Bug 18124: [Follow-up] Handle default parameters in a sub
    
    Adds a internal routine to handle default values for the parameters
    id and secret.
    Also adds a parameter session_id for generate_csrf and check_csrf. This
    session parameter is combined with the id parameter when generating or
    checking a token.
    
    Test plan:
    Run t/Token.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3562816dd1b8855c7973ce5650ff834407c1a548
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 15 17:14:13 2017 +0100

    Bug 18124: Restrict CSRF token to user's session
    
    Currently the CSRF token generated is based on the borrowernumber, and
    is valid across user's session.
    We need to restrict the CSRF token to the current session.
    
    With this patch the CSRF token is generated concatenating the id
    (borrowernumber) and the CGISESSID cookie.
    
    Test plan:
    Run t/Token.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8dad1582c100017f8ad3e331c9a9b9cc9ed4e4d6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 10:52:42 2017 -0300

    Bug 18312: Fix export unless a file is supplied
    
    Bug 18087 breaks export unless a file is supplied.
    
    Can't use an undefined value as a HASH reference at
    /home/vagrant/kohaclone/tools/export.pl line 75.
    
    Test plan:
    Export records using a file of id that is not a valid file (not txt or
    csv)
    Export records using a valid file
    Export records without supplying a file
    
    => The export should work or fail as expected.
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1a53b49980e913c55c6f2021d21b6aa99ac8cefd
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon Feb 20 01:37:49 2017 -0500

    Bug 18144: Restore pieces of C4/Auth to make Google OpenID Connect work
    
    By restoring some pieces of logic, with the name changed from $persona
    to $emailaddress, the openid will work again for OPAC logins.
    
    See https://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=10988#c68
    for an excellent test plan.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Did not test it, but trust in author and signoffer
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3db855b872ccbf133e238ddc537b6f0b818c931e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 24 18:49:15 2017 +0000

    Bug 13757 - DBRev 16.12.00.016
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e06c1931872f2a54e2a12cf2b8468480e613ce5c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Mar 22 18:51:48 2017 -0300

    Bug 13757: (QA followup) Filter out non-editable params before storing
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ec9ac4d7b9873dd99b92212564b698dc6bf904b1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Mar 22 16:22:53 2017 -0300

    Bug 13757: (QA followup) Exclude empty attributes from rendering if non-editable
    
    In self registration opac displayable (and not editable) attributes are
    displayed as empty. This an empty value is passed to the template for
    creating an empty input and it shouldn't when the attribute is not
    editable.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3ce090781970c869d6d4c78f9e0eb4eb3e0d8ad2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Feb 16 16:02:48 2017 -0300

    Bug 13757: Attribute with value 0 should be stored
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ebe44fc7febfa248842bf1f50ccb1c961f31259b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Feb 16 16:02:22 2017 -0300

    Bug 13757: (regression test) Attribute with value 0 should be stored
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit afb7b7dc2df5e2c0f7ebb4ed75777fef4a5ab12a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Feb 3 15:22:57 2017 -0300

    Bug 13757: Better display for attr changes in members-update.pl
    
    This patch changes the way changed attributes are displayed for the
    staff user to make the decision to approve (or not) the changes.
    
    Regards
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f9a5fd005efa2567be99f9eb2f44e5e79641f74c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Feb 3 15:22:37 2017 -0300

    Bug 13757: Make K::P::Modifications->pending return K::P::Attribute
    
    This patch makes Koha::Patron::Modifications->pending return
    Koha::Patron:Attribute objects. They are not stored on the DB but only
    live in memory on runtime.
    
    members-update.pl is the only place this is used, and this way we have
    all we need for better rendering the UI.
    
    Tests are added for the changed API.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e63e4bb35a67a2beed52139b2f149623526d5e23
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Feb 2 10:14:25 2017 -0300

    Bug 13757: (QA followup) Fix non-editable attrs on failed save
    
    When a field is not editable but displayable in the OPAC, and you submit
    an incomplete/wrong update, those attributes are displayed as empty.
    
    This patch fixes that.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c44a377d9cc44538b6a7134f48763184c9a110ba
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 30 12:36:57 2017 -0300

    Bug 13757: (QA followup) Make opac-memberentry.pl handle attrs deletion
    
    The original code on this bug skipped empty-valued attributes. But
    emptying attributes is the only way to tell the controller script that
    the user wants to delete them.
    
    This patch makes opac-memberentry.pl check the existence of attributes
    sharing the code of the empty for the given patron, and it stores the
    deletion on the Koha::Patron::Modification as needed. Otherwise
    deletions got skipped.
    
    To test:
    - Verify setting/deleting attributes that are opac-editable and verify
    the results are sound.
    
    https://bugs.koha-community.org/show_bug.cgi?id=13737
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b6797fdc8708e73eee0cfd7562e55543ed4f5e3b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 31 12:41:51 2017 -0300

    Bug 13757: Make Koha::Patron::Modification->store del empty attrs
    
    This patch makes Koha::Patron::Modification->store delete the passed
    attributes that contain empty values.
    
    This is the way it currently works, as all opac-editable attributes are
    presented to the end-user and they are allowed to delete them, and the
    best way I found to represent the deletion on the modification request
    is by setting it to the empty string. I chose this way because it is how
    the staff interface handles it, so it is consistent.
    
    To test:
    - Apply this patch
    - Run:
      $ prove t/db_dependent/Koha/Patron/Modifications.t
    => SUCCESS: This time tests pass!
    - Verify comment #70 on the bug is fixed now
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    https://bugs.koha-community.org/show_bug.cgi?id=13737
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bb039e0328e0151b78c752e7a7be2c6a1c4f7d3a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 31 12:39:53 2017 -0300

    Bug 13757: (regression tests) Empty attributes should delete existing
    
    This patch introduces tests for the required functionality.
    
    To test:
    - Run:
      $ prove t/db_dependent/Koha/Patron/Modifications.t
    => FAIL: The current code doesn't work like that
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    https://bugs.koha-community.org/show_bug.cgi?id=13737
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2811d8555d5dc409b8a358795d3f188c87fa950b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jan 20 10:59:27 2017 -0300

    Bug 13757: (QA followup) Check DB structure before altering table
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0fbc8620e2180f67270403d4c3a81d7334b3f62e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 3 17:19:30 2017 -0300

    Bug 13757: (followup) Fix authorized value display when opac_display & not opac_editable
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dc6702e3cd9aa17b41880975823305f5d5aa553c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 23 16:56:06 2016 -0300

    Bug 13757: (followup) Regression tests for ->approve changes
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c8889f0ff7cfb83422f0136faaf1be9cdec5515c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 23 16:19:06 2016 -0300

    Bug 13757: (followup) Only touch opac_editable attributes
    
    As reported by Owen, the members-update.pl was showing every attributes
    the patron has (display issue) instead of showing only those affected by
    the changes.
    
    This patch fixes this by filtering the patron's attributes by opac
    editability.
    
    It also fixes Koha::Patron::Modification->approve so it only clears the
    attributes with the updating 'code' and leaves the others untouched.
    As its been coded so far (until someone refactors it all) the
    Koha::Patron::Modification object needs to contain all the attributes
    for a specific code. And it comes from parsing the UI's input.
    
    Tests for Koha::Patron::Modification->approve to come.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 925e664f42ff9546624946258fe27263e6041fa3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 19 16:22:17 2016 -0300

    Bug 13757: (followup) Staff interface changes
    
    This patch adds proper extended attributes display and handling on the
    patron modifications moderation page (members-update.pl).
    
    It also adds changes checking to the opac-memberentry.pl page so it
    only saves a modification request if there are changes (it only checked
    regular fields and not the extended ones).
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bfa3f410320e6baad98f277a6cfd9b41a4d68dac
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 19 12:52:27 2016 -0300

    Bug 13757: (followup) Remove warnings
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01506e0195266a0e6b6005c43b9763bf4a09dd78
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 19 12:51:04 2016 -0300

    Bug 13757: Add extended attributes to the patron modification
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2eda977de72434643863301726c5aa9f51be7b36
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Oct 27 11:52:20 2016 -0300

    Bug 13757: DBIC update
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0a40e0c60ff2ac405960cfd34033dd3d5896ac08
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Wed Dec 14 12:30:10 2016 -0300

    Bug 13757: OPAC changes
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1fa5660dbcd015b20cd3059dfdba11c0b4f345bd
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Wed Dec 14 12:29:10 2016 -0300

    Bug 13757: DB update
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 21e496bd7bcf3cd3f8826410384005e0cabc17d4
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Wed Sep 2 17:54:04 2015 -0600

    Bug 13757: Add the option to set patron attributes editable in the OPAC
    
    Note: this is a squashed version of the original patchset, because it was needed
    
    This patch adds an opac_editable property of borrower attribute types
    that can be set in the interface. I'm removing work on OPAC and will
    refactor it, keeping the author attribution.
    
    Test plan:
      1. Repeat the following with a new and existing borrower attribute
         type:
      2. Verify that "Editable in OPAC" can only be checked if "Display in
         OPAC" is checked.
      3. Verify that this new property is correctly saved.
    
    Signed-off-by: Aleisha <aleishaamohia@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7b5c8cbf079725381341cea5494717d58735ca9b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 23 12:05:35 2016 -0300

    Bug 17792: Add opac_editable and opac_display methods
    
    This patch adds two methods to the Koha::Patron::Attribute:
    
    - opac_display
    - opac_editable
    
    Both method just check the corresponding Koha::Patron::Attribute::Type
    and return the values for those attributes. This is useful to avoid
    checking that manually on the controller scripts.
    
    To test:
    - Run:
      $ prove t/db_dependent/Koha/Patron/Attributes.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9812c8b26e9886f0a7a79bbcefba1ac91ec7ed79
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Dec 21 12:53:07 2016 -0300

    Bug 17792: Introduce Koha::Patron::Attribute(s)
    
    This patch introduces stub Koha::Object(s) for handling patron attributes.
    
    Edit: amended the POD to fix C&p mistake
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 382d086ecdb220f882382bbb58b0121d0604d684
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 10 12:32:06 2017 -0300

    Bug 17755: (followup) Override ->search to allow filtering by branchcode
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3f2ade46ace082e69cb9f40f7cf241853e1897f8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 19 15:09:15 2017 -0300

    Bug 17755: (QA followup) Return $self when appropriate
    
    As failure situations raise exceptions that should be handled outside
    the object class, methods should return $self so successive calls can be
    chained nicely.
    
    This patch makes methods return $self and adjusts the tests to reflect
    this change.
    
    Make sure tests pass:
    - Run:
      $ prove t/db_dependent/Koha/Patron/Attribute/Types.t
    => SUCCESS: Tests return green
    - Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a39fbd78e61d62b680f7e592effc903e344a928f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 31 15:09:43 2016 -0300

    Bug 17755: Introduce Koha::Patron::Attribute::Type(s)
    
    This patch introduces the Koha::Object-based classes for handling
    patron attribute types.
    
    It also adds branch limitation handling to the
    Koha::Patron::Attribute::Type class.
    
    It is built on top of the new Koha::Object::Library::Limit class
    that extends Koha::Object so it handles library limits.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62249ff5734819a148bff267855b570387ea231a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 12 11:15:45 2016 -0300

    Bug 17755: Unit tests
    
    This patch introduces unit tests for Koha::Object::Library::Limit. It is
    done this way because it needs to be instantiated to be usable.
    
    To test:
    - Run:
      $ prove t/db_dependent/Koha/Patron/Attribute/Types.t
    => SUCCESS: Tests pass
    - Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bd01041ac6985656ca1bf1f2a6b9d565e98bd61d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 12 14:17:44 2016 -0300

    Bug 17755: Introduce Koha::Object::Limit::Library
    
    This patch introduces a new class for extending Koha::Object using
    multiple inheritance. It cannot be used standalone, it needs to be
    used in Koha::Object implementations like this:
    
    use base qw( Koha::Object Koha::Object::Limit::Library );
    
    Its goal is to provide a single way and place to deal with this common
    pattern in Koha's codebase.
    
    As it happened with Koha::Object, that needed to be tested in a real object
    class, this work was done on top of Koha::Patron::Attribute::Type implementation
    and it is fully covered by the tests that are introduced for it.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9c347a7f3571b36b8c3415e41cf567fa76f0ad56
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 23 13:32:34 2017 -0300

    Bug 18066: Update Schema
    
    This patch basically reverts 85a21dd9715518746dd93defd4803a81d23a5b18

commit 64812347c9536340484f17758c6881ca882987d6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 23 13:31:24 2017 -0300

    Bug 18066: Add the new geolocation column to kohastructure.sql

commit 6fe4de7f5c093d077cf5192d7405d7da1ac2c0d2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 23 13:14:59 2017 -0300

    Fix updatedatabase.pl syntax error

commit be156d9ad9e5bcfadab34d44f90e04fd61e256ad
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 9 12:44:38 2017 +0100

    Bug 15854: Use a READ and WRITE LOCK on message_queue
    
    To make sure we will not never get a race conditions for these kinds of
    notices, we need to add a LOCK on the message_queue table.
    
    This does not smell the best way to do that, but I faced deadlock issues
    when I tried to use "UPDATE FOR"
    
    https://dev.mysql.com/doc/refman/5.7/en/innodb-locking-reads.html
    https://dev.mysql.com/doc/refman/5.7/en/lock-tables.html
    https://dev.mysql.com/doc/refman/5.7/en/commit.html
    
    To test this patch, or another solution, you need to apply manually this
    change:
    
             my $message = C4::Message->find_last_message($borrower, $type, $mtt);
             unless ( $message ) {
    +            sleep(1);
                 C4::Message->enqueue($letter, $borrower, $mtt);
             } else {
    
    And repeat the test plan from first patch.
    Do not forget to truncate the message_queue table.
    
    Followed test plans, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 607b14516a955c9989e4764c69527edbc1f36ba0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 9 12:13:07 2017 +0100

    Bug 15854: Simplify the code to limit race conditions
    
    There is an obvious race condition when CHECKIN and RENEWAL are
    generated from circulation.pl calling svc/renew or svc/checkin in AJAX.
    
    The 2 first queries will try to get the id of the last message
    (find_last_message) and if it does not exist, they will insert it.
    Theorically that could be lead to have several "digest" messages for a
    given patron.
    I did not recreate more than 2 messages, from the third one at least one
    of the two firsts existed in the DB already.
    
    This patch just simplifies the code to make the SELECT and INSERT or
    UPDATE closer and limit the race condition possibilities.
    
    Test plan:
    0. Set RenewalSendNotice and circ rules to have a lot of renewals available
    1. Use batch checkouts (or one by one) to check out several items to a
    patron
    2. Empty message_queue (at least of this patron)
    3. Renew them all at once ("select all" link, "renew or check in"
    button)
    4. Check the message_queue
    Without this patch you have lot of chances to faced a race condition and
    get at least 2 messages for the same patron. This is not expected, we
    expect 1 digest with all the messages.
    With this patch apply you have lot of chances not to face it, but it's
    not 100% safe as we do not use a mechanism to lock the table at the DBMS
    level.
    
    Tested both patches together, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 30d24fe6fc2021df37b0744b9b6270471e29c25a
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Wed Nov 9 14:37:33 2016 +0000

    Bug 17605: [MASTER] Add currency to orders generated by quotes
    
    Sets the vendors currency in the edi generated order
    The currency used is agreed between vendor and library
    and the value in the quote is optional
    
    Edifact potentially allows the currency to be overwitten
    by specifying another currency in the CUX segment but
    we know currently of no supplier doing this
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 85a21dd9715518746dd93defd4803a81d23a5b18
Author: Brendan Gallagher <brendan@bywatersolutions.com>
Date:   Thu Mar 23 00:39:22 2017 +0000

    Updating the Schema
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 3b794b1312d0cfac81b302d0e823e2c5683a1f0e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jan 25 17:00:34 2017 +0000

    Bug 17995 - HOLDPLACED notice should have access to the reserves table
    
    To test:
    1 - Add reserves.reservenotes to HOLDPLACED message
    2 - Enable emailLibrarianWhenHoldIsPlaced OpacHoldNotes sysprefs
    3 - Place a hold via OPAC with a note
    4 - view the messagequeue and note the reservenotes is blank
    5 - Apply patch
    6 - Place a hold with a note
    7 - view the messagequeue and note the reservenotes is populated
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit fbbd4b40f0d71b79194fc186e66f985488be26c6
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Sun Jan 29 15:40:14 2017 +0100

    Bug 18010: Remove potential exposure from gettemplate
    
    A similar bad template check from C4::Auth::get_template_and_user
    should be applied in C4::Templates::gettemplate.
    
    Before this patch it would be possible to expose files like:
    my $template = C4::Templates::gettemplate(
        '/etc/passwd', 'intranet', CGI::new, 1
    );
    print $template->output;
    
    Note that the is_plugin flag in the above call is the culprit. This patch
    provides a quick security fix without touching get_template_and_user, and
    can be backported to stable branches.
    I will provide an enhanced and centralized check on report 17989, also
    removing the is_plugin flag.
    
    Note: We allow .pref here too for use in admin/preferences.pl.
    
    Test plan:
    [1] Run t/db_dependent/Auth.t (triggering get_template_and_user and
        gettemplate).
    [2] Run t/db_dependent/Templates.t again (see first test plan).
        The tests should no longer fail.
    [3] Open a page on opac or intranet.
    [4] Open a systempreferences tab.
    [5] Add a book to the cart and send it ([opac-]sendbasket uses gettemplate).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 5508897d5a2b73c30d50fed26a6bfed62bf49398
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Sun Jan 29 15:52:22 2017 +0100

    Bug 18010: Unit test for gettemplate
    
    A trivial test, similar to the ones in Auth.t.
    Without the check in gettemplate (added in the second patch), the passwd
    file will be exposed and the test fails.
    
    Test plan:
    Run t/db_dependent/Templates.t without second patch. The two tests in the
    last subtest should fail.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit a6f50cbcb92c2575eb31e906ea54bf0386654906
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 1 12:42:43 2017 +0100

    Bug 18028: Remove outdated install_misc directory
    
    This directory is no longer maintained and contain outdated information
    on how to install Koha.
    On the Internet there are tutos using them and that can create confusion
    to new user (yes it could be confusing as well to execute a file that
    does no longer exist).
    
    NOTE: last tweak was mid 2016, but before that 2015. So I agree with
          the deletion.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit eee0020f4a1eaea3acf5fd53ea0a3d2e98b3ba35
Author: Brendan Gallagher <brendan@bywatersolutions.com>
Date:   Thu Mar 23 00:18:10 2017 +0000

    DBREV for Bug 18066 - Hea - Version 2
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit c3db243ad459782362c7051a648730bc51fda83d
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Tue Mar 21 12:01:45 2017 +0100

    Bug 18066: Fix map positioning in admin/usage_statistics.pl
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 7aff8696614604960b7244fac798a28c4438fc36
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 21 07:21:38 2017 -0300

    Bug 18066: Fix tests
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit c302fd2bea710c960db7bc14aeac762c865f677a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 28 17:13:07 2017 +0000

    Bug 18066: Use https for ws
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 0d479976af81df3a66024e4ffc18ecc2038c0103
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 28 11:16:56 2017 +0000

    Bug 18066: Do not use token for OSM tiles
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit f3c4c7016128e6550230cd44f8efedf0374db25e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 7 09:31:28 2017 +0100

    Bug 18066: Add the leaflet library
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 63a1adff9097493be0329aebab5fb3bf8a627b80
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 2 16:53:58 2017 +0100

    Bug 18066: Hea V2
    
    This patch is the Koha part of the Hea v2 project.
    You can find the (testing) code for the server at
      hea-ws  - https://github.com/joubu/hea-ws/commits/v2
      hea-app - https://github.com/joubu/hea-app/commits/v2
    They contain the different pull requests made over the last 6 months.
    
    More information on Hea at https://wiki.koha-community.org/wiki/KohaUsageStat_RFC
    The goal of this commit message is to provide an overview of what could
    be a new version of Hea.
    
    Prior to these changes, the Hea database was filled with 1 line per Koha
    installation. System preferences were filled by the libraries and a
    cronjob (share_usage_with_koha_community.pl) collected these values to send
    them to a webservice (hea-ws/upload.pl).
    
    With the need to collect more data we would want to collect data at the library
    level (branch) and not at the installation level.
    For instance the geolocation, the url or the country can be different from one
    library to another, even if managed from the same Koha installation.
    The Hea DB has been upgraded to reflect that change (see hea-app/sql/schema.sql).
    
    The hidden goal of this patch is to make Hea sexier and explain
    better to libraries how it can be useful to share their information
    with the Koha community. I guess the main problem is the lack of
    communication and explanations about what we are doing we these data.
    To fill this gap I'd like to (TODO)
      1. Communicate on the ML about this new version of Hea (once it got
    pushed and backported)
      2. Link the Privacy_Policy.md from the Hea interface
      3. Get help from a native English speaker to add
    popup/help/info/whatever on "Home › Administration › Usage statistics",
    to clearly explain what happens (and what will not happen!) when an option or
    another is set.
    
    You can find screenshot of this whole enhancement on bug 18066, comment 2.
    
    What this patch does:
    - Create a new branches.geolocation DB field
    - Add 3 new sysprefs:
      * UsageStatsGeolocation
      * UsageStatsLibrariesInfo
      * UsageStatsPublicID
    - Integrate the Leaflet JS library to get a fancy map to pick
    geolocations
    
    How does it works:
    On the new administration page where statistics to share are configured,
    there are several new things. It is now possible to share information either
    per Koha installation or libraries. If UsageStatsLibrariesInfo is set,
    the info at library level (url, name, country, geolocation) will be
    sent to the Hea webservice. If it is not set, you can decide to fill
    UsageStatsLibraryUrl, UsageStatsLibraryName, UsageStatsCountry,
    UsageStatsGeolocation to share these information. Note that even if the
    data are retrieved at installation level, it's better to fill the prefs
    as well: On the Hea website the different libraries defined for a given
    Koha installation could be displayed on the same page.
    This page is a public page which will be attributed to every
    installation (with the pref UsageStatsPublicID). On this page all the
    info available publicly will be displayed.
    
    TODO later:
    - Add a button on the administration page to delete the info shared
    publicly. It will be easy to show that the info are no longer displayed
    on the public page.
    - Add an icon per Koha installation to get a better "public page"
    - Any suggestions?
    
    Test plan:
    We will need to test hea-ws, hea-app and the Koha-side code to test the
    whole enhancement.
    1/ To start, clone the hea-ws and hea-app project and checkout the
    'master' branch (*not* 'v2')
    2/ Create the hea database and user
      CREATE DATABASE hea
      CREATE USER 'hea'@'localhost' IDENTIFIED BY 'hea';
      GRANT ALL PRIVILEGES ON hea.* TO 'hea'@'localhost';
      FLUSH PRIVILEGES;
    3/ Fill the DB with some data
      mysql hea < hea-app/sql/schema.sql
      mysql hea < hea-app/sql/sql/mock-data.sql
    4/ Checkout the 'v2' branch for both hea-ws and hea-app
    5/ Execute the upgrade DB script
      % cd hea-app
      % perl -p -i -e 's/REPLACE_ME/hea/' sql/upgrade.pl # Fill the DB info
      % perl sql/upgrade.pl
    Now the DB is using the v2 structure. That means we have 1 installation
    row per library previously defined. 1 library row has also been created.
    5/ Configure hea-ws
    % echo '192.168.50.1 hea.koha-community.org' >> /etc/hosts
    <VirtualHost *:80>
      DocumentRoot "/path/to/hea-ws"
      ServerName "hea.koha-community.org"
      <Directory "/">
        Options +ExecCGI
        Require all granted
        AddHandler cgi-script .pl
      </Directory>
    </VirtualHost>
    
    And enable it with a2ensite, then restart apache.
    The copy the database.yml.sample to database.yml and edit it to fill the
    DB info.
    
    6/ Launch the hea-app
      % cd hea-app
      % edit README.md # to install the missing modules
      % cp environments/config.yml environments/development.yml
      % edit environments/development.yml # to fill the DB info
      % perl bin/app.pl
    Then hit localhost:3000
    You should see a local version of Hea with sample data
    
    7/ Back to Koha side
    A. We will test that the webservice still works with previous version of Koha (without v2)
    a. Do not configure Hea
      % perl misc/cronjobs/share_usage_with_koha_community.pl -f -v
    Then hit localhost:3000
    => Nothing added
    b. Configure Hea on admin/usage_statistics.pl
    perl misc/cronjobs/share_usage_with_koha_community.pl -f -v
    => New library added
    c. Modify the Hea configuration
    perl misc/cronjobs/share_usage_with_koha_community.pl -f -v
    => Info are modified
    
    B. Not we will test that it works with the new version (much more fun ;))
    % git checkout hea-v2 # koha
    a. Configure Hea using /admin/usage_statistics.pl
    perl misc/cronjobs/share_usage_with_koha_community.pl -f -v
    => Check the result on localhost:3000
    b. Share libraries's info
    perl misc/cronjobs/share_usage_with_koha_community.pl -f -v
    c. Continue to play a bit and share the info.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 6b626b64944dff0ba0adff99da26e3bbe8eb7544
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Mar 12 19:54:58 2017 -0300

    Bug 14608: Move country list to an include file
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit ffbeae312bb472a58adf33e13b8c3d5f9124f0af
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Jan 13 13:33:05 2017 -0500

    Bug 14608: Follow up on labels and search box
    
    This addresses concerns raised in comment #26 and comment #27.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 384b69462e6005e316680b88de304095a39a318b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 22:31:41 2016 +0000

    Bug 14608: Add a reference to Hea at the end of the installer process
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 601312c6c80e82837869b4eb2c91686c6a1361b3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 22:31:25 2016 +0000

    Bug 14608: Add a link from the admin home page
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 3d46c0c7bb8ce487f85cd0d0233cb7ceffcbbde3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 22:29:53 2016 +0000

    Bug 14608: Add a page to configure shared statistics
    
    This patch set adds:
    - a reference to Hea at the end of the installation process
    - a link to the new page from the admin home page
    - a new page to easily configure shared statistics
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 01a8d633dfab80e6d146de17d9c27a84a1a06cc8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Mar 23 13:33:59 2017 +0000

    Update DB Schema
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 39f3ed3f10bf902354527d10896fa19c37e2f492
Author: Brendan Gallagher <brendan@bywatersolutions.com>
Date:   Wed Mar 22 22:16:10 2017 +0000

    DBREV for Bug 8010 - Search history can be added to the wrong patron
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit fe898bc641b6d76d7b869654dce4ec21e219daf8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 7 09:10:42 2017 +0100

    Bug 18069: Remove residue of rebuild_zebra -x
    
    Bug 17731 removed the -x option of rebuild_zebra but koha-rebuild-zebra
    still cals the script with this option.
    
    "Warning: You passed -x which is already the default and is now deprecated"
    
    Test plan:
    sudo koha-rebuild-zebra -f
    should no longer raise the warning
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 5823d4ca6a71404d502eeb7f1bf5dd152fd98e22
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 14 15:22:40 2017 +0000

    Bug 18094: Only search in searchable patron attributes if searching in standard fields
    
    Test plan:
    - Add a new patron attrbute and mark it searchable
    - Populate a new patron with 'potato' in that field
    - Add/edit another patron to have email potato@invalidemail.com'
    - Perform a patron search with query 'potato' (in standard fields)
    => Both patrons are returned
    - Perform a patron search with filters 'Email' and query 'potato'
    => Only 1 patron is returned and you are redirected to the patron detail page.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit f86500351af0a1a4d1593eb2aa689b8ec52bc401
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 14 16:19:25 2017 +0100

    Bug 18094: Add tests to highlight the problem
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 708a896ffadda23caf1dc52463f47aede8fe005a
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Mar 10 15:04:15 2017 -0500

    Bug 18215: Third case which was missed.
    
    Git install old-school style a pre-tls koha
    Drop the DB
    Create the DB
    change branch to master
    Run a web install.
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit c80cd97b68c76312062780783427542a5268c61f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 10 09:17:02 2017 +0100

    Bug 18215: Fix another tls warning
    
    Resolve warning:
    Use of uninitialized value in string eq at C4/Installer.pm line 79.
    
    Test plan:
    Add a trivial .sql file in atomicupdate (comment is sufficient).
    Run updatedatabase.pl
    Without the patch you have the warning.
    Apply the patch and repeat (no warning).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 37da40b323d8bc012724510fe4839dcb908c2b3b
Author: Marc Véron <veron@veron.ch>
Date:   Sat Mar 11 19:17:37 2017 +0100

    Bug 18246: Patron card creator: Unit not always displays properly in layouts
    
    To reproduce:
    
    1) Create a new layout
    2) Select an unit in "Units selection"
    3) Save
    4) Edit layout again
    5) Select other unit, e.g. 'SI Centimeter'
    6) Save
    7) Repeat
    8) Edit again
    Error: Latest unit seems to stick and can no longer be changed, because
    in units drop down, multiple untis are marked as selected.
    
    To test:
    1) Apply patch
    2) Repeat steps above, verify that value for units always display as expected.
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 20ad341eefc555e0cf2b0f2862347e8a48b28935
Author: Marc Véron <veron@veron.ch>
Date:   Sat Mar 11 17:18:10 2017 +0100

    Bug 8603: Patron card creator - 'Barcode Type' doesn't stick in layouts
    
    To reproduce:
    
    1. Make a new layout
    2. Tick "Print card number as barcode"
    3. Change 'Barcode Type' to anything other than Code39
    4. Save
    5. Edit it again
    6. Its back to Code39
    
    To test:
    1. Apply patch
    2. Repeat steps above
    3. Verify that 'Barcode type' is selected as expected
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=18063
    
    https://bugs.koha-community.org/show_bug.cgi?id=8063
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit b925afc451590acf9f30bcacde160b70f10b8be7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Feb 16 14:26:20 2017 +0000

    Bug 17169 - Use CCODE descriptions instead of codes
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 0b7702d00342c06241ea7f2430d13c204ce0e230
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Feb 6 16:49:49 2017 -0300

    Bug 17169: (QA followup) Add NORMARC and UNIMARC definitions for CCODE
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 306250e4967aa27dbb9807e622065ed76dd5048c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Oct 11 09:01:12 2016 +0000

    Bug 17169: Add a facet for ccode fields to ElasticSearch
    
    To test:
    1 - Apply patch
    2 - Backup your db
    3 - Drop and create a new db to ensure your mappings are refreshed from
    the patch
    4 - add some titles with items with collection codes
    5 - search and see collection code facets
    6 - sign off
    
    Work to be done:
    1 - Replace codes with descriptions
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 3115ac641f2e8cf2c7ec7b697e4e74092ef06f45
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 13 01:11:54 2017 -0300

    Bug 18256: Koha::Items - Remove GetItemsCount
    
    C4::Items::GetItemsCount can be replaced with Koha::Biblio->items->count
    
    Test plan:
    Create a bibliographic record with items attached
    Try to delete the record from a basket (acquisition module), the detail
    page and the batch item deletion tool.
    
    => You should not be able to delete it.
    
    Remove the items and then try again to delete the record
    
    => Now you must be able to delete it.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 0d239e4e6f3c7095173773252dc9ce38b48c0799
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Mar 20 07:22:41 2017 -0400

    Bug 18264 - (QA Followup) Remove use of GetBiblioFromItemNumber Replace <blank> with (blank)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 2ead301181c33f42d3c88abffa8d18b8a416b40a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Mar 14 14:16:09 2017 +0000

    Bug 18264 - Course reserves - use itemnumber for editing existing reserve items
    
    This patch alters the crouse reserves module to use itemnumber as the
    lookup method for existing reserves as opposed to barcode
    
    To test:
    1 - Apply patch
    2 - Add some items to a course reserves - all should work as expected
    3 - Delete the barcode for an item on reserve
    4 - Note the edit link still resolves to the correct item
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit eb5151b0a89758d6da83eccfa08b5239f20d4ea2
Author: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
Date:   Mon Mar 20 08:35:17 2017 +0000

    BUG 8010: Removed Auth2.t
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit db93f85a333f10499562605d26b6fc2600ffc496
Author: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
Date:   Fri Mar 17 16:12:59 2017 +0000

    BUG 8010: Correct a few syntax errors, and moved tests
    
    - Tests are now in t/db_dependent/Search/History.t
    - There were 2 differents sysprefs in sysprefs.sql and in atomicupdate => fixed
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 4f2c804e8a36f9016e02867cc46669dff59e605d
Author: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
Date:   Mon Feb 13 15:21:57 2017 +0000

    Added a new syspref to Load history to the next user
    
    Added a syspref LoadHistory addSearchHistoryToTheFirstLoggedUser to select if you want the system to add the history of searches performed without session when you log in as registered user.
    TEST PLAN
    1 - Search in the catalogue, check you are not logged
    2 - Log in : your last history should appear
    4 - Log out
    5 - Apply the patch
    6 - Repeat 1 and 2
    7 - Desactivate the syspref addSearchHistoryToTheFirstLoggedUser
    8 - Repeat 1 and 2 : your last history shouldn't appear
    
    The Unit test doesn't rollback but delete the added lines : the function get_template_and_user allway sets the autocommit to 1.
    
    https://bugs.koha-community.org/show_bug.cgi?id=8010
    
    Tested 3 patches together, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 547208d06458865300f1ff23f7723da6e4901d6a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Mar 3 16:10:09 2017 +0000

    Bug 18115 - Fix use of Objects as hashref in acqui/addorderiso2709.pl - Bug 15503 followup
    
    Fix use of 'gstrate' for 'tax_rate'
    
    Signed-off-by: Matthias Meusburger <matthias.meusburger@biblibre.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit f79cf7930d887ea157fa64bb89fb0eb130b74aae
Author: Nicolas Legrand <nicolas.legrand@bulac.fr>
Date:   Wed Feb 22 10:11:18 2017 +0100

    Bug 18150 - CanItemBeReserved doesn't work with (IndependentBranches AND ! canreservefromotherbranches)
    
    The variable $item used to be a hash, but at the end of the function,
    it's a Koha object. As $item->{homebranch} doesn't yield anything and
    should be $item->homebranch. It prevents people using different
    branches without holds between branches from placing a hold on an item
    they should be able to place hold on.
    
    Test plan:
    
    1. Before patch
    
      a. with IndependantBranches off
      b. try to place hold on an item you should be able to place hold on
      c. it should work
      d. put IndependantBranches on and canreservefromotherbranches off
      e. shouldn't work
    
    2. after patches redo steps from (1) and everything should be working
    fine.
    
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Note: Item is fetched twice, it's not necessary. But out of the scope of
    this patch.
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit a649958315c98500ebe0ea3f91c05a8067d54e58
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Mon Mar 20 15:13:13 2017 +0100

    Bug 18305 - jquery.fixFloat.js breaks advanced MARC editor
    
    Remove use of ECMASCRIPT 2015 default parameter syntax in
    jquery.fixFloat.js to be compatible
    with a wider range of browser versions.
    
    Test plan:
      1. Usa a not so modern browser, for example Chrome/Chromium < 49, any version of IE
      besides Edge, Opera, or Firefox < 15.0.
      2. Edit a bibliographic record in staff client and try switching to
      advanced MARC editor (check console, no errors should appear).
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 7aa0808ff227850fc448b74dabed9b15ac0eb927
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 9 16:58:17 2017 -0300

    Bug 18242: [SOLUTION 2]Handle correctly move to old_issues
    
    The table old_issues has a primary key defined on the issue_id column.
    This issue_id comes from the issues table when an item is checked in.
    
    In some case the value of issue_id already exists in the table
    
    Basically this happens when an item is returned and mysqld is restarted:
    The auto increment value for issues.issue_id will be reset to
    MAX(issue_id)+1 (which is the value of the last entry of old_issues).
    See also the description of bug 18003 for more informations.
    
    In this solution the change is done at code level instead of DB
    structure: If old_issues.issue_id already exists before moving from
    the issues table, the issue_id is updated (not on cascade for
    accountlines.issue_id, should it?) before the move.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 48b1328ebeb7ed2337ba75a582705389767b691a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 9 16:41:31 2017 -0300

    Bug 18242: [SOLUTION 2]Add tests
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 95f4c197692523d6abec712bbb003e4b710344e3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 17 10:52:46 2017 +0100

    Bug 18284: [QA Follow-up] Add test descriptions
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.coml>

commit 36ee625f0890c80190e53f59bbb2282c3b2bfcb5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 16 15:20:10 2017 -0300

    Bug 18284: (bug 17196 follow-up) Move biblio metadata when a biblio is deleted
    
    There is a deletedbiblio_metadata table but it is not populated when a
    biblio is deleted. Since we have a ON DELETE constraint on
    biblio_metadata.biblionumber, the row is deleted when the biblio entry
    is deleted => data lost!
    
    Test plan:
    - Create a biblio
    - Delete it
    
    => Without this patch the deletedbiblio_metadata table is not populated
    with the biblio_metadata row related to the biblio
    
    => With this patch applied you should see that the row has been moved.
    
    Followed test plan, behaves as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.coml>

commit 9d8e83528f39a2d8401f7ed50888c595f48205f5
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Tue Mar 7 13:26:51 2017 +0200

    Bug 18222 - Fix tests broken by Buug 18026
    
    root@koha_ci_1:/home/koha/Koha# KOHA_CONF=$KOHA_CONF perl t/Koha_Template_Plugin_Koha.t
    1..3
    ok 1 - use Koha::Template::Plugin::Koha;
    ok 2
        1..2
        ok 1 - Correct development version
        ok 2 - Correct maintenance version
    ok 3 - Koha::Template::Plugin::Koha::Version tests
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e6c2858c4faf71920912c3e2df92225b45548c9d
Author: Srdjan Janković <srdjan@catalyst.net.nz>
Date:   Tue Mar 14 12:24:42 2017 +1300

    Bug 18243: 16034 follow-up: Conditionally test Koha::ExternalContent::* modules loading
    
    To test:
    1 - Make sure you don't have WebService::ILS installed
    2 - prove t/00-load.t
    3 - You should get a failure to load module and tests are skipped
    4 - Apply patch
    5 - prove t/00-load.t
    6 - Module is not loaded, test are skipped
    Optional:
    7 - Install WebService::ILS
    5 - prove t/00-load.t
    6 - Module is loaded, test passes
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 69f68da800794d964836daa472e3c0ce2b154f95
Author: Srdjan Janković <srdjan@catalyst.net.nz>
Date:   Thu Mar 2 13:31:14 2017 +1300

    Bug 18243: 16034 follow-up: better handling of absence of WebService::ILS::OverDrive::Patron at testing
    
    To test:
    1 - Make sure you don't have WebService::ILS::OverDrive::Patron
    installed
    2 - prove t/Koha_ExternalContent_OverDrive.t
    3 - You should get a failure to load module and tests are skipped
    4 - Apply patch
    5 - prove t/Koha_ExternalContent_OverDrive.t
    6 - Module is not loaded, test are skipped
    
    Fixed small typo 'cannot filnd' -> 'cannot find'
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2470e225d8791d1b87daaebde2591caab6427d49
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 15 14:52:49 2017 -0300

    Bug 18275: Do not rely on CGI param userid to log a user in if auth is not required
    
    From opac/opac-memberentry.pl, authnotrequired is set.
    That means a patron can access the page without being logged in. It is
    used on this page for the self registration feature.
    
    From C4::Auth::get_template_and_user, we have
      $userid = $q_userid;
    $q_userid is previously set to the 'userid' CGI param.
    
    We end up here if authonotrequired is set AND CGISESSID does not exist.
    
    Test plan:
    - Run:
      $ prove t/db_dependent/Auth.t
    => FAIL: Regression test for checkauth fails
    - Apply this patch
    - Run:
      $ prove t/db_dependent/Auth.t
    => SUCCESS: Tests pass.
    - Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3844d6f36bcee2b0e2102c2df1323cdd86940303
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Mar 16 09:23:24 2017 -0300

    Bug 18275: Regression test
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 13de29ad4465b964e37d4f460f5c9145e23939a1
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jan 19 15:43:38 2017 +0100

    Bug 7143: Replace Santallan by Santellan
    
    Missed one typo in about.tt.
    Can go along with the next patch here.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 59ca80f2a181a18cb0d568b7ca86d1da99f9748b
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Mar 6 10:39:18 2017 +0100

    Bug 18215: Resolve warning on $tls in Database.pm
    
    Resolve this warning:
    updatedatabase.pl: Use of uninitialized value $tls in string eq at /usr/share/koha/masterclone/Koha/Database.pm line 63.
    
    Test plan:
    [1] Check if you do not see the warning anymore.
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Warning disappears after applying the patch.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d84ed89557e2c921f261b1c620434d432dcbd3f7
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Tue Apr 5 12:56:24 2016 +0100

    Bug 16202: GetIssuingCharges should return a collectable amount
    
    Charges should not include elements less than a penny/cent
    they are not displayed but can be saved to the database
    causing "odd" behaviour down the line
    
    Make the routine round the resultant charge to nearest cent,
    so consistent values are returned.
    Removed the one case where it was rounded post call.
    Although the main danger is values generated by the discount
    calculation apply the rounding to all returned charges in case
    the item charge is defined using the 3rd or 4th decimal
    places.
    
    NOTE: prove -v t/db_dependent/Circulation.t triggers the change.
          Though, all the returned amounts are 0.00 only.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7a5f17ff6ecbec3a7f73fa54b900dae909996b29
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 16 22:19:59 2017 +0000

    Bug 18135: Show alert if no authorities selected in batch record deletion
    
    To test:
    1) Go to Tools -> Batch record deletion
    2) Select Authorities as record type, put in an auth id, click Continue
    3) Unselect the authorities and click Delete selected records
    4) Confirm an alert shows up
    5) Clear the alert and confirm deleting the authority still works as
    normal
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5e7a78475a7f8fdb178b8beb4c84d781b5f09a72
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 3 18:36:55 2017 +0000

    Bug 16530 - DBRev 16.12.00.013
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 796379697849d6ca0364a736aa72dfecf28134e6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 1 17:54:43 2017 +0100

    Bug 16530: Add a new method to the Branches TT Plugin to avoid c/p
    
    We should do the same for the other check (FA exists), but cannot find a
    good and quick way to implement.
    
    Doing it this way will avoid regression later, we will no have to check
    if the variable is correctly passed to the template.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1edb8cbeee2f89c7fb4cd1f643b23cb20d91d35d
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue May 17 04:35:46 2016 +0000

    Bug 16530: Adding a circ sidebar navigation menu and circSidebar syspref to activate/deactivate
    
    Edit: Fast cataloging link should now show on all pages, removed offline circulation links
    Edit 2: Creates the syspref to activate or deactivate the sidebar
    Edit 3: Fixing merge conflicts, using Koha::BiblioFrameworks to find FA
    framework and adding sidebar to on-site checkouts
    
    This adds a sidebar to
    circ/branchoverdues.tt
    circ/circulation.tt (I also fixed up some of the indentation in this file to make it easier to see where the divs started and ended)
    circ/renew.tt
    circ/returns.tt
    circ/selectbranchprinter.tt
    circ/transferstoreceive.tt
    circ/view_holdsqueue.tt
    circ/waitingreserves.tt
    circ/branchtransfers.tt
    circ/on-site_checkouts.tt
    
    To test:
    1) Confirm syspref CircSidebar is activated
    2) Go to all of the above pages and confirm the sidebar menu shows up
    3) Confirm fast cataloguing link and transfer link are there
    4) Trigger any error messages you can possibly think of (i.e. on renew.pl: barcode does not exist). Confirm that this does not mess up the layout of the page
    5) Go to a user account page, Check out tab. (Since this is a circ/circulation.pl page). Ensure the circ nav sidebar doesn't show up (confirm it looks as it usually does)
    6) Deactivate circSidebar
    7) Confirm pages all look normal
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Jan Kissig <jkissig@th-wildau.de>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 84e48d03238ce2446e7ea24401bda0a8f4e4422d
Author: Dimitris Kamenopoulos <dkamen@gmail.com>
Date:   Sun Dec 27 16:01:43 2015 +1300

    Bug 15427 : Enable TLS support for MySQL
    
    In summary, changes are:
    1) If you have chosen MySQL, Makefile.PL will ask you if you want TLS (default:
    "no"), and then the locations for CA cert, client cert and client key
    (reasonable defaults are provided). Settings <tls>, <ca>, <cert> and <key> are
    added in koha-conf.xml
    2) If <tls>yes</tls> in koha-conf.xml, the installer and database connection
    scripts add the TLS options in both DBI connection strings and mysql command
    line
    
    To test
    1/ Apply patch
    2/ Check everything still works and db connections are the same as before
    3/ Either run Makefile.PL and step through the options or edit your koha-conf.xml to
    enable TLS
    4/ Check db connections are still working
    
    Patch provided to me by Dimitris Kamenopoulos and I reformatted it into a git patch,
    any errors are probably mine
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d9069b5b60c10db20136af2bef837123558a2c22
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 3 18:30:01 2017 +0000

    Bug 14764 - DBRev 16.12.00.012
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eaa9882dd10414cf16ecaf80bcf856bfc60e42c1
Author: Liz Rea <liz@catalyst.net.nz>
Date:   Fri Feb 3 10:18:51 2017 +1300

    Bug 14764 - [followup] Addressing QA concerns
    
    * removed Policy:
    * put the syspref in alpha order with the others
    * added els to the if.
    
    Signed-off-by: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c6ea593971502833ff6f37c3eccc994d5b15171e
Author: Liz Rea <liz@catalyst.net.nz>
Date:   Thu Nov 3 10:18:45 2016 +1300

    Bug 14764: OPAC news selector
    
    Test plan:
    
    1) Add more than one library, at least two in total is needed. Make note
       of which is your current user's home branch.
    2) Go to Tools -> News and add one global ("All") news item and one
       specific for each branch.
    3) Apply the patches.
    4) Perform database upgrades when you log in.
    5) Go to OPAC main, it should work as before: Showing global news as
       well as the news for your home branch once logged in.
    6) Go to System Preferences -> OPAC and set 'OPACNewsBranchSelect' to
       yes.
    7) Go to OPAC main, you should see the global news item plus any items
       for your home branch for the current user if logged in.
    8) Above the news, you will see a dropdown that lists the branches.
       Select one, and click "Change library."
    9) You should now see global news and the news for the selected branch,
       regardless of whether logged in or not.
    
    Sponsored-By: Halland County Library
    
    Fixes QA comments:
    
    * Keep the current selected branch selected
    
    * Change OPACNewsBranchSelect -> OPACNewsLibrarySelect
    
    * fix 'system wide only' view for logged in user. We still show system
      wide even when a library is selected.
    
    * Removed the "change library" link
    
    * Added a label to the field.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01371f8fad6efd30bf5a3b10bf3cf9f5eabbe5b5
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Feb 15 00:30:57 2017 +0000

    Bug 10978: Redirect to basket list of a supplier after deleting a basket
    
    This patch redirects to the vendor's list of baskets after deleting a
    basket, fixes breadcrumbs after deletion and also hides the toolbar
    actions after deletion (seeing as you can't edit/export etc a basket
    that no longer exists).
    
    To test:
    1) Go to Acquisitions -> find a vendor -> view a basket or create a new
    basket
    2) Delete the basket. Notice you are taken to a list of all vendors and
    baskets
    3) Apply patch and do step 1 again
    4) Delete the basket. Notice appropriate breadcrumbs, no toolbar, and
    confirm link to return to baskets for the vendor works.
    
    Sponsored-by: Catalyst IT
    
    Followed test plan, works as expected (links to vendor's baskets and all baskets)
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Re-tested. Wording of buttons "Show baskets for vendor..." and "Show all
    active baskets" makes sense.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3f6f4a2b36537cdcf3e89832e83595d7d6a649ad
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 24 07:46:19 2017 +0000

    Bug 7663: Fix bad merge conflict with bug 15584
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c3f6f26c35ecdab035f8e0035ee8eb73cd5fe99c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 24 01:29:22 2017 +0000

    Bug 7663 (QA Followup)
    
        Ignore empty entries
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 902342f415c51ebb13ea3b36cad3583a39afc1a7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 1 11:47:31 2016 +0000

    Bug 7663 - batch add barcodes to a list
    
    This patch changes the barcode input on add list to a textarea and
    process multiples barcodes to allow for adding many items to a list
    at once
    
    To test:
     1 - Create a list
     2 - Add some items
     3 - Verify items are added and success reported
     4 - Add these items again
     5 - Verify you are notified they were not added
     6 - Type invalid barcodes into the text area and submit
     7 - Verify you are notifed of failure to add
     8 - Try going to a list that doesn't exist and adding barcodes
      i.e. http://localhost:8081/cgi-bin/koha/virtualshelves/shelves.pl?op=add_biblio&shelfnumber=9999&barcodes=4
     9 - Verify correct error
    10 - Try the above but with a list that exists while signed in as a patron
         without lists permission:
         i.e. http://localhost:8080/cgi-bin/koha/opac-shelves.pl?op=view&shelfnumber=3
    11 - Verify correct error: "You do not have permission to view this list."
    
    Signed-off-by: Chris Kirby <chris.kirby@ilsleypubliclibrary.org>
    Works as advertised.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 19cbebc9b6dc061c6c9525a224a0c6d4a7b6d604
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 27 13:28:20 2017 +0000

    Bug 18169: Add test without before parameter for search_patrons_to_anonymise
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ff647be07c54191f1c1ee5693be96bf4d0040672
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 24 13:26:29 2017 +0100

    Bug 18169: Make 'before' param non mandatory for Koha::Patrons->anonymise_issue_history
    
    From opac-privacy.pl:
    
        # delete all reading records for items returned
        # uses a hardcoded date ridiculously far in the future
    
        my $rows = eval {
            Koha::Patrons->search({ 'me.borrowernumber' => $borrowernumber })->anonymise_issue_history( { before => '2999-12-12' } );
        };
    
    It sounds better to make this before parameter not mandatory, and remove the condition from the sql query if it is not passed.
    
    Test plan:
    1. Anonymise your reading history at the OPAC.
    2. Confirm that all your reading history has been anonymised
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b6cb18c4a8292cabe5fd611b349b51d5c79b5fe4
Author: Marc Véron <veron@veron.ch>
Date:   Wed Feb 15 10:24:56 2017 +0100

    Bug 18122 - Audio alerts: Add hint on where to enable sounds
    
    This patch adds a hint to page Home > Administration > Audio alerts
    and related help page about where to enable the sound system
    (syspref 'AudioAlerts').
    
    To test:
    - Apply patch
    - Disable syspref 'AudioAlerts'
    - Go to Home > Administration > Audio alerts
    - Note hint below title 'Audio alerts'
    - Enable syspref 'AudioAlerts'
    - Go to  Home > Administration > Audio alerts
    - Hint is no longer visible (since audios are enabled)
    - Open Help page (top right)
    - Verify that hint on help page makes sense.
    
    Amended to add alert class as requested by comment #2 2017-02-21 mv
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3d3ab8bd2f0ca7fc091d0367047248c561a3af8a
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 14 19:42:15 2017 +0000

    Bug 13685: Sorting by author in opac reading history
    
    opac-readingrecord.pl was actually already set up to do this, the option
    to sort by author was just not put into the tt file. This patch adds
    that.
    
    To test:
    1) Log into OPAC, go to your reading history
    2) Confirm that 'Order by author' shows in the dropdown
    3) Confirm it works as expected
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 93a3b1fe8d94b06f995d6a0df7df63194910af28
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 14 01:21:01 2017 +0000

    Bug 18108: Sorting by author in opac summary
    
    To test:
    1) Log into OPAC, go to your summary
    2) Notice 'author' is in Title column, therefore unable to sort by
    author
    3) Apply patch and refresh page
    4) Notice author has now been moved into Author column
    5) Confirm sorting by author works as expected and sorting of all other
    columns works as expected
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fd8c2d4e35f0ed4d7661eea2f1238fe2d094b969
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 7 14:03:54 2017 +0100

    Bug 18070: Correct error from podchecker on line 1376
    
    Resolves:
     *** ERROR: Spurious =cut command at line 1376 in file C4/AuthoritiesMarc.pm
    
    Test plan:
    [1] Run podchecker on C4/AuthoritiesMarc.pm
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 17e84750d9d90f3d2df466d1c8d8a63bbd5ad09d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 14 16:41:26 2017 +0100

    Bug 18070: [Follow-up] What should DelAuthority return?
    
    Script tools/batch_delete_records.pl only checks the return value of
    DelAuthority. The return value depends on DBI rows, which is not always
    reliable. It may return -1 when it 'does not know'.
    
    Testing $@ in tools/batch_delete_records.pl should actually be enough.
    The return value was discarded in C4/ImportBatch.pm. Removing an unused
    variable.
    
    Test plan:
    [1] Pick an authority record with a few linked biblios.
        Delete this authority record via tools/batch_delete_records.pl.
        Check if the linked biblio records are cleaned up.
    [2] Bonus: Make a typo in the SQL statement of DelAuthority. Check
        if batch_delete_records shows you the error message.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb58b11f6769f69e109c1f42a78b3756d429dc80
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 31 13:01:58 2017 +0100

    Bug 18070: Extend sub merge to remove fields for deleted authorities
    
    In order to accomplish this, we need to add some additional checks in
    the merge routine. The actual change to remove the field, is quite
    small.
    
    Furthermore, we need to add a merge call in DelAuthority and adjust
    the merge cron job accordingly.
    
    The change is well supported by additional tests, including a simulation
    of postponed removal via cron, if dontmerge is enabled.
    
    Note: Deleting an authority with linked biblios is tested on the next
    patch.
    
    Test plan:
    [1] Run t/db_dependent/Authorities/Merge.t
    [2] Delete an authority without linked biblios from the Authorities
        module. If the indexer is not fast enough, wait a bit and refresh to
        verify that the authority is gone on authorities-home.pl.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6572ee07dbcd9fde4169c6b9e3f3f8a8e0eaf516
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 31 11:46:21 2017 +0100

    Bug 18070: Deleting an authority should update the linked biblio records
    
    Adding a test where we delete an authority and prove that the linked
    biblio still contains a reference to it.
    
    Note: Currently, you can only delete a used authority from Tools,
    batch record deletion. If you do, the biblio records will still
    contain references to the deleted authority.
    
    Test plan:
    [1] Run t/db_dependent/Authorities/Merge.t
        Last test should fail: not ok 1 - Field 609 should be gone too
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9b92a494e6d91297f460eb8ed073a6d3dec5b2d9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Dec 15 14:10:56 2014 +0100

    Bug 18037: Hold notes template cleanup (from 15545)
    
    From the second patch of bug 15545:
    Removing some unused template code related to a former approach.
    Adding some changes for future extension by bug 15545.
    
    This patch was tested by Liz Rea when the routine IsHoldNoteRequired was
    called by opac-reserve.pl. The only change here is that we do not yet
    call this routine; so leaving her original signoff.
    
    Test plan:
    [1] Enable OPACHoldNotes.
    [2] Place a hold on a serial record. No behavior change.
    
    Signed-off-by: Liz Rea  <liz@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 257c1793420108f1cb5efdec7bf03649d41940a0
Author: Emma Nakamura Smith <emma.nakamura.smith@gmail.com>
Date:   Tue Jan 17 03:23:18 2017 +0000

    Bug 17840: adding classes to notes in checkouts
    
    Test Plan
    1) Add an internal and a public note to an item.
    2) Check out the item.
    3) Verify that both notes are shown in between title and barcode in the
    second column of the details table.
    4) Verify there is an empty class="" in the HTML source code for each
    5) Apply patch and refresh page
    6) View page source, confirm that class has been changed
    
    I tested this by first applying the patch for bug 17919 to catch the
    check-in software error. Patch working as expected :)
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3f66081fb5a69feeeb5cf7c0876a6debc932beee
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 26 12:43:14 2017 +0100

    Bug 17334: Format the date according to the system preference
    
    - Use KohaDates TT plugin to format the date correctly
    - Do not use a temporary variable
    - Replace:
        patron's info Requested: Datetime
      with
        patron's info - Requested on Datetime
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 21a13396c9610c5defa2451d1ca6fd0d08e8ca3c
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Fri Jan 20 03:59:24 2017 +0000

    Bug 17334- Added a timestamp to the members-update.tt To show the user when the pending modifications were requested.
    
    Test plan:
    1.Log into OPAC and click on Lists->Your Lists->your personal details
    
    2. Change/add a value in that form
    
    3. Select the 'Submit update request'
    
    4. Log into the Koha staff interface, then go to the url:
    cgi-bin/koha/members/members-update.pl
    
    5. You will see near the top of each box containing a pending request the following are displayed: surname, firstname,
        patron category, branch, and cardnumber but no timestamp.
    
    6. Apply this patch
    
    7. Repeat steps 1,2, 3, 4
    
    8. You will now see timestamp in the format "Requested: YYYY-MM-DD
    HH:MM:SS" next to each patrons details near the top of each pending
    request box.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit abdf2319cd0fca27046699ae029107e92bb7f02f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 27 13:21:18 2017 +0100

    Bug 16966: [QA Follow-up] Check count, not size in template
    
    The method size is not covered by tests at koha-tmpl/intranet-tmpl/prog/en/modules/tools/cleanborrowers.tt line 163.
    The method size is not covered by tests at koha-tmpl/intranet-tmpl/prog/en/modules/tools/cleanborrowers.tt line 183.
    
    Script cleanborrowers passes patrons_to_delete and patrons_to_anonymize to
    the template. One is an array ref where we should use 'size', the other is a
    Koha::Patrons object where we should use 'count'.
    If we don't, we will not anonymize a lot of records ;)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b4cd5faeb09b4872b5ea413e0aace3ebbaae26c5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 24 12:34:26 2017 +0100

    Bug 16966: move parameters to hashref
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ea321eaf3d6023d8d8b0fbb6ed4a85051f78d60b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 24 12:25:33 2017 +0100

    Bug 16966: Fix small QA issues
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 60a0e155a1586531bff220766704f0c9699cfb16
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 17 10:39:09 2017 +0100

    Bug 16966: Teach K::S::R::OldIssue its Koha objects class
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e8d34c2bdd741cdfbe9cb483740d645aef396f9a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 12:15:10 2016 +0100

    Bug 16966: The method should return a Koha::Patrons object
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ce55b024467f5d1da92a97c1dc058fbbd593b781
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 10:08:35 2016 +0000

    Bug 16966: Make the tests pass again
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 286be46e8a8c126c5a23dd16e310d11253378da5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 22 17:25:24 2016 +0100

    Bug 16966: Koha::Patrons - Move GetBorrowersWithIssuesHistoryOlderThan to search_patrons_to_anonymise
    
    The C4::Members::GetBorrowersWithIssuesHistoryOlderThan subroutine is supposed
    to return the patrons with an issue history older than a given date.
    
    It would make more sense to return a list of Koha::Patrons.
    
    On the way, the code from AnonymiseIssueHistory will be moved as well to
    anonymise_issue_history.
    
    Note that these 2 subroutines are strongly linked: one is used to know the
    number of patrons we will anonymise the history, the other one is used to
    anonymise the issues history. The problem is that the first one is not used to
    do the action, but only for displayed purpose.
    
    In some cases, these 2 values can differ, which could be confusing.
    Case 1:
    The logged in librarian is not superlibrarian and IndependentBranches is set:
    if 2+ patrons from different libraries match the date parameter, the interface
    will display "Checkout history for 2 patrons will be anonymized", when actually
    only 1 will be.
    Case 2:
    If 2+ patrons match the date parameter but one of them has his privacy set to
    forever (privacy=0), the same issue will appear.
    
    This patch moves the code from C4::Members::GetBorrowersWithIssuesHistoryOlderThan
    to Koha::Patrons->search_patrons_to_anonymise and from
    C4::Circulation::AnonymiseIssueHistory to
    Koha::Patrons->anonymise_issue_history
    
    Test plan:
    1/ Confirm the 2 issues and make sure they are fixed using the Batch
    patron anonymization tool (tools/cleanborrowers.pl)
    2/ At the OPAC, use the 'Immediate deletion' button to delete all your
    reading history (regardless the setting of the privacy rule)
    3/ Use the cronjob script (misc/cronjobs/batch_anonymise.pl) to
    anonymise patrons.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4f72b06e5d5807a88b243e12fe4085e617e822c8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 22 16:43:56 2016 +0100

    Bug 16966: Koha::Patrons - Move AnonymiseIssueHistory tests
    
    The next patch will move C4::Circulation::AnonymiseIssueHistory and
    C4::Members::GetBorrowersWithIssuesHistoryOlderThan to Koha::Patrons
    This patch move the history anonymisation code to the Patrons.t test
    file and the entire subtest related to StoreLastBorrower to
    StoreLastBorrower.t
    
    It just moves and add some minor adjustements.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bfe63a1e73bcfb57d6e2c41b98208419ba00a71f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 22 15:57:26 2016 +0100

    Bug 16966: GetBorrowersWithIssuesHistoryOlderThan - Highlight the existing issue in tests
    
    If IndependentBranches is set, the code is buggy. This patch only
    highlight the bug by providing a test.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e9d5615e70056cd887b9471827611a78275016ab
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Feb 21 13:13:02 2017 -0500

    Bug 13968: Follow up - Clean HTML tags for hints
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b2eb6109ff308de7d2bc9338d708ac7fe9b6e3d7
Author: Marc Véron <veron@veron.ch>
Date:   Sat Feb 18 17:15:06 2017 +0100

    Bug 13968 - Branch email hints are misleading
    
    This patch replaces missleading notes with Reply-To and Return-Path fields
    to reflect indicate falback values if they are empty (ReplyToDefault and
    ReturnpathDefault system prefs).
    
    To test:
    - Apply patch
    - In Home > Administration > Libraties and Groups, edit a library
    - Verify that hints display for fields Reply-To and Return-Path, indicating
      their default values.
    
    Amended to remove extra </li> - 2017-02-21 mv
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d43131c4fca8124a8a9e4dcdea82e2bdf1af196a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 14 10:52:14 2017 +0100

    Bug 18087: Handle invalid filetypes
    
    If an invalid file is used as biblionumber list, we should display a
    message.
    
    Test plan:
    1/ Use csv, plain text files
    => Should work
    2/ Use invalid files (binary files like pdf, doc*, xsl*, etc.)
    => Should not work and see a warning message.
    
    Amended patch after signoff: Remove one warn debug line
    
    Signed-off-by: Joy Nelson <joy@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 18af48bffe112a5df61a8a546da86dc31f32a7e7
Author: Joy Nelson <joy@bywatersolutions.com>
Date:   Thu Feb 9 11:42:57 2017 -0800

    Bug 18087 - Clarification on File type when using file of biblionumbers to export data
    
    Added a line to the screen  detailing the types of files that can be used to upload a list of biblionumbers.
    
    Test plan:
    1. Go to tools->export data
    2. under File option,  (File types accepted: .csv and .txt)  should appear
    3. Check both Bibliographic and Authority Export screens for this new string.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Joy Nelson <joy@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1102109f9ccff4ce0b01f95ae16adb65a9806b26
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 25 09:35:42 2017 -0300

    Bug 17992: REST api: Remove the use of ->unblessed from Cities controller
    
    As bug 17932 adds TO_JSON to Koha::Object(s), there's no need for using
    it. Also, as this is a reference implementation for developers to copy
    and paste it is sensible to make this change even when this is not
    causing any bug.
    
    To test:
    - Apply the patch
    - Run:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ prove t/db_dependent/api/v1/cities.t
    => SUCCESS: Tests still pass!
    - Sign off :-D
    
    Signed-off-by: Matthias Meusburger <matthias.meusburger@biblibre.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cddb4b1ef049204da9a0db169b6aa83c3a361eac
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 3 16:54:15 2017 +0000

    Bug 18160 [QA Followup] - Correct whitespace
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 37288efd23199420cb79316ed1acbd0e1b1beb00
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Feb 23 11:47:00 2017 -0500

    Bug 18160: Follow up tweak if condition
    
    Based on comment #9, moved if condition.
    Based on comment #8, tweaked condition to grab preference.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 72e67285b7d98cb1934350274bbcc7191c63c66e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Feb 23 00:35:13 2017 +0000

    Bug 18160 - Error when OverDriveCirculation not enabled
    
    This patch only executes OverDrive circulation JS if
    OverDriveCirculation pref is enabled
    
    To test:
    1 - Disable OverDriveCirculation
    2 - Log in to opac and view summary tab
    3 - Note 'Internal server error'
    4 - Apply patch
    5 - Repeat and note error is not present
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b1249dcc34d22722c23fb3a231b61bcd42f82550
Author: Francesco Rivetti <oha@oha.it>
Date:   Mon Feb 20 11:02:40 2017 +0100

    Bug 17941 add tests to cover the optimization of the nested loop
    
    the new code skip testing for more borrowers if the item can't be renewed
    this require more tests for the case where 2+ items are reserved.
    
    I tried to add 1 more reserve to the main test suit, but too many other tests
    rely on specific holds, and I couldn't get around it.
    
    Instead, I added a subtest that consider the specific simple case and leave the
    other test cases exactly has they were designed.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Amended-patch: Just fix 3 indendations
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 08b1ebec75623c84967fd09611cf1fef4442c200
Author: Francesco Rivetti <oha@oha.it>
Date:   Tue Feb 14 11:16:01 2017 +0100

    Bug 17941 don't compute priority more than needed
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 35e3678f13e47b5e9596b4a4d62cb050e1832760
Author: Francesco Rivetti <oha@oha.it>
Date:   Tue Feb 14 11:13:51 2017 +0100

    Bug 17941 avoid scanning the full cartesian product
    
    when a item match a borrower, there is no point in checking the
    other borrowers
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 50c5708fe8ed74e22d78d9acb81080c7840954dc
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 3 16:45:22 2017 +0000

    Bug 17260 - DBRev 16.12.00.011
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f7dbe1751c2e99a3e573038f2f8c90127a832ddf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 24 08:08:30 2017 +0000

    Bug 17260: Update existing installs
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 77337a2ab537843eab70cc06b8bc2531ad2014dc
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Fri Jan 27 16:51:26 2017 +0000

    Bug 17260: updatedatabase.pl fails on invalid entries in ENUM and BOOLEAN columns
    
    The loading of file admin/searchengine/elasticsearch/mappings.yaml
    specifies 'type' as empty, which fails with Mysql 5.7+ which is more
    stringent.
    
    Also, forcing an empty value into a boolean also fails.
    
    Both issues arise when updatedatabase.pl hit 3.23.00.050.
    
    NOTE: both issues could also be resolved by actually setting values in
          the load file. This doesn't make this solution incorrect, though.
    
    To Test/reproduce:
    -1) Happens with Mysql 5.7.4.  Maybe earlier, but certainly at
        that point. Use a Xenial kohadevbox to more easily test.
    0) Find a database on 3.22 or earlier, save it.
        a) place
               sql_mode=IGNORE_SPACE,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
           into the [mysqld] section of /etc/mysql/mysql.conf.d/mysqld.cnf
        b) restart you mysql server
        c) drop the db and recreate it
        d) checkout the 3.22.x branch
        e) do a web install
        f) remove the added sql_mode
        g) restart the mysql server
    1) Set your code base to master
    2) run updatedatabase.pl
    3) See the errors on 3.23.00.050
    4) Apply the patch
    5) Reload the 3.22 db.
       a) repeat steps 0(a)-0(g)
       b) don't forget the caching issues
    6) succeed with updatedatabase.pl
    7) drop the db and recreate it
    8) run the web installer
    9) notice no issues either.
    10) run koha qa test tools
    
    NOTE: This bug only solved the upgrade portion.
          I added the kohastructure.sql change as well.
          I confirmed that all the code changes were
          triggered with this test plan.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Mehdi Hamidi <mehdi.hamidi@inlibro.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 11bae489bc85a9463712c9caafd2caf7b63155d9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 23 14:47:10 2016 +0000

    Bug 17216: Fix SQL statement to setting marc_subfield_structure.authorised_value to NULL
    
    We want to update it if it's empty, not equal to ';'
    nopaste vim mode is to blame
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8255344215e79a5274b05033cae4bcad8d441391
Author: Kyle M Hall <kyle@kylehall.info>
Date:   Sun Feb 26 20:41:27 2017 -0500

    Revert "Bug 12461 - Add patron clubs feature"
    
    This reverts commit 4f1eefdbb8bf4df07b03fc451c1c18ebe989c8b7.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9a172ac2ef9f7f3eaa99d4ebeb1f48e4ab7d0a0e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Feb 24 09:22:26 2017 -0300

    Bug 16034: (followup) Fix DB update and schema files
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4f1eefdbb8bf4df07b03fc451c1c18ebe989c8b7
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri May 23 11:54:26 2014 -0400

    Bug 12461 - Add patron clubs feature
    
    This features would add the ability to create clubs which patrons may be
    enrolled in. It would be particularly useful for tracking summer reading
    programs, book clubs and other such clubs.
    
    Test Plan:
    1) Apply this patch
    2) Run updatedatabase.pl
    3) Ensure your staff user has the new 'Patron clubs' permissions
    4) Under the tools menu, click the "Patron clubs" link
    5) Create a new club template
       * Here you can add fields that can be filled out at the time
         a new club is created based on the template, or a new enrollment
         is created for a given club based on the template.
    6) Create a new club based on that template
    7) Attempt to enroll a patron in that club
    8) Create a club with email required set
    9) Attempt to enroll a patron without an email address in that club
    10) Create a club that is enrollable from the OPAC
    11) Attempt to enroll a patron in that club
    12) Attempt to cancel a club enrollment from the OPAC
    13) Attempt to cancel a club enrollment from the staff interface
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>

commit e9d0337f329ea01cd90c2c425f20a57737a76512
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Feb 21 20:01:17 2017 +0000

    Bug 16034 - DBRev 16.12.00.010
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e7aff8ea0d190bea71ab217806b04832f402833f
Author: Srdjan Janković <srdjan@catalyst.net.nz>
Date:   Fri Jul 29 12:42:23 2016 +1200

    Bug 16034 follow-up: added WebService::ILS to PerlDependencies
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c7a2ef261e4d905c3c4d61f088e1d72681305db3
Author: Srdjan Janković <srdjan@catalyst.net.nz>
Date:   Tue Dec 8 19:07:41 2015 +1300

    bug_16034 Add overdrive info to the users page in the public interface
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ff3bc31352f25ea51ad0d68055794ab774047017
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Tue Aug 18 15:55:51 2015 +1200

    bug_16034 Adding a new syspref - OverDriveCirculation
    
    If set to true, Opac will integrate OverDrive patron services
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 88aa2ebf9df1ae7780f3af83770c28b1889f86e3
Author: Srdjan Janković <srdjan@catalyst.net.nz>
Date:   Tue Dec 8 19:06:27 2015 +1300

    bug_16034 Koha::ExternalContent::OverDrive - a wrapper around WebService::ILS::Overdrive::Patron
    
    * Using the upstream module for all the heavy lifting
    * opac/external/overdrive/auth.pl - 3-legged authentication handler
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 171ef729945ad04fefadc16399a5e08833a5ebef
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Feb 8 02:07:29 2017 +0000

    Bug 18077: Batch item modification link is bold when batch item deletion is active in tools menu
    
    To test:
    1) Go to Tools -> Batch item deletion
    2) Notice the link for Batch item MODIFICATION is bold, not the deletion
    link
    3) Apply patch and refresh page
    4) Correct link should now be bold.
    5) Go to batch item modification and confirm the correct link is bold
    
    Sponsored-by: Catalyst IT
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Re-tested, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ff425d97371ad1bac1a7ef13494dc879a9b417f4
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 14 02:13:33 2017 +0000

    Bug 18109: Adding font awesome icon to uncertain prices button
    
    To test:
    1) Go to Acquisitions -> search for a vendor
    2) View a basket with uncertain prices or add an order with uncertain
    prices to a basket
    3) Confirm that font awesome icon is appropriate and button still works
    as expected
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit de7349e06af53996d3ae8244bda7f31655340e8a
Author: Caitlin Goodger <caitlingoodger.student@wegc.school.nz>
Date:   Thu Jan 19 00:54:24 2017 +0000

    Bug 17852 Follow up.Multiple URLs (856) in list email are broken
    
    This is a follow-up to my previous patch. This fixes it on the OPAC and
    the previous one was from the intranet
    Test Plan
    1: Add multiple urls to a biblographic record
    2: Add the biblographic record to a list and then email it from the OPAC
    3: See that the links are broken and have been merged into one.
    4: Apply patch
    5: Send the list again and see that the links work
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 59482c68634fe392b23a39b75fcbae74bbb97c66
Author: Caitlin Goodger <caitlingoodger.student@wegc.school.nz>
Date:   Tue Jan 17 21:37:49 2017 +0000

    Bug 17852; Multiple URLs (856) in list email are broken.
    
    Test Plan
    1: Add multiple urls to a biblographic record
    2: Add the biblographic record to a list and then email it.
    3: See that the links are broken and have been merged into one.
    4: Apply patch
    5: Send the list again and see that the links work
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f9a4f5edb84b826d9caf16b2221fed79fd7d421e
Author: Luke Honiss <luke.honiss@gmail.com>
Date:   Tue Jan 17 02:27:55 2017 +0000

    Bug 17865 'If a subscription has no history end date, it shows as expired today in OPAC'
    
    --TEST PLAN--
    1) View a subscription with no history end date
    2) Search for an item with a subcription in OPAC
    3) Under subscription tab click more details
    4) The end date will be the current date
    5) Apply patch and refresh
    6) The end date will not be shown
    
    Signed-off-by: Baptiste Wojtkowski <baptiste.wojtkowski@biblibre.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 57666e07ac60b32eed137c77e8ea35cbe9b628f3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 20 10:49:11 2017 +0100

    Bug 18026: Correct URL to database columns from .pref files
    
    Recently the DB schema website has been updated.
    The link to the columns' tables is now
      http://schema.koha-community.org/master/tables/table.html
      http://schema.koha-community.org/16_11/tables/table.html
      http://schema.koha-community.org/16_05/tables/table.html
    instead of
      http://schema.koha-community.org/tables/table.html
    
    To have a specific schema per Koha version.
    
    To avoid fixing this link every release this patch adds a __VERSION__
    marker to replace with the $version if stable ($version % 2) or 'master'
    
    Test plan:
    On master, 16.11.x and 16.05.x
    Search for PatronSelfRegistrationBorrowerUnwantedField,
    BorrowerMandatoryField and UniqueItemFields
    Click on the link
    You should get the correct page
    
    This patch WILL NOT WORK on 3.22.x
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1ce61ac6a372783b39a11386018e08d92ccd8f39
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Sat Feb 18 23:06:16 2017 -0500

    Bug 18111: Swap framework_name and frameworkcode
    
    With the frameworkcode changed to an empty string, which really
    is closer to the physical reality, some javascript somewhere
    breaks. This means the spinner does not appear when you confirm
    that you wish to import it.
    
    TEST PLAN
    ----------
    1) apply first patch
    2) export default framework, doesn't matter format
    3) import default framework using that file.
    4) answer yes or whatever it is.
       -- spinner does not appear.
    5) apply this patch
    6) import default framework use the same file.
    7) answer yes or whatever it is.
       -- spinner does appear.
    8) decide if you wish to find and fix the javascript conditions.
       if yes -- do so, and then obsolete this once you have.
       if not -- sign this off after running koha qa test tools
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c12aa9664ca71b38a0b570c71cbc0495ecfb9c0f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 14 16:21:45 2017 +0000

    Bug 18111: Fix import of default framework
    
    Caused by bug 16035.
    
    Recreate the issue:
    Go to Home › Administration › MARC frameworks
    For the default framework: Actions > import
    It will not work
    
    Test plan:
    Confirm test plans from bug 16035 and bug 17389 still pass
    Confirm that the import for the default framework now works
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 830786aba7084698c081a3f7745fe0fe54643c18
Author: Magnus Enger <magnus@libriotech.no>
Date:   Tue Oct 18 09:47:19 2016 +0000

    Bug 17461: Warn about plugins that can't be loaded
    
    The logs should have some info if a module has been installed that can
    not be loaded.
    
    To test:
    - Make sure you have an up to date dev install
    - Install v1.0 of the KitchenSink plugin from
      https://github.com/bywatersolutions/koha-plugin-kitchen-sink/releases
    - Make sure the plugin does not show up in the list of installed
      plugins, and that the intranet-error.log has no info about it
    - Apply the patch
    - Reload plugins-home.pl
    - Verify that there is now some interesting info in intranet-error.log
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    Works as advertised, generates useful diagnostic information in the form of a log entry to either intranet-error or plack-error.log. Relief, thanks Magnus!
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d64e4707ff55ef157be22fcda0d81e9fda14aaaa
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 17 17:17:12 2017 +0000

    Bug 17453 - DBRev 16.12.00.009
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 042912ab68d40eed06ee112863b616152d54a1e4
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Feb 15 20:13:14 2017 +0000

    Bug 17453 (QA Followup)
    
        Add line break before note message
    
    https://bugs.koha-community.org/show_bug.cgi?id=14753
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 61c752a98b81fcbb2304ad38dc09df12a5daaf87
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 10 08:54:39 2017 +0100

    Bug 17453: Take into account items that are lost or damaged
    
    If all the items are either lost, damaged or checked out, then pickup
    should be allowed.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=14753
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6c02e5f8dbaf26ed0ac37c896cadc111161f9870
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 9 18:46:38 2017 +0100

    Bug 17453: Add a visible notification to patron to explain why the hold locations are disabled
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=14753
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0d55faa9a9f195b4380bce768357cde1acd719d4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 31 11:16:05 2016 +0000

    Bug 17453: Allow pickup at a library where all items are checked out
    
    If all items are checked out then it should be possible to select the pickup
    library for that record.
    
    Signed-off-by: Janet McGowan <janet.mcgowan@ptfs-europe.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=14753
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d1d12fc770c2d6b9a8a2fa62c7162c74229cc190
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 24 09:02:19 2016 +0000

    Bug 17453: Add exceptions
    
    This patch adds the ability to define patron categories not affected by
    the behavior of OPACHoldsIfAvailableAtPickup.
    The new pref OPACHoldsIfAvailableAtPickupExceptions get a list of patron
    categories (separated by pipes |).
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=14753
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 00c5929c1a6c267ec782d620c867f24749cc122a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 18 14:02:58 2016 +0100

    Bug 17453: Inter-site holds improvement
    
    At the moment users can reserve items and choose any library as a pick up
    location, but there is no mechanism to prevent users from reserving items that
    are available on the shelf at any given location from reserving the item at the
    same location, essentially creating a Fetch and Collect scenario.
    This has an impact on staff workloads as they are having to process reservations
    and check shelves for items that students can already come and collect from the
    open library shelves.
    The aim of this enhancement is to decrease the impact on staff workload there
    should be a restriction in place that prevents users from requesting items for
    collection at a library where the item is currently available.
    
    Implementation:
    We first tried to add a new circulation rule adding a 4th
    “NotIfAvailableAtPickupLibrary” option to "On shelf holds allowed".
    That would make the development more flexible.
    But in that case we quickly faced non-trivial problematics:
    Let's say you have 3 items I1, I2 and I3. The first one has onshelfholds
    set to Yes and 2 others has it set to “NotIfAvailableAtPickupLibrary”.
    What would be the expected behavior if a hold is placed at biblio level?
    And if a hold is placed at item level for I1?
    This second point could be answered by reworking the interface to move
    the libraries dropdown list elsewhere (1 list per item) or by adding a
    lot of JS code to handle the different situation. But it would be
    much more complicated to implement.
    So finally I moved back to the simple approach and added a new pref to
    handle the behavior globally.
    
    Test plan:
    0/ Switch off OPACHoldsIfAvailableAtPickup
    1/ Let's say you have 3 libraries L1, L2, L3, create 2 items owned by L1
    and L2
    2/ Place a biblio level hold. You should only be able to pick it up at
    L3
    2/ Place a item level hold. You should only be able to pick it up at
    L3
    3/ Create a third items owned by L3
    4/ Now you should not be able to place a hold on this record anymore
    
    Sponsored-by: University of the Arts London
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=14753
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eb26c85b13f0db04693bea5161446ec060ad2016
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 18 13:06:55 2016 +0100

    Bug 17453: Add pref OPACHoldsIfAvailableAtPickup
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=14753

commit 856d7a66230ce6df2770b844d33689380cf7f325
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 14 13:42:41 2017 +0100

    Bug 14405: Remove pagination type, there is no pagination at the OPAC
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c98acf87738aea9588f8a425a85ec20201e93820
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 2 04:16:53 2017 +0000

    Bug 14405: Add datatables to fines table in OPAC
    
    To test:
    1) Apply patch
    2) Go to OPAC -> Your account
    3) Confirm you can now sort on all columns
    
    Sponsored-by: Catalyst IT
    
    NOTE: NICE!
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 056b16ead75e09fd260361b0068866154b07e1a0
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 2 23:30:43 2017 +0000

    Bug 11932: Move delete checkbox on patron modification to right
    
    To test:
    1) Go to Tools -> Batch patron modification
    2) Put in a user cardnumber and click Continue
    3) Notice checkboxes on the left of the input fields
    4) Apply patch and refresh page (resend information if prompted)
    5) Notice checkboxes on the right of the input fields
    6) Confirm they still work as expected
    
    Sponsored-by: Catalyst IT
    
    NOTE: Why not left before the label? And while functional,
          is there a pretty align it nicely with all the other
          checkboxes CSS styling somehow?
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 78720b20a28bfc7ad5ef40d87ce7e429b4c983d4
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Feb 15 00:03:28 2017 +0000

    Bug 7626: Delete multiple tags in OPAC at once
    
    This patch removes the individual 'Delete' buttons for every tag as
    suggested in Comment 0. It adds a checkbox to every tag, with a 'Delete
    selected tags' button at the bottom of the table. This patch also adds a
    function to check if any checkboxes have been checked before submitting
    the form (only works with JS enabled).
    
    To test:
    1) Find a record in the OPAC and add some tags to it
    2) Go to your tags and notice the checkboxes, no more delete buttons for
    each tag
    3) Click 'Delete selected tags' button without selecting any tags
    4) Confirm alert shows up. Click OK
    5) Select one or more tags and click 'Delete selected tags' button
    6) Confirm delete is successful and correct number of deleted tags shows
    up
    
    Sponsored-by: Catalyst IT
    
    Followed test plan, works as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 95525f527b8837620ffad1c72344d2218de2a57e
Author: David Cook <dcook@prosentient.com.au>
Date:   Mon Feb 13 16:39:41 2017 +1100

    Bug 18099 - Put call number in its own column on inventory screen
    
    TEST PLAN
    
    0) Apply patch
    
    1) Create an item with a call number in 952$o (e.g. ABC 123)
    2) Using the inventory tool, make sure you "Select items you want to check"
    which include that item (e.g. Item callnumber between: A and C)
    3) Click "Submit"
    4) The call number appears in the column marked "Call number"
    instead of appearing as [ABC 123] under the library in the
    "Library" column
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62cc2bc000b3eab4451965b117264de061b1d61d
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Feb 6 14:58:06 2017 +0100

    Bug 18063: Remove dead code from tools/manage-marc-import.tt
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1226d1f593014b426ab4cddbcc2cc505be413994
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 2 22:58:34 2017 +0000

    Bug 18040: Updating buttons in Tools -> Upload local cover image
    
    To test:
    1) Go to Tools -> Upload local cover image
    2) Select an image and click Upload file
    3) Notice Process images button looks different to Upload file button
    4) Apply patch and refresh page
    5) Follow steps 1-3 again and notice the changed styling of the buttons
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1c205a2ed5113b2be1f51a883eb4d3cb3d3a6425
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Feb 3 08:08:07 2017 +0100

    Bug 18036: [QA Follow-up] Descriptions and mock_preference
    
    Adjusted a few test descriptions.
    The test depends on template being set to prog. Made that explicit by
    adding a mock_preference. If you change the mock to bootstrap, this
    test will fail.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f5f8aa4a8832a9334c4518191839196e5966387f
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Feb 2 12:04:37 2017 -0500

    Bug 18036: All 4 cases tested
    
    Added theme, lang, and availablethemes tests for all 4 cases.
    Previously just availablethemes was tested.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    The warns from Mark's additional patch showed all four cases.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f7eca64f80f811bc4c276b668a8cdd6f378fedb8
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Feb 2 12:16:01 2017 -0500

    Bug 18036: Perlcritic improve t/db_dependent/Templates.t
    
    TEST PLAN
    ---------
    1) apply 17982
    2) perlcritic -3 t/db_dependent/Templates.t
       -- messages
    3) apply this patch
    4) perlcritic -3 t/db_dependent/Templates.t
       -- OK
    5) run koha qa test tools
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ad707d027482d5b926df59c1660bc4fdb7670c94
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 18:03:55 2017 +0100

    Bug 17968: Remove useless variable $item_format in C4::Overdues::parse_overdues_letter
    
    The variable $item_format is not used and should be removed from this
    subroutine.
    
    Moreover it the letter parameter, but it is never sent to this
    subroutine. letter_code is expected instead.
    
    Test plan:
    No test plan, just read the code and `git grep `
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e8420b5d80558a8a74f7f6a1421352dcad2c9c88
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Jan 23 22:32:39 2017 +0000

    Bug 17947: Searching my library first shows the branchcode by the search bar rather than branchname
    
    Test Plan
    1: Turn on SearchMyLibraryFirst and go into OPAC
    2: It should say Search (in <Branch Code> Only)
    3: Apply patch and refresh page. It should now say Search (in <Library Name> only)
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 86ec263b2d0994ecb53ff283ef246b529d4570e2
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Fri Jan 13 00:19:48 2017 +0000

    Bug 17895: 'Re-set' typo fix
    
    To test:
    1) Log into OPAC and go to change your password
    2) Enter current password incorrectly and click Submit changes
    3) Observe error message and typo 're-set'
    4) Apply patch and refresh page
    5) May be asked to resend data - if so, click Resend, if not, repeat
    step 2
    6) Observe error message and corrected spelling of 'reset'
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Caitlin Goodger <caitlingoodger.student@wegc.school.nz>
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d5446ed480283c37598a46271fea6c568e3919b2
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jan 4 16:11:03 2017 +0000

    Bug 17846: Remove get_infos_of declaration
    
    The function which was removed was still being exported.
    This removes it completely.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8c8b17b114f3a7248634c695a70defed36be7a7a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 4 12:39:18 2017 +0100

    Bug 17846: Remove C4::Koha::get_infos_of
    
    This subroutine does not longer make any senses. The call to
    get_infos_of can be replaced with $dbh->selectall_hashref.
    The third argument of this subroutine was never used.
    
    Test plan (for developer only):
    Compare the 2 codes and confirm that they are equivalent
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2877575ae0a515161b14fcaae41fdf3c66d210f1
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon Jan 9 14:53:11 2017 +0000

    Bug 17793: Follow up for identified missing changes
    
    I ran:
    $ git grep -l cat-search.inc | grep admin
    
    This means I believe the outstanding ones are
    (koha-tmpl/intranet-tmpl/prog/en/modules/):
    - admin/auth_subfields_structure.tt
    - admin/clone-rules.tt
    - admin/marc_subfields_structure.tt
    - admin/searchengine/elasticsearch/mappings.tt
    
    One other was recommended by Katrin in comment #9:
    - plugins/plugins-home.tt
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 16414374aa7e3e8cb6863943646ea57e8128be96
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Dec 19 22:56:12 2016 +0000

    Bug 17793: Make sysprefs search show on all Admin pages
    
    This patch is amended to use the sysprefs search on all Administration
    pages that do not have their own custom search.
    
    To test:
    1) Go to Administration
    2) Notice Catalogue search at the top - seems out of place.
    3) Apply patch and refresh page.
    4) Notice admin / sysprefs search now shows and is more appropriate.
    5) Confirm searching for sysprefs still works
    
    This patch affects the following pages:
    - admin-home.pl
    - audio_alerts.pl
    - authtypes.pl
    - auth_tag_structure.pl
    - authorised_values.pl
    - biblio_framework.pl
    - marctagstructure.pl
    - branch_transfer_limits.pl
    - branches.pl
    - checkmarc.pl
    - classsources.pl
    - columns_settings.pl
    - didyoumean.pl
    - edi_accounts.pl
    - edi_ean_accounts.pl
    - fieldmapping.pl
    - item_circulation_alerts.pl
    - items_search_fields.pl
    - items_search_field.pl
    - item_types.pl
    - koha2marklinks.pl
    - matching-rules.pl
    - oai_sets.pl
    - oai_set_mappings.pl
    - patron-attr-types.pl
    - smart-rules.pl
    - transport-cost-matrix.pl
    - sms_providers.pl
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b6de10944c768dcd80f85029c1a068d6b53a12f6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 24 10:48:31 2017 -0300

    Bug 17932: (followup) Tidy tests
    
    This patch makes the tests create its own data instead of searching the
    DB for a branchcode and a categorycode. It does so on each subtest,
    because there shouldn't be side effects between subtests.
    
    I also wrapped each subtest inside a transaction, for the same reason.
    
    To test:
    - Apply this patch
    - Run:
      $ prove t/db_dependent/Koha/Object.t
    => SUCCESS: Tests return green with this patch
    - Sign off :-D
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 02f781fee06cb9ce8df8940acc2e8833cb57644b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 24 10:41:00 2017 -0300

    Bug 17932: Unit tests
    
    This patch adds unit tests for the Koha::Object::TO_JSON function.
    It tests on top of Koha::Patron as Koha::Object needs to be
    instantiated.
    
    To test:
    - Apply the patch
    - Run:
      $ prove -v t/db_dependent/Koha/Object.t
    => SUCCESS: New tests for TO_JSON are run and return green.
    - Sign off :-D
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 39d090a8b6ecb2c97197f839a05c930a36ea6504
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 23 09:47:54 2017 -0300

    Bug 17932: (followup) Fix /patrons endpoint
    
    Bug 17927 introduced data type fixes on the /patrons endpoint (integer
    and boolean types got fixed). This led to the /patrons endpoint not to
    work because the underlying code didn't provide the right data.
    
    With the introduction of TO_JSON on Koha::Object(s) we now have a way to
    output the proper data types.
    
    This patch does so by:
    - Adding is_boolean => 1 to the relevant columns on the Borrower.pm
      schema file.
    - Tweaking the controller class for the /patrons endpoint so it doesn't
      use the $object(s)->unblessed call but just let the Mojo::JSON library
      pick out TO_JSON implementation instead on rendering the output.
    - It adds a new test for booleans.
    
    To test:
    - Have 17927 applied
    - Run:
      $ prove t/db_dependent/api/v1/patrons.t
    => FAIL: Tests fail [1]
    - Apply this patches
    - Run:
      $ prove t/db_dependent/api/v1/patrons.t
    => SUCCESS: Tests pass!
    - Sign off! :-D
    
    [1] It is self explanatory to just try the API using any of the
    available tools (I use HttpRequester on Firefox)
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 51f62ccb302e02b04ca608d382ce343ffd18726e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 18 15:37:42 2017 -0300

    Bug 17932: Add a TO_JSON method to Koha::Object(s)
    
    Bug 17927 fixes data types on the current REST endpoints. If you
    test those endpoints, you will notice trying to access them (for listing
    or retrieving single objects yields a data type error. Notably on
    booleans but also on integers.
    
    Integers fail due to https://rt.cpan.org/Ticket/Display.html?id=119904
    but it needs some global solution until there's a DBD::mysql release
    backported to the supported distros. There's the option to use
    http://search.cpan.org/~frew/DBIx-Class-Helpers-2.033002/lib/DBIx/Class/Helper/Row/NumifyGet.pm
    to get the integer columns fixed as a workaround:
    
     __PACKAGE__->add_columns(
        borrowernumber => {
            data_type         => 'integer',
            is_nullable       => 0,
            is_numeric        => 1,
        }
    );
    
    I didn't find bug reports related to this (maybe because we don't use
    warnings everywhere) But I don't think is worth going such a heavy
    overhead.
    
    A similar situation takes place for Boolean values. They need to be
    prepared for JSON output. This could have been done using DBIx filters
    as pointed out by Martin:
    
    __PACKAGE__->filter_column(
        lost => {
           filter_to_storage => sub { $_[1] ? 1 : 0 },
           filter_from_storage =>
                   sub { $_[1] ? Mojo::JSON->true :
                                 Mojo::JSON->false }
           }
    );
    
    but this could have other consequences that are worth exploring on
    another bug (i.e. it would mean we need to take care of every place
    where this boolean data is used/set needs to handle this data types
    nicely. Such would be the case if we were a Mojo-only app, but we
    aren't. We use Koha::Obect(s) in the whole app. Period.
    
    This patch adds the need to specify on the schema files, columns that
    are actually boolean, because we have no way to detect them for now
    (i.e. they are all tinyint, but we use tinyint for non-boolean stuff
     too).
    So if this patch is accepted, we would need to specify boolean columns
    like this:
    
    __PACKAGE__->add_columns(
        '+lost' => {
            is_boolean => 1
        }
    );
    
    This patch adds a TO_JSON method for Koha::Object(s) to be used for
    serializing Koha::Object-derived objects into JSON strings.
    
    To test it (as Koha::Object(s) need to be instantiated) I provide tests
    on top of the Koha::Patron(s) classes in the followup patches.
    
    [1] Yes, we use TINYINT(1) for booleans, but from DBIC's perspective
    there's no way to read the (1) in runtime.
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a3d2273b3516129eab774e95841a5cb61c8e4580
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 15 10:17:22 2016 +0000

    Bug 17627: Move C4::Koha::GetItemTypesByCategory to Koha::ItemTypes
    
    C4::Koha::GetItemTypesByCategory can be easily replaced with
    Koha::ItemTypes->search({ searchcategory => ? });
    
    So let's replace it where it is used.
    
    Test plan:
    Make sure this patch does not break the test plan of bug 10937
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f0e7a120ced84b4577f90d2e1879289c02b69bcd
Author: Remi Mayrand-Provencher <remi.mayrand-provencher@inLibro.com>
Date:   Wed Mar 9 11:48:31 2016 -0500

    Bug 16018: Merge.pl code cleanup
    
    Original patch from Remi Mayrand-Provencher.
    Amended by Marcel de Rooy (January 2017), part of omnibus bug 17908.
    
    EDIT:
    We cannot remove the ModAuthority call, since the reference record is
    the result of the merge and should be saved.
    Variable $overwrite is not used and can be removed.
    
    It is not useful to postpone a merge to the cron job here, since the
    old authority record is deleted. (Note that bug 9988 will address this
    subject too.)
    
    Removing the call to C4::ImportBatch::SetImportRecordStatus: Since
    $recordid2 is not an import_record_id, this is useless and potentially wrong.
    Removed the if statement for @errors, since it is not used at this point;
    putting the result of a comparison into $error is not useful either.
    
    Note: there is a lot of code in merge.pl around breeding that is actually
    unused. Template tools/manage-marc-import.tt contains two unused blocks
    final_match_link and match_link that contain a (unreachable) call to
    authorities/merge.pl with parameters:
    mergereference=breeding&authid=[% record_lis.match_id %]&authid=[% record_lis.import_record_id %]
    It seems that this would show the records correctly, but would not merge
    them correctly since that code expects two authority records.
    
    Leaving the signoff of Mehdi since he essentially tested the merge call.
    
    Test plan:
    [1] Restart Plack and restart koha-indexer. (I had some problems related to
        indexing as a result of the marcxml transition.)
    [2] Go to Authorities.
        Select two authorities to merge, start with two of the same type.
        Make sure that both are used in a few biblio records.
        Select at least one subfield from the authority to be removed for
        inclusion in the authority to be kept ("reference record").
    [3] Click Merge. You come back to the kept authority record.
        Note: The number of attached records may not yet be updated. This depends
        on the speed of koha-indexer. If you wait a bit and refresh, you should
        have the correct number.
        First check the authority record again for the inserted subfield.
        Now check a biblio that was ALREADY attached to the reference record.
        And check a biblio that was FORMERLY attached to the deleted one.
        Note: See bug 17913 to see how pref AuthorityMergeMode impacts this.
    [4] Try steps 2 and 3 again for a merge of two authority records that do not
        have the same authority type noting the remarks below.
        For instance try to merge from a CORPO_NAME to a PERSO_NAME record.
        Make a change in say 040$a of the record to be deleted. And select that
        field later on the merge form.
        Normally, you would use the PERSO_NAME framework in the merge now.
        When checking the authority record, look at 040a. When checking the
        record that was linked to the CORPO_NAME, check if it contains the
        PERSO_NAME authority in the correct field (say 100, 600, 700).
    
    Signed-off-by: mehdi <mehdi@inlibro.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested merging PERSO_NAME to PERSO_NAME and PERSO_NAME to CORPO_NAME.
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c5901cad450e8a869e7b53347cc6dbf4604f7a90
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 16 14:07:05 2017 +0000

    Bug 16749: Add is_instance check to koha-upgrade-schema
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 70e709393db743b3c722b0c574adface1787e98f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 16 14:33:57 2017 +0100

    Bug 16749: Check instancename in adjust_paths_dev_install
    
    Check if the instance does not exist (or was not even passed).
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 43f56795c7b0d02a6263ae93975ee155b8d89043
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 16 12:57:17 2017 +0000

    Bug 16749: Use is_instance to make sure the dev instance exist
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2f6d26a93fd02b5f12e4219148a7bcfe102b5703
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 13 08:56:17 2017 +0100

    Bug 16749: Go with a boolean flag, we love booleans
    
    As requested by Jonathan on comment 10 on Bugzilla and supported by Tomas,
    we should use the dev_install entry in koha-conf as a boolean flag.
    Since we already used it as a path, this patch is not too strict about it.
    If the entry is not empty and not equal to "0", we will interpret it as
    a true value. The path is taken from the intranetdir entry.
    
    Test plan:
    [1] Copy debian/scripts/koha-functions.sh to /usr/share/koha/bin
    [2] For a dev install:
        Remove the dev install line, or toggle its value between empty string,
        0 or 1 and each time test stop/start koha-indexer.
        Check the path to rebuild_zebra with ps aux|grep indexer.
        If you have no entry, an empty entry or a zero, you should see a regular
        path.
        (Note: You can do something similar with koha-start-sip.)
    [3] For a regular install:
        Remove the dev install line.
        Stop/start koha-indexer or koha-plack, and verify that it still works.
        Add a dev_install line with 0, and repeat stop/start.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Tested in a package installation of master+16749
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 531ec010ca5dcdcdfe51267519c2029fbcf68442
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Sep 12 11:51:22 2016 +0200

    Bug 16749: Update debian docs for koha-translate
    
    This patch adds the -d option to the documentation (with thanks to
    Magnus Enger).
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Tested in a package installation of master+16749
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 306e2c5fa74af614496ac1ab31ff1316e2f54126
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jun 16 10:38:54 2016 +0200

    Bug 16749: Adjustments for koha-translate
    
    [AMENDED February 10, 2017]
    
    [1] Added reading /etc/default/koha-common as in the other debian scripts.
        We need it for KOHA_HOME.
    [2] Add a -d|--dev parameter for dev installs.
    [3] No hardcoded PERL5LIB or KOHA_INSTALL_DIR (KOHA_HOME).
        They are read from default file or set by adjust_paths_dev_install.
    [4] Adjust template paths for dev installs: OPAC_TMPL, INTRANET_TMPL.
    [5] Remove references to obsolete themes ccsr and prog.
    
    Test plan:
    [1] Regular package install:
        Copy koha-translate to /usr/sbin.
        Run koha-translate -l to show installed languages.
        Run koha-translate -l -a to show available languages.
        Add a language: koha-translate -i nl-NL.
        Check template folders in regular location (/usr/share/koha/...)
        Remove a language: koha-translate -r nl-NL. Check again.
    [2] Dev install or kohadevbox:
        Copy koha-translate to /usr/sbin.
        If needed, add the <dev_install> line to koha-conf.xml.
        Run koha-translate -l -d yourinstance to show installed languages.
        (Note: You only see the languages installed in this instance.)
        Add a language: koha-translate -i nl-NL -d yourinstance.
        Check template folders in the clone.
        Remove a language: koha-translate -r nl-NL -d yourinstance.
    
        Note: Make sure you have sufficient file permissions for the kohaclone
        files and koha-conf.xml. On kohadevbox you might need to run sudo
        koha-translate within the the vagrant user context.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested on Jessie (Debian VM and Kohadevbox)
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Tested in a package installation of master+16749
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 35fad66881f77b3f569f9081fdcbf04f6e1a8ed0
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Feb 10 10:33:57 2017 +0100

    Bug 16749: Adjustments for koha-plack
    
    [1] Use run_safe_xmlstarlet for plack workers and requests
    [2] Simplify adjust_paths. The lazy export statement is actually enough to
        replace adjust_paths by one direct call to adjust_paths_dev_install.
    
    Test plan:
    [1] Copy koha-functions.sh and koha-plack:
        cp [YOUR_PATH]/debian/scripts/koha-functions.sh /usr/share/koha/bin/
        cp [YOUR_PATH]/debian/scripts/koha-plack /usr/sbin/
        where YOUR_PATH might well be /home/vagrant/kohaclone.
    [2] Make sure that you have dev_install in koha-conf.
        Stop and start koha-plack. Verify with ps aux|grep plack.
    [3] Rename dev_install to nodev_install (in start and end tag).
        Now stop/start koha-plack. Verify with ps aux|grep plack.
    [4] Change plack_requests to 51 in your koha-conf.
        Restart Plack and check that you see 51 in ps aux|grep plack.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested on Jessie (Debian VM and Kohadevbox)
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Tested in a package installation of master+16749
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ecc98c37f7d8bcdc89f6d6af2042997fce5e42e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Feb 10 09:37:13 2017 +0100

    Bug 16749: Adjust xmlstarlet calls in koha-functions
    
    In various scripts we use xmlstarlet to extract values from koha-conf.
    If we call xmlstarlet on non-existing entries in koha-conf, this may
    however result in silently failing scripts (when set -e is in effect).
    
    A function run_safe_xmlstarlet is added for situations where the entry
    might not exist. It will not halt execution.
    
    This patch only adjusts koha-functions.sh and modifies the xmlstarlet calls
    for dev_install and zebra_loglevels.
    
    Note: The function does not need to check file existence. If the file does
    not exist, xmlstarlet warns about it; the function returns empty string,
    but does not set an error exit status.
    
    Test plan: See second patch ("koha-plack adjustments").
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Tested in a package installation of master+16749
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2b9662e0ca87f6344a8edb9093e06c811295df6c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 25 11:33:43 2017 +0100

    Bug 17990: Refactor Perl module versions check
    
    The code is duplicated, variable are not set ($_), code is hard to read,
    not covered by tests and the subroutine has 2 completely different
    behaviors depending on the presence of the "module" parameter.
    No need more ti rewrite it.
    
    Test plan:
    - Use koha_perl_deps.pl with the different options (-u -m -a -i)
    - Go on the about page, "Perl modules" tab
    
    You should not see any differences from before and after this patch
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87dacffdf3e3a2371720269af22a5de90d3f90fc
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Jan 23 22:41:15 2017 +0000

    Bug 17977: Add acquisitions sidebar menu to suggestions
    
    To test:
    1) Go to Acquisitions -> Suggestions
    2) Notice no acquisitions sidebar
    3) Apply patch and refresh page
    4) Sidebar menu should now show.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 236dbdf5f1922f98305df8b4c3aee040c0086b05
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Feb 16 11:04:11 2017 +0000

    Bug 17974 (QA Followup)
    
        Use the $biblio_rs variable
    
        In case of Koha::Object you can call new_from_dbic directly, however,
        it fails for Koha::Objects so using an intermediary variable should
        be done for consistency
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c614342f2743b1076b6a7a6740ea6586acf547ac
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jan 21 16:45:34 2017 +0100

    Bug 17974: Add the Koha::Item->biblio method
    
    Test plan:
      prove t/db_dependent/Koha/Items.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>

commit 2f763a96890bc469f3aaea8f3be6c1ccb3603c91
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jan 21 16:47:03 2017 +0100

    Bug 17973: Add the Koha::Checkout->item method
    
    Test plan:
      prove t/db_dependent/Koha/Checkouts.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6f3732ee7228890f9253bd79c96596d6b10ab141
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 17 12:10:15 2017 +0000

    Bug 5784 - Undo link in breadcrumbs
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bf2c0be829c6129fa860b01f60ef3da04d10ecc7
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jan 23 15:57:54 2017 +0000

    Bug 17972 - Reformat acquisitions sidebar menu with acquisitions and administration sections
    
    This patch makes changes to acquisitions-menu.inc so that the style
    matches that of the Administration and Tools sidebar menus. The links
    are now divided up between Acquisitions (/acqui/) and Administration
    (/admin/). The link-highlighting JavaScript used elsewhere has been
    added.
    
    To test, apply the patch and view the Acquisitions home page.
    
    - Check that the "Acquisitions home" link is highlighted (bold).
    - Test the other Acquisitions links to confirm that highlighting works.
    - Click any link in the Administration section of the sidebar menu.
    - Confirm that everything looks correct and works correctly.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a5ca6cf07028766169aececa3a19080a33548d62
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 16 14:46:26 2017 +0100

    Bug 17959 - Add the Koha::Notice::Message[s] packages (message_queue table)
    
    This just add Koha::Notice::Message[s] for later uses.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 286f2f4d4470e3c1ba3db876de1ae12bbc69c347
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 23 12:35:13 2017 +0100

    Bug 17958: Add tests for Koha::Notice::Template[s]
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 86cfae3e059c7782e0b16d2cb9276057f5a49fc1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 16 14:10:09 2017 +0100

    Bug 17958: Add Koha::Notice::Template[s] packages (letter table)
    
    This just add Koha::Letter[s] for later uses.
    
    Test plan:
      prove t/db_dependent/Koha/Notices.t
      should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4c8ac01a1d3f3334b03dfab1fd3d8fab27af3957
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 16 14:10:22 2017 +0100

    Bug 17962: Add Koha::Tmp::Order[s]
    
    These packages should not be used outside the TT syntax scope.
    A rewrite of Koha::Acquisition::Order[s] should be considered instead.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c6e0d42521fa6b62fd0f39d79e7acbbf3639d40a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 16 13:25:31 2017 +0100

    Bug 17962: TT syntax for notices - Prove that ACQ_NOTIF_ON_RECEIV is compatible
    
    To make ACQ_NOTIF_ON_RECEIV TT compatible, we need to expose data from
    the aqorders table. We already have a package for it in the Koha
    namespace but it is based on Koha::Object[s].
    The other path creates dummy Koha::Tmp::Order[s] packages to make it
    usable. Of course we should use a valid Koha::Acquisition::Order[s]
    based on Koha::Object, but it's outside the scope of this bug report.
    
    This notice template is quite simple, and it's a good one to start.
    From C4::Acq::NotifyOrderUsers, GetPreparedLetter is called with 4
    elements: the library, the patron to notify, the biblio and the order
    information.
    Note that prior to this patch aqorders was filled from GetOrder, which
    retrieved a lot of information from the acquisition table (aqbasket,
    aqbookseller). The idea with the TT syntax is to access the data from
    where it really exists. So if a user wants to display the basket name,
    [% order.basket.basketname %] should be used instead.
    Note that this will not work at the moment, the basket method is not
    defined in the order package.
    
    However the basic template should work as before.
    The test added to TemplateToolkit proves that.
    
    Test plan:
    Use the default ACQ_NOTIF_ON_RECEIV to notify a patron that an order has
    been received.
    That generated template should be exactly the same as prior to this
    patch.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 849877d8d3bcd3791c624a84ec5e4cb0550fa0fe
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jan 23 11:40:48 2017 +0100

    Bug 17950: Merge.t: Improve variable handling at top level
    
    This patch does:
    [1] Remove unused $dbh.
    [2] Move all mocking statements to one sub.
    [3] Promote a few lexicals to globals when used in the subtests.
    
    Test plan:
    Run t/db_dependent/Authorities/Merge.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5d279befed1b6faf829ab0ebd19357dbfc7c576e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jan 23 10:44:57 2017 +0100

    Bug 17950: Improve quick UNIMARC fix in Merge.t
    
    Bug 17909 and 17913 added a quick fix for Merge.t on UNIMARC records.
    This patch improves that fix with the sub compare_fields, a merge from
    compare_field_count and compare_field_order.
    Also it adds the option to test MARC21/UNIMARC by adding a command line
    switch that triggers mocking the marcflavour preference.
    The test on a cleared field 609 in strict mode has been broken up in two
    tests: first a count without 609 and then counting 609s only.
    
    Note: Could have mocked GetMarcBiblio too, but decided to go this way.
    
    Test plan:
    [1] Run perl t/db_dependent/Authorities/Merge.t
    [2] (For UNIMARC users:) Run perl Merge.t -flavour MARC21
    [3] (For others:) Run perl Merge.t -flavour UNIMARC
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit edfcb171ebe23869a63c3b5ef823096bb4fba7da
Author: Caitlin Goodger <caitlingoodger.student@wegc.school.nz>
Date:   Thu Jan 19 23:31:16 2017 +0000

    Bug 17948 Link to make a new list in masthead in OPAC does not take you straight to add form
    
    Test Form
    1: Go to OPAC and click on add new list.
    2: It takes you to Your Lists and not straight to add a new list
    3: Apply patch
    4: Refresh and when you click on new list it should take you straight to
    add a new list
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 40babe1a10b2a7bbe0bbcf06a0aab42c732f8751
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 14 01:12:43 2017 +0000

    Bug 14854: Add DataTables on upload results table
    
    This patch adds datatables to the upload results table.
    Tools -> Upload
    
    To test:
    1) Go to Tools -> Upload
    2) Put any search term in search box, click Search
    3) Confirm table shows as datatable and sorting works on all columns
    EXCEPT Actions
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d115602c9881371d38f3b1c4bda66e979984b218
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Feb 6 16:22:51 2017 -0300

    Bug 18068: ES - Fix location and (home|holding)branch facets
    
    This patch makes the 'Locations' facet work as expected (i.e. having the
    same behaviour it has for Zebra: picking the 952$c in MARC21 and 995e
    for UNIMARC).
    
    It also adds the code to handle holding and home library settings for
    facets and makes the facets show the library name instead of the branch
    code.
    
    The mappings are updated so the labels match what facets.inc expect to
    work properly.
    
    To test:
    - On master, do a search that returns biblios with items having
    homebranch set.
    => FAIL: Under the 'Locations' label on the facets you will notice
    branchcodes are shown.
    - Apply the patch
    - Restart memcached and plack (just in case, it was tricky)
    - Reset your mappings:
      http://localhost:8081/cgi-bin/koha/admin/searchengine/elasticsearch/mappings.pl?op=reset&i_know_what_i_am_doing=1
    - Restart memcached and plack (again, not sure if needed)
    - Make sure this mappings are set:
      homebranch => HomeLibrary
      holdingbranch => HoldingLibrary
      (Note: it might not be set due to the place the yaml file is being picked)
    - Reindex your records:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ perl misc/search_tools/rebuild_elastic_search.pl -d -v
    - Repeat the initial search
    => SUCCESS: 'Location' contains the right stuff, 'Home libraries' and
    'Holding libraries' too.
    - Run
     k$ prove t/db_dependent/Koha_SearchEngine_Elasticsearch_Search.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Note: play with the 'DisplayLibraryFacets' syspref options.
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 116301ae473075a6e183beb0027bd3657816b5e6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 2 01:09:38 2017 +0100

    Bug 18045: Fix Reserves.t tests - caching issues
    
    If the cache has to be cleaned when marc structure is updated.
    
    Before this patch, if the age restriction was not mapped, Reserves.t
    failed with:
      Tag "" is not a valid tag. at t/db_dependent/Reserves.t line 523.
    
    Test plan:
    Just confirm that the tests still pass and that the changes make sense.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    It seems that only removing the key MarcSubfieldStructure- should be
    enough, but it does not hurt either to remove those four keys.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c6e09ca3877ced4afb05ea27175c46aa134dc3b3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 17 10:59:22 2017 +0100

    Bug 18136: Fix ExportRemoveFields pre-fill behaviour
    
    Looks like it's caused by bug 13190.
    Variable export_remove_fields is not sent to the template, let's
    retrieve the syspref's value using the TT plugin.
    
    Test plan:
    Fill ExportRemoveFields with something (100a for instance)
    Go on a checkout list page
    At the bottom, the "do not export fields" input box should be pre-filled
    with the content of the syspref
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a471ad80bb70ed790cf7f544a45cdd3e61672ff4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 15 17:14:11 2017 +0000

    Bug 18025: Simplify logic and avoid 1 call to ValidateBorrowernumber
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    This is fine with me.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01f69eb8a258cead5f448c70e1efddc87a341299
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 15 17:13:41 2017 +0000

    Bug 18025: Fix test
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    Seems to work fine
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e87dab6411a40ae0eba3d56032760d705ef62eaf
Author: Liz Rea <liz@catalyst.net.nz>
Date:   Tue Jan 31 21:59:01 2017 +0000

    Bug 18025 - Expired password recovery links cause sql crash
    
    When a user gets an email, but doesn't act or visit it within two days,
         attempting to create a new one causes a collision. We should just
         delete the old one, assuming they still want to reset their
         password.
    
    To test:
    create yourself a borrower with a userid and password.
    Attempt a password recovery on the OPAC
    update the entry in the database for that user to have an expired token
    e.g. update borrower_password_recovery set valid_until = '2017-01-25
    03:25:26' where borrowernumber = 12;
    Attempt another password recovery operation - should error
    apply the patch
    Try it again - no error, new token is generated and additional email
    with new link is sent.
    
    Issue reproduced - is resolved by patch
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 745c4c3da662ac71874f9be8e88d111bc6fe8b1c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 11:20:33 2017 +0100

    Bug 17933: Do not instanciate a patron if not needed
    
    Signed-off-by: Dobrica Pavlinusic <dpavlin@rot13.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6ee62d4917481f77db26f858491266cb86d2252c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 11:13:36 2017 +0100

    Bug 17933: Add test and return unless defined dob
    
    Without this patch get_age return actually 0 instead of
    
    Signed-off-by: Dobrica Pavlinusic <dpavlin@rot13.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 083a8f7b7274bdf9e9547bee60366259374c1c20
Author: Dobrica Pavlinušić <dpavlin@rot13.org>
Date:   Wed Jan 18 17:12:30 2017 +0100

    Bug 17933 - Internal software error when searching patron without birth date
    
    When patrons don't have date of birth (which is not required) patron
    search results on moremember page produce internal server error since we
    can't convert MySQL invalid date 0000-00-00 to datetime object and
    call strfdate on it.
    
    Additionally, since we assign dates to template variables and after
    than assign whole $data hash to template, later assigment overrides
    previous one, so we see birth date field even for patrons which don't
    have one.
    
    This patch fixes both of those problems.
    
    Test:
    1. edit patron and remove it's birth date
    2. try to search for it, and verify server error
    3. apply patch
    4. repeat search for patron and verify that it works and doesn't
       have enpty birth date field
    
    Signed-off-by: Grace McKenzie <grace.mcky@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7698f6453c6c14b4986d573c33f0e49cd73652c6
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Feb 15 06:52:32 2017 +0000

    Bug 18119: Fix comment in cataloguing.js
    
    Test plan:
    Go to cataloging, and try something which depends on javascript -
    collapse/uncollapse fields, open authority search window, ...
        -> without patch it is not working
        -> with patch it is working correctly
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 762188646904156e4b1c12bb4d2e04a060674e59
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 15 08:11:41 2017 +0000

    Bug 17780: Add a comment to explain the line
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 444bdcc2a50c64037c0f463200683009d8ae0b6e
Author: Oleg Vasylenko <synapse.ova@gmail.com>
Date:   Tue Jan 24 17:58:39 2017 +0200

    Bug 17780 - When choose an author in authority results new window shows a blank screen
    
    Select2 (Bug 13501) introduced divs and inputs that broke some assumptions about the expected HTML structure.
    This patch checks if input has name attribute, because some inputs in Select2 have not.
    
    To test:
    Try to add info from the authorities to field that has subfield with Select2 (subfield with authorised values on Koha 16.11+)
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>

commit 2d427b25aa778c7eafbc67af066f849c32b7cf06
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 14 14:52:10 2017 +0000

    Bug 15503 (QA Followup)
    
    Fix tabs
    Dereference hash for each
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit aa2ecb58d5a298a705d8b783bfa8b57834296048
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jan 24 08:15:35 2017 -0800

    Bug 15503 - Populate the order prices
    
    Signed-off-by: Benjamin Daeuber <bdaeuber@cityoffargo.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9b13e062757f938b0c9bfc2e6a159e222ae41bec
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Mon Dec 12 16:11:08 2016 +0000

    Bug 15503 [QA Followup] - Use Koha::AuthorisedValues and fetch notforloan values.
    
    Signed-off-by: Benjamin Daeuber <bdaeuber@cityoffargo.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 73ec9a075a3a3d26bba21e75b58db48c90599b40
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Nov 3 10:44:56 2016 +0000

    Bug 15503 [QA Followup] - Set itype and ccode properly
    
    Signed-off-by: Benjamin Daeuber <bdaeuber@cityoffargo.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1d2001803cd0f2851bbd37b9664f2ed9569760dd
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Feb 14 15:01:24 2017 +0000

    Bug 15503 - DBRev 16.12.00.008
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 261747e477fa19c8cff3c689685f37a45bcc9e66
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Wed Oct 19 16:36:13 2016 +0200

    Bug 15503 [QA Followup] - Display "uneven number of fields" error only in relevant biblios
    
    Signed-off-by: Benjamin Daeuber <bdaeuber@cityoffargo.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 35076653a4c8161da981150b4f8d74111a2a87e3
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Thu Oct 20 11:47:27 2016 +0200

    Bug 15503 [Followup] - Add replacementprice and itemcallnumber
    
    Signed-off-by: Benjamin Daeuber <bdaeuber@cityoffargo.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7c4565428d85b08fa2f375c0ba56a160a4750d9c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 16 13:05:41 2016 +0000

    Bug 15503 [QA Followup] - Remove the use of GetBranchesLoop
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Benjamin Daeuber <bdaeuber@cityoffargo.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 78e539460fb1dcbc4daae47c312afd64d2d97040
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Wed Aug 31 11:13:33 2016 +0200

    Bug 15503 - Fix adding multiple items in multiple biblios.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Benjamin Daeuber <bdaeuber@cityoffargo.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>

commit 9ada51e6b4ea581104f7b55586ec4ed4a056d76c
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Tue Jun 28 15:06:46 2016 +0200

    Bug 15503: Grab Item Information from Order Files
    
    The goal of this development is to automatically generate items in Koha with
    populated information based on a 9XX field and subfield, with the new syspref
    MarcItemFieldsToOrder.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Benjamin Daeuber <bdaeuber@cityoffargo.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>

commit adca73545e75c31198e3d094512da7961460ed02
Author: Marc Véron <veron@veron.ch>
Date:   Fri Feb 10 16:07:13 2017 +0100

    Bug 18095: Batch item modification: Better message if no item is modified
    
    If no item is modified, the result page of Batch item modification says:
    "item(s) modified (with fields modified)."
    The message should be: "No items modified"
    
    To reproduce:
    - Go to Tools -> Batch item modification
    - Put a barcode in and click Continue
    - Do not make any changes and/or deselect all item(s)
    - Click "Save"
    => Result message reads: "item(s) modified (with fields modified)."
    
    To test:
    - Apply patch
    - Repeat steps above
    - Verify that message makes sense.
    
    NOTE: Also tested positive case with actual field change.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7704478836c42088519bb4a91833720d921bc890
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Jan 20 17:34:56 2017 +0000

    Bug 17935: Follow up for C4::Plugin...
    
    TEST PLAN
    ---------
    -- apply first patch
    git grep "C4::Plugin"
    -- still two references
    perldoc Koha::Plugins::Base
    perldoc Koha::Plugins::Handler
    
    -- apply this patch
    git grep "C4::Plugin"
    -- no references
    perldoc Koha::Plugins::Base
    perldoc Koha::Plugins::Handler
    -- should look fixed
    
     Please enter the commit message for your changes. Lines starting
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b4c66d5cc4be5ca555799a719ff07ffae5b2f45f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jan 18 16:56:16 2017 +0100

    Bug 17935: Adjust some POD lines, fix a few typos
    
    This patch does the following:
    
    [1] Move some POD lines from Cache to Caches.
    [2] Correct C4::Plugins to Koha::Plugins in POD line of Koha::Plugins
    [3] POD Koha/AuthorisedValue.pm: lib_opac moved to opac_description
    [4] The POD in Koha/Patron.pm uses head2 and head3 inconsistently.
        Ran s/^=head2/=head3/ on those lines (7 substitutions on 7 lines)
    [5] Correct a copied POD line from reports/issues_stats.pl in
        reports/reserve_stats.pl.
    [6] Correct a test description in t/db_dependent/Koha/Authorities.t.
        You should never delete the library :)
    [7] Correct typo shouild in a comment of rebuild_zebra.pl
    
    Test plan:
    [1] Read the patch. Does it make sense?
    [2] Run perldoc Koha/Cache.pm and Koha/Caches.pm
    [3] Run t/db_dependent/Koha/Authorities.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4bd2188affee568de81342d0af24fcf0239d9f01
Author: Chloe Alabaster <chloealabaster@gmail.com>
Date:   Thu Jan 21 03:20:58 2016 +0000

    Bug 15584 - Staff client list errors are incorrectly styled
    
    To Test-
    1. In the Staff Client, go to Lists
       (/cgi-bin/koha/virtualshelves/shelves.pl) and create a new list with
       the same name as an existing one. --note that it has some red in it
       like an error
    2. apply patch
    3. In the Staff Client, go to Lists
       (/cgi-bin/koha/virtualshelves/shelves.pl) and create a new list with
       the same name as an existing one. --note that now it should be just
       yellow with black writing as an alert
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit da3ccdc14379816ea849eeb56ab321d8e7db59a2
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 3 11:38:53 2017 +0000

    Bug 18047 - JavaScript error on item search form unless LOC defined
    
    If LOC is not present, the item search form will raise a JS error:
    SyntaxError: expected expression, got '}'
    
    This patch fixes it by handling this specific case.
    
    Note that the "Status" column is still displayed.
    
    Test plan:
    Remove your LOC authorised values
    Go on the item search form
    => You will not get the JS error and the "Shelving location" bloc is no longer
    displayed. There is no need to display it if empty.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 680e6ce7d1aa53e716ea9fdab9c67e621fb828e2
Author: Adrien Saurat <adrien.saurat@biblibre.com>
Date:   Thu Dec 13 10:13:19 2012 +0100

    Bug 8306: Patrons statistics, fix for patron activity choice
    
    The "inactive" for "patron activity" choice is now effective.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5c1daf010ec97ed405bf7825eaa8143c225252b1
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 24 16:39:28 2017 +0100

    Bug 17982: Fix the use of uniq in sub themelanguage
    
    Doing uniq( \@themes ) is useless. It will just return to you the only
    reference you gave it.
    List::MoreUtils::uniq requires a list instead of an arrayref.
    So it is a trivial fix that makes sub themelanguage return one theme instead
    of three themes like [ 'prog', 'prog',  'prog' ].
    Note that Template->new inserts one or two include paths to TT for each of
    these three identical themes.
    
    Test plan:
    [1] Run t/db_dependent/Templates.t (should no longer fail)
    [2] Run t/db_dependent/Auth.t (triggering themelanguage)
    [3] Open a page on OPAC or intranet. (Did you restart Plack?)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    EDIT (Marcel): Amended test plan for additional unit test.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 460c9b1b1594b8beebedbc28809fe47bc8d3313c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 2 08:40:58 2017 +0100

    Bug 17982: Expose wrong use of uniq
    
    This test should fail without the patch fixing the uniq calls.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2e315c0cc6f31991868b17276807f28cdcce4306
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 9 13:13:50 2017 +0100

    Bug 18089: Remove warnings from tests using DBIx::Class fixtures
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ed5cb5fc9727ca09deb392f4392c1aa35b4e47a5
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Feb 9 11:48:40 2017 +0000

    Bug 18089 - All XSLT testing singleBranchMode = 0 fails to show even if install has only 1 branch
    
    Due to the way it has been implemented, singleBranchMode is set to an
    empty string rather than 0 if there is only one branch. This causes any
    block that tests for singleBranchMOde to be 0 to never appear.
    
    Test Plan:
    1) Apply this patch set
    2) prove t/XSLT.t
    
    Signed-off-by: Jenny Schmidt <jschmidt@switchinc.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 99cc3bdd0ec676d29205fb09d1a4e4b1e8889df0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Feb 9 11:48:08 2017 +0000

    Bug 18089 - Unit test
    
    Signed-off-by: Jenny Schmidt <jschmidt@switchinc.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 543dc8e0365240441114359b7ddfa74863a318b6
Author: Zoe Schoeler <crazy.mental.onion@gmail.com>
Date:   Wed Jan 18 00:55:43 2017 +0000

    Bug 17838 Availability limit broken until an item has been checked out.
    
    TEST PLAN
    
    1. Make sure you have no items checked out.
    2. Run sudo koha-rebuild-zebra -f -v kohadev.
    3. Go to search the catalog and search.
    4. Check items availability and then click on limit to currently
    available items.
    5. This should return no results.
    6. Apply patch and reload.
    7. Results should show.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Attribute 14: " Specifies whether un-indexed fields should be ignored. A
    zero value (default) throws a diagnostic when an un-indexed field is
    specified. A non-zero value makes it return 0 hits."
    From http://www.indexdata.com/zebra/doc/querymodel-zebra.html
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bcd566c5f6a847d7b3f359af119bb8218f23bf77
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Feb 3 13:31:56 2017 +0100

    Bug 18014: QA follow-up: Use ok() instead of is() for '>' comparison
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ad38b24308df1cd3d451302d2ada3a4e59c45b62
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jan 30 15:19:35 2017 +0100

    Bug 18014: AddAuthority should respect AUTO_INCREMENT
    
    Instead of using the MAX(authid)+1 logic, AddAuthority should just save
    the record and get the new id. The authid column is an autoincrement.
    
    This eliminates problems where a newly assigned authid also refers to a
    previously deleted record. (And it will not cause problems when refining
    the dontmerge functionality on report 9988.)
    
    Note: ModAuthority also calls AddAuthority to update an existing record; in
    that case we should not create a new record even if the record should not
    be found any more (which should be exceptional).
    
    This patch also simplifies handling of 001 in the authority record: in all
    cases this field is updated now; no need to check its contents.
    
    Test plan:
    [1] Run t/db_dependent/AuthoritiesMarc.t
    [2] Add a new authority record via the interface
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 24ac8392b39ac82b528cb931e97c19c0e582fbf8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 31 09:11:05 2017 +0100

    Bug 18014: Add test to AuthoritiesMarc.t to expose problem in AddAuthority
    
    Since AddAuthority uses max(id)+1 logic to produce the next authid,
    authority id's will be reused when you delete the last record. This may
    be a source of problems and will be addressed on the next patch.
    
    This patch add a test to expose the problem.
    
    Test plan:
    [1] Run t/db_dependent/AuthoritiesMarc.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac004aa63ec4dfbb73329d150ef6b32ac8ea5e87
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 31 08:59:45 2017 +0100

    Bug 18014: General update of AuthoritiesMarc.t
    
    Modern::Perl, Koha::Database, etc.
    
    Test plan:
    Run t/db_dependent/AuthoritiesMarc.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dbada67196818834f158890c0c348c0259085f7e
Author: Magnus Enger <magnus@libriotech.no>
Date:   Thu Nov 10 14:32:44 2016 +0000

    Bug 4126 - Exit bulkmarcimport if -a and -b given
    
    Currently it is possible to spceify both --biblios and --authorities
    as command line switches to bulkmarcimport.pl. This does not make sense
    so we should exit early and explain that these switches are mutually
    exclusive.
    
    To test:
    - Run one of these and check that there is no complaint about missing
      options:
      perl misc/migration_tools/bulkmarcimport.pl -a -b
      sudo koha-shell -c "perl misc/migration_tools/bulkmarcimport.pl -a -b"
      kohadev
    - Observe that this displays the perldoc, but does not complain about
      mutually exclusive switches.
    - Apply the patch
    - Rerun the command(s) from earlier.
    - Verify that the script is now halted and a small explanation given.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit add15799229df7a1910d759f487c0006bf3f30ae
Author: Mason James <mtj@kohaaloha.com>
Date:   Sun Jan 29 00:47:20 2017 +1300

    Bug 18009 - IssueSlip.t test fails if launched between 00:00 and 00:59
    
    to test patch...
    
    1/ set date between 00:00 and 00:59
    $ sudo date -s 'Sun Jan 29 00:41:55 NZDT 2017'
    
    2/ run prove, see fail
    $ prove -v t/db_dependent/Members/IssueSlip.t
    ...
    t/db_dependent/Members/IssueSlip.t (Wstat: 65280 Tests: 1 Failed: 0)
    Result: FAIL
    
    3/ apply patch
    
    4/ run prove, see pass
    $ prove -v t/db_dependent/Members/IssueSlip.t
    ...
    All tests successful.
    Result: PASS
    
    NOTE: for code obscurity you could have also done a modulus 24. ;)
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 21d63c8fb0c2ae3a8ca7caaf0d4041b7189213c3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Sat Dec 17 09:25:54 2016 -0300

    Bug 17788: (MARC21) Add $9 fields to Koha-Auth-Number:w index
    
    Looking at the default framework's fields that are linked to authority
    records, there's a divergence with the Zebra index definitions.
    
    This yields to authority usage count be incorrect for users searching
    for authority records.
    
    MariaDB [koha_kohadev]> SELECT tagfield,tagsubfield,authtypecode FROM
    marc_subfield_structure WHERE authtypecode IS NOT NULL AND
    authtypecode<>'' AND frameworkcode='' GROUP BY
    tagfield,tagsubfield,authtypecode ;
    +----------+-------------+--------------+
    | tagfield | tagsubfield | authtypecode |
    +----------+-------------+--------------+
    | 100      | a           | PERSO_NAME   |
    | 110      | a           | CORPO_NAME   |
    | 111      | a           | MEETI_NAME   |
    | 130      | a           | UNIF_TITLE   |
    | 440      | a           | UNIF_TITLE   |
    | 600      | a           | PERSO_NAME   |
    | 610      | a           | CORPO_NAME   |
    | 611      | a           | MEETI_NAME   |
    | 630      | a           | UNIF_TITLE   |
    | 648      | a           | CHRON_TERM   |
    | 650      | a           | TOPIC_TERM   |
    | 651      | a           | GEOGR_NAME   |
    | 654      | a           | TOPIC_TERM   |
    | 655      | a           | GENRE/FORM   |
    | 656      | a           | TOPIC_TERM   |
    | 657      | a           | TOPIC_TERM   |
    | 658      | a           | TOPIC_TERM   |
    | 662      | a           | GEOGR_NAME   |
    | 690      | a           | TOPIC_TERM   |
    | 691      | a           | GEOGR_NAME   |
    | 696      | a           | PERSO_NAME   |
    | 697      | a           | CORPO_NAME   |
    | 698      | a           | MEETI_NAME   |
    | 699      | a           | UNIF_TITLE   |
    | 700      | a           | PERSO_NAME   |
    | 710      | a           | CORPO_NAME   |
    | 711      | a           | MEETI_NAME   |
    | 730      | a           | UNIF_TITLE   |
    | 796      | a           | PERSO_NAME   |
    | 797      | a           | CORPO_NAME   |
    | 798      | a           | MEETI_NAME   |
    | 799      | a           | UNIF_TITLE   |
    | 800      | a           | PERSO_NAME   |
    | 810      | a           | CORPO_NAME   |
    | 811      | a           | MEETI_NAME   |
    | 830      | a           | UNIF_TITLE   |
    | 896      | a           | PERSO_NAME   |
    | 897      | a           | CORPO_NAME   |
    | 898      | a           | MEETI_NAME   |
    | 899      | a           | UNIF_TITLE   |
    +----------+-------------+--------------+
    
    This patch adds the missing ones to the authority number index as it is
    done for the rest of the fields.
    
    To test:
    - Verify that
    etc/zebradb/marc_defs/marc21/biblios/biblio-koha-indexdefs.xml
    contains intries pointing the $9 subfield of all the fields in the
    'tagfield' column above, to the Koha-Auth-Number:w index.
    - Sign off :-D
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 137cbd8d09be549c9ae97dfad746a9c52d27b9a6
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Oct 27 15:07:29 2016 +0200

    Bug 17512: Improve handling dates in C4::Items
    
    This is a follow-up on the internal server error on 0000-00-00 in the items
    column onloan. This patch deals with preventing to have such dates at all
    in the date fields of items.
    
    It is accomplished by:
    [1] Adding a (private) subroutine _mod_item_dates. It takes an item hash
        and replaces date values if needed.
    [2] AddItem and ModItem call _koha_new_item resp. koha_modify_item. In these
        routines a call to the new _mod_item_dates is inserted.
    [3] Although the routine is actually private, I have added some unit tests
        to Items.t.
    
    Test plan:
    [1] Add a new item. Fill a correct date in dateaccessioned and an invalid
        date in Price effective from (=replacementpricedate).
    [2] Verify that dateaccessioned is saved correctly and replacementpricedate
        is still null (does not contain 0000-00-00).
    [3] Edit the item again. Fill some text in dateaccessioned and put a correct
        date in replacementpricedate. Verify the results.
    [4] Run t/db_dependent/Items.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e9cd82e4ca754024009608242d7c9930ac248cff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 2 10:28:21 2017 +0100

    Bug 17988: Add a comment to explain the line
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 317abac238147cf20f09d2aa0b0dc069c12b0892
Author: Oleg Vasylenko <synapse.ova@gmail.com>
Date:   Wed Jan 25 12:01:05 2017 +0200

    Bug 17988 - Select2 prevents correct tag expand/minimize functionality
    
    Overview:
    Select2 (Bug 13501) introduced divs and inputs that broke some assumptions about the expected HTML structure.
    Because of that, expanding fields to show all hidden subfields does not work properly.
    
    Steps to Reproduce:
    1. Open some book in the editor or create new (cataloguing/addbiblio.pl)
    2. Try to minimize or expand fields, that have among subfields the following:
            — Thesaurus driven subfield → subfield with Select2
            — Hidden subfield.
    
    Actual Results:
     — some fields become hidden, some not, and vice versa
     — in the console, you'll see «Uncaught TypeError: Cannot read property 'match' of null»
    
    Expected Results:
     — all subfields should minimize/maximize completely
    
    Additional Information:
    This happens because Select2 adds some divs, that do not have ID property.
    The following patch adds check for the needed attribute existance.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 908163754010df8d78acf463d6777ba2c4c3a2e9
Author: Emma Nakamura Smith <emma.nakamura.smith@gmail.com>
Date:   Wed Jan 18 21:37:23 2017 +0000

    Bug 17134: Replace item types codes with category in facets (opac)
    
    To test:
    -Search in OPAC for two or more items
    -Note that item types display category codes rather than names
    -Make change to file and test in OPAC
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ba89de5837bbe3055a8b0a04517332d8aee68da7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 22 09:35:07 2016 +0000

    Bug 16984: Do not clone the item block for standing orders
    
    If AcqCreateItem is set to ordering and the basket is marked as
    "standing orders", when ordering a JS error is raised:
    additem.js:176 Uncaught TypeError: window[events[i]] is not a function
    
    The item block should not be displayed in that case.
    
    Test plan:
    - Set AcqCreateItem to "ordering"
    - Create a basket and tick the "Standing orders" checkbox
    - Add an order to this basket
    => Without this patch you get the JS error
    => With this patch applied you will not get it
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ae2c1e6a83fab8b76606cc84a306b37d3b7403e4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 8 17:49:41 2017 +0100

    Bug 17940: (follow-up 14695) Fix - Mark holds as waiting when transfer is done
    
    When an item from Library A is reserved and set to be picked up at
    Library B, the hold buttons fail to confirm or cancel during check in at
    Library B when the item is transferred from Library A.
    
    Test plan:
    * Create a hold for item at Library A to be picked up at Library B.
    * Check in item at Library A to trigger the transfer.
    => item shows in transit
    * Switch to Library B and check in item.
    * Confirm the hold.
    => item shows waiting
    
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac99f64010c6bdbe40abc2b823c2180b9b223425
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 8 12:41:37 2017 +0100

    Bug 18076: Replace holds_to_place_count with an input type=text
    
    From http://www.template-toolkit.org/docs/manual/Directives.html#section_WHILE
    
    """
    The Template Toolkit uses a failsafe counter to prevent runaway WHILE loops which
     would otherwise never terminate. If the loop exceeds 1000 iterations then an undef
    exception will be thrown, reporting the error:
    
    WHILE loop terminated (> 1000 iterations)
    
    The $Template::Directive::WHILE_MAX variable controls this behaviour and can be set
    to a higher value if necessary.
    """
    
    I do not think we want to increase this value, and I do not think we want to display a
    dropdown list with 1000 entries.
    
    This patch replaces the dropdown list with an input text.
    
    Test plan:
    - Set circulation conditions - holds per record = 999
    - Search for record with items
    - Go to the holds tab
    - Search for a patron
    - Verify that when you send your search, the 'internal server error' is not shown
    and you see the input text.
    You should be able to enter a value > than 999 and < 1
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 95873bfa88d3f18350acdd3fea3d421083a59950
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Feb 8 08:49:46 2017 +0000

    Bug 18079: Holds to pull cleanup
    
    Changes made:
    
      - remove obsolete comment in pendingreserves.pl
      - use Modern::Perl in circ/pendingreserves.pl
      - get rid of unusable param run_report - followup for bug 8454
      - get rid of references to hold status - followup for bug 9320
      - remove unused data from SQL and reservedata structure
    
    Test plan:
    1) Apply patch from bug 18073
    2) Apply patch on this bug
    3) Enable on shelf hold in administration -> circulation and fines rules
    4) Create some holds on avalaible items
    5) Confirm that circulation -> holds to pull page works as expected
    6) Try to find any regression
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a1f348fe5cbdcc00194f4e0f4410ad71c57ad7b0
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Feb 9 13:09:56 2017 +0000

    Bug 18073: Followup - don't use CONCAT_WS
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3732e8dcb2899ff446aa9ec4e427dde544b79edb
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Feb 7 17:44:12 2017 +0100

    Bug 18073: Holds to pull table enhancement
    
    Test plan:
    0) apply the patch
    1) enable on shelf hold in administration -> circulation and fines rules
    2) create some holds on avalaible items
    3) go to administration -> columns settings and confirm there is new holds-to-pull table in circulation section
    4) go to circulation -> holds to pull page and confirm that
        4a) that the page does work as before
        4b) there is ne "Column visibility" button in datatable toolbar
        4c) the column configuration does work as expected
        4d) there is new column "First patron" with link to patron which is
            first in holds queue for given record
        4e) sorting works ax expected
        4f) filters (in teh bottom of table) work as expected
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Works nicely!
    
    https://bugs.koha-community.org/show_bug.cgi?id=18079
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>

commit 27a4149625252e4c28dc97df998d82fd6f2652b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jan 21 08:48:20 2017 +0100

    Bug 16115: Remove JS error on item search if NOT_LOAN values do not exist
    
    If NOT_LOAN is not present, the item search form will raise a JS error:
    SyntaxError: expected expression, got '}'
    
    This patch fixes it by handling this specific case.
    
    Note that the "Status" column is still displayed.
    
    Test plan:
    Remove your NOT_LOAN authorised values
    Go on the item search form
    => You will not get the JS error and the "Status" bloc is no longer
    displayed. There is no need to display it if empty.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6ce97d9b06843fa65d6fb4a6d7c8cecd322bc8d6
Author: Luke Honiss <luke.honiss@gmail.com>
Date:   Thu Jan 19 02:55:31 2017 +0000

    Bug 11450: Hold Request Confirm Deletion
    
    ==TEST PLAN==
    1) Go to an item with a hold and click on the holds tab on the
    left
    2) Click the red 'X'
    3) The hold will be deleted immediately
    4) Apply patch
    5) Return to an item with a hold and click the 'X'
    6) There will now be a confirmation dialog
    7) Click cancel and the dialog will disappear and the hold will not be
    deleted
    8) Click OK and the hold will be deleted
    
    Restored indentations - Mark Tompsett
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2f64fd3918a205ac21630657160f61200c791320
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Feb 3 15:57:42 2017 -0300

    Bug 17927: (QA followup) Fix timestamp nullable in hold.json
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 105b82b8461786ac6695e90aa8a2c1d4c36b4190
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 17 15:19:06 2017 -0300

    Bug 17927: (QA followup) Fix boolean types
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d628cd828d938e7c263faee2081ea8f4045b956b
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Nov 4 00:34:38 2016 +0000

    Bug 17927: (followup) Fix /cities cityid type
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9d805b5b5f6711bc6b5efcb846756c6763dabc07
Author: Lari Taskula <larit@student.uef.fi>
Date:   Tue Aug 16 13:37:29 2016 +0300

    Bug 17927: Fix /holds and /patrons data types
    
    This patch changes current Swagger definitions for patrons and holds to have
    data types corresponding to column data types in their database tables.
    
    To test:
    1. GET http://yourlibrary/api/v1/patrons/YYY where YYY is existing borrowernumber
    2. Observe that numbers / integers are in string data type.
    3. Apply this patch
    4. Repeat step 1.
    5. Observe that numbers / integers are now actually numbers / integers.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 185256deba961c2595ce934afbb910cf3ad952e0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 27 10:14:46 2017 +0100

    Bug 17782: Fix tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b68557148d17295557cae449e5617166950ac47f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jan 25 15:59:42 2017 +0000

    Bug 17782 - (QA Followup)
    
    Fix tests
    
    prove t/db_dependent/Koha/Patrons.t
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 92a4e0e5f36fd4c5c817db96f8206b3ad903436e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 15 14:17:55 2016 +0000

    Bug 17782 - Patron updated_on field should be set to current timestamp when borrower is deleted
    
    To test:
    01 Find a patron
    02 Get the updated_on value from the db in borrowers table
    03 Delete the patron
    04 Get the update_on value from the db on deletedborrowers table
    05 Values from 02 and 04 are the same
    06 Apply patch
    07 Repeat 01-04
    08 Values should now be different
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 21ac9fcdc2ca449a491cc79e68cc854ee248d911
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Mon Dec 12 16:49:44 2016 +0200

    Bug 16387: Fix default shortened loan period time
    
    When a loan period is shortened due to using decreaseLoanHighHolds* the time is
    always set to the current time in X days, even if the original loan period is
    given in days and not in hours.
    
    It should default to 23:59 as is normal for loan periods given in days.
    
    As original due date time defaults to 23:59 when given in days, this patch
    modifies the hours and minutes of shortened due date to be equal to original due
    date.
    
    To test:
    1. prove t/db_dependent/DecreaseLoanHighHolds.t
    
    Signed-off-by: Grace McKenzie <grace.mcky@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 18529d7cc5a6334e45d977da9ddfe5429f402c2b
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Jan 24 07:16:37 2017 +0000

    Bug 17929 - You can't edit indicators in the cataloging screen
    
    Test plan:
    0. Do not apply the patch
    1. Edit a biblio record, note you can't edit an indicator (in fact you edit it, but can't see the value)
    2. Edit an authority record, note you can't edit an indicator (in fact you edit it, but can't see the value)
    3. Apply the patch, you may need clear the browser cache (in Firefox Ctrl+F5 is often enough)
    4. Repeat steps 1 and 2 - but now you will be able to edit the indicator
    
    Signed-off-by: J Schmidt <jschmidt@switchinc.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 95e94766af653de4bc721af64981140cacecf567
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Jan 18 11:29:57 2017 +0100

    Bug 17922: Use correct number of digits when replacing date placeholders
    
    This patch also fixes a typo ("<<MM><" should be "<<MM>>")
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 844cf7a748c2b4f567bec2e5088665a9edf94468
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Mon Jan 30 15:59:59 2017 +0100

    Bug 18015 - On shelf holds allowed > "If all unavailable" ignores notforloan
    
    If in the circ rules matrix you set "On shelf holds allowed" to "If all unavailable",
    items with status "Not for loan" are considered available and break the functionality.
    
    Test plan:
    
    - Set "On shelf holds allowed" to "If all unavailable" for your patron and item
      category (or everyone and everything)
    - Have two items for a record. Check out one
    - Set 7 - Not for loan: "Not For Loan" for the second item
    - Try to place a hold. Does not work.
    
    - Apply the patch
    - Try to place a hold. Should work now.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 58e7a0a5d510de6a035329ea86a130996dda5849
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 24 08:34:44 2017 -0300

    Bug 17871: (followup) Remove zebra::* from the packages templates
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0eb5d8491ebbf44f213d0cbe05695521dafc6dd9
Author: David Cook <dcook@prosentient.com.au>
Date:   Tue Jan 10 12:36:25 2017 +1100

    Bug 17871: Remove zebra::snippet to allow access to facets in YAZ 5.8.1+
    
    This patch restores access to zebra facets (or zebra::snippet) with YAZ 5.8.1 or higher.
    
    It was failing due to The <retrieval syntax="xml" name="zebra::*" /> entry in
    retrieval-info-bib-dom.xml which IndexData said it wasn't even needed to
    get that access.
    
    Edit: I amended the commit message (tcohen)
    
    Signed-off-by: Colin Campbell <colin.campbell@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    I tested on kohadevbox and found no regression or behaviour change. I
    will provide a followup for the packages.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6495facedbccde81ca66a552de94d72ecb5b361e
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Jan 18 12:36:37 2017 +0000

    Bug 18005: Re-styled pagination on search results with Bootstrap
    
    Test plan:
    0. Don't apply path
    1. Make catalogue search in staff client with more then 20 results,
        scroll down to see that pagination is broken
    2. Apply the patch
    3. Make similar search and confirm, the pagination looks OK with new
    style
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 79c742303cf3e81acfd64c072cfd9567613c899c
Author: Dobrica Pavlinušić <dpavlin@rot13.org>
Date:   Mon Jan 30 13:02:36 2017 +0100

    Bug 18013 - acqui/transferorder.pl typo in find method
    
    This typo was introduced in Bug 13726 and has obvious fix
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 80a43833f89ea1f31753245cb2d6f20acb7216a4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 6 09:18:29 2017 +0100

    Bug 18044: Add a test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 544cf17d6f3279d95835ba42d40d49982e97f0a2
Author: Chris Nighswonger <cnighswonger@foundations.edu>
Date:   Sun Feb 5 16:11:30 2017 -0500

    Bug 18044: Label Batches not displaying
    
    SQL expects lists to be comma separated. A trailing comma must also
    be avoided.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4740438b41573d24c6e83d182e2ce1cf6fc54545
Author: Dobrica Pavlinušić <dpavlin@rot13.org>
Date:   Mon Jan 30 12:42:09 2017 +0100

    Bug 17775 - Add new user with LDAP not works under Plack
    
    This patch fixes internal server error:
    
    Undefined subroutine &C4::Auth_with_ldap::AddMember called at /srv/koha_ffzg/C4/Auth_with_ldap.pm line 213.
    
    It occurs only under plack, and it's strange since C4::Members
    does EXPORT AddMember and we are importing it into Auth_with_ldap.pm
    (and it does work under CGI).
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    I did not test but trust author and signoffer. The change cannot hurt.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eee1f23bc49d233bca6c8a8004dd6e79e2425484
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 12 12:28:38 2015 +0000

    Bug 15030: Add tests
    
    This test will prevent regression on the lost of data when
    items.itemcallnumber is linked with a plugin.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9f460de741902a3c35e4ecaef0275608fd2f4750
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Thu Oct 22 16:49:10 2015 -0400

    Bug 15030 - continue. The enumchron value was overwritten by 'header' even when value supplied
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1017edad1c27d2624fb8ed6f8fb0018985b33295
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Wed Oct 21 14:35:18 2015 -0400

    Bug 15030 - Fixes the serials fields associated with a plugin, to not overwrite the previously saved value
    
    This fixes the remaining fields from serials-edit.pl that were seeing their previously entered values
    be oblitarated with each new edit.  The fields associated to a plugin (dateaccessioned and barcode) were
    always displaying <empty> with each new edit, losing the previous effort.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4cdcdb3cb5ebefedcb44766745078a949227f0a5
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Mon Oct 19 12:16:05 2015 -0400

    Bug 15030 - Certain values in serials' items are lost on next edit
    
    When editing serials subscription, we can edit them but some values are not pulled from the DB correctly to be put in the edit box.  If not noticed, the value will be overwritten on the next save.
    
    Test:
    - Create a subscription
    - Edit itemcallnumber (952o?) and make sure to have a different value than the default one.
    - Save.
    - Edit it again
    - The saved value is not there.
    
    This is true for itemcallnumber and a few other fields.
    
    This was caused by calls to ->field($subfield).  This would always fail, of course.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4f178fad53fb748bd1ccf67680e02411918c9584
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Tue Jan 10 16:28:35 2017 +0200

    Bug 17255 - Upgrade Elastic Search code to work with version 5.1
    
    Builds on top of commit:
        Bug 17255 - Upgrade Elastic Search code to work with version 2.4+ - rebased wip
    
    -Fix data type 'string' to 'keyword' and 'text'
    -index: not_analyzed deprecated, replaced with type: keyword which is equivalent
    -store: yes was deprecated, use store: true
    
    TODO: Installer bindings to both the debian package install and the raw developer install.
    A taster in Buug 17851
    
    ZE TEST PLAN
    
    0. Remove existing ES and reinstall ES 5.1
       apt-get purge elasticsearch
       Follow instruction here:
       https://www.elastic.co/guide/en/elasticsearch/reference/current/deb.html
    
    1. Reset Elasticsearch index since facets are hard coded to dynamic search_marc_mappings.
    1a. perl -e 'use Koha::SearchEngine::Elasticsearch; Koha::SearchEngine::Elasticsearch->reset_elasticsearch_mappings();'
    1b. If you get trouble, simply DELETE FROM [search_fields|search_marc_to_fields|search_marc_mapping];
        and retry 1a.
    1c. Destroy elasticsearch index
        curl -XDELETE localhost:9200/koha_biblios
        so it can be recreated
    
    2. Recreate the index:
       perl misc/search_tools/rebuild_elastic_search.pl
    2a. Add something to index if your koha.biblio-table is empty
    
    3. Fetch all indexed records and the facet for subject__facet
    
    curl -XGET localhost:9200/koha_biblios/data/_search?pretty -d '{
      "aggregations": {
        "my_agg": {
          "terms": {
            "field": "subject__facet"
          }
        }
      }
    }'
    
    4. Run the included tests:
       perl t/db_dependent/Koha_Elasticsearch_Indexer.t
       perl t/db_dependent/Koha_Elasticsearch.t
       perl t/db_dependent/Koha_SearchEngine_Elasticsearch_Search.t
    
    Have fun with your new ES 5.1 cluster!
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d1077b5ae6aa5c375ef91e6150a7d39b60513325
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Mon Jan 9 18:17:48 2017 +0200

    Bug 17255 - Upgrade Elastic Search code to work with version 2.4+ - rebased wip
    
    -Changed deprecated facets to aggregations
    -Fixed boolean datatypes not allowing analyzers to be specified
    -Fixed deprecated '_id' to 'es_id'. Now the ES-index has the correct id==biblionumber
    
    ZE TEST PLAN
    
    1. Reset Zebra index since facets are hard coded to dynamic search_marc_mappings.
    2. perl misc/search_tools/rebuild_elastic_search.pl
    3. Fetch all indexed records and the facet for subject__facet
    
    curl -XGET localhost:9200/koha_biblios/data/_search?pretty -d '{
      "aggregations": {
        "my_agg": {
          "terms": {
            "field": "subject__facet"
          }
        }
      }
    }'
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0b2393cd655eb43e2d9893b40fb48abf1e786618
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Feb 1 20:48:49 2017 +0100

    Bug 18033: Remove duplicate code in paycollect.pl
    
    Test plan:
    0) apply the patch
    1) try to pay individual fee, with full amount and partial amount
       it should work the same as before patch
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6abf904bffbf433b26a6da904fec2b1800274c20
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Feb 6 17:43:47 2017 +0000

    Bug 17960 - DBRev 16.12.00.007
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2e9ae12aa4af4aed7725389ac2f54484838a1471
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 2 09:22:09 2017 +0100

    Bug 17960: Replace missing occurrences
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cbbe3619b90b747eb0fdb1eab7073eaf8a71a49a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 24 09:14:26 2017 +0100

    Bug 17960: Add opac_news.content values in tests
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 77c34a3d7790e67c61d70061ed139ec3c25f79b0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 16:54:50 2017 +0100

    Bug 17960: DBIC Schema changes for opac_news.content
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0031db5c172052296cb67dc50de59786ad1dc268
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 20 02:31:41 2017 +0100

    Bug 17960: Update installed files
    
      git grep opac_news.new installer
    should not return any occurrences in sql files
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a233f06574f5ca6417245cba58162af1360bf327
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 17 08:29:23 2017 +0100

    Bug 17960: Rename opac_news.new with opac_news.content
    
    The field opac_news.new is very confusing and should be renamed.
    If you want to access it via Koha::NewsItem you will have trouble:
    
      use Koha::News;
      my $news_item = Koha::News->next;
      say $news_item->new;
    
    => Attempt to bless into a reference at /home/vagrant/kohaclone/Koha/Object.pm line 78.
    
    This patchset is going to rename this DB field to opac_news_content instead.
    
    Since the opac_news.new can be used in notice templates, we need to warn the
    user during the update DB process that some templates must be updated.
    
    Test plan:
    0/ Apply the first patch "Add a test to highlight the issue" and confirm that
    the test fail
    1/ Apply this second patch
    2/ Execute the DB entry
    3/ Confirm that you get a warning if at least one of your notice templates is
    using opac_news.new
    4/ Confirm that the test new pass
    5/ Add/update and delete a news
    6/ Confirm that the RSS new feed still works as expected
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a6b13fbcb315d3749da23d494c11e4b6f9e70165
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jan 21 10:49:40 2017 +0100

    Bug 17960: Add a test to highlight the issue
    
    With only this patch applied, proving t/db_dependent/Koha/News.t
    will return
      "Attempt to bless into a reference at /home/vagrant/kohaclone/Koha/Object.pm line 78."
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af345984486a3e105c1e95111b885b7c907ca69a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Nov 10 19:53:30 2016 +0000

    Bug 17610 - Allow the number of plack workers and max connections to be set in koha-conf.xml
    
    It would be nice if we could control the number of workers and max
    requests on a per instance basis, rather than the numbers being
    hardcoded in the plack startup script.
    
    Test Plan:
    1) Build a new package of Koha with this patch applied ; )
    2) Verify koha-plack still works
    3) Add the following to the config section of your koha-conf.xml:
     <plack_max_requests>75</plack_max_requests>
     <plack_workers>4</plack_workers>
    4) Stop plack
    5) Start plack
    6) Verify the number of works and max requests worked!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Larry Baerveldt <larry@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Rebased against master and added a description for the new configuration
    entries
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 40cb8e3b7579987d0d461e8da6e350228722727c
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Jan 30 16:47:23 2017 +0100

    Bug 17902: Follow-up fixing SQL statement
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f42dbd67d1b960906fd2b98560e7e3724452bce9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 10 18:06:51 2017 +0100

    Bug 17902: Fix possible SQL injection in serials editing
    
    /cgi-bin/koha/serials/serials-edit.pl?serstatus=*/+,2,3,'2016-12-12','2016-12-12',6,'jjj7','jjj8'%20--%20-&subscriptionid=1+and+1%3d2+Union+all+select+111+/*
    
    The SQL query is not constructed correctly, placeholders must be used.
    Subscription id and status list can be provided by the user.
    
    This vulnerability has been reported by MDSec.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4dc7c32a3db11db2a3862e4979e62db23b2a208c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jan 30 12:12:08 2017 +0000

    Revert "Bug 17902: Fix possible SQL injection in serials editing"
    
    This reverts commit 904716f581102887c27d5bfc727430564cc12284.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 904716f581102887c27d5bfc727430564cc12284
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 10 18:06:51 2017 +0100

    Bug 17902: Fix possible SQL injection in serials editing
    
    /cgi-bin/koha/serials/serials-edit.pl?serstatus=*/+,2,3,'2016-12-12','2016-12-12',6,'jjj7','jjj8'%20--%20-&subscriptionid=1+and+1%3d2+Union+all+select+111+/*
    
    The SQL query is not constructed correctly, placeholders must be used.
    Subscription id and status list can be provided by the user.
    
    This vulnerability has been reported by MDSec.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e2d1bafa22f213658fc040d541534299c126bd1b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jan 30 11:52:56 2017 +0000

    Revert "Bug 17902: Fix possible SQL injection in serials editing"
    
    This reverts commit 8924439054fec94acabef6045f21369117e528f0.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8924439054fec94acabef6045f21369117e528f0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 10 18:06:51 2017 +0100

    Bug 17902: Fix possible SQL injection in serials editing
    
    /cgi-bin/koha/serials/serials-edit.pl?serstatus=*/+,2,3,'2016-12-12','2016-12-12',6,'jjj7','jjj8'%20--%20-&subscriptionid=1+and+1%3d2+Union+all+select+111+/*
    
    The SQL query is not constructed correctly, placeholders must be used.
    Subscription id and status list can be provided by the user.
    
    This vulnerability has been reported by MDSec.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 93cc0956a923e94663ae74d1f435604844536571
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 11:46:21 2017 +0100

    Bug 9569: Security patch for AutoLocation
    
    If a patron is not allowed to access the staff interface because its IP
    address in the authorised range of IPs, the cookie should not contain
    the CGISESSID.
    If it is, the patron is logged in and will be able to access the staff
    interface if he reload the page (or hit another one).
    
    Test plan:
    Confirm the that AutoLocation feature is now working as expected.
    
    Note: It seems that this feature has never really worked as intended.
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7afddcb157a8d8e27cfdee3cdbeb0eae483aa24c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 10:00:40 2017 +0100

    Bug 9569: Update warning message
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af0af36bb9a520c31c31067b9b68fd565eef0e63
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 16 14:01:40 2016 +0100

    Bug 9569: Do not check the IP for login at the OPAC
    
    At the OPAC, the AutoLocation feature should not be taken into account:
    login to the OPAC from outside the IP range should work
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 936b23e17a4b7d76d94be276ed1ceb9be8872299
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 16 13:56:25 2016 +0100

    Bug 9569: Remove unused occurrence of AutoLocation
    
    `git grep ManualLocation` does not return any results
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit acabdc87c9a883e36def78dcff6fccb4980d35ab
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 16 13:56:19 2016 +0100

    Bug 9569: AutoLocation should not depend on IndependentBranches
    
    Those 2 prefs can be independent and it does not make sense to consider
    AutoLocation only if IndependentBranches is set.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a8fdac38d8a1cf9e996195c5b04702d1d2eaa106
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 16 14:02:58 2016 +0100

    Bug 9569: Fix AutoLocation - handle .* for subnets
    
    The example in branches.tt is:
      Can be entered as a single IP, or a subnet such as 192.168.1.*
    
    But actually the regex in C4::Auth does not handle subnets.
    
    Test plan:
    0/ Apply all the patches
    1/ Switch AutoLocation on
    2/ Define a subnet (192.168.0.* if your ip is like 192.168.0.X) in the IP
    range of your library
    3/ Log in on the staff interface
    => Should work
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0c3c162f767f5587f5fad7375151f8efca3689b3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 13 16:19:45 2017 +0100

    Bug 17905: FIX CSRF in member-flags
    
    If an attacker can get an authenticated Koha user to visit their page
    with the url below, privilege escalation is possible
    
    The exploit can be simulated triggering
        /cgi-bin/koha/members/member-flags.pl?member=42&newflags=1&flag=superlibrarian
    
    Test plan:
    Trigger the url above
    => Without this patch, 42 is now superlibrarian
    => With this patch, you will get the "Wrong CSRF token" error.
    
    This vulnerability has been reported by MDSec.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b0bb1b0aa60071950a39b1c1b9e9ec145b304086
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 13 16:46:51 2017 +0100

    Bug 17904: Fix possible SQL injection in late orders
    
    To recreate:
    /cgi-bin/koha/acqui/lateorders.plop=send_alert&ordernumber=1)and%20(select*from(select(sleep(20)))a)--%20&letter_code=0
    
    Notice the delay.
    
    The SQL query is not constructed correctly, placeholders must be used.
    
    This vulnerability has been reported by MDSec.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 179ff58b0980f348821c727c2fa79a5eca310901
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 13 16:40:59 2017 +0100

    Bug 17903: Fix possible SQL injection in serial claims
    
    To recreate:
    /cgi-bin/koha/serials/claims.pl?serialid=1)and%20(select*from(select(sleep(20)))a)--%20&letter_code=0
    
    Notice the delay.
    
    The SQL query is not constructed correctly, placeholders must be used.
    
    This vulnerability has been reported by MDSec.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb4fa17a2712d04590d218635913bfe794510615
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 13 17:07:34 2017 +0100

    Bug 17901: Force context to scalar
    
    See bug 15809 for more references.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 45cffd874c62c7b090390c5fb3c955c31f524608
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 13 17:03:41 2017 +0100

    Bug 17901: Fix possible SQL injection in shelf editing
    
    It has been reported that
    /cgi-bin/koha/opac-shelves.pl?op=edit&referer=view&shelfnumber=146&owner=4&shelfname=testX&sortfield=titleaaaaaa\`&category=1
    
    Could lead to SQL injection
    Actually it explodes because the generated SQL query is not correctly formated.
    
    However it would be good to limit the possible values for sortfield.
    
    This vulnerability has been reported by MDSec.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 42460b871472d2a408bc38a747fd375062af4d7e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 27 10:01:42 2017 +0100

    Bug 17900: Update the tests to the new API
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a70980d8255a66c33539926796c06b29b26fbb40
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 13 17:43:25 2017 +0100

    Bug 17900: Fix possible SQL injection in patron cards template editing
    
    To recreate:
    /cgi-bin/koha/patroncards/edit-template.pl?op=edit&element_id=23%20and%201%3d2+union+all+select+1,user(),@@version+--%20
    
    Look at the Profile dropdown list.
    
    To fix this problem and to make sure it does not appears anywhere else
    in the label and patroncards modules, I have refactored the way the
    queries are built in C4::Creators::Lib
    Now all of the subroutine takes a hashref in parameters with a 'fields'
    and 'filters' parameters.
    From these 2 parameters the new internal subroutine _build_query will
    build the query and use placeholders.
    
    Test plan:
    1/ Make sure you do not recreate the vulnerability with this patch
    applied.
    2/ With decent data in the labels and patroncards modules, compare all
    the different view (undef the New and Manage button groups) with and
    without this patch applied.
    => You should not see any differences.
    
    This vulnerability has been reported by MDSec.
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ff78a9a0da486d7f267d1e252f3628ec1a5f149
Author: David Cook <dcook@prosentient.com.au>
Date:   Wed Jan 25 09:58:40 2017 +1100

    Bug 17986: Perl dependency evaluation incorrect
    
    It looks like I made a copy/paste error in a previous patch.
    
    While the fix was working when you pass the param "module" to
    version_info, it wasn't populating the version correctly
    for the "all" param, which causes koha_perl_deps.pl to
    think all OK modules actually need an upgrade.
    
    TEST PLAN
    
    0) Be on a system where you know your Koha Perl dependencies are
    mostly up-to-date
    
    1) Run ./koha_perl_deps.pl -a -c
    2) Note that most modules say they need an upgrade even when
    the installed version is the same as the minimum version
    
    3) Apply patch
    
    4) Run ./koha_perl_deps.pl -a -c
    5) Note that most moduls say they're OK, especially when the
    installed version is the same or greater than the minimum version
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Running koha_perl_deps.pl -u convinced me.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bcf9fdafabcddc9b50f874969bb6a84beecbacc3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 27 09:05:18 2016 +0100

    Bug 17588: ->get_issues has been replaced with ->checkouts
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 90f9a3c6aca2b767e11eed7114589b8144184bfb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 6 09:22:11 2016 +0100

    Bug 17588: get_account_lines->get_balance has been replace with account->balance
    
    On previous bugs
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 45cee0cec8684824d6e4e3cd83cd30b44c511c02
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 13:52:56 2016 +0000

    Bug 17588: Koha::Patrons - Move GetMemberIssuesAndFines
    
    The GetMemberIssuesAndFines subroutine used to retrieve the issues,
    overdues and fines for a given patron. Most of the time, only 1 or 2 of
    these values were used.
    This patch removes this subroutine and uses the new get_issues,
    get_overdues and get_balance method from Koha::Patron and Koha::Account::Lines.
    
    Test plan:
    1/ Add overdues, issues and fines to different patrons
    2/ On the checkout, checkin and patron search result and the patron
    detail pages, these 3 informations, if displayed before this patch, must be
    correctly displayed.
    3/ Use the batch patron deletion tool and make sure that patrons with a
    balance > 0 are not deleted
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 42bef19fe9794394ff89eb864fd656295b5e60df
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 28 18:19:34 2016 +0000

    Bug 17824: Remove C4::Members::GetBorrowersWhoHaveNeverBorrowed
    
    This subroutine is no longer in used and can be removed.
    
    Test plan:
      git grep GetBorrowersWhoHaveNeverBorrowed
    must not return any results
    
    NOTE: grep -i getborrowerswhohave `find . -type f`
          works well enough to find the cleanborrowers.pl too.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e429db4746f4ea53abe4e271afd6adb43b54c5d8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 10 17:11:08 2017 +0100

    Bug 17501: [Follow-up] QA Requests
    
    This patch makes the following changes, as requested by QA:
    
    [1] UploadedFile->delete always calls SUPER::delete.
        The return value normally comes from SUPER::delete; if removing the
        file failed, we return false. Two warns are kept.
        Since delete does no longer return the filename, a few changes were
        needed in tools/upload.pl.
    [2] Method getCategories is moved to UploadedFiles. Script tools/upload.pl
        now only contains one call. Added a use C4::Koha.
    [3] Calls UploadedFiles->delete as class method. As a result I removed
        method delete_errors for now; may be reconsidered on a new report.
    [4] Adjusted three ->search calls for id and public to ->find calls.
    [5] If you pass no id to upload.pl when deleting, you don't get an alert.
    
    All by all, we got rid of 15 lines !
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a118dd2ba09c62f4d30475636f4900232ef80132
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Nov 24 14:13:22 2016 +0100

    Bug 17501: Additional polishing (POD, unit tests)
    
    This patch adds some documentation lines.
    And mainly rearrangs the tests in Upload.t. The 'basic CRUD testing' is
    not needed separately any more. A new test catches the "file missing"
    warn.
    
    Test plan:
    [1] Run perldoc on UploadedFile[s].pm
    [2] Run t/db_dependent/Upload.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3acee793105f66ff0acc5b8879e3cbceb0fb2b54
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Nov 24 10:02:19 2016 +0100

    Bug 17501: Rename Upload to Uploader
    
    Why? Koha::Uploader now only contains the actual CGI upload. The new name
    better reflects its handler status.
    Pragmatically, the difference between Uploaded and Uploader makes it
    easier to specifically search for them in the codebase.
    
    Test plan:
    [1] Run t/db_dependent/Upload.t.
    [2] Add an upload via the interface.
    [3] Check the code:
        git grep "Koha::Upload;"
        git grep "Koha::Upload\->"
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ba5cd2455327c8eddc4c5e9c90642398b210a680
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Nov 24 09:27:23 2016 +0100

    Bug 17501: Move getCategories and httpheaders from Upload.pm
    
    Class method getCategories has no strict binding to Upload.pm. While
    Upload.pm is now restricted to the actual uploading process with CGI
    hook, this routine fits better in the UploadedFile package.
    
    Class method httpheaders can be moved as well for the same reason. Note
    that it actually is an instance method. The parameter $name is dropped.
    
    Test plan:
    [1] Run t/db_dependent/Upload.t.
    [2] Check the categories in the combo box of tools/upload.
    [3] Check a download via tools/upload and opac-retrieve-file.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 158442eb9e3658e22c54a3315caa57673e6940ab
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Nov 22 16:57:21 2016 +0100

    Bug 17501: Remove Koha::Upload::get from Koha::Upload
    
    The get routine actually returns records from uploaded_files. It should be
    possible to replace its calls by direct calls of Koha::UploadedFiles.
    
    This patch is the crux of this patch set. It deals with all scripts that
    use Koha::Upload.
    
    In the process we do:
    [1] Add a file_handle method to Koha::UploadedFile. This was previously
        arranged via the fh parameter of get.
    [2] Add a full_path method to UploadedFile. Previously returned in the
        path hash key of get. (Name is replaced by filename.)
    [3] Add a search_term method too (implementing get({ term => .. }).
        This logic came from _lookup.
    [4] Add a keep_file parameter to delete method. Only used in test now.
    
    Test plan:
    [1] Run t/db_dependent/Upload.t
    [2] Go to Tools/Upload. Add an upload, download and delete.
    [3] Add another public upload , search for it.
        Use the hashvalue to download via opac with URL:
            cgi-bin/koha/opac-retrieve-file.pl?id=[hashvalue]
    [4] Go to Tools/Stage MARC for import. Import a marc file.
    [5] Go to Tools/Upload local cover image. Import an image file.
        Enable OPACLocalCoverImages to see result.
    [6] Test uploading a offline circulation file:
        Enable AllowOfflineCirculation, and create a koc file (plain text):
        Line1: Version=1.0\tA=1\tB=2
        Line2: 2016-11-23 16:00:00 345\treturn\t[barcode]
        Note: Replace tabs and barcode. The number of tabs is essential!
        Checkout the item with your barcode.
        Go to Circulation/Offline circulation file upload.
        Upload and click Apply directly.
        Checkout again. Repeat Offline circulation file upload.
        Now click Add to offline circulation queue.
    [7] Connect the upload plugin to field 856$u.
        Enable HTML5MediaEnabled.
        Upload a webm file via the plugin. Click Choose to save the URL,
        and put 'video/webm' into 856$q. Save the biblio record.
        Check if you see the media tab with player on staff detail.
        (See also: Bug 17673 about empty OPACBaseURL.)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7a620054684e4ab0dfdbb5bd285a9c70928a7e14
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Nov 21 14:53:27 2016 +0100

    Bug 17501: Move Koha::Upload::delete to Koha::UploadedFile[s]
    
    Since delete is not part of the upload process, we will move it now
    to Koha::UploadedFile[s].
    Deleting the file will be done in UploadedFile.
    The (multiple) delete method in UploadedFiles refers to the single delete.
    
    Test plan:
    [1] Run t/db_dependent/Upload.t
        The warning ("but file was missing") in the last subtest is fine;
        the file did not exist. Will be addressed in a follow-up.
    [2] Search for uploads on Tools/Upload. Clone this tab (repeat search on
        a new tab in your browser).
    [3] Delete an existing upload on the first tab.
    [4] Try to delete it again on the second tab. Error message?
    [5] Bonus points:
        Add an upload. Mark the file immutable with chattr +i. Try to delete
        the file. You should see a "Could not be deleted"-message.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 42f0bdf9f1a3f14ca454fee93507d795f6da74c0
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Nov 21 14:12:17 2016 +0100

    Bug 17501: Use Koha::Object in Koha::Upload::_delete
    
    Note: This is the last occurrence where we use DBI to perform a CRUD
    operation. In this case a delete from uploaded_files.
    
    We now call Koha::UploadedFile[s]->delete to only delete the record
    from the table. A next step will be moving the additional functionality
    of removing the file(s) too.
    
    Test plan:
    [1] Run t/db_dependent/Upload.t
    [2] Delete an upload from tools/upload.pl
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4efe9e82cd75b48e3fc98646259d1744963402c2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Nov 21 08:48:02 2016 +0100

    Bug 17501: Use Koha::Object in Koha::Upload::_lookup
    
    The _lookup routine performs a few select statements on uploaded_files.
    In this patch the SQL statements are replaced with Koha::Object calls.
    One call of _lookup is replaced directly by Koha::UploadedFiles.
    
    Note: _lookup can be removed in a later stage.
    
    Test plan:
    [1] Run t/db_dependent/Upload.t
    [2] Upload a file in some upload category
    [3] Try to upload the same file into the same category. Error?
    [4] Try to upload the same file in another category. Should work.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 44c4b3fca6eff57dd88989309970fe9cebfb8b6e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Sun Nov 20 16:10:33 2016 +0100

    Bug 17501: Use Koha::Object in Koha::Upload::_register
    
    The _register routine basically inserts a new record in uploaded_files.
    It should use Koha::UploadedFile now.
    
    Test plan:
    [1] Run t/db_dependent/Upload.t
    [2] Upload a file via Tools/Upload.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 44d4dc70404e596648415f3db60ff7975e986281
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Sat Nov 19 17:24:11 2016 +0100

    Bug 17501: Introduce Koha::Object[s] classes for UploadedFile(s)
    
    In the next set of patches we will start using these new classes in
    Koha::Upload, and scripts using it.
    This is just the starting point of that migration.
    
    Test plan:
    [1] Run t/db_dependent/Upload.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 57568b9a0bf38706e41580e5a9e48777793c00ac
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Sep 12 12:22:05 2016 +0200

    Bug 16733: [Follow-up] Add $home to api path too
    
    In the meantime api was enabled in plack.psgi and needs a little tweak
    too for a dev install.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 08ece513cd202a8d4bd26002b5e72746f971adeb
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jun 15 14:08:28 2016 +0200

    Bug 16733: Adjust other debian scripts using PERL5LIB
    
    This patch makes the following changes:
    
    koha-foreach, koha-upgrade-schema (shell scripts):
    [1] Read default file
    [2] Include helper functions
    [3] Add call to adjust_paths_dev_install
    [4] Replace hardcoded path by $PERL5LIB
    
    koha-shell (perl script):
    [1] Remove hardcoded lib path
    [2] Add a sub that reads PERL5LIB from default or koha-conf, just as the
        shell scripts do.
    
    koha-plack (shell script), plack.psgi:
    [1] Add call to adjust_paths_dev_install
    [2] Remove hardcoded lib path
    [3] Add installer path to PERL5LIB, remove it from plack.pgsi
    
    koha-sitemap (shell script):
    [1] Add call to adjust_paths_dev_install
    [2] Remove hardcoded lib path
    [3] Add installer path to PERL5LIB
    [4] Adjust path for call to sitemap cron job
    
    koha-start-sip (shell script):
    [1] Read default file
    [2] Include helper functions
    [3] Add call to adjust_paths_dev_install
    [4] Adjust path to C4/SIP
    
    koha-stop-sip (shell script):
    [1] Remove KOHA_CONF and PERL5LIB (not needed to stop the daemon)
    [2] Same for paths in daemon client options
    
    NOTE: Script debian/scripts/koha-upgrade-to-3.4 has been left out
    intentionally.
    
    Test plan:
    [1] Regular install:
        Run koha-foreach echo Hi
        Run koha-upgrade-schema yourinstance
        Run koha-shell yourinstance
        If you have plack, run koha-plack --start|--stop yourinstance
        Run koha-sitemap --generate yourinstance
        Run koha-start-sip yourinstance
        Run koha-stop-sip yourinstance
    
    [2] Dev install [yourinstance] with <dev_install> in koha-conf.xml:
        Run koha-upgrade-schema yourinstance
        Run koha-shell yourinstance
        If you have plack: koha-plack --start|--stop yourinstance
        Run koha-sitemap --generate yourinstance
        Run koha-start-sip yourinstance
        Run koha-stop-sip yourinstance
    
    [3] Git grep on koha/lib
        You should no longer see occurrences in debian/scripts except:
        koha-translate: see report 16749
        koha-upgrade-to-3.4: left out intentionally
    
    [4] Git grep on koha/bin
        You should only see hits for lines with koha-functions in the
        debian scripts except:
        koha-upgrade-to-3.4: left out intentionally
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Most scripts tested on Wheezy (although it would not matter much).
    Plack script tested on Jessie.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2a7d595736d132dac5831f990bc17836d4d22bef
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jun 15 13:57:12 2016 +0200

    Bug 16733: Adjust koha-rebuild-zebra
    
    [1] Add a call to the new adjust_paths_dev_install
    [2] Differentiate location of rebuild_zebra.pl
    [3] Replace a hardcoded path by $PERL5LIB
    
    Test plan:
    Adjust a biblio record in package or dev install.
    Run koha-rebuild-zebra -b -z for same instance.
    Verify that the change has been indexed.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2fc1b469e223065d168a6e33a0a7c541a76a6ada
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jun 15 13:43:41 2016 +0200

    Bug 16733: Adjust koha-indexer
    
    [1] Add a call to the new adjust_paths_dev_install
    [2] Differentiate location of rebuild_zebra.pl
    
    NOTE: The scripts assume koha-functions.sh to be in /usr/share/koha/bin.
    Finding a better location for this shell library may be hard.
    
    Test plan:
    Run koha-indexer for a regular package install or a dev install.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 513618e627d90d7996267befe940ab850ef1fd62
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jun 14 16:00:58 2016 +0200

    Bug 16733: Add adjust_paths_dev_install to koha-functions.sh
    
    This new function checks koha-conf.xml for a given instance and if it
    contains a dev_install line, it adjusts PERL5LIB and KOHA_HOME
    accordingly. Otherwise it does not touch the values of these
    variables as normally read from /etc/default/koha-common.
    
    The function will be used in various debian scripts to allow for more
    flexibility with dev installs. And at the same time aiming to make better
    use of PERL5LIB and KOHA_HOME.
    
    Test plan:
    [1] Add <dev_install>/not/there</dev_install> to your koha-conf.xml.
    [2] Run on the command line:
            PERL5LIB=test
            source [path-to-your-instance]/debian/scripts/koha-functions.sh
            echo $PERL5LIB
            adjust_paths_dev_install [name-of-your-instance]
            echo $PERL5LIB
        The last echo should be: /not/there
    [3] Remove the <dev_install> line and repeat step 2.
        The last echo should be: test
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7d140258a051921d78f46ac1d9e9443cbcfbd51b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 28 13:51:17 2016 +0000

    Bug 7533: Add a warning to the about page if template_cache_dir is not set
    
    We need to tell the administrators that it would be great for them to
    set this config entry.
    
    Test plan:
    - Do not set template_cache_dir and confirm that you see the warning
    - Set template_cache_dir and confirm that you do not see the warning
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Both templates for koha-conf.xml are updated. After applying the
    patach a warning was correctly displayed. After adding
    template_cache_dir to koha-conf.xml and restarting memcached it
    went away.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 819cea62f222286b016941d8ba08da0996289668
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 28 13:49:59 2016 +0000

    Bug 7533: Add the template_cache_dir entry to koha-conf.xml
    
    And comment it, as we don't know what are the sysop's preferences
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit aaf6b6724f5c7c6e29433600d55b9f1e8836a77b
Author: Radek Šiman <radek.siman@centrum.cz>
Date:   Mon Oct 24 00:57:03 2016 +0200

    Bug 17487: Styling moved from style attribute into staff-global.css
    
    Test plan:
    1) Apply patch
    2) Display Z39.50 search dialogs:
       - cataloguing / new from Z39.50
       - authorities / new from Z39.50
       - acquisition / new from an external source
    3) Select all / Clear all should be placed below "Search targets" header
    4) [Optionally] Set some style in IntranetUserCSS for class z3950checks
    
    https://bugs.koha-community.org/show_bug.cgi?id=17487
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f05b2986da26717f70134b07020c509821aeb3f7
Author: Radek Šiman <radek.siman@centrum.cz>
Date:   Sun Oct 23 02:51:53 2016 +0200

    Bug 17487: Links to "select/clear all" moved below the header tag
    
    Test plan:
    1) Apply patch
    2) Display Z39.50 search dialogs:
       - cataloguing / new from Z39.50
       - authorities / new from Z39.50
       - acquisition / new from an external source
    3) Select all / Clear all should be placed below "Search targets" header
    
    https://bugs.koha-community.org/show_bug.cgi?id=17487
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1104e61635e2d567c89587c28fd9a24b4f262037
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jan 13 16:10:20 2017 +0100

    Bug 17899 - Show only mine does not work in newordersuggestion.pl
    
    Bug 12775 added a link "Show only mine" in newordersuggestion.pl.
    This does not work, no results.
    
    Also corrects the fact that click must not do default action by adding e.preventDefault().
    
    Test plan :
    - You must have suggestions you have accepted
    - Create a new order from suggestion : /cgi-bin/koha/acqui/newordersuggestion.pl
    - Click on Show only mine
    => Without patch the table is empty showing "No matching records found"
    => With patch you see only suggestions you have accpeted
    
    Signed-off-by: Zoe Schoeler <crazy.mental.onion@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7401d9422be26c5ff900269a10e70c9ca4364de6
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Jan 17 06:42:11 2017 +0000

    Bug 17920: t/db_dependent/Sitemapper.t fails because of permissions
    
    The directory it attempts to create an xml file may not be writable for
    the user running the test. By changing the directory from the current
    directory to a temporary one, the test runs. After all 'chmod 777
    t/db_dependent' is a bad idea.
    
    TEST PLAN
    ---------
    1) sudo koha-shell "prove t/db_dependent/Sitemapper.t" kohadev
       -- fails
    2) apply patch
    3) sudo koha-shell "prove t/db_dependent/Sitemapper.t" kohadev
       -- succeeds
    4) run koha qa test tools
    
    Tested without qa tools
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9fe4f3b2bac53afe4844a42ec71da0640aeaeb97
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jan 20 14:00:47 2017 +0000

    Bug 17813 - DBRev 16.12.00.006
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0f3ced357de22c3b46060a305d4dd80aacc72de4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 12 12:09:42 2017 -0300

    Bug 17813: (QA followup) Properly check DB structure before altering it
    
    This patch makes the atomic update use the new functions introduced by
    bug 17234 for checking the structure before attempting to call ALTER
    TABLE.
    
    It checks for the column existence, and also if it is a primary key.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 48d7667af9637c2369154f16bb540a77c14a5ba2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 23 15:57:54 2016 -0300

    Bug 17813: DBIC update
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb17720f47b34d5677b1e4c3245c084359358df0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 23 15:54:02 2016 -0300

    Bug 17813: Add a primary key to borrower_attributes
    
    This patch adds 'borrower_attributes' a field (if) which
    will act as a primary key.
    
    This is needed for DBIC to be used to handle rows, and also will help
    when faced with the implementation of the REST api for this resource.
    
    To test:
    - Run all patron modification / attributes and verify nothing breaks
    - Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 07626b3b6e12c62496e8b8e82c7077949c37a1b0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jan 20 13:58:52 2017 +0000

    Bug 17913 - DBRev 16.12.00.005
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5a9ffa92cecf69ec44450da9676cfbdb0f7d9fa1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 23 09:18:03 2016 +0000

    Bug 17808: Fix behavior when editing a circ rule
    
    The original behavior is broken, see https://stackoverflow.com/questions/21410484/jquery-selector-to-find-out-count-of-non-empty-inputs
    
    Test plan:
    Edit a circ rule
    => Without this patch you get a useless message
    => With this patch, no message
    Edit a circ rule with content in inputs
    => With or without this patch you get a useful message
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6ddd4b2f5f57c5cf30b240faaf4380b4256df783
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 20 13:51:29 2017 +0100

    Bug 17913: [Follow-up] Fix duplicate $9s after merging in loose mode
    
    We need to add $9 to the skip_subfields hash too. Formerly, it was
    added to $exclude as well.
    Thanks, Julian, for catching this one.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8fcf2d6e50091e542a87d62289c1dbb5f52da8b5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 20 12:54:56 2017 +0100

    Bug 17913: [Follow-up] Another small fix for UNIMARC
    
    Adding another delete for field 100.
    Will mock GetMarcBiblio on a new report.
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dd1c63230f7327bea6151962e92474acee38ab01
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 17 11:59:53 2017 +0100

    Bug 17913: Run perltidy on the inner foreach loop
    
    Kept the same number of lines.
    You could verify with diff -w.
    
    Test plan:
    [1] Run t/db_dependent/Authorities/Merge.t
    [2] As the last patch in this series, also test the interface:
        Set AuthorityMergeMode to loose. Set dontmerge to Do.
        Modify an authority record attached to multiple biblios.
        Edit a subfield, clear a subfield and add a subfield.
        Save. Wait a bit for the merge and Zebra update.
        Verify that the changes are merged properly into biblio records.
    [3] Repeat step 2 with AuthorityMergeMode to strict.
        Remember that this affects the extra subfields in biblio records.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 28b74224d34ca33415766155cec747d599195a6c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 17 11:37:55 2017 +0100

    Bug 17913: We always need some housekeeping
    
    Remove some commented warnings
    Remove the commented old code at the end of sub merge
    Explicitly set merge mode in the first subtest
    Move the return to loose mode from the second subtest to the third
    
    Test plan:
    Run t/db_dependent/Authorities/Merge.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ede08d725e56cd34bd2f1aa4ca87fa837cc01580
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 17 10:09:40 2017 +0100

    Bug 17913: Remove possible duplicates in strict merge mode
    
    Since strict mode does not allow additional subfields that would make
    identical fields linked to the same authority different, there is no
    need to keep them while merging.
    
    We achieve this goal by simply:
    [1] Count the number of same fields linked to mergefrom in strict mode to
        eliminate duplicates.
    [2] Replaces the if-statement on auth_number by a next. (Tidy follows.)
    
    Test plan:
    Run t/db_dependent/Authorities/Merge.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 681ae8430e60fd0c97ea0652b02ee3daf849ed5d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jan 17 09:32:44 2017 +0100

    Bug 17913: Do not keep a cleared subfield in loose merge mode
    
    If you modify an authority and clear a specific subfield, you expect that
    merge respects your edit and clears this subfield too in the biblio
    records. It does in the new strict mode, but it does not yet in the
    default loose mode.
    
    This patch fixes that by adjusting the code around $exclude so that it
    uses a new hash skip_subfields, built from the reporting tags from the old
    and the new authority record.
    
    This is supported again by some changes in the unit test.
    
    Test plan:
    Run t/db_dependent/Authorities/Merge.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8cde85451e3bae584ed1838efcaa4085cb656dfe
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jan 16 14:54:37 2017 +0100

    Bug 17913: Fix the new field tag in merge when changing type
    
    Originally aimed for 9988, adjusted for this report.
    
    Old behavior was: pick the first tag. This is definitely wrong.
    If you (would) merge 610 to 611, you don't want to get a 111.
    
    This patch resolves the problem by determining the new tag in a small
    helper routine _merge_newtag, and corrects the position of the new field
    in the MARC record with append_fields_ordered. Too bad that MARC::Record
    does not have such a function; it looks like insert_fields_ordered, but
    it is different in case of multiple fields with the same tag.
    
    Note: These two small helper functions are not tested separately, since they
    should not be called outside of merge. They are implicitly tested by the
    adjusted tests in Merge.t.
    
    Note: In adding tests for this fix, I chose to simplify compare_field_count
    (no need for the pass parameter), and replace the pass parameter of sub
    compare_field_order by an exclude parameter, a hash of fields to exclude in
    counting fields.
    
    Test plan:
    Run t/db_dependent/Authorities/Merge.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9290e10abee67fea6619ae6a1564fc96777274b4
Author: Maxime Beaulieu <maxime.beaulieu@inlibro.com>
Date:   Mon Aug 18 10:04:55 2014 -0400

    Bug 17913: Adjust merge test for AuthorityMergeMode
    
    Original fix from a patch on bug 11315.
    Amended by Marcel de Rooy January 2017.
    
    Test plan:
    Run t/db_dependent/Authorities/Merge.t in both loose and strict mode.
    Should no longer make a difference.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 79c81920abe7f6821d49834e71a5c1649f2f615e
Author: Frédérick Capovilla <frederick.capovilla@libeo.com>
Date:   Wed Nov 27 12:30:55 2013 -0500

    Bug 17913: Use AuthorityMergeMode pref in sub merge
    
    Original fix from a patch on bug 11315.
    Amended by Marcel de Rooy January 2017.
    
    Test plan:
    If you set mode to loose, the test will still pass.
    If you set mode to strict, one test will fail. (Fixed later.)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ffe1f6555ca420a3bf46cb42f180761f13f715f8
Author: Frédéric Demians <f.demians@tamil.fr>
Date:   Mon Jan 3 16:32:21 2011 +0200

    Bug 17913: Use replace_with instead of insert_grouped_field
    
    Original fix from a patch on bug 5572.
    Amended by Marcel de Rooy January 2017.
    
    Note: This does not yet resolve the field order when merging to another
    auth type, but is a good start.
    
    Test plan:
    Run t/db_dependent/Authorities/Merge.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f9a4204ce36f1cf268ab45c6fcc89c51bd4c0d37
Author: Frédéric Demians <f.demians@tamil.fr>
Date:   Mon Jan 3 16:32:21 2011 +0200

    Bug 17913: Add AuthorityMergeMode preference
    
    Original patch from bug 5572, dating back to 2011!
    Amended by Marcel de Rooy January 2017. Renamed the pref.
    
    The fix on this report is based on this preference.
    Depending on the pref, subfields will be deleted or kept.
    
    Test plan:
    Run the dbrev.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e3a12e517a9039fa93b8b57e0adedbad5f0e9153
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Jan 20 12:16:44 2017 +0100

    Bug 17909: QA followup: remove unused var and move global var
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9510b023300cfdd3a560d06b0bdb5944d43d3d5c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 20 11:29:30 2017 +0100

    Bug 17909: [Follow-up] Quick fix for UNIMARC
    
    UNIMARC inserts field 100. This interferes the field count and order
    in the test.
    Note: This is a quick fix. Will polish it after bug 17913.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b5a95937e695dec4a7ecbff6f65d795af9ee029b
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Mon Jan 16 13:03:21 2017 +0000

    Bug 17909: Followup - fix typos
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    EDIT:
    
    Adjusted three small typos that did not disturb the test in its current
    form, but do when we are fixing bugs on bug 17913.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4457d2e64c30f95fc79e306023e271ee7274b740
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jan 16 12:15:56 2017 +0100

    Bug 17909: Additional polishing
    
    No spectacular things:
    
    [1] Move the framework modifications to a sub. Use same style to create auth types and linked fields.
    [2] Change some new Object occurrences to Object->new.
    [3] Add tests for field count and field order in the first two subsets.
    [4] Few whitespace changes (sorry) and comment lines.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a7c2fc75054e81ca8909e05b6c2cfd6b9ba7293b
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jan 4 11:15:51 2017 +0100

    Bug 17909: Add tests for merging with another authtype
    
    Originally aimed for bug 9988. Adjusted in line with other subtests.
    Will polish the three subtests a little more on a follow-up.
    
    Test plan:
    Run t/db_dependent/Authorities/Merge.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b89be0d72fb24752bf5a2d939b15f90e6f23017d
Author: Maxime Beaulieu <maxime.beaulieu@inlibro.com>
Date:   Mon Aug 18 10:04:55 2014 -0400

    Bug 17909: Adding tests from bug 11315
    
    Based on original patch from Maxime Beaulieu on bug 11315.
    Amended by Marcel de Rooy on report 17909.
    
    EDIT:
    
    Original tests have been adjusted in view of:
    [1] Test on bug 11315 heavily leaned on DBD::Mock. Since we are
        using Test::DBIx::Class on such tests now, this would need attention.
        Moreover, the advantage of mocking the database in this case is at
        least arguable.
    [2] Matching the first (somewhat older) subtest of 11700.
    [3] Simplification and readability.
        Look e.g. at the use of $MARCto and $MARCfrom on 11315.
    
    This made me merge them in the db_dependent counterpart.
    
    Also note that this subtest adds another needed test case: the merge from
    auth1 to modified auth1, while 11700 tested auth1 to auth2.
    
    Test plan:
    Just run t/db_dependent/Authorities/Merge.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d4de65c21f4671b3fbbaf6d00904fe1753a8ae9a
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Feb 19 11:31:13 2014 +0100

    Bug 17909: Add unit tests for C4::AuthoritiesMarc::merge
    
    Original patch from Julian Maurice on bug 11700.
    With sign offs by:
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Amended by Marcel de Rooy on report 17909.
    
    EDIT (January 2017):
    Removed some tests not related to merge.
    Put remaining tests in a subtest, made them working on current merge.
    Slightly revised the mocking.
    
    Note: I plan to move the zebra retrieval stuff outside merge in one of
    the next stages, and replace it by calling Koha::SearchEngine. This will
    reduce mocking complexity here.
    
    Test plan:
    Just run t/db_dependent/Authorities/Merge.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b732963e2f91a54894f12cd5fd964c21e1c6f533
Author: David Cook <dcook@prosentient.com.au>
Date:   Thu Jan 12 11:15:22 2017 +1100

    Bug 17880 - Use version.pm to parse version numbers in C4::Installer::PerlModules
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2321ae0d796fa6b13cde8f321b6c697cc48a5437
Author: David Cook <dcook@prosentient.com.au>
Date:   Thu Jan 12 11:14:34 2017 +1100

    Bug 17880 - Add test to check version number comparison
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 71740f98a8c9d74e3d57e8ff51e1a9f806da89b6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 3 13:13:32 2017 -0300

    Bug 17836: (ILSDI) Regression test
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 13923e7b0598b09d21647558f42ca54c31abf470
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 3 13:14:25 2017 -0300

    Bug 17836: (ILSDI) Make GetPatronInfo fill 'charges' correctly
    
    This trivial fix corrects a typo on C4/ILSDI/Services.pm.
    It was hidden because the tests for ILSDI only cover the 'attributes'
    portion of the response. I added regression tests for this.
    
    To test:
    - Have the regression test patch applied
    - Run:
      $ prove t/db_dependent/ILSDI_Services.t
    => FAIL: Tests fail because 'charges' is always set to 1
    - Apply the patch
    - Run:
      $ prove t/db_dependent/ILSDI_Services.t
    => SUCCESS: Tests pass
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cd771f36867cab33ad74e47234eac5a7782ffab2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 23:58:59 2017 +0100

    Bug 17726: biblioitems.marc has been removed
    
    We will certainly have to do something with the biblio_metadata.metadata
    field later.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ddf1d9bcdde4790b713eca8040f0c9fce8fdcf6a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Dec 13 14:10:45 2016 +0100

    Bug 17726: [QA Follow-up] Add test descriptions
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 41358176e1d276e47d3034a37bd089b7e6c7e846
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 12 22:38:40 2016 +0000

    Bug 17726: TestBuilder - Add default values
    
    The items.more_subfields_xml is set to random data (generated by
    TestBuilder), and so GetMarcBiblio does not manage to embed items (if
    needed).
    
    The error is:
      :1: parser error : Start tag expected, '<' not found
    
    More precisely it explodes in
    C4::Items::_parse_unlinked_item_subfields_from_xml when
    MARC::Record->new_from_xml is called with an invalid xml
    
    This patch adds a default values mechanism to TestBuilder to avoid
    modifying all the existing calls.
    
    Test plan:
    Set SearchEngine to ElasticSearch
    prove t/db_dependent/Circulation.pl
    should return green with this patch
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 63f7cbc777521c33f8ada3e1068be01b98da9050
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jan 13 18:06:34 2017 +0000

    Bug 8361 (QA Followup) Add warnings
    
     - Added message to circulation.tt to warn if rule undefined for
    patron/itemtype combination
    
    To test:
    1 - Remove all circ rules
    2 - Add one rule
    3 - Checkout to patron an itemtype that is outside of rule
    defined above
    4 - Note explanation that no rule is defined
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 11dfb2e0b2d32c313f556b623ee8522b4342af26
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 22 11:23:23 2016 +0000

    Bug 8361: Do not allow checkouts if no rules are defined
    
    We should require a circulation rule to allow checkouts and reject them
    if no rules are defined.
    
    Test plan:
    - Delete all issuing rules
    - Check an item out
    => Without this patch the checkout is allowed
    => With this patch applied it is rejected
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 743dbe3e6423f51ae93477ef58a9d696661bf2cd
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Jan 19 00:38:52 2017 +0000

    Bug 17917: [AMENDED] Fix path issue in t/db_dependent/check_sysprefs.t
    
    EDIT (from Marcel):
    
    Previous patch fixes issue caused by Search.t.
    This patch still adds some small changes to check_sysprefs.t.
    
    Signed-off-by: Grace McKenzie <grace.mcky@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b5c2b6510761dad352c814d801cda47aa6161ae8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 20 10:11:47 2017 +0100

    Bug 17917: [QA Follow-up] Reprove Search.t
    
    The config tweaks from Search.t break check_sysprefs.t later on.
    Clearing the cache resolves that.
    
    Test plan:
    [1] Run prove t/db_dependent/Search.t t/db_dependent/check_sysprefs.t (in
        one statement) before and after applying this patch.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    A prove t/db_dependent did not fail check_sysprefs.t (only skipping two
    tests: 00-strict.t and Koha/IssuingRules.t; not enough patience)
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6d2ce70a479367530ef7973251e799e7be6f44db
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Jan 19 15:22:05 2017 +0000

    Bug 17615 - Fix unit tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e331a9c0d061f586f50db7ac27390417c74aec48
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Nov 16 10:37:48 2016 +0000

    Bug 17615 - Fix updating borrower attributes in checkpw_ldap
    
    Signed-off-by: Oliver Bock <oliver.bock@aei.mpg.de>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d379be5de02b60b55408b42394c2ff1dae0113c5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jan 19 10:56:30 2017 +0100

    Bug 7143: [QA Follow-up] Handling tabs
    
    Editing spaces before releases and developer:
    876,$s/  \+releases$/^Ireleases/ (20 substitutions)
    876,$s/  \+developer$/^Ideveloper/ (7 substitutions on 7 lines)
    
    Editing spaces between date and text:
    876,$s/2016  \+/2016^I/
    876,$s/2017  \+/2017^I/
    Fixed a few single spaces too.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Display on Timeline tab looks good now.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d7e01a8c33b480a9faef027397d04fde0d8e37e2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jan 19 10:41:23 2017 +0100

    Bug 7143: [QA Follow-up] Correcting dates for first patch pushed
    
    The date first patch pushed is not the date the patch was written. The
    Bugzilla reports tell us when the patch got actually pushed.
    Adjusting the developer numbers accordingly.
    Authors radiuscz and Radek Siman are actually the same person.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a9f883456bee020737e38004de3386d3f617c866
Author: Rebecca Blundell <rebecca.blundell@catalyst.net.nz>
Date:   Thu Jan 12 12:19:09 2017 +1300

    Bug 7143: Update about.tt with new devs
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5d333a80925473d3b9943f7de37cd8eb224263c8
Author: Rebecca Blundell <rebecca.blundell@catalyst.net.nz>
Date:   Thu Jan 12 10:35:17 2017 +1300

    Bug 7143: Update history file
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2ce4b1635d24179fb3d5b11459045d86b9cf977e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 14:32:56 2017 +0100

    Bug 17469: Fix number of values
    
    Will fix
      ERROR 1136 (21S01) at line 57: Column count doesn't match value count at row 2
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c7dc340d639bf53abc204c96d3ffc8154db16069
Author: Caitlin Goodger <caitlingoodger.student@wegc.school.nz>
Date:   Tue Jan 17 02:11:51 2017 +0000

    Bug 17469: Follow-up adding hold print notice
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b37b22a4fd7aa3f4a59a1c541aae2fcd5b9cbd1f
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Oct 20 00:10:52 2016 +0200

    Bug 17469: Add missing sample notices to fr-CA web installer
    
    Adds missing notices to the fr-CA web installer:
    - MEMBERSHIP_EXPIRY
    - PASSWORD_RESET
    Renames RESERVESLIP to HOLD_SLIP
    
    TEST PLAN
    ---------
    1) Apply the first patch
    2) prove xt/sample_notices.t
       -- it should fail for fr-CA.
    3) Apply the second patch
    4) prove xt/sample_notices.t
       -- it should pass.
    5) run all tests (prove t; prove xt)
       -- they should generally pass
    6) run koha qa test tools
    
    NOTE: Split test patch from fix patch, so could prove problem
          exists easily.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Caitlin Goodger <caitlingoodger.student@wegc.school.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3c09fefb1dd3c8728404ef641f95885e61a674f4
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Oct 20 00:10:52 2016 +0200

    Bug 17469: Add missing sample notices fr-CA test
    
    Add fr-CA installer to xt/sample_letter.t
    
    To test:
    - Verify xt/sample_letter.t test checks fr-CA now and
      fails for just fr-CA.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Caitlin Goodger <caitlingoodger.student@wegc.school.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e88c11b6ff86b3bb803d8a8fb51a81f3e862288b
Author: Grace McKenzie <grace.mcky@gmail.com>
Date:   Tue Jan 17 23:30:44 2017 +0000

    Bug 8266 - remove location from pulldown
    
    Found shelving location in html and removed
    
    To test
    - Go to the advanced search in the OPAC
    - Click on 'more options' (this changes the pull downs)
    - Check the pull downs with search options, there is now "shelving
    location"
    - Apply the patch
    - Refresh the page and notice the option is gone
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 88ce1db8fa04c539e3dfe9071cb74ec05c833759
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 14:26:49 2017 +0100

    Bug 17691: Does not repeat "subscriptions"
    
      Number of subscriptions: X subscriptions
    Sound like we repeat "subscriptions"
    Replaced with
      Number of subscriptions: X
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 59a3f2ddbe9825c62f4071bf7879028fba9726c1
Author: Grace McKenzie <grace.mcky@gmail.com>
Date:   Wed Jan 18 02:20:05 2017 +0000

    Bug 17691 - add serial subscription
    
    Adding some subscription information to the vendor page
    
    To test
    - Search for a vendor, access profile
    - Under Contact, Subscription details
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Fixed a missing </div>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>

commit 8fcfdf6853267d81f644e8f32f647dc192f5ab86
Author: Caitlin Goodger <caitlingoodger.student@wegc.school.nz>
Date:   Tue Jan 17 22:41:52 2017 +0000

    Bug 15460 Adding spaces after subfields c and h of 245
    
    Test Plan
    1: Add something inside c and h of 245 on a Bibliographic Record. There won't be a space between
    the c and h
    2: This will occur on both the search results and the details pages of
    the record in both the intranet and opac.
    3: Apply the patch
    4: Refresh and see that there is now a space between c and h.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7a2cbfba1f271d307045d867654ff0d7de939aa6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 6 15:37:50 2016 +0100

    Bug 17731: Remove noxml option from rebuild_zebra.pl
    
    The removal of the noxml is a logical follow-up of bug 16506 (which
    make xml the default).
    
    Actually this option should have been removed by bug 10455 (it removes
    the biblioitem.marc field).
    
    Test plan:
    Make sure the rebuild_zebra.pl script works as before.
    
    Signed-off-by: Emma Smith <emma.nakamura.smith@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 639489f48f5285ec7990a01b8e991719edf45af4
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Dec 8 12:28:53 2016 +0100

    Bug 17931: Remove unused vars from reserves_stats
    
    Change to Modern::Perl.
    Remove null_to_zzempty and add a few blank lines between subs.
    Remove unused vars: $podsp, $type, $daysel, $monthsel and $mime.
    Removing trailing 1;
    
    Test plan:
    Run a few reports from reports/reserves_stats.pl
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Emma Smith <emma.nakamura.smith@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Wrongly pasted from reports/issues_stats.pl initially
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 36a637974b6f17b083d3b19616c3b8cf5fa7e4c9
Author: Emma Nakamura Smith <emma.nakamura.smith@gmail.com>
Date:   Tue Jan 17 20:54:18 2017 +0000

    Bug 17891: Remove extra div tag in the housebound module
    
    This fixes the menu layout issue.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 16dcea233008c0560c5a9783a3e6dd60470b06b1
Author: Karen Jen <karenliang.student@wegc.school.nz>
Date:   Tue Jan 17 22:46:02 2017 +0000

    Bug 17823: Add label for MARC 583 - Action note
    
    test plan
    Edit a record
    Edit field 583a to add an action note
    Save the record and confirm that the note does not show up in staff
    client or opac
    Apply patch and refresh page
    Action note should now show up in staff client and opac
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b43b79156f179094ed16a896f0bf0b3d39b4af7d
Author: Magnus Enger <magnus@libriotech.no>
Date:   Tue Jan 17 14:50:49 2017 +0000

    Bug 17924 - Fix error in password recovery
    
    To test:
    
    - Set OpacResetPassword = allowed
    - Make sure you have a user with a username and email
    - Go to the OPAC and make sure you are not logged in
    - Click on the "Forgot your password?" link
    - Fill in "Login" and "Email" and click on "Submit"
    - You will get an error that says:
    
    Undefined subroutine &C4::Letters::GetPreparedLetter called at
    /home/vagrant/kohaclone/Koha/Patron/Password/Recovery.pm line 142.
    
    - Apply the patch
    - The steps above will have added your user to the borrower_password_recovery
      table in the database. Delete it from there to make sure you start a
      fresh reset request.
    - Repeat the steps above and notice that the error is gone. You should
      get a nice message instead that says "An email has been sent to [your
      email]".
    - Sign off
    
    Signed-off-by: Zoe Schoeler <crazy.mental.onion@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 17d5051e084c40f0896ed9d3c661e70161491379
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 19 12:03:44 2017 +0000

    Bug 5784 [QA Followup] - Move link to breadcrumbs
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a9c60996448badadaa962a7a97c439ed25f103a4
Author: Grace McKenzie <grace.mcky@gmail.com>
Date:   Tue Jan 17 22:01:56 2017 +0000

    Bug 5784 - link to aq from budgets & funds
    
    1. Go to /cgi-bin/koha/admin/aqbudgets.pl and notice that there is no link
    to the aq home, there are other aq links but not back to the home
    2. Apply the patch
    3. Reload the page and notice there is link
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 769869bdcb1ed30c11d0724c63c366dc7294816e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 19 12:46:03 2017 +0100

    Bug 17771: aqorders.biblionumber was already part of the query
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 33717f705d9cd516b6711b772ad808940968f81a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 19 11:48:55 2017 +0000

    Bug 17771 [QA Followup] - Tidy table html
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ec4165434063b507d1ffc9e3c214777672dbcb74
Author: Luke Honiss <luke.honiss@gmail.com>
Date:   Tue Jan 17 22:15:28 2017 +0000

    Bug 17771: Add link to bibliographic record on spent/ordered lists in acquisitions
    
    ==TEST PLAN==
    1) Open Acquisitions and click on the ordered link under the fund
    2) There will be no link on the title
    3) Go back and click on thespent link
    4) There will be no link on the title
    5) Apply patch
    6) Go to Acquisitions and click on ordered
    7) There will now be a link that takes the user to the book catelog
    page
    8) Go back and click on sent
    9) There will be a link that takes the user to the book catelog
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Works like a charm!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e077b978e770b51de7f0b38003ec93b690f61b1d
Author: Zoe Schoeler <crazy.mental.onion@gmail.com>
Date:   Tue Jan 17 23:22:17 2017 +0000

    Bug 17784 Ability to see funds with an amount of 0.00 when doing a new
    
    order
    
    TEST PLAN
    
    1. Go to the acquisition module and create budget with fund of 0.00 and
    another fund of 1.00.
    2. On acquisitions use a vendor to create a new basket and add an order
    to that basket.
    3.Find a record and order it.
    4. Under accounting details the fund with 0 in it won't be visable.
    5. Apply patch and refresh, then it should be.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2c40579077b67d4203665b7e6ecdb749235456a4
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Dec 14 16:48:45 2016 +0100

    Bug 17777: koha-remove should deal with temporary uploads
    
    If the temporary upload folder exists, it should be discarded when
    removing an instance. If we do not, it may/will create problems when
    recreating the same instance.
    
    A function in koha-functions.sh is added to determine the temp directory
    instead of hardcoding /tmp.
    
    Test plan:
    [1] Copy koha-functions.sh to /usr/share/koha/bin
    [2] Run koha-create --create-db newinstancexx
    [3] Run mkdir /tmp/koha_newinstancexx_upload (if /tmp is your temp!)
    [4] Run debian/scripts/koha-remove newinstancexx
        Do not run the regular one, but verify that you use the updated one.
    [5] Check that /tmp/koha_newinstancexx_upload is gone.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Karen Jen <karenliang.student@wegc.school.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3a19e5538299f1aa3d1c03401872999a70628585
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 12 18:45:40 2017 +0000

    Bug 17894 - Remove and replace WriteOffFee
    
    WriteOffFee is the last of the "payment" subroutines that need to be
    merged into Koha::Account::pay ( as a writeoff is really just type of
    payment ).
    
    Test Plan:
    1) Apply this patch
    2) Verify the writeoff, and writeoff all buttons still work
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 595c251b5939c9de2475c666e184202214cd0809
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 12 14:41:53 2017 +0000

    Bug 17894 - Add unit tests
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c718ad63752f5f12ab216a513dd21f6fd2e23181
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 12 14:24:02 2017 +0000

    Bug 17894 - Update pay() and use it internally for WriteOffFee
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2b303129b82a5134f04c24907c05bf863603fef7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 16 11:51:01 2017 +0100

    Bug 17914: Do not try and add the updated_on columns to the borrowers and deletedborrowers table
    
    Bug 10459 has been backported and the DB entry (add borrowers.updated_on and
    deletedborrower.updated_on) is now played in
      - 16.06.00.027
      - 16.05.00.002
      - 3.22.08.001
    
    This will raise a MySQL warning if the column already exists.
      DBD::mysql::db do failed: Duplicate column name 'updated_on'
    
    Since bug 17234 we have now a subroutine (C4::Installer::column_exists) to test
    if a column exists.
    When a DB entry modifying the DB structure is backported, it HAS TO check if the
    column, constraint or table exists before executing the query.
    
    Test plan:
    git checkout 3.22.x (16.05.x or 16.11.x)
    install Koha
    git checkout master
    execute the installer
    => Without this patch you will get a warning when adding borrowers.updated_on)
    => With this patch, you should not get it
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 288304c25ee1354b6514b3911faaa8e8ca45a35b
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Jan 17 06:28:25 2017 +0000

    Bug 17919: (bug 17466 follow-up) Koha::Issue is now called Koha::Checkout
    
    Ignoring the pluralization or lack thereof:
    $ git grep "Koha::Issue"
    -- This has results.
    But this was renamed by 17796, and supposedly still
    in discussion in 16870.
    
    apply this patch, and do the same git.
    There will be no results.
    
    This was found while running a prove t/db_dependent/00-strict.t
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c919e8bfa2fe3176096c7e4da57b81d145c48e6c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 16 10:07:46 2017 +0100

    Bug 6782: Fix fixup_cardnumber call
    
    The fixup_cardnumber subroutine takes only 1 parameter, the cardnumber.
    This call is wrong and morevover makes a lot of tests fail:
    
    t/db_dependent/Letters.t .. 1/79 Can't use an undefined value as a HASH
    reference at /home/vagrant/kohaclone/C4/Members.pm line 502.
    
    This happens because the userenv is not mocked in a lot of test files.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 23cb7ca4582ea319e8890d7c4b64950eb8f5d316
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Jan 10 12:21:05 2017 +0000

    Bug 17874: Bug 16239 followup - polishing things
    
    This patch is made on top of bug 16239 to polish things.
    
    Makes these changes:
    - Buttons on add circulation message modal
    - Dropdowns has top and bottom margin 4px instead of 3px
    - btn-link class (for example in toolbar on advanced search pages)
    - Delete circ message is btn-link
    - Add new circ message is btn-link
    
    Test plan:
    - Confirm that all changes are as described above and that they make sense
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c2fcde413503027cfb8efa070e5a5c9c3172a628
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Jan 10 10:45:36 2017 +0000

    Bug 16239: Followup - remove unusable js from cateditor-ui.inc
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 166317bbbb40ab22e9ffa36a3456506846392982
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 10 09:28:56 2017 +0100

    Bug 16239: Update Bootstrap's license on the about page
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit debcf3f2d12d65ea7b29eaa0037b85f1245827df
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Dec 20 18:17:50 2016 +0000

    Bug 16239 [CSS Follow-up] Upgrade Bootstrap in the staff client
    
    This followup tweaks some CSS and markup in order to correct conflicts
    between default Bootstrap styles and the expected (previous) style of
    the staff client. Included:
    
    - Corrections to the widths of some modals.
    - Corrections to the style of the <pre> tag, seen often in MARC preview
      modals.
    - Corrections to the default active and hover states for dropdown menus.
    
    To test, apply the patch and view various pages which use Bootstrap
    modals, confirming that they look correct.
    
    - Add order from staged file MARC preview
    - Add order from external source MARC preview
    - Cataloging record merge MARC preview
    - Batch record modification MARC preview
    - Authorities Z39.50 search MARC preview
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d80d87bc73980d3b41fb5a1c9e26ef6147afd115
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Nov 25 09:25:35 2016 +0000

    Bug 16239: Use inline-block for split buttons only in tables
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a4f58501243157897fa534bfcde44a0dfcc14b57
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Nov 10 09:59:00 2016 +0000

    Bug 16239: Update javascript files
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2686d70bc0e4aa1857a6f5b2db2939c93018b001
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Nov 10 09:58:37 2016 +0000

    Bug 16239: Update css files
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 804677265e1bb6c5118bc76d5f45b51ae0f579b4
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Nov 10 09:57:47 2016 +0000

    Bug 16239: Update templates
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 922c8df511f54c8f968d351089abf15e2bbcc4ab
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Nov 10 07:46:07 2016 +0000

    Bug 16239: Update Bootstrap to 3.3.7
    
    Customization tool used.
    
    Javascript modules:
        alert
        button
        dropdown
        modal
        tooltip
        popover
        transition
    
    CSS modules:
        type
        code
        grid
        tables
        forms
        buttons
        responsive-utilities
        button-groups
        input-groups
        navs
        navbar
        breadcrumbs
        pagination
        pager
        labels
        badges
        thumbnails
        alerts
        progress-bars
        media
        list-group
        panels
        responsive-embed
        close
        component-animations
        dropdowns
        tooltip
        popovers
        modals
    
    Test plan:
    1) Apply the patch
    2) Try to go through interface to find problems, inconsistencies, etc.
    3) Read the diff
    
    Migration guide for bootstrap: http://getbootstrap.com/migration/
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c5a758d9a06dba412a8564c8574c68eebf0b6ff8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jan 13 14:00:55 2017 +0000

    Bug 17196 - DBRev 16.12.00.004
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2bf3ce268de6bc8b2386cfb5d768f60b05d75f44
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 13 11:27:08 2017 +0100

    Bug 17196: [QA Follow-up] Additional fix on acqui/basketgroup
    
    acqui/basketgroup calls GetOrders and expects marcxml in the results.
    Fixing it by an additional call of GetXmlBiblio.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0ffe964fb70084e4f74c1daf7339ed7de98c5ea3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 13 11:21:54 2017 +0100

    Bug 17196: [QA Follow-up] Adjust some text on marcxml
    
    No code changes here, just text.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 32db2b0ed1f3a27dbe4e2c8bd99f414199fae88a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 13 11:37:49 2017 +0100

    Bug 17196: Remove occurrence of marcxml in columns.def
    
    Also remove a wrong ref to the marc column
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5f62c2c4938f070f3258409d1a6f8cb14958d9f5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 13 09:58:54 2017 +0100

    Bug 17196: [QA Follow-up] Missing unique key in kohastructure
    
    See the atomic update.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested on command line.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fd427111cd26b5bd0c2e5855221964053b23a9b3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 13 08:49:43 2017 +0100

    Bug 17196: [QA Follow-up] Wrong module in Record.t
    
    Should be the singular version instead of the plural one.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6c3f6d9e474777382c22cc2196b165f63c1fb9ab
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 13 08:37:17 2017 +0100

    Bug 17196: [QA Follow-up] DBIx schema changes
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 80fb3160d98ad1696b1d47e4be03e4d859ac0ceb
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 13 08:22:50 2017 +0100

    Bug 17196: [QA Follow-up] Correct POD in ILSDI/Services.pm
    
    QA tools complains about:
    Apparent command =cut not preceded by blank line.
    
    Trivial fix.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9921b88bf3ee24ff5e0a6a735e315fa59412c7e3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 29 18:15:40 2016 +0000

    Bug 17196 - (QA Followup) Use items from Koha::Biblio
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Amended: Using items from Koha::Biblio seems better :)
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 28c4b908ce9b6ff0e5c560b8a4bab8ab34a81cf3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 29 02:16:21 2016 +0000

    Bug 17196: Fix delete_records_via_leader.pl
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5ea64fc366a589719afef0a566f735986452588e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 6 19:23:51 2016 +0000

    Bug 17196: Update POD of sanitise_records.pl
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4fd41a4893cc0da1522e63dfa7b3b395b60ff471
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 6 19:01:04 2016 +0000

    Bug 17196: Fix build_oai_sets.pl
    
    The wrong value was retrieved.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6fa17b1b9033c300033c58628012f57bdd846dc9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 4 15:19:13 2016 +0100

    Bug 17196: follow-up for bug 17088
    
    If bug 17088 is pushed first, we will need this patch.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 98874bf9e2112db163a955eb1a13588276ee5bd7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 29 13:35:57 2016 +0100

    Bug 17196: Fix - Update metadata on update
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5573179c3dfeab2d58cf58522c7903eebfb2c150
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 29 13:24:12 2016 +0100

    Bug 17196: Simplify tests for the different marc flavours
    
    centralize the way MARC field are set.
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 739e2e0c5dc26502e195e2cc4c687ababdcaf381
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 26 09:23:30 2016 +0100

    Bug 17196: DB Changes
    
    Remove biblioitems.marcxml and deletedbiblioitems.marcxml
    and adds 2 table biblio_metadata and deletedbiblio_metadata
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 12cf801945ebbed32a760e4a5b987583402f6d6d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 15:18:12 2016 +0100

    Bug 17196: Update switch_marc21_series_info.pl
    
    Not sure if this script is still used, could someone confirm?
    
    Test plan:
    If you know how to test it, please do
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2096876b36e466becf589cc9433822a57db379a8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 14:59:12 2016 +0100

    Bug 17196: Update misc/maintenance/sanitize_records.pl
    
    Test plan:
    Use the sanitize_records.pl maintenance script with the --auto-search
    option
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 27b1acf209b212b4e34d9021cfd20dc177bee47c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 13:24:19 2016 +0100

    Bug 17196: Fix query builder for item search
    
    The item search needs to join on biblio_metadata to allow search on
    marcxml field
    
    Test plan:
    Launch complex item searches (using marc fields).
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c6e488f4af72a2629fd86ee040a6973e2a6c73f4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 11:41:56 2016 +0100

    Bug 17196: Move marcxml out of the biblioitems table
    
    Two discussions on koha-devel lead to the same conclusion:
    biblioitems.marcxml should be moved out this table
    - biblio and biblioitems
    http://lists.koha-community.org/pipermail/koha-devel/2013-April/039239.html
    - biblioitems.marcxml & biblioitems.marc / HUGE performance issue !
    http://lists.koha-community.org/pipermail/koha-devel/2016-July/042821.html
    
    There are several goals to do it:
    - Performance
    As Paul Poulain wrote, a simple query like
      SELECT publicationyear, count(publicationyear) FROM biblioitems GROUP BY publicationyear;
    takes more than 10min on a DB with more than 1M bibliographic records
    but only 3sec (!) on the same DB without the biblioitems.marcxml field
    Note that priori to this patch set, the biblioitems.marcxml was not
    retrieved systematically, but was, at least, in
    C4::Acquisition::GetOrdersByBiblionumber and C4::Acquisition::GetOrders
    - Flexibility
    Storing the marcxml in a specific table would allow use to store several
    kind of metadata (USMARC, MARCXML, MIJ, etc.) and different formats (marcflavour)
    - Clean code
    It would be a first step toward Koha::MetadataRecord for bibliographic
    records (not done in this patch set).
    
    Test plan:
    - Update the DBIC Schema
    - Add / Edit / Delete / Import / Export bibliographic records
    - Add items
    - Reindex records using ES
    - Confirm that the following scripts still work:
        * misc/cronjobs/delete_records_via_leader.pl
        * misc/migration_tools/build_oai_sets.pl
    - Look at the reading history at the OPAC (opac-readingrecord.pl)
    - At the OPAC, click on a tag, you must see the result
    
    Note: Changes in Koha/OAI/Server/ListRecords.pm is planned on bug 15108.
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Zeno Tajoli <z.tajoli@cineca.it>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fdc15cb7623ed2ed8cd2d0b3fcfbd96d90f59041
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Dec 21 02:46:57 2016 +0000

    Bug 17799: MARC bibliographic frameworks breadcrumbs broken for Default framework
    
    To test:
    1) Go to Admin -> MARC frameworks -> Default framework actions -> MARC
    structure
    2) Click New tag
    3) Notice the breadcrumbs say '()' instead of 'Default MARC framework'
    or something more appropriate
    4) Apply patch and refresh page
    5) Confirm breadcrumbs are now filled correctly
    6) Go back to tag structure and try deleting a tag (Actions -> Delete)
    7) Confirm breadcrubs are filled correctly
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b664d68ca493939a957b45fb366ac042c0bf838c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 15 11:10:51 2016 +0000

    Bug 17629: Koha::Biblio - Remove ModBiblioframework
    
    There is only one call to C4::Biblio::ModBiblioframework, it's called
    just before C4::Biblio::ModBiblio in cataloguing/addbiblio.pl
    At first glance this call does not seems useful: all the subroutines
    called from ModBiblio send the frameworkcode in parameter.
    
    I'd go to remove it, but I'd like to get confirmation by others.
    
    No test plan here, you need a good pair of eyes and deep into the
    C4::Biblio code.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 46085442e0acc7a3da3b2aad0ec5c8964fb465c5
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jan 13 12:34:45 2017 +0000

    Bug 17486 - DBRev 16.12.00.003
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d51d1899e8de85edb0b65fc1ac064665dfdda68e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 6 08:58:20 2017 +0100

    Bug 17486: [QA Follow-up] Changes as to set_userenv
    
    Add shibboleth parameter to POD of set_userenv.
    Removed a 12th set_userenv parameter from Borrower_Discharge.t.
    Replaced set_userenv call in PatronLists.t looking like a fortunate typo.
    
    Test plan:
    Run the two corrected tests.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e55b38928a14c9362be22d682e1fbe5344ab17ae
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 14 18:30:43 2016 +0100

    Bug 17486: Remove Mozilla Persona
    
    Persona never really took off, and although many browsers currently
    support it, very few services actually implement it.
    
    This has lead to it's founders, Mozilla, to end the project. In their
    own words:
    
    =============================================================================
    Persona is no longer actively developed by Mozilla. Mozilla has
    committed to operational and security support of the persona.org
    services until November 30th, 2016.
    
    On November 30th, 2016, Mozilla will shut down the persona.org services.
    Persona.org and related domains will be taken offline.
    
    If you run a website that relies on Persona, you need to implement an
    alternative login solution for your users before this date.
    
    For more information, see this guide to migrating your site away from
    Persona:
    
    https://wiki.mozilla.org/Identity/Persona_Shutdown_Guidelines_for_Reliers
    
    =============================================================================
    
    Given the above, and that the Persona authentication methods as a whole
    are no longer being actively maintained by anyone anywhere to ensure
    ongoing security, we should deprecate the option from koha.
    
    Test plan:
    Apply this patch and make sure you do not find any references of Persona
    Have a look at patches from bug 9587 and confirm that everything has
    been reverted
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Code looks good to me.
    Also ran several tests including: Auth.t, Auth_with_shibboleth.t.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 09c7b8058567517fb2210847eeb51c56a97f1c8d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Dec 30 18:30:46 2016 +0000

    Bug 17466 [QA Followup] - Give the link some style
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7681eae389d3ad33fa7b2549044cc51fa67b840a
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Dec 7 11:23:47 2016 +0000

    Bug 17466: Followup, change button to link and fix terminology
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 13f3d0cbec193df92a8d502a0381adb1059367ff
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Oct 19 10:55:55 2016 +0000

    Bug 17466: Show number of outstanding issues when checking in
    
    Test plan:
    1) Apply patch
    2) Checkout more then one item to a borrower
    3) Check one of that items
    4) Note, that on in returns table there is a button with number of
    outstanding issues in patron column. The button should take you to checking
    out page
    5) When the outstanding issues count is 0, there is no button
    
    Signed-off-by: Radek Šiman <rbit@rbit.cz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 80a9a7f9972950554a819138119c8bc3fd3a7f9b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 11 22:37:33 2017 +0100

    Bug 17181: Simplify code
    
    - do not prepare statement when used only once
    - remove use of Data::Dumper
    - remove $duplicate, not needed
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2173b780c951a4d6abd990a212c6e6bb23fa37d7
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Jan 11 00:40:31 2017 +0000

    Bug 17181: Check for duplicate image names when uploading image to patron card creator
    
    This patch adds a check for duplicates before uploading the image.
    
    To test:
    1) Go to Tools -> Patron card creator -> Manage images
    2) If you haven't already, upload an image
    3) Try to upload another image with the same image name
    4) Notice the first image is replaced with the second image, with no
    warning.
    5) Apply patch and refresh page
    6) Try to upload an image with the same image name again
    7) Notice you are now warned about a duplicate image name.
    8) Check that uploading an image with a unique name still works.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a2afebe115662ea5dcb8a98888f108d6730128ec
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jan 13 12:24:39 2017 +0000

    Bug 14187 - DBRev 16.12.00.002
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac3e4ce671ae7542986a4e93802f20f83d5130e2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 12 12:42:05 2017 -0300

    Bug 14187: (QA followup) Properly check DB structure before altering it
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 292b9df91489e4456b2ce4a3bc2b0fba0c9d5770
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Tue May 12 10:19:05 2015 +0300

    Bug 14187: branchtransfer needs a primary key (id) for DBIx and common sense.
    
    * C4/Circulation.pm (GetTransfers, GetTransfersFromTo): Also return
      branchtransfer_id in return columns.
    * installer/data/mysql/atomicupdate/14187.perl: New file.
    * installer/data/mysql/kohastructure.sql: Modify branchtransfers structure.
    * t/db_dependent/Circulation/transfers.t: Update tests to expect
      branchtransfer_id.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Test plan successful on all steps.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Amended patch: Remove Schema changes from this patch
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fe3194d4d10782a43cd07a820f2a935163052dc4
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Thu Jan 5 17:12:59 2017 +0100

    Bug 16083: [QA FOLLOWUP] Add more cli arguments.
    
    * Makefile.PL: Add `zebra_sru_host`, `zebra_sru_biblios_port` &
      `zebra_sru_authorities_port` as possible command line arguments.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ec03b78106d60b0f28ed9a8085c70febee9de111
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Wed Mar 16 17:04:48 2016 +0100

    Bug 16083 Allow cli overrides for makefile settings.
    
    Currently the Makefile.pl script only accepts the '--prev-install-log' commandline flag for reading Koha configuration values from the previous installation.
    
    The Makefile does not have help output.
    
    The aim of this bug report is to add 2 things:
    - --help output
    - commandline parameters that should allow automating many of the common settings if desired
    - when commandline parameters are not passed we simply fall back to the interactive method of old
    
    Test Plan:
    
    - Run the Makefile without parameters — the script should work as before.
    - Run the script with the '-h' flag — it should output help.
    - Run the script with any number of additional legal flags — the script should skip those questions in its interactive mode.
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    Reworked the log message with Bugzilla comments.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    Amended patch: perltidy GetOptions block
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6caac44a94b6eeac489aeea1fa66472022d4e72a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Dec 30 18:42:37 2016 +0000

    Bug 6782 [QA Followup] - Remove unused param and limit calls to Koha.Preference
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 141d29358f15eed2659de041ee5c4295c24e0fb5
Author: Meenakshi R <meenakshi.r@osslabs.biz>
Date:   Wed Jun 6 16:46:15 2012 +0530

    Bug 6782 - Move auto member cardnumber generation to occur when record is "Saved" (avoid collisions).
    
    Currently the card number is generated when the user enters the patron creation form. This creates a problem of concurrency - when two or more simulataneous users are registering members, the error "card no. in use" can occur.
    
    This change moves the card number generation to occur after the "Save" button is pressed.
    
    Changes:
    -C4/Members.pm:
    Added code to fixup_cardnumber,If the cardnumber is blank and "autoMemberNum" ON.
    -koha-tmpl/intranet-tmpl/prog/en/modules/members/memberentrygen.tt:
    Added code to display "leave blank for auto calc during registration" in cardnumber label in patron registration form only if "autoMemberNum" ON.
    -members/memberentry.pl:
    Added code to get weather or not "autoMemberNum" is on or off and removed fixup_cardnumber generation.
    
    Test cases:
    -If "autoMemberNum" ON:
    ->In blank case, must generate auto card number in simulataneous users.
    ->If user entered, check for unique card number.
    
    -If "autoMemberNum" OFF:
    Must work normal.
    
    Followed test plan, works as expected.
    Note: Syspref PorrowerMandatoryField must not include cardnumber, otherwise
          you can not save. Maybe that should be mentioned in the comment for
          syspref autoMemberNum.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d3752c85dc2f5af974ec2fe4585efa8510302968
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Jan 10 22:20:40 2017 +0000

    Bug 17879: Use image filename if no image name is entered
    
    This patch changes the code to use the filename of the uploaded image if
    no specific image name is entered.
    
    To test:
    1) Go to Tools -> Patron card creator -> Manage images
    2) Upload an image and leave the image name field empty
    3) Notice this works and 'Name' is left empty.
    4) Apply patch and refresh page
    5) Upload an image and leave the image name field empty
    6) Notice the image name is given the filename so that 'Name' is no
    longer empty.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dc915ce1f7830913753dd3ff027a2b2a1799dd42
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jan 6 16:12:25 2017 +0000

    Bug 17859 - Move JavaScript to the footer on about and auth pages
    
    This patch modifies the about page and the login page templates so that
    JavaScript is included in the footer instead of the header.
    
    To test, apply the patch and test each page to confirm that
    JavaScript-based interactions are unaffected:
    
    - On the About page tabs and header menu dropdowns should work correctly
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b9cf724e982cdb828de1ca5d30e1c0a800c37270
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Dec 21 02:59:44 2016 +0000

    Bug 17800: Add admin sidebar menu to marc-subfields-structure.pl
    
    Adding to marc-subfields-structure because auth-subfields-structure has
    it, so I assume it was just missed when the admin-menu was added.
    
    To test:
    1) Go to admin -> MARC bibliographic frameworks -> Actions for any
    framework -> MARC structure -> Actions for any tag -> Subfields
    2) Notice no admin-menu on the side
    3) Apply patch and refresh page
    4) Notice admin-menu now shows
    
    Note: the link in the sidebar menu for MARC bibliographic frameworks
    does not show as active (bold) from this page. This is fixed in Bug
    17794
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 767a33a91eb58a1ec68bdfb6c159dd5d59e39209
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 7 03:21:43 2016 +0000

    Bug 17741: Use Koha::Patron->holds when deleting a patron
    
    There is a TODO in Koha::Patron->delete, this method should call the
    Koha::Patron->holds to retrieve the holds made by the patron we are
    removing instead of calling Koha::Holds->search
    
    Test plan:
      prove t/db_dependent/Koha/Patrons.t
    Should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 81585647ef6ab330cf3d7e6cb80717aa7bf891b9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 7 14:42:41 2016 +0100

    Bug 17740: Add the Koha::Patron->holds method
    
    The goal of this method is to replace
    C4::Reserves::GetReservesFromBorrowernumber but could be reused for
    something else, that's why it has its own bug report.
    
    Test plan:
      prove t/db_dependent/Koha/Patrons.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Rebased. Edited two test descriptions.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3371b08123ad5848ee6202c1ac8609276c46f9a1
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Dec 30 10:12:24 2016 -0500

    Bug 17447: %opt is unused
    
    Deleted the line.
    perlcritic -4 before and after.
    Before there are issues. After there is not.
    
    Also, changed function to not rely on implicit return value
    of last line, but explicitly stated a return. And operator
    changed, due to precedence issues.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 56391bd15ae797a7bca348aef01c9d70466f14ad
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 14 14:27:15 2016 +0200

    Bug 17447: Remove unused vars from batchRebuildItemsTables.pl
    
    Variables $extkey not used, %opt not used.
    Variables $tmptest[...] not used, calling _build_tag_directory useless.
    The script now does not only print help if you specify -t.
    Sub defnonull tidied.
    Rearranged modules, removed Dumper.
    
    Test plan:
    [1] Run the script with -t flag. The script should not only print usage
        statement, but should do a dry run. (Test this on a small database,
        or pass an additional where clause.)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2b62f24a4a87beeaa7a4d30e6edfdd9f61b613a8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Dec 30 11:01:36 2016 +0100

    Bug 17447: Run perltidy on batchRebuildItemsTables.pl
    
    Test plan:
    Verify that the output of diff -w between the original and tidied file
    does not introduce code changes.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bee87e4f61d6f515bee20ab1792b4ca76605c0e9
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Dec 21 02:27:46 2016 +0000

    Bug 17794: Menu items in Tools menu and Admin menu not showing bold when active but not on linked page
    
    To reproduce:
    admin-menu
    1) Go to a page like admin/categories.pl
    2) Click New Category
    3) Notice Patron categories in the sidebar menu is no longer bold
    tools-menu
    4) Go to a page like reviews/reviewswaiting.pl
    5) Notice bold Comments in sidebar menu
    6) Click Approved Comments tab
    7) Notice no longer bold in sidebar menu
    To test:
    8) Apply patch and refresh page
    9) Follow above steps to reproduce bug, confirm that active links are
    always bold
    10) Test with other links to confirm nothing has broken
    Special cases
    11) Go To admin -> MARC bibliographic frameworks -> Actions for any
    framework -> MARC structure
    12) Confirm sidebar menu link is still bold
    13) Go to admin -> Authority types -> Actions for any auth type -> MARC
    structure
    14) Confirm sidebar menu link is still bold
    15) Click Actions for any tag -> Subfields
    16) Confirm sidebar menu link is still bold
    17) Go to admin -> OAI sets config -> Actions for any set -> Define
    mappings
    18) Confirm sidebar menu link is still bold
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c69e6faa983fa87412927f6f0a640d5eb07d0f93
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 10 15:52:57 2017 +0100

    Bug 17778: Simplify fetch date
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ff711c48cfa02c7b6ab09fe22f699a872420db8d
Author: Magnus Enger <magnus@libriotech.no>
Date:   Fri Jan 6 15:27:04 2017 +0100

    Bug 17778 - Make "Earliest Registered Date" in OAI dynamic
    
    This was hardcoded to 0001-01-01.
    
    To test:
    - Make sure you have a couple of records, with different timestamps
    - Enable OAI-PMH
    - Check http://localhost:2201/cgi-bin/koha/oai.pl?verb=Identify
      and verify that "Earliest Registered Date" is 0001-01-01
    - Apply the patch
    - Re-check the "Earliest Registered Date" and verify that it is now
      the lowest timestamp in your biblio table
    - Manipulate the timestamps and verify that "Earliest Registered Date"
      changes accordingly
    - Sign off!
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ae8223e333201d264b19bf6ed9e91c10c94349ad
Author: Magnus Enger <magnus@libriotech.no>
Date:   Thu Sep 8 14:13:46 2016 +0200

    Bug 17265 - Make koha-create-defaults less greedy
    
    koha-create-defaults substitutes the instance name with the placeholder
    __KOHASITE__ in the SQL file that it creates. If the instance name is
    something common, like "data", this means that way too many substitutions
    will be made, and when koha-create uses the SQL file as a template, broken
    data can be the result.
    
    The solution in this patch was suggested by drojf on IRC.
    
    To test:
    - Create an instance called "data"
    - Run "sudo koha-dump-defaults data > test.sql"
    - Take a look at test.sql and verify there are way too many occurences
      of __KOHASITE__, like "-- Dumping __KOHASITE__ for table `accountlines`"
    - Apply the patch
    - Copy the resulting koha-create and koha-dump-defaults to somewhere
      running off the packages
    - Run "sudo koha-dump-defaults data > test.sql" again and verify there
      are only 4 occurrences of __KOHASITE__, in places that make sense
    - Create an instance with something like:
      $ gzip test.sql
      $ sudo koha-create --create-db --defaultsql test.sql.gz test17265
    - Verify that you have a working Koha install
    
    Signed-off-by: Andreas Roussos <arouss1980@gmail.com>
    Works as expected.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5a08969a71dc27562a1a22af809673a8727f5c82
Author: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
Date:   Tue Dec 13 14:57:52 2016 +0100

    Bug 17766 - Patron notification does not work with multi item holds
    
    This patch fixes notification when same biblio has multiple reserves with same borrower,
    introduced in Bug 14695. C4::Reserves::ModReserveAffect uses internal method
    _koha_notify_reserve but sends itemnumber and biblionumber instead of record_id.
    
    To test:
    Prerequisites:
    - One biblio with two items attached
    - A patron with hold_filled notification activated
    - A letter for HOLD with <<reserves.reserve_id>> in it
    1) Place two reservations on same biblio
    2) checkin item x on pickup branch, observe patron message generated
    3) checkin item y on pickup branch, observe patron message generated
    4) note that reserve_id is the same on both messages, which is wrong
    5) apply this patch and repeat 1-3
    6) now observe notifications have correct (different) reserve_id
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 14c34c0c687ddece0708baf3dfc0cc43f1c5b8be
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jan 9 17:39:01 2017 +0000

    Bug 17870 - Call to include file incorrectly moved into the footer
    
    This patch moves a line of template code from js_includes.inc back into
    doc-head-close.inc where it belongs.
    
    To test, apply the patch and view a page which uses a template that
    depends on html_helpers.inc being processed. For example:
    
    - The set library page
    - The holds queue report
    - The new patron form
    
    The pages should work correctly.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87bbe7e18b19b774fe80d0a9c3e0a9bb494a861d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 11 21:06:09 2017 +0100

    Bug 17725: Same for textarea when cloning a field
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e12b080a4cc1131fd55810e1c18d0217e0ef765a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 11 13:39:47 2017 +0100

    Bug 17725: Do not copy subfield's content when cloning
    
    To replicate:
    - Open an existing record in your catalog
    - Create another field or subfield of a field/subfield already used using the icon to repeat it
    - Verify that the content is copied over
    - Verify this happens for input (one line) and textare (multiple lines)
    
    I can't make this happen for when creating a new record, but more consistently on editing existing records.
    
    This is rather annoying when cataloguing in Koha, as the cataloguer has to empty the field first and that adds an extra step for each repeated field.
    
    Test plan:
    Confirm than the content is not copied when you clone a field or a subfield.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c7a02725808ba029a28a178ff2ffe9045a9842b0
Author: Patricio Marrone <pmarrone@unc.edu.ar>
Date:   Wed Jan 11 12:39:21 2017 -0300

    Bug 17817: (Follow up) Fix reordering subfields issues
    
    Authority controlled subfields have invisible divs which produced
    a strange behavior when reordering (multiple clicks were needed
    to push a subfield up over an authority controlled subfield)
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cc26863d355fb9524ed90aba7c03c53115641900
Author: Patricio Marrone <pmarrone@unc.edu.ar>
Date:   Tue Jan 10 15:53:33 2017 -0300

    Bug 17817: Fix cloning subfields using select2
    
    Based on Jonathan's patch (the DO NOT PUSH one), I put together this fix.
    What was changed is that select2 is reinitialized only after the cloned element
    has been appended to the DOM (so that select2 can correctly calculate the field's
    width). Also, I changed the selectors that searched for the line divs (for reordering)
    and for the subfield's input element (for erasing the field's value) to be more specific,
    since select2 introduced divs that broke some assumptions about the expected HTML structure
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    I confirm that these 2 patches fix the add item and mod biblio views as
    well as the batch item modification tools.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7638a33aafacf006d2547724e9e172b8c6d8f9b8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 12 13:50:05 2017 +0000

    Bug 15905 [QA Followup] - Fix bad syntax in pay()
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f59c22b72baaee66b59390d2491b80115ebc2862
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jan 11 14:57:36 2017 +0000

    Bug 15905 - Remove use of makepayment
    
    Test Plan:
    1) Apply these patches
    2) prove t/db_dependent/Accounts.t
    3) 'git grep makepayment' should return no results
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c439fc8f68dbb83f71e30e216cbd056b7d5c7049
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 16:10:48 2016 +0000

    Bug 15905 - Update unit tests
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c3685f041c0ca301ce2621d0c489895539a96e85
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 15:56:52 2016 +0000

    Bug 15907 - Remove use of makepayment in opac/opac-account-pay-paypal-return.pl
    
    Test Plan:
    1) Apply this patch
    2) Make a payment via PayPal in sandbox mode
    3) Note the payment succeeds
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Bug 15907 [QA Followup] - Simplify code and call pay() only once
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 05fdd855c8da85d3be27d42721f6a544b0145e57
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 12 10:44:46 2017 +0100

    Bug 17234: Need to separate KEY and FOREIGN KEY checks
    
    In the previous patch we use the constraint_exists subroutine to verify
    if an index or a foreign key exists.
    But the `SHOW INDEX` query does not return foreign keys (as its name
    suggests!).
    We need another subroutine foreign_key_exists to check the FK existence.
    
    I have found that because t/db_dependent/TestBuilder.t fails on
    oai_sets_biblios, because oai_sets_biblios_ibfk_1 has not been removed.
    
    Test plan:
    0/ Do not apply this patch
    1/ Use a 3.20 DB
    2/ update the DB
    3/ SHOW CREATE TABLE oai_sets_biblios
    will display oai_sets_biblios_ibfk_1
    
    Apply the patch and repeat 1, 2, 3
    => Will not display oai_sets_biblios_ibfk_1
    It has been removed as expected.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1e0becf91586b6a03d2e5681eb63483dc06cd940
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 16:24:04 2016 +0000

    Bug 15908 - Remove use of recordpayment_selectaccts
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/Accounts.t
    3) Test fine payment via the "Pay selected" button
    
    Signed-off-by: Laura Slavin <lslavin@hmcpl.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9f51f7a7adec3c98319d508d4e967bb4533badab
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 16:34:23 2016 +0000

    Bug 15909 - Remove the use of makepartialpayment
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/Accounts.t
    3) Test fine payment via the "Pay" button,
       but make the payment for less then the full amount
    
    Signed-off-by: Laura Slavin <lslavin@hmcpl.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e134350813db967458ca8a0928210909d5ec7e4d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 14:01:23 2016 +0000

    Bug 15898 - Use Koha::Account::pay internally for makepartialpayment
    
    This is the fourth patch in a series to unify all payment functions into
    a single mathod
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/Accounts.t
    3) Test fine payment via the "Pay" button,
       but make the payment for less then the full amount
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cf52095e19a348865f3728c43f20ebb2e2415dd8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 10 21:52:07 2017 +0100

    Bug 15879: Add Tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ea6a11ec826b0b174f4dc0f4c36395466f3f4e6f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Feb 22 14:25:18 2016 +0000

    Bug 15879: Allow multiple plugin directories to be defined in koha-conf.xml
    
    It would be very useful to be able to define multiple plugin directories
    in the Koha conf file. This would allow for ease of plugin development
    so that each plugin installed can live in its own git repository. For
    compatibility, the first plugindir instance defined should be the one
    used for uploading plugins via the web interface.
    
    Test Plan:
    1) Apply this patch
    2) Define a second pluginsdir line in your koha-conf.xml
    3) Clone the kitchen sink plugin to this new path like this:
       git clone https://github.com/bywatersolutions/koha-plugin-kitchen-sink.git /path/to/new/plugins/dir
    4) Restart memcached if you are running it
    5) The Kitchen Sink plugin should now appear in your list of plugins!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    I rebased it against master and tested it on a kohadevbox
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 435b7badc22d9c05cb16623d6f423206992ec476
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 2 11:36:53 2017 +0100

    Bug 17234: Test the column and constraint non-existence
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8938631f38bb22456424219d3c3453493df6f848
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Dec 30 14:08:33 2016 -0500

    Bug 17234: Two new functions lack tests
    
    This adds two tests to t/db_dependent/Installer.t
    
    TEST PLAN
    ---------
    1) Apply patch
    2) prove -v t/db_dependent/Installer.t
       -- column and constraint tests were added.
    3) run koha qa test tools
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0b15c5e2cc5d5a84b062c5c5738fe54ab5df98ab
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 27 08:28:09 2016 +0100

    Bug 17234: Move new subroutines to C4::Installer
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c08922180e83b0222dc3d54a292aaf49cc15000a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 20 16:55:40 2016 +0100

    Bug 17234: Add constraint_exists and column_exists to updatedatabase.pl
    
    These 2 subroutines will help us deal with the absense of ALTER IGNORE
    TABLE
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ea484677e7049ddb835fcc6d6f24a801f2eb6ba
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon Sep 19 14:27:14 2016 -0400

    Bug 17234: Follow up to handle new problems
    
    Bug 16276 added two more ALTER IGNORES. This removes them.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit acf425bbbcb8c22f3655472f90285869c3ad7164
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Fri Sep 2 08:05:48 2016 -0400

    Bug 17234 - updatedatabase.pl's ALTER IGNORE break with mysql 5.7.4+
    
    The doc says: "As of MySQL 5.7.4, the IGNORE clause for ALTER TABLE is removed and its use produces an error."
    This fix replaces ALTER IGNORE with ALTER in updatedatabase.pl
    
    To TEST, try an upgrade from 3.18 to 3.22 after installing the latest mysql (at least 5.7.4, by the doc).
    Some will fail with error
    
    DBD::mysql::db do failed: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IGNORE TABLE aqbasket
                ADD KEY authorisedby (authorisedby)' at line 1 [for Statement "
            ALTER IGNORE TABLE aqbasket
                ADD KEY authorisedby (authorisedby)
        "] at ./installer/data/mysql/updatedatabase.pl line 10563.
    
    0) Find a database on 3.18, save it.
    1) Set your code base to 3.22(or master)
    2) run updatedatabase.pl
    3) See the errors.
    4) Apply the patch
    5) Reload the 3.18 database
    6) succeed with updatedatabase.pl
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1c225986879648c326408b3ad10b3bcb498b2271
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 10 10:21:23 2017 +0100

    Bug 15897: Update ->pay POD
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f34fb4735c6417f203ea01ec472a941a89bdced5
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jan 9 17:19:54 2017 +0000

    Bug 15897 [QA Followup] - Update unit tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 275aa1c8d70339f13b7ec3f6c84c77fa5ff63b07
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Dec 7 02:41:08 2016 +0000

    Bug 15897 - Folowup Revert "Bug 15896: [QA Follow-up] Add accountlines_id parameter in paycollect"
    
    This reverts commit b6d5748c001febc5acd67938d12ba25844d11fbc.
    
    As this bug report no more uses the accounline_id parameter to identify
    account lines to pay in Koha::Account->pay, it should revert this, to
    use the new notation everywhere.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9c9d0bcfe00830acc8b4386d236adf351a8a80e4
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 13:30:07 2016 +0000

    Bug 15897 - Use Koha::Account::pay internally for recordpayment_selectaccts
    
    This is the third patch in a series to unify all payment functions into
    a single mathod
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/Accounts.t
    3) Test fine payment via the "Pay selected" button
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b0562eee87e80532d6abb423177c76062be84cc
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jan 3 11:01:08 2017 +0000

    Bug 14610 [QA Followup] - Minify opac.css
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4e40339db3209c913c79b935067e139b470255cc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 29 17:54:40 2016 +0100

    Bug 17830: CSRF - Handle unicode characters in userid
    
    If the userid of the logged in user contains unicode characters, the token
    will not be generated correctly and Koha will crash with:
      Wide character in subroutine entry at /usr/share/perl5/Digest/HMAC.pm line 63.
    
    Test plan:
    - Edit a superlibrarian user and set his/her userid to '❤' or any other strings
    with unicode characters.
    - Login using this patron
    - Search for patrons and click on a result.
    
    => Without this patch, you will get a software error (with "Wide
    character in subroutine entry" in the logs).
    => With this patch, everything will go fine
    
    You can also test the other files modified by this patch.
    
    Signed-off-by: Karam Qubsi <karamqubsi@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f43a73597e17687cfcf3ca0069d621b712eff57c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Dec 2 10:30:55 2016 +0100

    Bug 17569: [QA Follow-up] Small changes
    
    Patron.pm: Adds two missing semicolons at the last statement. Not strictly
    needed, but strongly recommended.
    Patrons.t: Add a test description, remove two comments that refer to
    previously hardcoded dates.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4c00190250b8c290b6a03e4621ee6c282be0be62
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 08:07:02 2016 +0000

    Bug 17569: Do not limit by branch if option is not passed
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f91fe7da2cf6ead81efcff49fbc7361229b99e6d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 08:02:38 2016 +0000

    Bug 17569: Remove C4::Members::GetUpcomingMembershipExpires
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4f48dcc9f86e5fc3edbb4c22b7cc2ad2a87e1f04
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 14:38:17 2016 +0000

    Bug 17569: Koha::Patrons - Move GetUpcomingMembershipExpires to search_upcoming_membership_expires
    
    This patchset moves the C4::Members::GetUpcomingMembershipExpires
    subroutine code to the Koha::Patrons->search_upcoming_membership_expires
    method.
    This subroutine was used from only 1 place, so it's an easier to move.
    
    Test plan:
    Use the membership_expiry.pl cronjob script using the different
    options.
    The behavior should be the same as prior to this patch.
    
      prove t/db_dependent/Koha/Patrons.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c1e62ceaf7f6344460417a452bc5a013a41b1da9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 15:34:32 2016 +0100

    Bug 17569: Move tests to the patron module test file
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit da064f1387f255086249ad968632618695e9c008
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 13:18:54 2016 +0000

    Bug 17569: Rewrite existing tests to make them reusable and more robust
    
    In order not to cheat you, I am rewriting the tests in a separate
    commit.
    You can confirm that they pass with the other patches.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d8cdceb2613bad6e43826233f0c635c0e34d718b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Dec 28 15:10:26 2016 +0000

    Bug 13726 - (QA followup) Fix vendor retrieval in invoices.pl
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f532d27302596b1736b67f81c6520160c4e3d8f0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 29 09:16:55 2016 +0000

    Bug 13726: Fix for serials/acqui-search-result.pl
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5c0dfe852396f6391ad1b9873eebed7fb8134437
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 17 14:37:10 2015 +0100

    Bug 13726: Make Koha::Acq::Bookseller using Koha::Object
    
    This patch create a Koha::Acquisition::Booksellers module and
    Koha::Acquisition::Bookseller::Contract[s] modules.
    
    All code in the acquisition module is adapted to use the CRUD methods of
    Koha::Object[s].
    The former C4 routines are removed.
    
    Test plan:
    Since a lot of files are impacted by this patch, try a complete
    acquisition workflow and try to catch errors.
    Be focused on bookseller and bookseller' contacts data.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af171f9b21da8fa1c22754caa541e826ffeee529
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 28 13:14:06 2016 +0100

    Bug 17820: use ->find instead of search->next
    
    From C4::Auth:
      my $patron = Koha::Patrons->search({ userid => $userid })->next;
    
    This should be replaced with
      my $patron = Koha::Patrons->find({ userid => $userid });
    
    userid is a unique key
    
    Caught with NYTProf:
     # spent 78.9ms making 1 call to Koha::Objects::next
    
    Test plan:
    Login at the intranet
    Reload the page
    => You must still be logged in
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested by enabling TrackLastPatronActivity and logging in again.
    Verified lastseen column in borrowers.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 28d81cb7bbde241cafb7c1cd05860251840d7e04
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Dec 28 13:56:07 2016 +0000

    Bug 17767 - DBRev 16.12.00.001
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e721f53eddb0b02d7a5a8441f4f63c3634f449d2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Dec 14 12:06:59 2016 -0300

    Bug 17767: (followup) Rename test file
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bc35ae21d512929b81e1d807040a51feaa493436
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Dec 15 01:31:01 2016 -0300

    Bug 17767: Unit tests
    
    This patch introduces tests for the new behaviour, and also
    enhances the existing ones aiming to reach full coverage.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 332895b781993651b7df32a679ab180d83460117
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 13 17:45:41 2016 -0300

    Bug 17767: Make Koha::Patron::Modification handle extended attributes
    
    This patch makes Koha::Patron::Modification aware of the new extended_attributes
    column, which is expected to contain valid JSON data.
    
    The ->store method is modified so it validates the field value (i.e. the content
    is decoded using the JSON library) and raises a convenient exception in case of
    failure.
    
    This behaviour change is covered by the provided unit tests.
    
    To test:
    - Apply the patchset
    - Run:
      $ prove t/db_dependent/Koha/Patron/Modifications.t
    => SUCCESS: Tests make sense, and they pass
    - Sign off :-D
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ce0d3fa66217c1e1a99d54ff9eee726c1e68daa4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 13 17:42:53 2016 -0300

    Bug 17767: DBIC update
    
    This patch can be skipped by the RM, it just updates the DBIC schema files.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af976a7fc65928d87bc7311f8211f3c349f9cfba
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 13 17:42:35 2016 -0300

    Bug 17767: Add borrower_modification.extended_attributes
    
    This patch changes the DB structure adding borrower_modifications.extended_attributes
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 02e2a4261c4691f37f3abe086ff990e0ab505282
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 25 11:52:11 2016 +0100

    Bug 17679: C4::Circulation - Remove unused GetItemIssues
    
    Ready for an archaeology course?
    
    C4::Circulation::GetItemIssues is only used once, from
    catalogue/issuehistory.pl
    This call has been added by
      commit 95d6452462a560ba0c0ac859a2cfb7783c25c925
        Adding some more information on issuehistory.
    which says "Adding itemnumber to issuehistory.pl API so that one could search
    for issuehistory of a specific item."
    So it added the ability to see the item issue history but did not
    provide a way to access it via the interface.
    It's ok so far but this subroutine is broken since
      commit aa114f53499b9cffde0571fe7e08622f9c9a332a
        Bug 5549 : Only use DateTime for issues table
    because of this change:
    -    my $today = C4::Dates->today('iso');
    +    my $today = DateTime->now( time_zome => C4::Context->tz);
    
    I let you catch the typo ;)
    And since this commit the subroutine explodes with "The following
    parameter was passed in the call to DateTime::from_epoch but was not
    listed in the validation options: time_zome"
    
    Since it has never been raised by someone and that the feature is
    hidden, I'd recommend to simply remove it.
    
    Note that the "Checked out from" column would have been wrong even if we
    fixed all the previous issue.
    
    Test plan:
    Just dig into the code and confirm what this commit message tells
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Looks fine for me.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8f8e908061c07cb9f22ad338bb05bc95cb691bf6
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Dec 23 14:07:42 2016 +0000

    Bug 17584 [QA Followup] - Rename Koha::Patron::get_checkouts to Koha::Patron::checkouts
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6eab0b94248d86fd4996065ec92f9ebbf44646ea
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 12:52:52 2016 +0000

    Bug 17584: Add the Koha::Patron->get_checkouts method
    
    Test plan:
      prove t/db_dependent/Koha/Patrons.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0b9dcc9ac4f526165351c3901e5f342533c243b3
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Aug 29 04:47:36 2016 +0000

    Bug 17209: Remove use of onclick from masthead
    
    There are two instances which use onclick in the OPAC masthead: clearing
    search history, and logging out.
    
    To test:
    Confirm that clearing search history using the 'x' in the masthead, and
    logging out by clicking 'Log out' in the masthead, work the same before
    and after the patch.
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5fdbf16959757ce67a954b1e85adbb1b6786d6fd
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Dec 12 00:00:30 2016 +0000

    Bug 16072: Changing all instances of 'loading-small.gif' to 'spinner-small.gif' and removing loading-small.gif file.
    
    Confirm that I have not missed any places where there is 'loading-small.gif'
    Have amended patch to not include OPAC changes from previous patch.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2ee5cd27129d487fee26987118a8675033139c53
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Dec 2 19:37:07 2016 +0000

    Bug 15711: Follow up batch_id not used
    
    Changed batch_id to image_id in the template, as the multiparam
    would catch the array case.
    
    TEST PLAN
    ---------
    1) attempt to delete a selected item, but get a warning.
    2) apply this follow up
    3) attempt to delete a selected item, it deletes.
    4) run koha qa test tools
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bd3879e037727cdc2cc851aa910c68bd257ee6f4
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Aug 24 01:08:11 2016 +0000

    Bug 15711: Fixing the 'Delete selected' button on patroncard images
    
    To test:
    1) Go to Tools -> Patron Card Creator -> Manage images
    2) Upload an image if you haven't already
    3) Click Delete selected without selecting any images
    4) Notice broken behaviour as described in Description
    5) Apply patch, refresh page
    6) Click Delete selected without selecting any images
    7) Notice alert. Click OK
    8) Select one image or more, click Delete selected
    9) Notice confirm delete message.
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1b492938e4eee4d1babe26417cfbf69cede2b844
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Dec 20 16:11:36 2016 +0100

    Bug 17785: Fix OAI-PMH's XSLT-generated URLs under Plack
    
    Look at e.g. the URL for Show More at the end of the output of Records or
    Identifiers. If you use Plack, you will see that it refers to
    yourserver:/opac/oai.pl, which is not correct.
    
    This is caused by using CGI's self_url in combination with script alias,
    mounting point, etc. Note that we cannot solve this problem in the code of
    Koha only. Since HTTP::OAI modules also call self_url, we still end up
    with some wrong url's.
    
    Instead of a larger architectural operation on Apache and Plack config files,
    this patch adjusts the final xslt transformation on the OAI response.
    It hardcodes the correct path only once, in a xslt variable. And replaces
    all oai:OAI-PMH/oai:request/text() calls, containing wrong URLs, by this
    variable.
    
    Test plan:
    Run oai.pl. Try the various verbs.
    Verify that the URLs point to /cgi-bin/koha/oai.pl.
    
    Edit: changed commit subject
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Works as expected. Good workaround until a definitive solution is implemented.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2c67648093b9e7479b1dd1135c80ada2d46aee7c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Dec 22 14:00:37 2016 +0000

    Bug 17781 - Improper branchcode set during renewal
    
    For no discernable reason, when AddIssue calls AddRenewal, it passes the
    branchcode generated from _GetCircControlBranch. Assume
    _GetCircControlBranch is set to return items.homebranch. So:
    1) If an item owned by LibraryA is checked out at LibraryB, the
      statistic line branchcode will be LibraryB
    2) If an item is renewed via the ajax datatables renewal function, the
      statistic line branchcode will be LibraryB the
    3) If an item is renewed via scanning the item into the checkout again,
      statistic line branchcode will be *LibraryA*
    
    This is clearly improper behavior. The renewal is taking place at
    LibraryB, so the branchcode passed to AddRenewal should be LibraryB,
    the logged in library. This also jives with the documentation for
    the subroutine.
    
    Test Plan:
    1) Set CircControl to "the library the item is from" aka ( ItemHomeLibrary )
    2) Set HomeOrHoldingBranch to 'The library the items is from" ( aka homebranch )
    3) Create item with homebranch of LibraryA and holdingbranch of LibraryB
    4) Set the logged in library to LibraryB
    4) Check the item out to a patron at LibraryB
    5) Note the statistics line has a branchcode of LibraryB
    6) Check the item out again to trigger a renewal, renew the item
    7) Note the statistic line has a branchcode of LibraryA!
    8) Apply this patch
    9) Repeat step 6
    10) Note the statistics line has a branchcode of LibraryB!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: David Kuhn <kuhn@monterey.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 853d355576698d1643080ef37b797e937338a1f8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 28 09:57:14 2016 +0100

    Bug 17742: Use TestBuilder to create the library and patron category
    
    Moreover we do not need to remove the existing issues and patrons
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5c2618d653f6a8fe4b220f1ca986c8d6c58264e3
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Dec 6 21:07:56 2016 +0000

    Bug 17742: Fix t/db_dependent/Patrons.t
    
    Moves the getting of testing date for updated_on just after the storing
    the test patron data to make the gap between generating data and now
    date as short as possible
    
    Fixes test 7
    
    Use Koha::Database instead of C4::Context->dbh
    
    Test plan
    1. prove t/db_dependent/Patrons.t
    2. read the diff
    
    NOTE: Only minor improvement could be using test builder to
          generate the category and branch codes, rather than assume
          data exists. However, that is beyond scope of this bug.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit db592d14bb7a67aeb2cf91ba47b8210c5101dea2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 27 16:57:34 2016 +0100

    Bug 17520: Do not overlap with advance_notices.pl
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 94085a801c958cebb0e58af87f1470a524455a6f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Oct 31 14:44:51 2016 +0100

    Bug 17520: add serialsUpdate.pl to the list of regular cron jobs
    
    This patch adds the job to debian package file and the examples file
    in misc.
    
    Test plan:
    Add these lines to your cron file.
    Check the results. (If an issue you expect passes the grace period defined
    in the subscription, its status should go from Expected to Late.)
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ea7bd9c4ada6eb6f03d37e43cce89d1431293761
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Sep 5 09:54:35 2016 +0100

    Bug 17246: Do no support arrayref to define multiple FK
    
    Currently you can call GetPreparedLetter like:
    
    $prepared_letter = GetPreparedLetter(
        (
            module      => 'test',
            letter_code => 'TEST_HOLD',
            tables      => {
                reserves => [ $fk1, $fk2 ],
            },
        )
    );
    
    It assumes that $fk1 is a borrowernumber and $fk2 a biblionumber.
    It seems hazardous to do this guess.
    
    I suggest to remove this feature and only allow hashref indeed.
    
    Test plan:
    Use different way to generate letters and make sure you do not reach the croak
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0747a11b2648a20fcca9d3f5e02a4b3b9270b3f3
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Dec 23 13:35:34 2016 +0000

    Bug 14637: Followup - Fix number of tests due to rebase
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a28334aeceba9ea8fcfcd301c4c01f473110bbe3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 6 10:40:46 2016 +0100

    Bug 14637: Fix add patron category under MySQL 5.7
    
    If no dateofbirthrequired or upperagelimit is set on the interface, the
    ->store method will receive an empty string defined for these values.
    For INT field, we must explicitely set these empty value to undef
    instead to avoid MySQL 5.7 (and strict mode) to raise:
      DBD::mysql::st execute failed: Incorrect integer value: ' for column
    'dateofbirthrequired''
    
    Test plan:
    Using MySQL 5.7 (and/or sql_mode=STRICT_TRANS_TABLES)
    Create a patron category without specifying upperagelimit or
    dateofbirthrequired
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5ea0b70dad5213292cb678f38a8b93e5118bdf4d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 6 10:40:28 2016 +0100

    Bug 14637: Fix add patron category under MySQL 5.7 - tests
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2fe2ef41bd8bf2f142597e39f493edbdbf75c8a3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 18:07:40 2016 +0100

    Bug 17783: Replace ok with is
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c5ca94df995ee7543350bf1bab3a1c80b923340f
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Tue Dec 20 16:54:44 2016 +0200

    Bug 17783: Prevent crash when providing an undefined value
    
    When calling the proposed version of get_effective_issuing_rule with undefined
    parameter values, a following crash occurs:
    
    SQL::Abstract::puke(): [SQL::Abstract::__ANON__] Fatal: SQL::Abstract before v1.75
    used to generate incorrect SQL when the -IN operator was given an undef-containing
    list: !!!AUDIT YOUR CODE AND DATA!!! (the upcoming Data::Query-based version of
    SQL::Abstract will emit the logically correct SQL instead of raising this
    exception) at /home/ubuntu/kohaclone/Koha/Objects.pm line 182
    
    This patch adds a test to cover this problem and fixes the issue.
    
    To test:
    1. Run t/db_dependent/Koha/IsssuingRules.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 401f01125c23fe54e7697b0c22619c4d8e728b12
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Thu Dec 15 19:31:30 2016 +0200

    Bug 17783: Optimize Koha::IssuingRules->get_effective_issuing_rule
    
    This patch modifies method get_effective_issuing_rule in Koha::IssuingRules
    aiming to optimize the search for matching issuing rule.
    
    Before this patch, in worst case scenario, we have had to make a SELECT query
    eight times. This will have a negative impact on performance where-ever we need
    to find matching issuing rule multiple times, if the search is not directly
    matching an issuing rule on the first query.
    
    This patch makes get_effective_issuing_rule have a stable performance on both
    best and worst case, whereas the old method was really fast on the best case
    and really slow on the worst case.
    
    However, this patch slightly lowers the performance for best case, where matching
    issuing rule is found instantly before (branchcode, categorycode and itemtype all
    are specifically defined in issuing rules). For all other cases this patch offers
    a performance improvement.
    
    To test:
    1. Run t/db_dependent/Koha/IssuingRules.t and compare the results with previous
       tests.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1ad30e63ea5e1d574d7cf82e86948ef501920d64
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Thu Dec 15 19:28:38 2016 +0200

    Bug 17783: Add Koha::Objects->single
    
    Returns one and only one object that is part of this set.
    Returns undef if there are no objects found.
    
    ->single is faster than ->search->next
    
    This is optimal as it will grab the first returned result without instantiating
    a cursor.
    
    It is useful for this Bug as we only want to select the top row of found issuing
    rules.
    
    To test:
    1. Run t/db_dependent/Koha/Objects.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5b35c8e038a49a4e998656c60ba08e88dd982498
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Thu Dec 15 18:35:13 2016 +0200

    Bug 17783: Test to print performance of get_effective_issuing_rule
    
    This test prints the amount of issuing rule matches per second for
    1. worst case, when non-existent branchcode, categorycode and itemtype is
       being searched (currently 8 queries)
    2. mid case (rule found on 4th query)
    3. 2nd best case (rule found on 2nd query)
    4. best case, when an issuing rule is defined for exactly those branchcode,
       categorycode and itemtype (currently 1 query)
    
    To test:
    1. Run t/db_dependent/Koha/IssuingRules.t
    2. Write down the per-second amount to compare with next patch
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f708b2e8d1f52efbbca9728d1cd7262a6fc0722c
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Thu Dec 15 17:58:39 2016 +0200

    Bug 17783: Test to confirm correct effective issuing rule selection
    
    This patch adds a test to cover the validity of effective issuing rule selection
    in correct order.
    
    To test:
    1. Run t/db_dependent/Koha/IssuingRules.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7ecd9e330481389d523da27f962e8e5242c1bbfa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 25 14:16:26 2016 +0100

    Bug 17689: Add the Koha::Checkout->is_overdue method
    
    This patch adds a new method Koha::Checkout->is_overdue and provide tests
    to cover it.
    The goal is to behave like GetItemIssues set the 'overdue' flag to
    issues.
    I don't understand why the existing GetItemIssues truncate dates to
    minutes, so I did not recreate this behavior.
    
    Test plan:
      prove t/db_dependent/Koha/Checkouts.t
    should return green
    
    Signed-off-by: Mika Smith <mikasmith@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 19ee95a6d5a292152ac0313ad4429b78210da4e0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 14:45:33 2016 +0100

    Bug 17678: Use Koha::Checkouts instead of Koha::Issues
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9dc9437b4ddbfb2b8e47e696cef5d1fbabd03670
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Dec 2 09:57:50 2016 +0100

    Bug 17678: Typo iss in Circulation.t
    
    Iss should be is.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3a41dffaf3908f2397bc662e2a9d77cff6521bd0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 25 11:12:20 2016 +0100

    Bug 17678: C4::Circulation - Replace GetIssues with Koha::Issues
    
    The C4::Circulation::GetIssues subroutine is only called once and can be
    replaced with a call to Koha::Isues->search with a join on items.
    
    Test plan:
    - Apply first patch and make sure the tests pass
    - Apply second patch and make sure the tests still pass
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3de12fdeed83aeadbc5a2bcd32547d06ad8cd5f7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 25 11:06:25 2016 +0100

    Bug 17678: Add tests for CanBookBeIssued + AllowMultipleIssuesOnABiblio
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 194d5898c85abbf3a78d9c4c225a2e439fa54d48
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Oct 4 14:55:51 2016 +0200

    Bug 17398: Enhance circulation messages UI
    
    Test plan:
    1) Apply patch
    2) Add same circulation messages, note that both buttons are in bootstrap style and the whole form is a bit cleaner
    3) Confirm that adding works as expected
    4) Try to delete some of your messages, note the delete link is also button now
    5) Confirm that deleting works as expected
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2f87409a835ac56a651f6a0895a7c92037c28212
Author: Lyon 3 Team <koha@univ-lyon3.fr>
Date:   Fri Sep 30 14:50:16 2016 +0200

    Bug 17317: Perfomance Improvement
    
    - Use of GetItemnumbersForBiblio instead of GetItemsByBiblioitemnumber (thx Jonathan Druart)
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 36222fb735eb4db9fe8309e4db21d34d5aa63e7b
Author: Lyon 3 Team <koha@univ-lyon3.fr>
Date:   Tue Sep 20 12:13:23 2016 +0200

    Bug 17317: ILSDI: Getavailability method with id_type=bib implementation
    
    To test this patch you should try to send a query to you opac formatted
    this way :
    http://[your-opac-domain-name]/cgi-bin/koha/ilsdi.pl?service=GetAvailability&id=[biblionumber]&id_type=bib
    
    You should get availability status for all the items of the matched
    bibliographic record.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4c5f495f0e0f2b7852908d84764b3be0ac02a90f
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Fri Dec 2 04:08:45 2016 +0000

    Bug 17208: Checking if classification source or filing rule already exists before adding
    
    To test:
    1) Go to Admin -> Classification sources
    2) Attempt to reproduce bug before applying patch. Notice the message
    saying the add was successful, but was not added to the table
    3) Apply patch and refresh page (restart plack if necessary)
    4) Add new classification source with same code as existing one. Notice
    you are now told that the add failed.
    5) Confirm adding new classification source with unique code works
    6) Add new classification filing rule with same code as existing one.
    Notice you are told that add failed.
    7) Confirm adding new classification filing rule with unique code works
    
    Sponsored-by: Catalyst IT
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    This is not the way to go, we should use an eval instead.
    But since we do not have RaiseError set, it will not work.
    This module will need to be moved to Koha::Objects to be implemented
    correctly.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8e68e41df448e9bde7baf69ebab2646d2138cca4
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Dec 23 11:31:00 2016 +0000

    Bug 15415 [QA Followup] - Make code more readable
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 47e80e899aca7c79aaeb58350401a1963fbe709d
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Fri Dec 2 03:04:07 2016 +0000

    Bug 15415: Warn when creating a new print profile
    
    As per Jonathan's comment in Comment 3, I've put that line of code in an
    if statement that will only call the get_attr method if we are editing
    an existing profile (therefore the profile id will exist).
    
    To test:
    1) Go to Tools -> Patron Card Creator -> New printer profile
    2) Notice warn
    3) Apply patch
    4) Refresh page
    5) Confirm warn is gone and page still works as expected
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d84458374b45723e280de06c84b0d98a3d8dd622
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Dec 21 14:13:23 2016 +0100

    Bug 17804: Remove some modules from showdiffmarc.pl
    
    Remove DBI, LibXML, LibXSLT.
    Add CGI's -utf8 flag.
    Few whitespace changes.
    
    Test plan:
    [1] Export an existing record to marcxml.
    [2] Edit the file, make some small changes.
    [3] Import it again, use a matching rule.
    [4] Check the diff on Manage staged. (Here is showdiffmarc.pl)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f15eb9d5f534489585f2819ccbce43e6ddc95511
Author: Dani Elder <dani@bywatersolutions.com>
Date:   Mon Oct 10 09:51:43 2016 -0400

    Bug 16933 - Update documentation/help file.
    
    Updates help documentation about Alt+W to open renew tab.
    
    To test: Go to circulation help page, open help file and see that new
    line mentioning Alt+W.
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fc676f4130b399b2f69878760e699c6d01fd262a
Author: Tim McMahon <tmcmahon@wlpl.org>
Date:   Thu Sep 8 12:19:17 2016 -0400

    Bug 16933 - Alt-Y not working on "Please confirm checkout" dialogs
    
    This patch changes the keyboard shortcut for renew from Alt+y to Alt+w.
    
    To test:
    1) Press Alt+y when you get a "Please confirm checkout" dialog.
    2) The renew tab is selected instead of confirming the dialog.
    3) Apply the patch and refresh your browser to load the change.
    4) Repeat step one.
    5) Alt+y confirms the checkout, Alt+w selects the renew tab.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0b915fbd9735d2585944253fc5230fdb7417fb80
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Dec 22 12:46:06 2016 -0300

    Bug 16914: Remove unused empty_lines.inc file
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 152ce671eca4b5d74329b518d9d71106f4e60c84
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Dec 22 12:45:08 2016 -0300

    Bug 16914: Rely on TT for newlines
    
    The translation scripts have an historical tendency to chomp newlines
    and we introduced an empty_line.inc file to force newlines when building
    CSV output out of our templates (in item search and late orders).
    
    This patch makes the mentioned templates use TT ability to force newlines
    plus some misuses of the 'minus' sign.
    
    Test plan:
    - Apply the patch
    - Do an item search that returns more than one result
    - Export as CSV
    => SUCCESS: The CSV file is correctly formed.
    - Install any translation:
      $ sudo koha-shell kohadev
     k$ cd kohaclone/misc/translator
     k$ perl translate install <chosen language>
    - Enable <chosen language> (e.g. es-ES)
    - Repeat the item search
    - Export as CSV
    => SUCCESS: The CSV file is correctly formed in your chosen language.
    - Have more than one late orders (bummer)
    - Go to late orders
    - Choose them
    - Export as CSV (in english)
    => SUCCESS: The CSV file is correctly formed.
    - Switch language
    - Go to late orders
    - Choose them
    - Export as CSV (in english)
    => SUCCESS: The CSV file is correctly formed in your chosen language.
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit 8db17f9ecab0ced4276dcc55e9663d6d0a45575a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 13 12:28:35 2016 +0000

    Bug 17764: (bug 17556 follow-up) Fix search for logged out users and lost items
    
    If you are non logged-in and you the search result contain lost items,
    you will get:
    Can't call method "category" on an undefined value at
    /home/liz/koha-src/koha/C4/Search.pm line 2091.
    
    This is because bug 17556 assumed that $userenv was not defined when the
    user is logged out. Actually it is, with non defined or empty string
    values.
    
    Test plan:
    Do a search in the opac that would turn up a whole list of results (and
    not just that one) with the lost item included.
     => Without this patch you should get an error
     => With this patch applied you should see the search results
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan A Gallagher <brendan@bywatersolutions.com>

commit c86a9e4d300fe746fe542e38a60148de6501f7a6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 15 10:47:24 2016 +0000

    Bug 17743: Item search - Fix indexes build on MARC
    
    Searching items by custom search fields does not work because these
    fields are not correctly processed in JS.
    
    In case of custom search field, the parent of the option is not the
    select but the optgroup element.
    
    Test plan:
    Create a custom search field on 245$c for instance
    On the items search form, select this field and launch a search
    => Without this patch, the results will not be filtered and you will get
    all your items
    => With this patch applied, the results should be correctly filtered
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e16ec2fcdb8bf67c507591386f94b9d024fec596
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 15 13:50:42 2016 +0100

    Bug 16951: Replace some more
    
    In order to avoid warnings in the logs, $cgi->param should be forced to
    scalar context
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2184fa6ab1a7449857df15894c8de075aac729ec
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 15 13:45:22 2016 +0100

    Bug 16951: Fix Item search sorting
    
    Caused by
      commit ac5a1bfececb5400a77f0ebad90181f5215d5a85
        Bug 16154: CGI->multi_param - Manual changes
    
    The change was wrong, we wanted to retrieve a scalar (the string), not
    an array.
    We want to retrieve a string with the different column' names, not an
    array of 1 element.
    
    Test plan:
    Launch an item search and play with column sort
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 00591b2e091b5810b86aa47720501bdaa9695ccf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 14:29:49 2016 +0000

    Bug 17692: Remove 'CGI::param called in list context' warnings
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ffcac846ad125534c0008291d53f094cfde6cc4b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Dec 15 11:10:38 2016 +0000

    Bug 17692 - Can't add library EAN under Plack
    
    When adding a library ean under plack, there is an "internal server
    error" when running Plack. Tested with Koha 16.11 release.
    
    Test Plan:
    1) Apply this patch
    2) Enable Plack
    3) Add, Edit and Delete a Library EAN
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 68b6d3976c2a7e2ea13837da24df057dd79cb321
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 14:28:00 2016 +0100

    Bug 17796: Move Koha::OldIssue[s] to Koha::Checkout[s]
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit be140718d71df9521dca38d51ebe0ee77d7efa9a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 20 13:57:00 2016 +0100

    Bug 17796: Replace Koha::Issue[s] with Koha::Checkout[s]
    
    Koha::Issues and Koha::Checkouts have been added to the codebase to
    represent the same thing.
    
    In ODLIS the word Issue is never used in the sense we use it. Another
    problem with Issue is it has so many meaning in English (such as
    problem/bug)
    The word Checkout *is* in ODLIS, closer to what we use:
    http://www.abc-clio.com/ODLIS/odlis_c.aspx#checkoutslip
    
    Test plan:
      git grep Koha::Issue
    should not return any occurrences and the tests must still pass
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d4b15e40b0a217712756a8a208d4aab97218bbac
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Dec 19 12:55:59 2016 +0100

    Bug 17790: Fix js error on undefined autocomplete(...).data(...)
    
    Bug 17418 moved some code to js_includes.inc.
    But if #findborrower does not exist, you cannot define _renderItem.
    Trivial fix.
    
    Test plan:
    [1] Find a page where this include is used and #findborrowers is absent.
        Like about.pl
    [2] Without this patch, you will have a js error in the js console.
    [3] With this patch, you should no longer have it.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2f07f7b48eab65f8dbd84f50993e388aff907594
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 15 14:01:41 2016 +0000

    Bug 17631: Koha::Biblio - Remove GetHolds
    
    C4::Biblio::GetHolds can be replaced with Koha::Biblio->holds->count
    
    Test plan:
    Create an order and place a hold on the biblio you have ordered.
    On the basket view, you should not be able to Cancel the order and/or
    delete the record
    Receive the order, on the parcel page you should get the same behavior.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6475f83189f2565173a8deb6b1afd363b84a7607
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 15 11:37:30 2016 +0000

    Bug 17630: Add the Koha::Biblio->holds method
    
    This method will be useful to get the current holds placed on a given
    bibliographic record.
    
    Test plan:
      prove t/db_dependent/Koha/Biblios.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 35a8fe0bd11777c785d9d4ca73edb05fdc1f1ecd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 6 09:12:57 2016 +0100

    Bug 17586: Move ->get_balance to Koha::Account->balance
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit de33f2f2916c8d4de0700d8c04e635b6b6c08a7b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 13:50:10 2016 +0000

    Bug 17586: Add the Koha::Account::Lines->get_balance method
    
    Test plan:
      prove t/db_dependent/Accounts.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d4a15fc1f141aa7ddf5ccd487eb9ae3df8048005
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 6 07:58:34 2016 +0000

    Bug 17585: Replace ->get_account_lines with ->account
    
    And return a Koha::Account instead of a Koha::Account::Lines
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ce92367784b4c59db3b6aeb0e765ee3ecc0cef84
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 13:19:39 2016 +0000

    Bug 17585: Add the Koha::Patron->get_account_lines method
    
    Test plan:
      prove t/db_dependent/Koha/Patrons.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 430542ad55368ffeb038c0425dafd5fb2477c292
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Dec 16 13:14:50 2016 +0000

    Bug 17578 [QA Followup] - Update number of tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 631d3006bc2a9e5f876bb9cefb5dbc0f44c9dd11
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 29 19:20:13 2016 +0100

    But 17578: (followup) amountoutstanding
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b59df2bce788bc5cc3b184c9c74688dd745a2fb0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 11:03:54 2016 +0100

    Bug 17578: GetMemberDetails - Remove GetMemberDetails
    
    All the values different from the ones GetMember returned has been
    managed outside of GetMemberDetails.
    It looks safe to replace all the occurrences of GetMemberDetails with
    GetMember.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 69018a7930928c141b3bc1a192f450b1dd5bf6a7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 09:47:53 2016 +0000

    Bug 17578: GetMemberDetails - Remove enrolmentperiod
    
    This value is not used anywhere
    
    Test plan:
      git grep enrolmentperiod| grep -v installer| grep -v translator|vim -
    
    should show you that I am right
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 43dda643817b6bb83c27fd257532d2b4a2593592
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 09:46:15 2016 +0000

    Bug 17578: GetMemberDetails - Remove reservefee
    
    Same as other patches, reservefee is only used in opac-reserve.pl
    
    Test plan;
    Set reserve fee for a patron category
    Place a hold at the OPAC with one of these patrons.
    You must get a message about the reserve fee.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5a0a2ce584dec74808f471b0f92b2114c3d6029e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 18:14:49 2016 +0100

    Bug 17578: GetMemberDetails - Remove is_expired
    
    The is_expired value is used in 2 places, let's use
    Koha::Patron->is_expired instead.
    
    Test plan:
    Depending on the different value of BlockExpiredPatronOpacActions for
    the patron category, a patron must be blocked if he has expired.
    Confirm that behavior from opac-renew and opac-reserve scripts
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 41493004f69caf471e8d73b7db2a64e433f57465
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 16:52:54 2016 +0000

    Bug 17578: GetMemberDetails - Remove flags
    
    Same as authflags, a flags key is set containing all the patron flags.
    It is only used in a few places and it's better to call
    C4::Members::patronflags when we need it.
    
    Test plan:
    Look at the diff and confirm that the change make sense
    Use git grep to confirm we do not use the flags somewhere else.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4e78f1000de2cfa6a9cc434a4605d3e4ed6742d1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 16:16:04 2016 +0000

    Bug 17578: GetMemberDetails - Remove amountoutstanding
    
    The amountoutstanding value set by GetMemberDetails was only used in a
    few places. In that case it makes sense to only retrieve it when needed.
    
    Test plan:
    1/ Add fines to a patron, on the OPAC patron info page, you should see a
    "Fines" tab
    2/ Add credit to a patron, you should see the credit displayed
    3/ Set the pref maxoutstanding to 3
    4/ Add a fine of 4 to a patron
    5/ Try to place an hold for this patron
    => You should get a "too much oweing" message
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d1e7bbc602039da4443405cf710d2203fc7685ce
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 17:01:03 2016 +0100

    Bug 17578: GetMemberDetails - Remove authflags - 2
    
    This script is not used from the Koha codebase and does not seem very
    useful.
    We could rewrite it if needed later (ie. if someone complains I will
    rewrite it).
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fbb50b517f38682ce0f95ccc5a73604969463e4b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 17:02:55 2016 +0100

    Bug 17578: GetMemberDetails - Remove authflags - 1
    
    GetMemberDetails create a authflags key, but this key is only used from
    2 different places.
    One is a very simple script, which does not seem very usefull
    C4/SIP/interactive_members_dump.pl. I propose to simply remove it.
    The other one is the member-flags.pl script. What is done in this one is
    a bit weird since we a doing twice the same query (it was not highlighted
    before this patch). We will need to fix that later.
    At the moment the goal it to remove the GetMemberDetails subroutine
    without introducing any regressions (and so without adding big changes)
    
    Test plan:
    Select/unselect permissions for a patron, save and edit again.
    The behavior of the permission checkboxes should be ok
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 492280102fdc61568e1c7fbf9f464a852ac12c2c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 15:53:25 2016 +0000

    Bug 17578: GetMemberDetails - Remove BlockExpiredPatronOpacActions
    
    The correct way to get the value of BlockExpiredPatronOpacActions from a
    patron object is to get the patron category then call the
    effective_BlockExpiredPatronOpacActions:
      $patron->category->effective_BlockExpiredPatronOpacActions
    
    So this patch applies this change and remove this value from the
    GetMemberDetails subroutine.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ca5fb693627a46aac06b40d6bc2ee1d7f3781340
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 14:24:54 2016 +0000

    Bug 17568: Add the Koha::Patron->library method
    
    This method will be convenient when moving code to Koha::Patrons
    
    Test plan:
      prove t/db_dependent/Koha/Patrons.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01226c61a1be588cb472e7ca7822c0e9d4ecf7b4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 4 16:21:03 2016 +0000

    Bug 17557: Koha::Patrons - Move GetAge to ->set_age (and remove SetAge)
    
    As said in the previous commit, I considered SetAge as unnecessary and
    removed it.
    
    Test plan:
    1/ Edit a patron using the different 'Edit' links
    2/ Play with the patron category limited to age ranges, and date of
    birth
    3/ You should get the expected warning if the date of birth is inside
    the patron category date range.
    
    To finish:
      prove t/Circulation/AgeRestrictionMarkers.t t/db_dependent/Reserves.t \
            t/db_dependent/Koha/Patrons.t t/db_dependent/Members.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7808bd690b2e51c8a56d3a11f84fbe2b332beb24
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 4 16:18:00 2016 +0000

    Bug 17557: Revised patron age calculation tests
    
    The SetAge and GetAge test coverage are excessive.
    First the SetAge subroutine was only created for testing purpose.
    The goal of GetAge is quite simple and it seems quite easy to provide
    corect test coverage using DateTime->add using negative numbers.
    
    Edit: rebased so it applies
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>

commit b133b0e94d57546e70eeb3a3b20befd130c343e6
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Apr 5 14:51:43 2016 +0200

    Bug 16203: Convert item plugins to new style (see bug 10480)
    
    Converts item plugins to new style (with builder and launcher).
    See also bugs 10480 and 13437.
    
    The following plugins have been adjusted:
    barcode_manual.pl
    barcode.pl
    callnumber-KU.pl
    callnumber.pl
    cn_browser.pl (Added license statement too)
    dateaccessioned.pl
    macles.pl
    stocknumberam123.pl
    stocknumberAV.pl
    stocknumber.pl
    
    Test plan:
    Connect the plugin to an item field.
    Verify that the plugin still works.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested if all plugins compile okay.
    Ran most of them thru FrameworkPlugin.t.
    Tested them in the item editor.
    
    Note: the form for macles.pl comes up, further hard to test.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d5a160ed956703c3572dcc9dde8d1e253272f011
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Mon Nov 7 09:32:54 2016 +0000

    Bug 17472: Borrower Previously Checked Out: Display title
    
    Test plan:
    0) apply the patch
    1) turn on checking previously checkouts - syspref CheckPrevCheckout
    2) checkout an item to borrower
    3) check the item in and check it out again, you should see the
    dialog, with information that the current item was previously checked
    out to this patron. With this patch, the information includes title and
    author of the item
    
    Signed-off-by:  Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e180c568affed09580ecf0f40737d1ec426fe2fa
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Oct 10 05:52:51 2016 -0400

    Bug 17418 - Move staff client home page JavaScript to the footer
    
    This patch alters the header and footer include files so that JavaScript
    can be included in either one or the other. As a proof of concept, the
    staff client home page is updated to include JS in the footer instead
    of the header.
    
    The processing of JavaScript included on individual pages can now be
    similar to how it is done in the OPAC. A block is created with the
    page's JavaScript which is then processed in js_includes.inc in the
    correct order, after other required js assets.
    
    On pages which have been modified to allow JavaScript to be moved to the
    footer you must add a variable to the template: [% SET footerjs = 1 %].
    Eventually all staff client templates should be modified so that setting
    a flag is not required.
    
    "[% MACRO jsinclude BLOCK %]" is used instead of "[% BLOCK %]" and "[%
    PROCESS %]" because MACRO allows the template directives to be
    processed correctly when included by intranet-bottom.inc.
    
    To test, apply the patch and view the staff client home page.
    
    - Confirm that you get a confirmation when deleting a news item from the
      home page.
    - Enable the CircAutocompl system preference and test that patron
      autocomplete works from the "Check out" tab from the staff home page
      and from other pages where the "Check out" tab is present.
    - Test that JavaScript is working correctly on other pages like
      Circulation, Preferences, etc.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 97eb773c0a4054f0538c8966e207734f6f56bdd5
Author: Kyle M Hall <kyle@kylehall.info>
Date:   Mon Dec 12 06:59:30 2016 -0500

    Bug 17761 - Renewing or returning item via the checkouts table causes lost and damaged statuses to disappear
    
    Due to the fact that the lost and damaged status are contained within the due_due span,
    when the item is renewed or returned these statuses disappear.
    Some librarians find this disconcerting and it seems that it would be better to keep the visible.
    
    Test Plan:
    1) Find a lost item checked out to a patron
    2) Renew that lost item via the checkouts table
    3) Notice the lost status disappears from that row
    4) Apply this patch
    5) Refresh the page ( you may want to clear your browser cache as well )
    6) Renew the item again
    7) The lost status should remain visible!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Edie Discher <edischer@cityoffargo.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3cd1a60157ea5cf5c4b906b96a8a39ed01292288
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Nov 16 10:02:34 2016 +0000

    Bug 17700: Add columns setting to fines tables
    
    Test plan:
    0) Apply the patch and restart memcached + koha-common services if
    needed
    1) Go to adminitration -> Configure columns and confirm there is new
    table configuration with id=account-fines in Patrons section available
    2) play with table setting to ensure it works as expected
    3) go to to boraccount page for some patron with both fines - payed and
    owed
    4) Note there is new button "Columns visibility" in top paginator panel,
    try to use it
    5) Play with the datatable, sort filter and so on
    
    Signed-off-by: Radek Šiman <rbit@rbit.cz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b292874538ac9af55314b55155d98e2c42d00970
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Oct 31 14:39:40 2016 +0000

    Bug 14876 - Show number of holds per record on the search results
    
    This patch sues the existing plugin
    Koha::Template::Plugin::Biblio->HoldsCount
    
    To be consistent with current behaviour 'Holds (0)' is shown when
    no holds have been placed on an item
    
    To test:
    1 - Search in staff
    2 - Note holds link has no extra information
    3 - Apply patch
    4 - prove -v t/db_dependent/Template/Plugin/Holds.t
    5 - Do search in staff that returns records with some holds (i.e. place
                    some holds)
    6 - Note the number of holds now displays next to the text of the link:
        Holds (#)
    
    Signed-off-by: Barbara Johnson <barbara.johnson@bedfordtx.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b222e7d9218e353908ed8d7eda1407d8846b75b5
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Fri Sep 30 09:31:11 2016 +1300

    Bug 13029 : Follow up
    
    Adding POD, changing the config files to live in a path pointed to by
    koha-conf.xml
    
    This means multiple instances can have their own config
    
    Please test the 2 patches together
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Works as advertised. Arbitrary arguments can be passed to SMS:Send
    drivers. If an argument is provided that has already been set by
    SMS::Send or the driver, it will be overwritten by the value from
    the YAML file. My only suggestion for an improvement would be an
    example of what the YAML should look like, but that is a minor thing.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d6d16e90dab280188e9a1a3b1466a5e6a9139fae
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Oct 6 15:04:12 2014 +0200

    Bug 13029: Allow to pass additional parameters to SMS::Send drivers
    
    C4::SMS::send_sms now reads a YAML file and pass all parameters in the
    file to SMS::Send::new.
    
    The config file is read in <installdir>/etc/sms/driver/<driver>.yaml.
    For instance, if the driver used is SMS::Send::UK::Kapow, the config
    file has to be in <installdir>/etc/sms/driver/UK/Kapow.yaml
    
    A underscore character is prepended to all parameter names so they are
    treated as driver-specific options (leading underscore must not appear
    in config file).
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1bfcebfb7fa0837428fb577a6fc059886fe37afb
Author: Chris Kirby <chris.kirby@ilsleypubliclibrary.org>
Date:   Mon Nov 28 00:15:02 2016 -0500

    Bug 17652: opac-account.pl does not include login branchcode
    
    opac-account.pl does not include the login branchcode, whereas the other pages
    available to users (opac-user, opac-memberentry, opac-passwd, opac-readingrecord,
    opac-suggestions, opac-messaging, opac-shelves, etc.) on login DO provide
    the login branchcode. Having the login branchcode available on opac-account.pl
    would facilitate customization of the OPAC for individual branches.
    
    To test:
    1) Login to the OPAC and open  /cgi-bin/koha/opac-account.pl
    2) Inspect the body tag and observe the class attribute does not include
       the login branchcode.
    3) Apply the patch.
    4) Repeat step 2.
    5) Observe that the login branchcode is present.
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b5c1a965b165093fb66a5db356da84b4a62bf9a6
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 25 13:22:42 2016 +0100

    Bug 17681: Exiisting typos might thow some feees when recieved
    
    Yes, we are fixing these four typos here.
    
    Test plan:
    [1] Read the changes.
    [2] Run t/Auth_with_shibboleth.t
    [3] Run git grep recieved| grep -v -e 'recievedlist' | grep -v -e 'serials-recieve.tt'
    
    Note: serials-recieve.tt is just history. Bonus points for the one who makes
    us get rid of that column recievedlist.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    EDIT:
    Rebased. Change in Accounts has been corrected already.
    Removed the po file.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb3f899826966b5da1242292091aa71ab4831618
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 2 17:16:10 2016 -0300

    Bug 17547: (MARC21|NORMARC) have Chronological term field $9 indexed
    
    This patch makes Zebra index the 648$9 link for chronological terms on
    bibliographic records. This way an authority search on chronological terms
    will show the right number in 'Used in X records' message.
    
    To test:
    - Have a record with a 648 field, linked to an authority record (i.e. with an authid on 648$9).
    - Search for the record, notice it is indexed.
    - Perform an authority search for the chronological term
    => FAIL: the term is linked to our record, but koha shows '0' count.
    - Apply the patch
    - Run:
      $ cd kohaclone
      $ xsltproc etc/zebra/xsl/koha-indexdefs-to-zebra.xsl \
           etc/zebradb/marc_defs/marc21/biblios/biblio-koha-indexdefs.xml \
         > etc/zebradb/marc_defs/marc21/biblios/biblio-zebra-indexdefs.xsl
      $ git diff
    => SUCCESS: Notice the shipped etc/zebradb/marc_defs/marc21/biblios/biblio-zebra-indexdefs.xsl
       is up-to-date
    - Run:
      $ sudo cp etc/zebradb/marc_defs/marc21/biblios/biblio-zebra-indexdefs.xsl \
                /etc/koha/zebradb/marc_defs/marc21/biblios/biblio-zebra-indexdefs.xsl
      $ sudo koha-restart-zebra kohadev
      $ sudo koha-rebuild-zebra -f -b -v kohadev
    - Search for the record, notice it is indexed.
    - Perform an authority search for the chronological term
    => SUCCESS: the term is linked to our record, usage count is 1
    - Sign off :-D
    
    I assume NORMARC is similar on this regard. Feel free to fail it if the NORMARC part of the
    patch is wrong.
    
    Sponsored-by: Universidad Nacional de Cordoba
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 82d75e124e416aef13f11d43837438799bd850dd
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Dec 12 13:48:40 2016 +0100

    Bug 17759: Remove invalid guarantorid's in Members.t
    
    See also bug 17733. As long as we have no FK, these invalid guarantorid's
    can make tests fail.
    Adding a sql statement to clear them in the beginning of the test.
    
    Test plan:
    [1] Since it seems that AUTO_INC+8, +9 and +10 may fail one or two tests,
        we should manipulate one or two borrowers:
        Run this SQL query first:
    SELECT `AUTO_INCREMENT` FROM  INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = '[your database]' and table_name='borrowers';
        Now run: UPDATE borrowers SET guarantorid=[former value + 8] WHERE borrowernumber=[some existing borrowernumber]
    [2] Without this patch, run Members.t. Should fail two tests.
    [3] Apply the patch. Fetch the new AUTO_INCREMENT value and update
        guarantorid accordingly again for the manipulated borrower.
    [4] Run the test. It should not fail.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a1592ec10be56569b64774a3dde1e85c53ba36d9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 8 19:41:33 2016 +0000

    Bug 17749 - Missing l in '.pl' in link on waitingreserves.tt
    
    Fixes a small typo introduced by Bug 17010
    
    waitingreserves.p#[% tab %]
    
    should be
    
    waitingreserves.pl#[% tab %]
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62074e39f0bbce1665f2b329beecc61fc55c994e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 6 17:09:21 2016 +0100

    Bug 17733: Fix Members.t
    
    In some dirty DB (Jenkins), the borrowers.guarantorid field is not set
    to a valid patron id.
    That make some tests fail if we create a patron with that patron id.
    
    In my DB, auto increment for borrowers is set to 52 before the tests
    On the 4th run of the tests, some tests fail.
    Before I got a patron with a guarantorid=112 (I let you do the math).
    
    Test plan:
    The easiest is to trust me
    
    Todo: Add a FK!
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Opened a new report for special case: Bug 17759.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b67f635b14b6ce1337785f65ef1dfaa4a36258e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Dec 15 08:43:05 2016 +0100

    Bug 17666: [QA Follow-up] Mark File::Slurp as required
    
    Not optional since we are 'using' it in updatedatabase.pl.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c9e95aa22e56536654305ab32ab1b15a27e89557
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 12 21:44:59 2016 +0000

    Bug 17666: Revert "Bug 16685 [QA Followup] - Use Path::Tiny::slurp instead of File::Slurp"
    
    This reverts commit 7ac1bc35372990520a7c67870b2c702c41bbebcc.
    
    On a kohadevbox:
    Error flock (1) on
    '/home/vagrant/kohaclone/installer/data/mysql/atomicupdate/bug_xxxx.perl':
    No locks available at installer/data/mysql/updatedatabase.pl line 13637.
    
    This is because Path::Tiny->slurp[_utf8] uses flocks which does not work
    with NFS
    
    Test plan:
    Execute a .perl atomic update file on a kohadevbox
    => Without this patch you should get the flock error
    => With this patch the update should work fine
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6163337cd8caab98db993e4d51ac73abbdd83b86
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Nov 21 08:26:13 2016 -0500

    Bug 11274 Sent Notices Tab Not Working Correctly
    
    This patch implements the notices toggle event using a different method.
    Using on() lets us bind the event to a parent element, allowing the
    event to attach to elements which may not exist on the page yet.
    
    Test plan the same as original patch:
    
    1) have a patron with more then 20 notices sent
    2) go to patron profile -> notices
    -> without patch, the showing/hidding of notices content does work
    correctly only on first loaded page
    -> with patch, it should work correctly everywhere - try to use
    paginator, searching, ordering....
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 604c56c088a224cd0fa4c536e93967c89da78462
Author: Olivier Crouzet <kohateam@univ-lyon3.fr>
Date:   Thu Nov 10 17:25:09 2016 +0100

    Bug 17470 Make overdue notices according to branch item only
    
    When a patron had overdues on items from different branches
    he received from each corresponding branch a notice claiming
    the complete list of these items.
    
    Signed-off-by: sbujam <sbujam@users.noreply.github.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3e9dc5d51c5a14fcefe8611c532fe970e930b72a
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Dec 8 10:13:35 2016 +0100

    Bug 17744: Remove the oai_dc:dcCollection wrapper in OAI responses
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3ff400e20d8d509e6a98a132b571e71f112ba756
Author: Kyle M Hall <kyle@kylehall.info>
Date:   Sat Dec 10 10:07:28 2016 -0500

    Bug 15896 [QA Followup] - Remove use of Carp::Always
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 662f5625c2a87c9d2c738c7f0c0022fc493288a6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 4 15:12:53 2016 +0000

    Bug 17556: Koha::Patrons - Remove GetHideLostItemsPreference
    
    The subroutine C4::Members::GetHideLostItemsPreference can easily be
    replaced with Koha::Patron->find(42)->category->hidelostitems
    
    Test plan:
    Create 2 patron categories, 1 with "Lost items in staff client" set to
    "shown" and another one to "Hidden by default"
    Create 2 patrons using them
    On the result search page, the detail page of a record, the item list
    page and the page to place a hold, make sure the lost items are
    shown/hidden as expected
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7705a195a7675b247d128f56e8453d945220826e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Oct 31 13:50:16 2016 +0000

    Bug 17516 - Add CSV export option to item search after displaying output to screen
    
    To test:
    1 - Perform an item search
    2 - Note you now have a link to output to csv
    3 - Click that link
    4 - Page should not change and you should recieve a csv
    5 - Ensure nothing breaks
    6 - Sign off
        High five!
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb3c3a57949d732e0a11182922e816d0611e9bf7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 23 09:23:19 2016 +0000

    Bug 17416: Fix audio alerts
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 10a0f53fb6f4413a23e5836c14567c23e8284774
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Oct 10 05:52:51 2016 -0400

    Bug 17416 - Move javascript in doc-head-close.inc into a separate include
    
    In order to prepare to move staff client javascript assets into the
    footer, this patch creates a new include file containing all <script>
    content. This change should have no visible effect on how pages are
    generated.
    
    To test, apply the patch and view various pages in the staff client
    (ciruclation, preferences, etc) to confirm that JavaScript is working
    correctly.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2fcceb7f402abdc7ca30d72d11e1815a1309b41b
Author: Kyle M Hall <kyle@kylehall.info>
Date:   Fri Dec 9 12:56:49 2016 -0500

    Bug 15896 [QA Followup] - Supress warn when running unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4b0f08e0e1bb785fc08a1f63e99ebcdbbc75a50e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 4 13:05:18 2016 +0100

    Bug 15896: [QA Follow-up] Fix parameter name in POD
    
    Also adjust typo feees.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8ed2cd10bebf5df7cbc4834aada7e6b266e37507
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Nov 4 10:40:38 2016 +0000

    Bug 15896 - Unit Tests
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b6d5748c001febc5acd67938d12ba25844d11fbc
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 4 11:39:12 2016 +0100

    Bug 15896: [QA Follow-up] Add accountlines_id parameter in paycollect
    
    We can solve the minor problem reported on 15906 now by using the
    accountlines_id parameter of this report.
    
    Test plan:
    [1] Add two manual fines (say 20 and 30).
    [2] Pay the second one in full, and check that the first one is not paid
        first. So the 20 should remain and not the 30 with 20 outstanding.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ed9cf81c3aa8fd82f9347556364e9d2e6cef8a82
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 12:36:20 2016 +0000

    Bug 15896 - Use Koha::Account::pay internally for makepayment
    
    This is the second patch in a series to unify all payment functions into
    a single mathod
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/Accounts.t
    3) Test fine payment via the "Pay" button
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Veron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 30dd8f99204837e2e76015badd93025599cd552c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 4 09:46:08 2016 +0100

    Bug 15906: [QA Follow-up] Correct a partial payment
    
    The amount in accountlines should be saved as a negative amount, but
    amount outstanding is correct.
    
    Note: This routine is actually used only once (in paycollect.pl). And is
    only cosmetically tested in Accounts.t.
    
    Test plan:
    [1] Create a manual invoice, Fine, say 20.
    [2] Click on the Pay button next to this fine, and pay 1.
    [3] Pay again, using 'Pay amount' button, and pay 2.
    [4] Pay again, using 'Pay' on the same line, the full remaining amount.
    [5] Verify that you see -1, -2 and -17 on the Accounts tab.
    [6] Run t/db_dependent/Accounts.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e716299c32e201e2cf442a937a7fa7a6a47f6907
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 15:51:07 2016 +0000

    Bug 15906 - Remove use of makepayment in paycollect.pl
    
    Test plan:
    1) Apply this patch
    2) Make a payment in full using the "Pay" button
    3) Note payment succeeds
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 427ba8b0c7f7a976e3c90a4f811836532e0f3875
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 5 11:19:12 2016 -0300

    Bug 17722: Make PatronLists.t run inside a transaction
    
    This patch makes t/db_dependent/PatronLists.t run inside a transaction.
    It also makes it generate its own data using t::lib::TestBuilder instead
    of relying on sample patrons on the DB.
    
    To test:
    - Run:
      $ prove t/db_dependent/PatronLists.t
    => SUCCESS: Tests pass
    - Apply the patch
    - Run:
      $ prove t/db_dependent/PatronLists.t
    => SUCCESS: Tests pass
    - Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 36c608ab846c97aa76ea2fd721c7ce09f2c638ed
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 8 17:19:03 2016 +0000

    Bug 14541 (QA followup) Add warning to gist system preference
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb3d6625e87fbc861c11e181cea36f9f9cd329cc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 9 09:13:27 2016 +0000

    Bug 14541: Do not truncate tax rate values
    
    Tax rates are stored in decimal(6,4) fields which means that 4 decimals
    are allowed.
    If a tax rate is 8.42%, it is stored as 0.0842
    If a tax rate has more precision than that, Koha won't deal correctly
    with it. We will need to update the DB structure.
    
    With this patch, the tax rate will be displayed with the same precision
    as in the DB. So if you enter 8.42, you will see 8.42% instead of 8.4%
    without this patch.
    
    Test plan:
    Do a full acquisition workflow with a tax rate like 8.42% and confirm
    that it is correctly displayed.
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3e112f3837346b500ce863a248920d3207e27131
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 22 15:28:04 2016 +0000

    Bug 17668: Fix typo in parcel.pl - listinct vs listincgst
    
    This typo has been introduced by
      commit eed14b080db8691f371b4c19f1a190b87fcc396a
        Bug 13001: Refactor VAT and price calculation - parcel page
    So before the tax rewrite (13321, 13323).
    It sounded weird to me that testers did not catch the bug on this page.
    
    To understand the logic:
    Conditions are listincgst, invoiceincgst
    Conditions | Before this patch |  If we fix the typo  | After this patch
     0     0   |    excluded       |    excluded          |   excluded
     0     1   |    included       |    included          |   included
     1     0   |    excluded       |    excluded          |   excluded
     1     1   |    included       |    included          |   included
    
    Test plan:
    Create 4 vendors with the difference combinations
    Create a basket, add an order (with a tax) and receive it
    Confirm that the different values displayed on the parcel page are correct
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 167c74bfd386287783e101989b804077b1020369
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 23 10:06:04 2016 +0000

    Bug 15822: Fix 500 error when searching if items.onloan=0000-00-00
    
    The calls
      output_pref({ dt => dt_from_string( $date ) })
    are wrong and should be replaced with
      output_pref({ str => $date })
    For better error handling.
    
    Here we fix the problem of items.onloan when searching
    
    Test plan:
    - Set items.onloan=0000-00-00 (UPDATE items SET onloan='0000-00-00')
    This can come from old data or bad migration
    - Execute a search
    => Without this patch you get
    Can't locate object method "ymd" via package "dateonly" (perhaps you forgot to load "dateonly"?) at /home/vagrant/kohaclone/Koha/DateUtils.pm line 225.
    => With this patch you won't get the error
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 32354d8322afd05704d87cb38d9bc032ce8c4ec1
Author: David Cook <dcook@prosentient.com.au>
Date:   Mon May 23 11:57:04 2016 +1000

    Bug 16376 - Koha::Calendar->is_holiday date truncation creates fatal errors for TZ America/Santiago
    
    Using a DateTime object with a timezone of America/Santiago
    was causing fatal errors for Koha::Calendar->is_holiday
    and Koha::Calendar->exception_holidays, when the objects
    were truncated to an invalid local time.
    
    Using a floating zone allows us to use the same day, month, year
    for comparison purposes without running into the possibility of
    creating an invalid local time and thus a fatal software error.
    
    Edit:
    
    While the changes to is_holiday and single_holiday make sense (Jonathan agrees too)
    I didn't manage to have them fail, because truncate is not failing in my trials, but
    days_between. So to me, it narrows down to have exception_holiday return floating tz
    datetime objects so it doesn't break days_between.
    
    Anyway, it is ok to push this patch, and the regression test I provide covers this scenario
    I'm describing.
    
    To test:
    - Apply the regression tests patch
    - Run:
      $ prove t/db_dependent/Holidays.t
    => FAIL: Unexpected error due to bad timezone/date combination
    - Apply this patch
    - Run:
      $ prove t/db_dependent/Holidays.t
    => SUCCESS: Tests pass
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c6a0848ff0b7acbec4d7bf817447d7cc84c0615e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 6 11:29:08 2016 -0300

    Bug 16376: (regression tests)
    
    This patch introduces a regression test for exception_holidays. This routine
    returns a list of datetimes to be used in date comparison and some datetimes don't exist
    in some timezones, so floating timezones should be used instead.
    
    To test:
    - Apply the patch on master
    - Run:
      $ prove t/db_dependent/Holidays.t
    => FAIL: The new test fails
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d0b6197709f468aac6157c9901acc89be48e304f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Dec 5 16:11:04 2016 +0000

    Bug 17586 [QA Followup] - Correct the number of unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 15ed13845ff1c54605434a8f3100a72534af2351
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 2 15:32:13 2016 -0300

    Bug 17716: (followup) Remove dep on existing data and tidy
    
    This patch removes the requirement for this tests for the DB to include
    at least 10 borrowers to pass. Borrowers are now created on each run
    using t::lib::TestBuilder and a loop.
    
    Bonus: some tiny changes to tidy the file.
    
    To test:
    - Run:
      $ prove t/db_dependent/CourseReserves.t
    SUCCESS => Tests pass with and without the patch.
    - Sign off :-D
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c275cf490fae608d9eec17d5ed55e5cd3f73c350
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 2 15:21:58 2016 -0300

    Bug 17716: Remove itemtype-related t/db_dependent/CourseReserves.t
    
    This patch makes t/db_dependent/CourseReserves.t create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/CourseReserves.t
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
      set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/CourseReserves.t
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b74d04543593bc4ead9da839c6692bf2d1841712
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 2 14:32:30 2016 -0300

    Bug 17715: Remove itemtype-related t/db_dependent/Holds/RevertWaitingStatus.t warnings
    
    This patch makes t/db_dependent/Holds/RevertWaitingStatus.t create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Holds/RevertWaitingStatus.t
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Holds/RevertWaitingStatus.t
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2dd4ecb4c7e0c9b717d6b6dec42ec3ad735236be
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 2 14:19:22 2016 -0300

    Bug 17714: Remove itemtype-related t/db_dependent/Members/* warnings
    
    This patch makes t/db_dependent/Members/* create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Members/*
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Members/*
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0b71fda3d591266fb02a11c9fbbaff04de1aafa6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 2 15:10:51 2016 +0000

    Bug 17713: Fix Members.t tests
    
    If the category_type is 'S', GetBorrowersToExpunge won't return the
    patron.
    
    Test plan:
      t/db_dependent/Members.t
    should always return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8edb7f6fb94a72f7ebc0b1d0ade031f0bed651cf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 5 08:17:21 2016 +0000

    Bug 17720: CSRF - Handle unicode characters
    
    From the pod of Digest::MD5:
    """
    Since the MD5 algorithm is only defined for strings of bytes, it can not
    be used on strings that contains chars with ordinal number above 255
    (Unicode strings). The MD5 functions and methods will croak if you try
    to feed them such input data.
    What you can do is calculate the MD5 checksum of the UTF-8
    representation of such strings.
    """
    
    Test plan:
    - Set a MySQL/MariaDB password with unicode characters:
      UPDATE user SET password=PASSWORD('❤') WHERE USER='koha_kohadev';
      FLUSH PRIVILEGES
    - Update your $KOHA_CONF file
    - Restart Memcached
    - Hit the files modified by this patch
    
    => Without this patch, you will get a software error (with "Wide
    character in subroutine entry" in the logs).
    => With this patch, everything will go fine
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Edit: removed debugging leftover
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 59a322ae7014820603ac807de7234a13c06ad696
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Dec 5 14:19:35 2016 +0000

    DBRev 16.12.00.000 - Update Koha.pm
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 46432511a600f0f22b35d004ee47eb573a33f94f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 12:16:49 2016 +0000

    Bug 17580: Add the Koha::Patron->get_overdues method
    
    This method will be used by several patches later.
    
    Test plan:
      prove t/db_dependent/Koha/Patrons.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9d0c436cb4e6f6866957cdfd9623a10df07126f7
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Dec 2 11:25:29 2016 +0100

    Bug 17583: [QA Follow-up] Final polishing
    
    Number of tests in Patrons.t corrected.
    Method is_going_to_expired (no english!) renamed to is_going_to_expire.
    Adding a negative duration replaced by a subtract. Reads easier.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6bea1c641f8adf69b34205282e4318263e771d40
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 15 11:16:03 2016 +0000

    Bug 17583: Mock the pref before tests
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac281a12910df8d4cc9116d9c4748d028402f67a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 9 13:24:09 2016 +0000

    Bug 17583: Make sure we are comparing 2 dates
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c48646e956b2ec8105f818be9ee6cc275372cc6f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 9 11:25:16 2016 +0000

    Bug 17583: Fix tests
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e5ea08beadb9185f2b34dcf8f1830f01efc563b8
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Nov 9 09:59:50 2016 +0000

    Bug 17583: Add test for is_going_to _expired to be true
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 57fd09f45c4372438b10cf6779a42def51c77960
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 15:01:55 2016 +0000

    Bug 17583: Add the Koha::Patron->is_going_to_expired method
    
    In order to be consistent, we need to create this method as well.
    
    Test plan:
    Make sure the pref NotifyBorrowerDeparture works as expected
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 57eb834ba74a0f440e38e2eea94e9ce315d1a62d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 12:26:00 2016 +0100

    Bug 17583: Use Koha::Patron->is_expired from the circulation page
    
    Bug 17579 introduces a Koha::Patron->is_expired method.
    Let's use it from this script.
    
    Test plan:
    Confirm that you see the message on the interface from the circulation
    page for an expired patron
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4716c495e091cb9cf6e867bfaa993fd5aeb8ccae
Author: Petter Goksøyr Åsen <petter.goksoyr.asen@kul.oslo.kommune.no>
Date:   Wed Nov 23 11:12:24 2016 +0100

    Bug 17671: Remove unused variables in C4::Reserves
    
    I was reading through Reserves.pm trying to figure out a bug - found some
    unused variables instead.
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 24102a7787ebbbccce2a8c8f013e2c79b33cce62
Author: Eric Phetteplace <phette23@gmail.com>
Date:   Tue Nov 29 12:16:23 2016 -0800

    Bug 17696: Add 2 missing periods in opac-suggestions.tt
    
    Problem:
    
    - two missing trailing periods in template
    
    Test plan:
    
    - configure MaxOpenSuggestions with a low limit (e.g. 1)
    - visit opac-suggestions.pl?op=add, login if necessary
    - note that the period is missing from the second sentence of the leading paragraph under the "Enter a new purchase suggestion" heading
    - continue to submit suggestions until you've reached the MaxOpenSuggestions limit
    - observe the missing period in the "TooManySuggestionsText" paragraph
    - apply patch
    - revisit opac-suggestions.pl?op=add
    - note that the period is now present in the second sentence of the leading paragraph under the "Enter a new purchase suggestion" heading
    - note that the period is also present at the end of the "TooManySuggestionsText" paragraph
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 13bffe7347502cdd66593098af7d512dd8a8b28e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Dec 1 20:11:41 2016 +0000

    Bug 17709 - Article request broken - 'internal server error'
    
    Article requsts from OPAC and from intranet are showing an 'internal
    server error'. I am testing in 16.11 with Plack.
    
    Test Plan:
    1) Set circ rule to record only article requests
    2) Attempt to place a request on a record with no items
    3) Note the error
    4) Apply this patch
    5) You should now be able to place the request!
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9191246b87da14fd0c2098bc3e9b189845dd68a4
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Nov 23 01:25:23 2016 +0000

    Bug 17670: Grammar mistakes - effect vs affect
    
    In two places:
    
    1. Administration -> Preferences -> Circulation ->
       AllowMultipleIssuesOnABiblio: says effect, should say affect
    2. Reports -> Lost Items -> Help (top-right corner): says effect, should
       say affect
    
    To test, navigate to these two places and confirm charges have been made
    and are correct.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f0cb5c43dcb23d6e55914e6cfef8431bae8f4086
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Nov 7 23:16:06 2016 +0100

    Bug 17577: Improve sample notices for article requests
    
    - Adds "Dear..."
    - Fixes capitalization
    - Removes 'E-mail' from the description as you could also have
      a print template
    
    To test:
    - Make sure the SQL has no errors
    - Install the letters and proof read them
    
    If you agree - sign off!
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fc084f90d1da1dedb70c97a225d3df332f8224d2
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Oct 4 12:52:46 2016 +0200

    Bug 17395 - exporting checkouts in CVS generates a file with wrong extension
    
    In checkouts table, the is an export form (when some exports syspref are enabled).
    Export using a CSV profile will create a file with name koha.mrc (same as ISO2709 export).
    It would be better with koha.csv.
    
    Bug 14647 manages the export page, this but will only manage for export from checkouts table where file name is hard-coded.
    
    Test plan :
    - Enable checkouts exports by setting syspref ExportWithCsvProfile with a profile for record export
    - Go to circ page of a patron with checkouts : /cgi-bin/koha/circ/circulation.pl?borrowernumber=xxx
    - Show checkouts table
    - Select some checkboxes in "Export" column
    - Select "CSV" in export format combo-box
    - Click on "Export"
    => Without patch, the generated file is koha.mrc
    => With patch, the generated file is koha.csv
    - Check ISO2709 export generates a file named koha.mrc
    
    Signed-off-by: Dani Elder <dani@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8dce1cde3a8b1d0cd742f26545aa1d09e4ff63df
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 19 12:01:32 2016 +0100

    Bug 16873: Improve renewal error messages on self check
    
    When a patron is not allowed to renew from the self check module, the
    only message displayed is "No renewals allowed".
    It would be nicer to let him/her know that the renewal is not allowed
    because it's a on-site checkout or automatic renewal.
    
    To do so we can call CanBookBeRenewed instead of CanBookBeIssued and get
    the renewal error.
    
    Test plan:
    0/ Switch off AllowSelfCheckReturns
    1/ check out an item and tick "auto renewal"
    2/ Go on the self check module
    => auto renewal message is displayed
    3/ check out an item and tick "on-site checkout"
    4/ Go on the self check module
    => on-site checkout message is displayed
    5/ check out an item without ticking any checkboxes (regular checkout)
    Renew it to reach the max renew allowed
    6/ Go on the self check module
    => regular checkout message is displayed
    7/ Switch on AllowSelfCheckReturns and repeat previous steps
    => "Return this item" button is displayed in addition of the renewal
    error message
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2d769cd5081de0572f9b59e3dbcb99f309caf0a2
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Oct 13 11:05:00 2016 +0200

    Bug 14699: Reword "Select all/Clear all" and change their behaviour
    
    "Select all" -> "Select all visible rows"
    "Clear all" -> "Clear selection on visible rows"
    
    + fix the bug where the Delete link was visually enabled only if you
    checked a box in the first page (now every checkbox enable the link)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a329494f8926a6056433f9c8ba31322e363189bd
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Tue Sep 8 08:49:44 2015 +0200

    Bug 14699: Show number of selected searches in search history
    
    With the number displayed, it should remove the ambiguity about what
    "Select all" and "Clear all" do.
    The number is repeated in the "Delete" confirmation dialog.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ce87a89374b1016ced5cb15c189fdf6055599f56
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Aug 20 15:38:59 2015 +0200

    Bug 14699: Fix intranet search history issues due to pagination
    
    DataTables removes hidden rows from the DOM. Because of that, "Select
    all", "Clear all" and the form submission don't work correctly
    (basically they act only on the currently displayed page).
    
    This patch fixes just that.
    
    Test plan:
    1/ Go to your search history page
    2/ Make you sure you have at least 21 entries in your search history. If
    not, do some searches and come back here.
    3/ Click "Select all" and change page. The checkboxes on the new page
    should be checked.
    4/ Check some checkboxes on this new page and click "Clear all". Go back
    to the previous page, checkboxes shouldn't be checked.
    5/ Check some checkboxes on at least 2 different pages and click
    "Delete". All selected search history entries should be deleted.
    
    Followed test plan. Works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6f4cbc8dad2b4c78768d38b033aa4dd89c28a7e6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 24 13:37:52 2016 +0000

    Bug 17676: Update default COLLATE of marc_subfield_structure
    
    (This issue has been raised on bug 17216 comments 93-103)
    On bug 11944 (3.19.00.006) we updated the default COLLATE for all our tables to
    utf8_unicode_ci but not the marc_subfield_structure table.
    Indeed we want to keep tagsubfield a utf8_bin (to allow lowercase and uppercase
    of the same letter for subfields).
    We should have set the default collate to utf8_unicode_ci for further changes.
    
    This patch updates the DB entry 3.19.00.006 to set the default COLLATE to this
    table (for people upgrading from prior to 3.19.00.006) and set this
    default COLLATE on 16.06.00.033 (for people upgrading from after 3.19.00.006).
    
    The error is:
    DBD::mysql::db do failed: Can't create table `koha_kohadev`.`#sql-306_9f9` (errno: 150 "Foreign key constraint is incorrectly formed") [for Statement "
                ALTER TABLE marc_subfield_structure
                MODIFY COLUMN authorised_value VARCHAR(32) DEFAULT NULL,
                ADD CONSTRAINT marc_subfield_structure_ibfk_1 FOREIGN KEY (authorised_value) REFERENCES authorised_value_categories (category_name) ON UPDATE CASCADE ON DELETE SET NULL;
                "] at installer/data/mysql/updatedatabase.pl line 13175.
    Upgrade to 16.06.00.033 done (Bug 17216 - Add a new table to store authorized value categories)
    
    Test plan:
    1/ git checkout v3.18.00
    2/ Do an install
    3/ git checkout master;
    4/ perl installer/data/mysql/updatedatabase.pl
    => Without this patch, you get the error
    => With this patch applied you will not get it and the default COLLATE for
    marc_subfield_structure will be correctly set. Make sure tagsubfield is
    still utf8_bin
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Will put some notes on the Bugzilla report.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5485f10ed2c2086da92b86375471acabaff0539b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 29 17:36:59 2016 +0000

    DBRev 16.12.00.000 - the road goes ever on
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3128ee6953e3bde9f9851f7bf7e24aaa25db3b53
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 22 11:28:51 2016 +0000

    Bug 17344 - Followup to fix selectors
    
    Add '#' selector to several tags
    Fix some spacing
    Remove duplicated line
    
    To highlight that all is working set PatronQuickAddFields as below for testing:
    streetnumber|address|address2|city|state|zipcode|country|branchcode
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2e6be2f343c46867e83b70e245fb03838ecc560e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Nov 21 11:47:00 2016 +0000

    Bug 17344 - Can't set guarantor in quick add brief form
    
    This patch updates the guarantor form to work with the quick add form
    
    To test:
    1 - Quick add a 'Kid' patron (or other patron type that may have
        guarantor)
    2 - Verify form appears as expected
    3 - Test that you can add a patron manually or using selector
    4 - Test that deletion works as expected
    5 - Test 3 and 4 from the full version of the form
    6 - Save or cancel and add a new patron using the full form only
    7 - Verify that adding/deleting guarantor works with no errors
    8 - Sign off
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3c9d916641196a9a892d6be24d885ee8539be7bd
Author: Frédéric Demians <f.demians@tamil.fr>
Date:   Sat Oct 22 12:41:21 2016 +0200

    Bug 17292 Follow-up, fix typos
    
    - wrong assignation
    - reference to 'serials' table rather than 'serial'
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7636c68d769a1c2e62ced6aa9f2fbe12adf22c8d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 22 12:14:00 2016 +0000

    DBRev 16.11.00.000
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b674d48023d811d4c7fbc6c40d9bebe1de739f59
Merge: 2f5237c167 d3f93aaac2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 22 17:45:56 2016 +0000

    Merge remote-tracking branch 'translations/16.11.0-translate' into HEAD
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2f5237c167efb210f96b886398d3da2a67b03c71
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 22 11:58:05 2016 +0000

    Add release notes for the 16.11.00 release
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 312783f8fcc6dc6be892b2a7ce641ef443de5e0c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 22 13:49:59 2016 +0000

    Bug 8835 - DBRev 16.06.00.050

commit 88b4baceeee7cb820a3aa08f319e4f8ed7e98072
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Oct 13 10:49:17 2016 +0200

    Bug 8835: New db rev for issn_idx
    
    This db rev reapplies dbrev 3.15.00.049 in case that one failed due to
    existence of issn_idx.
    
    Test plan:
    If you do not have index issn_idx, recreate it:
        ALTER TABLE biblioitems ADD INDEX issn_idx (issn (255))
    Run this db rev. You should see: Removed issn_idx.
    Rerun the dbrev. You should see: Everything is fine.
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>

commit 0fee84690ebf2998a43a956abca275f1c90025fa
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Oct 12 15:29:01 2016 +0200

    Bug 8835: Drop issn_idx for completeness
    
    When dbrev 3.15.00.049 failed, the still existing issn_idx must have
    been the cause.
    This patch only adjusts the old db rev.
    Still thinking if we also need a new db rev to fix isbn and issn for
    those installs where 3.15.00.049 failed too. (In that case the fields
    may not have been changed to mediumtext and no indexes were added.)
    
    Test plan:
    Ideally, run an upgrade from something older than 3.15.00.49.
    But running the added sql command from the command line might convince
    you too.
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>

commit a83600fe204f83e6d76310ed3f0eb16a6859dd83
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 22 07:33:50 2016 +0000

    Bug 17278: Fix test compilation errors
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b19bd975569b5e65c57fe2d85f8ad0329c5053f2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 3 12:27:21 2016 +0100

    Bug 17278: Fix "show all items" link
    
    Then we need to remove the "available" part from the query.
    They are really awkward patches...
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5cc7c17c6444aeef00dd39acdf55c87a23b3e5e9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 3 10:45:13 2016 +0100

    Bug 17278: Use available limit when requesting zebra when ccl query is used
    
    When a ccl query is used, the buildQuery subroutine does not handle
    the available limit (not an index).
    This available limit is handle later in the subroutine.
    This affect the author links on the detail page for instance (an=xx).
    A much better solution would be to keep an 'available' zebra index up-to-date.
    
    Test plan:
    (OPAC or staff interface, it does not matter)
    - Launch a search, click on a result and then on an author link to
      launch another query (an:xx)
    - Limit to available items without the 'facet'
    => Without this patch you won't get any results
    => With this patch applied you should get relevant result (regarding the
    known bugs 16970, 13715, 13658, 5463, etc.)
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d4383c6bdc6c57ad5735913eb8dad115e90cf143
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Wed Nov 16 10:05:09 2016 -0600

    Bug 17609: Small typo in about.tt
    
    Small typo whould => should
    To avoid any misunderstanding you should not export the memcached config
    from ENV in line 79
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fcaea08cc0797f8705a103da593f2067fd9cc4d1
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Thu Nov 10 11:26:45 2016 -0600

    Bug 17609: Tiny typo in ElasticSearch mappings (mappings.tt)
    
    Typo found when translating in:
    
    intranet-tmpl/prog/en/modules/admin/searchengine/elasticsearch/mappings.tt:74
    
    An error occurred when updateing mappings => updateing
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 141538fb517613e7cb913c6648f2434b49909141
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 22 11:38:26 2016 +0000

    Bug 17391 - DBRev 16.06.00.049
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0a84274f6bfa3ea6e4c37367da7a449d98ce8aca
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 22 11:05:19 2016 +0000

    Bug 17391 (QA Followup) use INSERT INGORE in atomicupdate
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 49f8e05b20bd10e017877b996254c47cd2444385
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 17 09:01:19 2016 +0000

    Bug 17391: Fix number of values in sysprefs.sql
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d785cd5b0a025dd2670c7259fd20038f450ab1ef
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 17 08:58:55 2016 +0000

    Bug 17391: Add atomic update file
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 15e57368bba86844d103fa46cd3a47438565c56e
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Oct 16 14:20:42 2016 +0200

    Bug 17391: Add missing prefs to sysprefs.sql
    
    Adds
    - ReturnpathDefault
    - ReplytoDefault
    to the sysprefs.sql file.
    
    To test:
    - Run the web installer in any language
    - Check all preferences are installed without error
    - Check prefs listed above now exsit in your
      systempreferences table
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 37afb9439106fa76139dd9af1bb3d139f390445d
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Mon Nov 14 15:20:22 2016 -0600

    Bug 17616: (follow-up)Select tag on elasticsearch mappings page is not closed properly
    
    Also some close tag </selected> should be </select>
    Follow previous patch to test
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 575b3519b30ad6fd3efa5bcd151a307ee8e8fb86
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Nov 11 16:48:15 2016 +0000

    Bug 17616: Select tag on elasticsearch mappings page is not closed properly
    
    Test plan
    1) Have SearchEngine syspref set to Elastic
    2) Look at source on admin/searchengine/elasticsearch/mappings.pl
    -> without patch you'll see select with attribute
       data-id="mapping_search_field_name" closing tag written badly as
       "/select>"
    -> with patch everything looks OK
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 153e07fe5e9956e2024a261dee793cc34ed1351c
Author: Lari Taskula <larit@student.uef.fi>
Date:   Tue Aug 9 14:42:15 2016 +0300

    Bug 17086: Reword borrowers to patrons in Swagger tags for holds
    
    Routes for holds have tags called "borrowers". We should use "patrons" instead
    in order not to have both (endpoints for patrons already add "patrons").
    
    This patch changes the tags from borrowers to patrons in:
    GET  /holds
    POST /holds
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 65af3904c5b1359a298c4ed0024a6e258ac8e342
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 22 10:45:56 2016 +0000

    Bug 17626 (QA followup)
    
        Fix SAX parser error pointing to INSTALL docs
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 50537e6a00b04bd9a6137b7e20d69104fc008f7a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 15 08:55:04 2016 +0000

    Bug 17626: Remove existing install instructions and link to the wiki pages instead
    
    Since we are pretty bad to maintain INSTALL files, I'd suggest to point
    to the wiki.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4cd462117a1f16f048265fb73f7890482576a035
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 15 08:54:45 2016 +0000

    Bug 17626: Remove INSTALL.distri files
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d91e75919a234ffeae27acf164055db69aa714ab
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Aug 15 18:12:44 2016 +0000

    Bug 17132 - Availability search broken when using Elastic
    
    Elastic appears to be indexing onloan as a string, but our code assumes
    it is a boolean.
    
    Test Plan:
    1) Ensure you are set up using Elastic as your search engine
    2) Search only for available items from the advanced search
    3) Note you get no results
    4) Apply this patch
    5) Re-run the search
    6) You should now get results!
    
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d9be9950b3d59f43d997ca9ead5860fba0274fe0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Nov 21 16:34:46 2016 +0000

    Bug 17663 - DBRev 16.06.00.048
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9ca72539de083c9a62f16b2f114b9111a0f06636
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Sun Nov 20 16:35:53 2016 +0100

    Bug 17663: Forgotten userpermissions from bug 14686
    
    Bug 14686 added in a dbrev:
        (13, 'upload_general_files', 'Upload any file'),
        (13, 'upload_manage', 'Manage uploaded files');
    
    But these were not added in userpermissions.sql somehow :)
    So, what now?
    
    This patch:
    [1] adds them to userpermissions.sql as should have been done,
    [2] adds a dbrev to add them for newer installs that did not run the
        14686 dbrev.
    
    Test plan:
    [1] Run this sql statement:
        DELETE FROM permissions WHERE code = 'upload_general_files' OR
            code = 'upload_manage'
    [2] Run the db rev.
    [3] Check if you see Tools/Upload (with sufficient perms).
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a0416ff132469e6816554136707e398f114ab13e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 18 15:26:17 2016 +0000

    Bug 17660: #adv is considered as an ad by adblock
    
    So let's rename it!
    
    Test plan:
    Edit a $t in any framework, you should be able to unfold the "Advanced
    constraints" part
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 88e0264413b1dc9ecf5dbe562636f40c7e0555d1
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Mon Oct 10 17:06:07 2016 +0300

    Bug 17419: Fix smsalertnumber and mobile confusion in moremember.pl
    
    members/moremember.pl will set mobile number as smsalertnumber in template if
    smsalertnumber is not defined. This will cause incorrect display for SMS number
    in patron's Details-tab. This confusion between smsalertnumber and mobile is
    already fixed in Bug 14683, but members/moremember.pl was not fixed yet.
    
    This is a minor issue since it won't occur for manually added new patrons due to
    fixes already pushed in Bug 14683, but in case patron's smsalertnumber is null
    in database, this bug can be replicated:
    
    To test:
    1. Set EnhancedMessagingPreferences to "Allow" and make sure SMSSendDriver
       has been set.
    2. Add a new patron, give it a mobile/other phone number.
    3. Run a SQL query:
       update koha.borrowers set smsalertnumber=NULL where borrowernumber=XXX;
       (replace XXX with your new patron's borrowernumber)
    4. Go to patron's details tab and observe that SMS number shows the mobile/
       other phone you provided earlier.
    5. Apply patch.
    6. Refresh patron's details tab.
    7. Observe that smsalertnumber is now empty, as it should be.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d3f93aaac280fb041c4b45a2662d4965f706a637
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Sun Nov 20 17:34:19 2016 -0300

    Translations update for 16.11.0

commit ccdd661851dfb2008b536903514eac3027651495
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Nov 7 23:03:33 2016 +0100

    Bug 17543: Update German web installer sample files for 16.11
    
    Updates sample files with German translations:
    - Sample notices for article requests
    
    To test:
    - Make sure the German web installer installs all
      sample files correctly.
    - Bonus: check German translations.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Tested german installer/translation
    No errors
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    Amended patch:
    - Authorised value HSBND_FREQ
    is done by bug 17576 (and correctly translated in German)
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ca81da74c4c3a20c1b9c6d68155f4077d3602aee
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 18 08:37:07 2016 +0100

    Bug 17642: [QA Follow-up] Issues_stats.pl is not plack safe
    
    Resolve:
    Variable "$ccodes" is not available at reports/issues_stats.pl line 358.
    Variable "$locations" is not available at reports/issues_stats.pl line 359.
    Variable "$ccodes" is not available at reports/issues_stats.pl line 358.
    Variable "$locations" is not available at reports/issues_stats.pl line 359.
    
    Test plan:
    Run the script. Choose Collection or Shelving Location.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5f4337a765c34fd736abfda2faddcdb11367f642
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 17 11:23:57 2016 +0000

    Bug 17642: Do not explode if no authorised value exist
    
    Can't call method "lib" on an undefined value at
    /home/vagrant/kohaclone/Koha/AuthorisedValues.pm line 137.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a16a75018063477cf13fdbdad60152bbb27a7616
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 17:46:34 2016 +0100

    Bug 17642: Add and use get_descriptions_by_koha_field
    
    Ok I am silly, we needed to replace to use the cache mechanism for
    search_by_koha_field, not find_by_koha_field...
    Let's create another subroutine
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6585bfc28480d969eeff2289208f775d920ff19c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 17:29:07 2016 +0100

    Bug 17642: use get_description_by_koha_field when needed
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4692cb4c2757a9e2dbc9d9e2d1daeb692f3e5c80
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 17:23:23 2016 +0100

    Bug 17642: Add get_description_by_koha_field
    
    Most of the time we just need the descriptions (lib or
    opac_description), so let's add a new method for that and cache the
    descriptions in L1.
    Ideally we should cache it in L2 as well, but the AV code is not robust
    enough to allow that
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c45b26aea2bcd92dfb2353e5b55480169fa3b457
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 16:37:16 2016 +0100

    Bug 17642: use find_by_koha_field when needed
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 864aa5805dfb68dde762796d6cacd2f7959d15c5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 15:08:59 2016 +0000

    Bug 17642: Add find_by_koha_field
    
    When we call search_by_koha_field with an authorised_value, we actually
    expect only 1 value
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3b921db2226a9014c51c14c93d2bb6b3215f7052
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 10:49:03 2016 +0000

    Bug 17642: Try to fix AV code
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fcb11e296eeec6501dea5efbbf35ed52db4fd285
Author: Radek Šiman <rbit@rbit.cz>
Date:   Thu Nov 3 14:45:43 2016 +0100

    Bug 17559: Fixed HTML element ID of B_streetnumber
    
    There is a duplicate ID in HTML code, because of this:
    <input type="text" id="B_address" name="B_streetnumber" size="5"
    value="" />
    <input type="text" id="B_address" name="B_address" size="40" value="" />
    
    Test plan:
    1) Edit a patron and look into its HTML code
    2) Find input: name="B_streetnumber"
    3) Its ID is B_address - a duplicate within the code in fact
    4) Apply the patch
    5) Repeat steps 1 and 2
    6) The ID is unique now: B_streetnumber
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 317c377a32a36312f69790fdc66ad986a9cd3366
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Nov 16 08:22:08 2016 -0500

    Bug 17645 - Remove obsolete interface customization images
    
    This patch removes three files which are obsolete following the removal
    of the OPAC prog template.
    
    To test, apply the patch and confirm that these files no longer exist in
    misc/interface_customization:
    
    - koha3-opac-button-background.png
    - koha3-opac-button-background.psd
    - koha3-opac-button-background.svg
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6229a5211c3c5a9ef3521ced354a1563f1ebf73b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Nov 10 10:47:25 2016 +0000

    Bug 17601 - Regression: Incomplete CSS update introduced by Bug 14610
    
    Bug 14610 revised staff-global.css so that the "holdcount" class was
    renamed "number_box." That's good. It's good to have something more
    generic since the class is used in multiple places.
    
    The problem is that there are still several instances of the "holdcount"
    class in the templates which should have been updated at the same time
    to say "number_box." Those instances are now unstyled.
    
    Test Plan:
    1) Apply this patch
    2) Check that the holds count on catalogue/detail.pl is styled
    3) Check that the patron modifications count on members/member.pl is styled
    4) Check that the pending comments count on tools/tools-home.pl is styled
    5) Check that the pending tags count on tools/tools-home.pl is styled
    
    Signed-off-by: Chris Kirby <christopherlawrencekirby@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b4d94a5ea4a3d9dac4295c53497cbb25e1b1212b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 8 17:26:36 2016 +0000

    Bug 17590 - Exporting reports as CSV with 'delimiter' SysPref set to 'tabulation' creates files with 't' as separator
    
    To test:
    Set 'delimiter' system preference to 'tabs'
    Export a report as csv
    Open the file in text editor and note fields separated by character 't'
    Apply patch
    Export report as CSV
    Open file in text editor and note tabs are used to separate fields
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    tabs now, no errors.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 847da48cfbbbe5f9573f715d9c32669627e34eaf
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 4 09:34:12 2016 -0400

    Bug 17545 [Revised] Make "Add biblio" not hidden by language chooser
    
    This alternate patch changes the menu direction so that it "drops" up
    instead of down. This avoids the problem of overlapping or being hidden
    by the language chooser.
    
    The disadvantage of this patch is that it is not global. However, I
    think it's a better long-term solution to the problem.
    
    To test, apply the patch and follow the issue description:
    
    - Make sure more than one language is active for the staff client, so
      that the language chooser bar shows at the bottom of each page
    - Do one or more Z39.50 searches, to make sure you have some records in
      the reservoir
    - Go to "Cataloging" and do a "Catalog search", so that the reservoir is
      searched. Make sure your search is broad enough that some results from
      the reservoir is shown "below the fold"
    - Scroll to the last result and click on the "Actions" menu
    
    The direction of the menu should be up instead of down.
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Popup menus on the cataloging search page now pop up instead
    of down, which means they avoid being hidden by the language
    chooser. Mission accimplished!
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 474a369fc03f992971c8af11c910f778e34ac9b9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 27 14:15:57 2016 +0000

    Bug 17513: Create GRANT for user@localhost in koha-create
    
    See the bug description for the details.
    
    Test plan:
    Use this script to create a new koha installation, using MariaDB
    You should not display
    "user koha_kohadev doesn't have enough privilege on database koha_kohadev "
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Confirm that this still works (with MySQL).
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 66bb0a2e3323f17d19a803297d1b9667f9392a4d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 18 08:23:16 2016 +0000

    Bug 17657: Fix locations of item types images
    
    Koha::ItemType->image_location takes the interface in parameter or
    default to OPAC.
    From the item types admin page, we need to specify the intranet
    interface to retrieve the correct image's url
    
    Test plan:
    Go on the item types admin page, see the source of the page and find the
    image' urls.
    => Without this patch, they point to the OPAC
    => With this patch, the location is correct
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f67adfcb11e0465cb2016663e0df7038e5d2c811
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 17 16:08:00 2016 +0000

    Bug 17654: Add tests to enforce swagger definition files integrity
    
    The swagger definition error we found on bug 17651 should have been
    caught earlier with tests.
    
    Now we are testing for nullable columns.
    
    QA: Have a look at the FIXME
    
    Test plan:
    Apply without 17651 (revert if already pushed)
    The tests won't pass
    On top of 17651 the tests will pass
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4366a0b4699c9c16ce63e36fe7e5c3c0317c17e6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Nov 17 12:29:14 2016 -0300

    Bug 17653: Remove itemtype-related t/db_dependent/Circulation* warnings
    
    This patch makes t/db_dependent/Circulation* create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Circulation*
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Circulation*
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01097457ee8958386712f450200d816a1fdfaf7c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Nov 16 16:44:44 2016 -0300

    Bug 17647: Remove itemtype-related CancelReceipt.t warnings
    
    This patch makes t/db_dependent/Acquisition/CancelReceipt.t create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Acquisition/CancelReceipt.t
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Acquisition/CancelReceipt.t
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a8f3d8cfd58f7af9f5b8a13790a1fe320329f33b
Author: Katrin Fischer <Katrin.Fischer.83@web.de>
Date:   Mon Nov 10 20:23:45 2014 +0100

    Bug 12359: Add HidePatronName functionality to the holds queue
    
    This changes the Holds Queue page to not show the patron's name
    and phone number, but only the cardnumber, when HidePatronName
    is set to 'Don't show'
    
    This also changes the link to the patron account to use
    the borrowernumber instead of the cardnumber, which seems
    more consistent.
    
    Fixes a tiny capitalization error: Only item...
    
    To test:
    - Look at the holds queue page with holds displayed
    - Toggle HidePatronName system preference and observe the change
    - Make sure the link works correctly
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Rebased 2016-10-16
    
    Signed-off-by: Chris Kirby <christopherlawrencekirby@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 665c5c62fa8b61752e65ff9d18487befc38cb647
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Aug 24 11:13:48 2016 +0000

    Bug 14736 - AllowRenewalIfOtherItemsAvailable slows circulation down in case of a record with many items and many holds
    
    If the AllowRenewalIfOtherItemsAvailable sys pref is set to allow, and a
    borrower has an item checked out that has many items {30+} AND many
    holds {70+) on it, loading the checkouts table for this borrower takes
    FOREVER to load. The load time takes forever, because of the
    factoring that happens to determine if an item is truly
    available for renewal.
    
    This patch swaps the use of GetMemberDetails for GetMember
    and reorders the subroutine calls to check each items' renewability
    from fastest to slowest.
    
    In a test case, the results of pre patch were:
    Start of loop: 2016-08-24T11:05:14
    End of loop:   2016-08-24T11:05:29
    Resulting in 15 seconds being spent in the loop
    
    Post patch results were:
    Start of loop: 2016-08-24T11:08:43
    End of loop:   2016-08-24T11:08:48
    Resulting in only 5 seconds being spent in the loop!
    
    Test Plan:
    1) Apply this patch
    2) Note there are no changes in functionality for the renewals column of
       the patron checkouts table.
    
    If you wish to go further and test the performance benefit:
    1) Create a record with 50 items and 100 holds ( 50 waiting, 50 unfilled )
    2) Check out one of the waiting holds to a patron
    3) Time the amount of time it takes for the checkouts table to load
    4) Apply this patch
    5) Repeat step 3, you should see an improvement in load time
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 722d045986b2762a22190bb08569b7a5f5536eae
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Tue Nov 8 15:15:22 2016 +0100

    Bug 17576: Add housebound mandatory auth_values.
    
    * installer/data/mysql/de-DE/mandatory/auth_values.sql: Add values.
    * installer/data/mysql/es-ES/mandatory/auth_values.sql: Add values.
    * installer/data/mysql/fr-CA/obligatoire/auth_values.sql: Add values.
    * installer/data/mysql/fr-FR/1-Obligatoire/authorised_values.sql: Add
      values.
    * installer/data/mysql/it-IT/necessari/auth_val.sql: Add values.
    * installer/data/mysql/nb-NO/1-Obligatorisk/auth_values.sql: New file.
    * installer/data/mysql/pl-PL/mandatory/auth_values.sql: New file.
    * installer/data/mysql/ru-RU/mandatory/auth_values.sql: New file.
    * installer/data/mysql/uk-UA/mandatory/auth_values.sql: New file.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ba43bdb4f9249a8d1df3c5db729679e03e22f4f1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 18 11:00:40 2016 +0000

    Bug 17659: Fix sample_notices.sql for fr-CA
    
    branchcode and is_html columns are present in this file
    
    Test plan:
    mysql < installer/data/mysql/fr-CA/obligatoire/sample_notices.sql
    should not return any errors
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb76c3bd97665ef6bee1f9be8b0e96333f91abbe
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 29 16:08:36 2016 +0100

    Bug 17377: ES - Take control fields into account
    
    There is a bug in Koha::SearchEngine::Elasticsearc::Search->json2marc, it
    assumes that the MARC::Field constructor always takes >= 5 parameters.
    This assumption is wrong for control fields, to create a control field you
    need to call the constructor with:
      MARC::Field->new($tag, $value);
    
    Note that I got "Too much data for control field" in the _warning value of my
    MARC::Field because too many parameters were passed, and the value was undef.
    
    That broke the result search links (on the staff interface) for DB with
    biblio.biblionumber mapped with 001.
    
    Other bugs will certainly be fixed by this patch.
    For instance I got:
      GetMarcBiblio called with undefined biblionumber at /home/koha/src/opac/opac-search.pl line 664.
      GetCOinSBiblio called with undefined record at /home/koha/src/opac/opac-search.pl line 665.
    in my logs, with this patch I don't get them anymore.
    
    Test plan:
    You can try to recreate the different issues and confirm than this patch
    fixes them.
    Or just run the tests
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 847ac4b031d7b89968743c8f1f22feb4f4906d8c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 29 16:41:53 2016 +0100

    Bug 17377: Add tests for json2marc
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6d5b056a14e5671f51735dded7609f65ca389f00
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 20 11:40:13 2016 +0100

    Bug 17323: Column search_history.time cannot be null
    
    When doing a search, with SearchHistory pref switched on:
    
    DBD::mysql::st execute failed: Column 'time' cannot be null [for Statement "
            INSERT INTO search_history(
                userid, sessionid, query_desc, query_cgi, type, total, time
            ) VALUES(
                ?, ?, ?, ?, ?, ?, ?
            )
        " with ParamValues: 0="7874", 1='12338a0bd8da63e32c79ee84f8493a07', 2="kw,wrdl: d", 3='q=d', 4='biblio', 5=6104, 6=undef] at C4/Search/History.pm line 34.
    
    Since MySLQ 5.7, undef does not mean "the default value".
    To let the DBMS set the default value (CURRENT_TIMESTAMP), the parameter should not be passed
    
    Test plan:
    OPAC+Intranet, swith the 2 SearchHistory syspref on
    Do a search
    => Without this patch, you will get an error in the log and the row will not be inserted in the table.
    => With this patch, everything must go fine
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Not verified with MySQL 5.7. But this looks good to me.
    Works under Jessie.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 660be0e0195613ce9eaaf45b17d2e5db4ad705f0
Author: Lyon 3 Team <koha@univ-lyon3.fr>
Date:   Tue Oct 25 13:37:47 2016 +0200

    Bug_17484 Search with date range limit (lower and upper) does not work
    
    If the period is entered without spaces wrapping the hyphen
    You can't get any result
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    I can't reproduce the error, search still works after applying the patch
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 68173511bf7004eac8c7ecd34bfcdc79dd215ecc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 17 15:12:01 2016 +0000

    Bug 17651: borrowers.updated_on can be null - swagger def
    
    The swagger file does not consider borrowers.updated_on as a nullable
    value, it should
    
    Test plan:
    0/ Do not apply this patch
    1/ update borrowers set updated_on=null;
    2/ prove t/db_dependent/api/v1/patrons.t
    => Fail
    3/ Apply this patch
    4/ prove t/db_dependent/api/v1/patrons.t
    => green
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6aecba93a5bd762c82fc67ba0bbe824e55908ad5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 15 17:40:22 2016 -0300

    Bug 17636: Remove itemtype-related GetIssues.t warnings
    
    This patch makes t/db_dependent/Circulation/GetIssues.t create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Circulation/GetIssues.t
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Circulation/GetIssues.t
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    All test pass successfuly
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2a73cdac5b600408ac62adc028266e4659964f98
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 17 07:52:38 2016 +0000

    Bug 17431: Remove use of C4::Items and C4::Biblio
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 620a8fb82384ea44c4e2c2ed74b83f11e509420e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 19 14:14:41 2016 +0100

    Bug 17431: Create the object we need instead of assuming something exists
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f9e9f520182d4b7774d12e22a51d3360ecc0aca5
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Wed Oct 19 15:18:02 2016 +0300

    Bug 17431: (follow-up) Fix issuingrules
    
    Issuingrules could had prevented holds.t from passing with error tooManyReserves.
    This patch sets issuingrules at the beginning of the test to make sure reserves
    are allowed.
    
    To test:
    1. Apply patch & Run t/db_dependent/api/v1/holds.t
    2. Observe test pass
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9fca67d46714cdb9ab4880d9c8535178d8954562
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Wed Oct 12 14:29:26 2016 +0300

    Bug 17431: Fix failing test t/db_dependent/api/v1/holds.t
    
    This patch fixed failing test for t/db_dependent/api/v1/holds.t which was broken
    after Bug 14695.
    
    $ perl t/db_dependent/api/v1/holds.t
    ...
    not ok 42 - similar match for JSON Pointer "/error"
        #   Failed test 'similar match for JSON Pointer "/error"'
        #   at t/db_dependent/api/v1/holds.t line 291.
        #                   'Reserve cannot be placed. Reason: itemAlreadyOnHold'
        #     doesn't match '(?^u:tooManyReserves)'
        # Looks like you failed 1 test of 42.
    not ok 4 - Test endpoints with permission
    
    To test:
    1. Run t/db_dependent/api/v1/holds.t and observe it fail.
    2. Apply patch.
    3. Run the test again and observe it pass.
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 20d38884e8400319e9bb128b8b70a7eadd3c0aaa
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Nov 16 10:59:26 2016 -0300

    Bug 17646: Remove itemtype-related IssueSlip.t warnings
    
    This patch makes t/db_dependent/Members/IssueSlip.t create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Members/IssueSlip.t
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Members/IssueSlip.t
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    All test pass successfuly
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 521e9a98dddebbbac39cbc50117d47c14211b5ba
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Nov 16 12:40:31 2016 +0000

    Bug 17644 - t/db_dependent/Exporter/Record.t fails
    
    Test Plan:
    1) prove t/db_dependent/Exporter/Record.t fails
    2) Apply this patch
    3) prove t/db_dependent/Exporter/Record.t succeeds!
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ccd49a60dfa6ae73f1083398d9745710e38d2617
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Nov 16 11:40:21 2016 -0300

    Bug 17638: Make sure t/db_dependent/Search.t doesn't use a cached koha-conf.xml
    
    This patch makes the tests clean the 'config' namespace for cache before
    it runs any tests.
    
    To test:
    - Run:
      $ prove t/db_dependent/Search.t
    => FAIL: Self explanatory
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Search.t
    => SUCCESS: All green
    - Sign off :-D
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    All test pass successfuly
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Cannot reproduce, but I trust everyone telling me it's failing ; )
    No regressions spotted

commit 1171b28145c5cf5ed6688721b901c851ac54f7f0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Nov 16 13:15:52 2016 -0300

    Bug 17640: (Jonathan complain followup) Use Koha::*->search->delete instead
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8a3ae73079c56e81666669fc50e2bbd57c516a9c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Nov 16 12:58:23 2016 -0300

    Bug 17633: (QA followup) remove debugging leftover
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f384f94702d6bdd1dd2099bd44b728d60e4bb818
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Nov 16 15:52:17 2016 +0000

    Bug 17640 [QA Followup] - Remove any outstanding issues before removing patrons
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f427166215fbeb4458b8deea9d65d0aa902bb3b6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Nov 16 12:48:11 2016 -0300

    Bug 17640: (QA followup) Add more tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e7833cf331102d4a6e30fee9f34e3541cb436976
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 09:41:26 2016 +0000

    Bug 17640: Fix t/db_dependent/Template/Plugin/Categories.t
    
    These tests fail since commit 6ee8dd3a597d08ccc5122473e55790d3f21d5163
        Bug 15407: Koha::Patron::Categories - replace C4::Category->all
    
    Indeed the patron categories plugin now returns a
    Koha::Patron::Categories object and does not set a 'selected' flag.
    We do not need this flag (`git grep Categories.all **/*.tt` to trust me)
    
    Note that this patch also add a patron category to make the test passes
    even if no category exist.
    
    Test plan:
      prove t/db_dependent/Template/Plugin/Categories.t
    should return green
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 81cd8b93bbdc8691cd7d86070d86634d6957c86d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 15 14:08:15 2016 -0300

    Bug 17633: (QA followup) Remove unneeded warnings
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 54bc0272894b292075a8943a368b8a25d4a3dc60
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 15 16:07:35 2016 +0000

    Bug 17633: Do not call set_preference from tests
    
    If memcached is running, the pref's value will be set in cache, what we
    do not want.
    
    t/db_dependent/Context.t and t/db_dependent/sysprefs.t are exceptions
    for obvious reasons.
    
    Test plan:
    Make sure all these tests still pass
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 08f7baf3e3da147b01c3660f789bb7b7cdd707da
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 09:49:20 2016 +0000

    Bug 17641: Fix t/Biblio/Isbd.t
    
    On commit cadf5aea814636ccccd85fcc38aa30f751d779c0
        Bug 11592: MARCView and ISBD followup
    The prototype of C4::Biblio::GetISBDView has been changed to take a
    hashref in parameter.
    But the tests have not been updated
    
    Test plan:
      prove t/Biblio/Isbd.t
    should return green
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=17637
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fbaa28bf2a79e0416706f8caad5728a88223d04b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 07:44:03 2016 +0000

    Bug 17637: Fix tests Auth_with_ldap.t
    
    Koha::Patron->delete create a transaction and so we need to use
    txn_begin to have nested txn
    
    DBD::mysql::db begin_work failed: Already in a transaction
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0faf643661f23eddd066488b26004428e57bfe18
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 07:29:45 2016 +0000

    Bug 17634: Fix circ dependency with require instead of use
    
    This is definitely wrong but we won't have time to fix it correctly
    before the release.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 64900dc7c6511e657c890d91f0adfe05e0005e91
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 16 07:23:19 2016 +0000

    Revert "Bug 17634: Unit test t/db_dependent/ArticleRequests.t is failing"
    
    This reverts commit 75f75101585d795ab6b0e4e40f585b21e0f841cb.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 379f392ddc0cfe545b026c1a3f907f2d263b67be
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 15 15:07:14 2016 -0300

    Bug 17635: Fix templates with missing body id
    
    The following template files are missing body id and class and should be fixed:
    
    - members/housebound.tt
    - reports/cash_register_stats.tt
    
    To test:
    - Run:
      $ sudo koha-shell kohadev ; cd kohaclone
     k$ prove xt/tt_valid.t
    => FAIL: Tests fail due to the mentioned templates
    - Apply this patch
    - Run:
      $ sudo koha-shell kohadev ; cd kohaclone
     k$ prove xt/tt_valid.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 75f75101585d795ab6b0e4e40f585b21e0f841cb
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 15 17:37:24 2016 +0000

    Bug 17634: Unit test t/db_dependent/ArticleRequests.t is failing
    
    Test Plan:
    1) prove t/db_dependent/ArticleRequests.t
    2) Apply this patch
    3) prove t/db_dependent/ArticleRequests.t
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit aa1390a220350f726758e26357a2c448ac4aa777
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 15 15:49:00 2016 +0000

    Bug 17599: Make the tests pass
    
    If you run TooMany or MultiplePerRecord.t after
    t/db_dependent/Circulation/Returns.t (for instance) and that you are
    running memcached, item-level_itypes will be 0.
    These tests assume that the pref is 1
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bdcbb1c899aec3240ca9f1d84191eca77112f68b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 10 08:44:54 2016 +0000

    Bug 17522: Fix opac-user.pl if OpacRenewalAllowed is set
    
    This patch fixes a bug added by commit 81a04af27804621609004dc370284413baa5caa2
        Bug 14610 - Add and update scripts
    
    If OpacRenewalAllowed is enabled, the following error message is
    displayed:
    
    Template process failed: undef error - The method is_expired is not
    covered by tests! at /home/vagrant/kohaclone/C4/Templates.pm line 121.
    
    The is_expired and BlockExpiredPatronOpacActions methods did not exist
    for the Koha::Patron object. These 2 values were returned by
    GetMemberDetails.
    
    To fix this, we need bug 17579 which introduces the
    Koha::Patron->is_expired method and also bug 17604 for the
    Koha::Patron->effective_BlockExpiredPatronOpacActions.
    
    Test Plan:
    1) Check out an item for a patron
    2) Enable OpacRenewalAllowed
    3) Log in as that patron, go to opac-user.pl
    4) Note the error
    5) Apply this patch
    6) Reload opac-user.pl
    7) Page should now load!
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 72fea80a33bc9ea57335e6d8c00500439a38b1c4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 15 12:32:53 2016 -0300

    Bug 17599: (QA followup) Perltidy really long lines
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7953beeffd03b3688283de641938c29958a4b1ea
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 15 12:27:33 2016 -0300

    Bug 17599: (QA followup) Remove userenv warning
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6edbd47a44823eb53ee7ebc3904cbd7ce796b19d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 9 16:36:39 2016 +0000

    Bug 17599: Move C4::Circulation::GetIssuingRule to Koha::IssuingRules->get_effective_issuing_rule
    
    This is a POC, I have not tested it yet.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 36280356c1d4488fe42609357daea36e7dc023a1
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 15 15:27:13 2016 +0000

    Bug 17579 [QA Followup] - Fix the number of tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ea3704203e88382024837c5caa2c264a153a3cf0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 9 13:23:54 2016 +0000

    Bug 17579: Make sure we are testing the real life
    
    Without this patch, the tests are not testing the same things as what
    happens on the interface.
    We need to refresh the object to make sure the date set into dateexpiry
    is the one in DB.
    Without this patch, ->is_expired test a datetime object, with this patch
    it compares with a date oject
    
    Without the changes made in Koha::Patron->is_expired, a patron which has
    a dateexpiry set to today was marked as expired on the interface. This
    is a change in the behavior, what this refactoring does not want to do.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d892342e6f8569a4ea51a0e550b5d9c59b92e588
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 17:12:58 2016 +0000

    Bug 17579: Add the Koha::Patron->is_expired
    
    This new method will be handy for further uses
    
    Test plan:
      prove t/db_dependent/Koha/Patrons.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 81ea88fff6bfffd958cc0a85871e1487b05a445a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 15:47:43 2016 +0000

    Bug 17604: GetMemberDetails - Add Koha::Patron::Category->effective_BlockExpiredPatronOpacActions
    
    This patch simply adds a new method to retrieve the correct value of
    BlockExpiredPatronOpacActions.
    
    Test plan:
      prove t/db_dependent/Koha/Patron/Categories.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1da4a7b4a204033b21e8537b2988bdd43a7357ec
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 9 13:20:16 2016 +0000

    Bug 17594: Make Koha::Object->discard_changes available
    
    We need this new method to refresh an object after it has been updated.
    
    Test plan:
      prove t/db_dependent/Koha/Object.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4277f43a91189e5bbe51e82061d0ea3a81167fd7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 4 15:05:08 2016 +0000

    Bug 17555: Add Koha::Patron->category
    
    We need to use the DBIx::Class relationship to retrieve the patron
    category.
    It is more convenient to have a Koha::Patron->category method to
    retrieve the category of a given patron.
    
    Test plan:
    Make sure that the tests in t/db_dependent/Koha/Patron* return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3a6d38cbcb3644cefd508f3c4489045dd650316f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Nov 9 11:11:08 2016 +0000

    Bug 16520 - (Follow up) Restore retrieval of syspref_cache
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a618c62ae6c6ddc8334e795ddb1760a7363a88f8
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Sep 14 15:14:02 2016 -0400

    Bug 15690: Hardcoded 16 is uncool
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Followed test plan in comment #7, works as expectd.
    Signed-off-by: Marc <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87380d8b460857157b4cf06fa8def626d1d2badb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 13 15:43:50 2016 +0100

    Bug 15690: CardnumberLength should not be bigger than 16
    
    borrowers.cardnumber is a varchar(16), so CardnumberLength should not
    have a max > 16
    
    Test plan:
    Test different value in CardnumberLength ("20", "20,30", "40,")
    Edit a patron a make sure the text display under the cardnumber input is
    correct
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marc <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2975c010204cad61d5a2c1982dabfd3b7812e74c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Nov 10 10:21:52 2016 -0300

    Bug 17607: Fix patron definition in Swagger
    
    This patch makes the patron swagger definition match the DB schema.
    To test:
    - Run:
      $ prove t/db_dependent/api/v1/swagger/definitions.t
    => FAIL: 'lastseen' field is not declared in the swagger definition
    - Apply the patch
    - Run:
      $ prove t/db_dependent/api/v1/swagger/definitions.t
    => SUCCESS: Tests pass!
    - Sigh off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    All tests pass successfuly
    
    Signed-off-by: Lari Taskula <lari.taskula@jns.fi>
    Fixed a typo: seed -> seen
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0a90892387ec1a69ea9a811cb95e29e2db02979d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 8 14:43:46 2016 +0000

    Bug 17582: Fix authority framework edition
    
    Step to recreate:
    Admin>Authority types > Actions > Marc structure
    
    Test plan
    Confirm that this patch fixes the issue
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Fix the issue, no errors.
    Can edit auth marc structure
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f4bd05d00dbbb96215dca1551e4f92961b60cb6f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 7 11:19:03 2016 -0300

    Bug 17567: Make populate_db.pl initialize ES mappings
    
    To test:
    - Have a clean install, no DB
    - Run populate_db.pl:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ misc/devel/populate_db.pl
    - Go to
    http://localhost:8081/cgi-bin/koha/admin/searchengine/elasticsearch/mappings.pl
    => FAIL: No mappings
    - Delete the DB and create an empty one:
      $ mysql -uroot
      > DROP DATABASE koha_kohadev; CREATE DATABASE koha_kohadev;
      > GRANT ALL PRIVILEGES ON koha_kohadev.* TO
      'koha_kohadev'@'localhost';
    - Run populate_db.pl:
      $ sudo koha-shell kohadev
     k$ cd kohaclone
     k$ misc/devel/populate_db.pl
    - Go to
      http://localhost:8081/cgi-bin/koha/admin/searchengine/elasticsearch/mappings.pl
    => SUCCESS: There are mappings!
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62c09397f2c5e5dd1df2c0cccf190c80363b8033
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Nov 9 16:45:38 2016 -0300

    Bug 17603: Remove itemtype-related Borrower_Discharge.t warnings
    
    This patch makes t/db_dependent/Patron/Borrower_Discharge.t create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Patron/Borrower_Discharge.t
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Patron/Borrower_Discharge.t
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ddd6f6917b6f0012a15d277d1f4f2a6890b7aecf
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 8 16:28:07 2016 -0300

    Bug 17592: Remove itemtype-related maxsuspensiondays.t warnings
    
    This patch makes t/db_dependent/Circulation/IssuingRules/maxsuspensiondays.t create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Circulation/IssuingRules/maxsuspensiondays.t
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Circulation/IssuingRules/maxsuspensiondays.t
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0b56b5857d3e37ab486564a4465f6e00af3599d3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 8 12:40:45 2016 -0300

    Bug 17587: Remove itemtype-related IsItemIssued.t warnings
    
    This patch makes t/db_dependent/Circulation/IsItemIssued.t create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Circulation/IsItemIssued.t
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Circulation/IsItemIssued.t
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bc6a51c065c9a0f829d3d63f0e26bbd957bf5308
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 7 16:08:02 2016 -0300

    Bug 17575: (followup) Remove missing fine type warnings
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 76e16495a970018530e9a6453662d97b030fa7f0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 7 16:00:21 2016 -0300

    Bug 17575: Remove itemtype-related warnings from Circulation.t
    
    To test:
    - Run:
      $ prove t/db_dependent/Circulation.t
    => FAIL: Lots of warnings
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Circulation.t
    => SUCCESS: All green and no itemtype warnings
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8fe707769a3b2824f386069c3d61eb41d82e2a62
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 7 15:31:53 2016 -0300

    Bug 17574: Remove itemtype-related warnings from LocalHoldsPriority.t
    
    To test:
    - Run:
      $ prove t/db_dependent/Holds/LocalHoldsPriority.t
    => FAIL: Tests raise lots of warnings
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Holds/LocalHoldsPriority.t
    => SUCCESS: Tests pass, and no warnings!
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 108c2d177312e65d59801ae33a5855abc4d9c1b3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 7 15:24:34 2016 -0300

    Bug 17573: Remove itemtype-related warnings from DecreaseLoanHighHolds.t
    
    To test:
    - Run:
      $ prove t/db_dependent/DecreaseLoanHighHolds.t
    => FAIL: Lots of warnings
    - Apply the patch
    - Run:
      $ prove t/db_dependent/DecreaseLoanHighHolds.t
    => SUCCESS: All green and no warnings.
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6fdd99e811a6246c8e781e4d0ad8d57bedd295b8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 11 09:27:12 2016 +0100

    Bug 17572: [QA Follow-up] Cosmetic changes
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 177f7ef49de7a43e5674af3ef01de19a3e6904f4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 7 15:09:24 2016 -0300

    Bug 17572: (followup) Remove test's hardcoded values
    
    This patch makes the tests use t::lib::TestBuilder instead of
    hardcoding values.
    
    Test plan:
    - Run:
      $ prove t/db_dependent/Circulation/issue.t
    => SUCCESS: All tests return green with and without the patch
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4bf2a1d81f97e56afea057abe6202001fb98e6eb
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 7 14:55:41 2016 -0300

    Bug 17572: Remove itemtype-related warnings from issue.t
    
    This patch makes t/db_dependent/Circulation/issue.t create
    good sample data for its tests. It does so by creating a random
    itemtype.
    
    To test:
    - Run
      $ prove t/db_dependent/Circulation/issue.t
    => FAIL: lots of warnings about "item-level_itypes set but no itemtype
    set for item"
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Circulation/issue.t
    => SUCCESS: Tests are green, and no warnings.
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0550385730d09a4def0e1d976dec746a3074312a
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Nov 11 11:23:40 2016 +0000

    Bug 17558: QA followup - use TestBuilder for creating patron
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1997ea648ccefb622fa8e7d69d76bf50a33e62f7
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Oct 25 21:50:43 2016 +0000

    Bug 17558: Add more tests
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    All tests pass successfuly
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7d28998c93e7376af972f2bd75d8c0c620749ddb
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Oct 25 21:52:11 2016 +0000

    Bug 17558: Fix adding manager id to patron messages in store method
    
    Test plan:
    
    prove t/db_dependent/Koha/Patron/Messages.t
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised. Pass OK
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8630e83ed1b0261bcffd7d4966460daca8c9a3af
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Nov 7 16:07:01 2016 +0100

    Bug 17420 - record export fails when itemtype on biblio - followup
    
    Same as previous patch for misc/export_records.pl.
    
    Test plan :
    - Use syspref item-level_itypes = biblio record
    - Run misc/export_records.pl
    => Without patch you get an error : DBD::mysql::st execute failed: Unknown column 'biblioitems.itemtype' in 'where clause' ...
    => With patch you get a correct export file
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Export Ok, no errors.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 37256b4d2d040822ef3690fdd4946b193b3e0c11
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Oct 10 16:46:04 2016 +0200

    Bug 17420 - record export fails when itemtype on biblio
    
    In Tools, Export data, you can export with a filter on item type.
    When item type is on biblio record, you get the error :
    export.pl: DBIx::Class::ResultSet::next(): Unknown column 'biblioitems.itemtype' in 'where clause' at /home/koha/src/Koha/Objects.pm line 150
    
    Looks like its because this code use to be a SQL Select and is now a DBIx call :
                              C4::Context->preference('item-level_itypes')
                                ? ( 'items.itype' => $itemtype )
                                : ( 'me.itemtype' => $itemtype )
    
    This patch corrects by using "me.itemtype"
    
    Test plan :
    - Use syspref item-level_itypes = biblio record
    - Go to Tools > Export data : /cgi-bin/koha/tools/export.pl
    - Select an item type
    - Click on "Export biblio records"
    => Without patch you get an error 500
    => With patch you get a correct export file
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Fix the issue, no errors.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 61f3c5b880fa4da59959db116bf0cd3145a8b45a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Aug 26 15:04:12 2016 +0000

    Bug 17204: Rancor Z39.50 search fails under plack
    
    MetaSearcher.pm forks children to handle searching each server. When the
    process waits for the children it never continues.
    
    The simplest solution here is to exclude the metasearcher service from
    running under plack
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 78d728f1463eda04289f030037de750bf5f2bba9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 10:25:57 2016 +0000

    Bug 17562: Fix Acquisition.t
    
    I find these tests too much complicated and decided to remove them.
    They depends on the number of fields in the DB and any time we change
    this table we need to update the tests.
    As I don't understand the tests, I prefer to simply remove them, they
    don't seem very useful.
    Feel free to provide a counter patch if you think we should keep them.
    
    Test plan:
      prove t/db_dependent/Acquisition.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    This tests should be removed as this patch does.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 47bae5b36572011ad06a0d4bc4b401a538e39fe0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 8 16:11:49 2016 -0300

    Bug 17563: (followup) Silence undef warnings
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ed848e167aaaec2e67bffc87ea4a17396fec20d6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 10:55:06 2016 +0000

    Bug 17563: Fix Acquisition/CancelReceipt.t
    
    Test plan:
      prove t/db_dependent/Acquisition/CancelReceipt.t
    should return green
    
    Confirm that the changes made by
      commit 20d9ed618fbe3cdcb9c04444a1f8a584b0364069
        Bug 13321: Rename variables
    was wrong for the budget_id var and that this patch reverts it
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bf315c45cf5b33915578d1a878865122e5683ecd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 11:10:04 2016 +0000

    Bug 17564: Fix t/db_dependent/Acquisition/OrderUsers.t
    
    ModReceiveOrder takes now a 'order' parameter and is mandatory.
    This new test file has been added after the first submission of bug
    13321 and has not been updated during the rebases.
    
    Test plan:
      prove t/db_dependent/Acquisition/OrderUsers.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 80c80ca683217455221e15e0c24a81d5e60e49e0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 8 17:12:27 2016 +0000

    Bug 17589 - Improper method type in Koha::ItemType(s)
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2b54196b72757a6483dc99a1fa8d2e76538a5102
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Oct 4 12:36:11 2016 +0200

    Bug 17394 - exporting checkouts with items selects without items in combo-box
    
    In checkouts table, the is an export form (when some exports syspref are enabled).
    When selecting some checkouts and selecting "ISO2709 with items" in export format combo-box, clicking on "Export" will select "ISO2709 without items" in the export format combo-box.
    This is quite strange.
    Its because the form as 2 inputs with same name and id "output_format" : an hidden input (the wanted arg for tools/export.pl) and a select (the export format combo-box).
    So an action meant on the hidden input impacts the select.
    
    This patch corrects by changing id and name of the export format combo-box : issues-table-output-format
    
    TEST plan :
    - Enable checkouts exports by setting syspref ExportWithCsvProfile with a profile
    - Go to circ page of a patron with checkouts : /cgi-bin/koha/circ/circulation.pl?borrowernumber=xxx
    - Show checkouts table
    - Select some checkboxes in "Export" column
    - Select "ISO2709 with items" in export format combo-box
    - Click on "Export"
    => Without patch, the export format combo-box changes to "ISO2709 without items"
    => With patch, the export format combo-box does not changes
    - Check the export file contains the items
    - Check exports "ISO2709 without items" and "CSV" are OK
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d711d62a4801f77c553e51c31bcc1cea6e8d13fb
Author: Radek Šiman <radek.siman@centrum.cz>
Date:   Mon Oct 31 23:24:42 2016 +0100

    Bug 17521: Added missing age limit check
    
    Following patron modification partial editor had no age constraint
    checking:
    /cgi-bin/koha/members/memberentry.pl?op=modify&borrowernumber=3&step=3
    
    Test plan:
    1) Apply the patch
    2) Open profile of a patron
    3) Click Edit under "Library use": http://prntscr.com/d1ghim
    4) Change category to an invalid one (eg. Adult instead of Kid)
    5) Error saying "Patron's age is incorrect for their category." should
    be displayed.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Lucio Moraes <lmoraes@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 988e9430a402ca04ec7563f49d6cc43c2737c46a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 4 13:49:57 2016 +0000

    Bug 17552: Continue revert and add tests to highlight the problem
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3ee051c7067d40327ccfe09e59881d877a99b4c1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 4 13:47:21 2016 +0000

    Bug 17552: Revert "Bug 17091: Remove explicit declaration of Koha::Objects->reset"
    
    This reverts commit c253af2e519570c4024891dc4d1e81743a2c5fc2.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3f8a4cd2a12668af4f3ff1d22b4beac06f17df57
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 2 09:36:53 2016 +0000

    Bug 17535: Fix search for reports by keywords
    
    The commit cf9031711282f4be23e4a639797d0fd178940e1f
        Bug 14435: Add the ability to store result's report
    introduced a regression when searching for reports by keywords.
    It also breaks tests in t/db_dependent/Reports/Guided.t
    
    It's caused by the missing join on saved_reports.
    The error says DBD::mysql::db selectall_arrayref failed: Unknown column
    'report' in 'where clause'
    
    Test plan:
    Confirm that the tests are fixed and that you are able to search for
    reports using the "keyword" input
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8eec57d605b379694927ef344f9a8c302a7b05d7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Oct 21 07:01:30 2016 +0000

    Bug 17476: Add a way to bypass dt_from_string processing time for slow servers
    
    We already change this value from 1 to 2 but apparently it's not enough
    So let's switch it back to on and add a flag (env var SLOW_SERVER) and skip these tests
    if set
    
    Test plan:
      prove t/DateUtils.t
    and
      SLOW_SERVER=1 prove t/DateUtils.t
    
    should return green
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7e0f372b6c63778ad7a234e467d30303094f07e4
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Fri Oct 21 17:04:58 2016 +0200

    Bug 17481: Fix incorrect merge of bug 11048 (logout redirection for CAS authentication)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9e82c921a6a5d43323535393d1b5006c12535eba
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 4 09:19:01 2016 +0000

    Bug 17548: Fix step 1 of memberentry
    
    This bug has been highlighted by bug 15407.
    
    The date limit check on the category code did not work on step 1. But
    after bug 15407 the script crashes with
      Can't call method "dateofbirthrequired" on an undefined value at
      /home/vagrant/kohaclone/members/memberentry.pl line 311.
    
    Test plan:
    - Edit "step 1" information of a patron (first 'Edit' on a patron detail
    page).
    - Save
    => Without this patch it BOOMs
    => With this patch, the info should be correctly saved
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b2c59c7ff248597aefc9043bc2aa4547938c82b5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 15:05:15 2016 +0000

    Bug 16908: Remove non-desired export line
    
    GetTitles has been removed by bug 16847 and reintroduced it by bug
    16908, caused by a bad merge conflict.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 22770166205401f030b2feeafae2e8f9f6189339
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 7 15:16:45 2016 +0000

    Bug 12633: Remove export line
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9427edc2f6ae268f2af65c21b6b7850b31f35358
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Nov 4 12:18:57 2016 -0300

    Bug 17494: (QA followup) Fix exception name
    
    This patch changes the exception name to match the package name. And
    also adds a test for the thrown exception message.
    
    Also creates a general Koha::Exception::Patron::Modification exception
    to make the new one inherit from it, following the common use in the codebase.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f6148ab777b2231cb047f54677d8d716954b062a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Oct 31 11:15:02 2016 +0000

    Bug 17494: Prevent duplicate tokens from getting stored
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit df3a9105e843d8f41abb85b7a1416f538f2896e2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 27 10:04:30 2016 +0200

    Bug 17494: Make sure the same verification token won't be generated twice
    
    Well, this patch does not enforce the unique constraint but mimic what
    is already done in C4::ImportExportFramework and Koha::Upload where
    md5_hex is used.
    
    Test plan:
    Have a look at the code and confirm that it adds more randomness to the
    hashed string
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 43c6850269d7bc28ec339ccab780592fb306ac4d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jun 8 10:53:25 2016 +0000

    Bug 16493: [QA Followup] Restore title and author match as an option, make it the default
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ed932be618da24b226cd6404eb2f526886dbd781
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed May 11 14:19:41 2016 +0000

    Bug 16493: acq matching on title and author
    
    When you order from a staged file you're getting duplicate warnings that
    are inaccurate.  For example, when you order a file of 50 DVDs for
    example and they don't have ISBNs they're matching on the books. And
    then you have to order them one by one.
    
    This patch replaces the use of FindDuplicates with Koha's match point
    system. This means you can select from the same match points defined
    and used in the batch record importer, or you can opt to skip matching
    altogether!
    
    Test Plan:
    1) Import a record with a title, isbn and author.
    2) Delete the from the record and stage it again
    3) Attempt to add it to a basket via the staged record
    4) You should note the gives you the "No records imported" message
    5) Apply this patch
    6) Create a matcher for ISBN
    7) Create a matcher for Author/Title
    8) Attempt to add the record to your basket using the ISBN matcher
    8) Koha should find no match and import the record to the basket
    9) Stage the record again
    10) Attempt to add the record to your basket using the Title/Author matcher
    11) You should recieve the "No records imported" message.
    
    Signed-off-by: Barbara Fondren <bfondren@roundrocktexas.gov>
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4fd1f3e48ea103d1656adebe70d9c9672f7217f7
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 4 08:58:20 2016 +0100

    Bug 17539: [QA Follow-up] Move handle after schema
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 91774fcf15cf8e3c2c6142d5ee646c1e8a06a7a2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Nov 3 12:04:31 2016 -0300

    Bug 17539: (QA followup) Silence warnings
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 246bca4a67b2ca177d4defb39284a3ede2a0703a
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Wed Nov 2 15:28:30 2016 +0200

    Bug 17539: Fix failing Reserves.t tests if category enrolmentfee > 0
    
    To test:
    1. Set patron category "S" with enrolmentfee 1
    2. perl t/db_dependent/Reserves.t
    3. Observe following errors:
    
    not ok 59 - Bug 14464 - No fines at beginning
    ok 60 - Bug 14464 - 1st reserve correctly created
    ok 61 - Bug 14968 - Keep found column from reserve
    not ok 62 - Bug 14464 - No fines after cancelling reserve with no charge configured
    ok 63 - Bug 14464 - 2nd reserve correctly created
    not ok 64 - Bug 14464 - No fines after cancelling reserve with no charge desired
    ok 65 - Bug 14464 - 1st reserve correctly created
    not ok 66 - Bug 14464 - Fine applied after cancelling reserve with charge desired and configured
    
    4. Apply patch
    5. perl t/db_dependent/Reserves.t
    6. Observe test pass
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c414e7608956ca04648aed1a15b79c5cd281fb3c
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Wed Nov 2 15:05:28 2016 +0200

    Bug 17539: Fix Already in a transaction error
    
    perl t/db_dependent/Reserves.t
    
    1..72
    ok 1 - use C4::Reserves;
    ok 2 - CheckReserves Test 1
    ...
    ok 52 - Reserve in waiting status cant be canceled
    ok 53 - Reserving an ageRestricted Biblio without a borrower dateofbirth succeeds
    DBD::mysql::db begin_work failed: Already in a transaction at
    /usr/share/perl5/DBIx/Class/Storage/DBI.pm line 1489.
    DBD::mysql::db begin_work failed: Already in a transaction at
    /usr/share/perl5/DBIx/Class/Storage/DBI.pm line 1489.
    at /usr/share/perl5/DBIx/Class/Schema.pm line 1080.
    ...
    Koha::Object::store('Koha::Patron=HASH(0x9e43b20)') called at
    /home/ubuntu/kohaclone/C4/Members.pm line 542
    C4::Members::ModMember('borrowernumber', 658535, 'dateofbirth', '2001-11-02')
    called at t/db_dependent/Reserves.t line 516
    
    This patch fixes this issue by replacing dbh autocommit=0 with
    txn_begin.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e0e88806fae409e6ec6e360f5e82f55a45ca0e96
Author: Lari Taskula <lari.taskula@jns.fi>
Date:   Wed Nov 2 14:51:23 2016 +0200

    Bug 17539: Fix Undefined subroutine &C4::Circulation::GetItem error
    
    perl t/db_dependent/Reserves.t
    
    1..72
    ok 1 - use C4::Reserves;
    ok 2 - CheckReserves Test 1
    ok 3 - CheckReserves() include reserve_id in its response
    ok 4 - CheckReserves Test 2
    ok 5 - CheckReserves Test 3
    ok 6 - GetReservesControlBranch returns item home branch when set to ItemHomeLibrary
    ok 7 - GetReservesControlBranch returns patron home branch when set to PatronLibrary
    ok 8 - Item is correctly waiting
    ok 9 - Item is correctly priority 1
    ok 10 - Item is correctly priority 2
    ok 11 - GetWaiting got only the waiting reserve
    ok 12 - GetWaiting got the reserve for the correct borrower
    Undefined subroutine &C4::Circulation::GetItem called at /home/ubuntu/kohaclone/C4/Circulation.pm line 1853.
    
    This patch fixes this error. The solution was to use C4::Reserves before C4::Items.
    Also due to this edit, change use_ok to require_ok
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 27596ca2e4de7ad57c095c45f1ef6c9ad35f4848
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Tue Jun 21 13:24:20 2016 -0600

    Bug 16792: Add Font Awesome Icon and mini button to Keyword to MARC mapping section
    
    Improve Admin > Keyword to MARC mapping to fit with others interfaces in Koha.
    This bug change "Delete" link with a mini-button and introduce the trash icon.
    
    To test:
    -Apply patch
    -Goto Admin > Keyword to MARC mapping
    -Select one framework
    -Add some mappings
    -Notice about the new button with trash icon
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4a85117160b4afd7d12d9ae9ca3ec0ddc009c2da
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Nov 3 10:17:32 2016 -0300

    Bug 17544 - : Remove t::lib::Mocks dependency from populate_db.pl
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 96fec3a16d66ffa30da9682e91069195f6eb831e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 2 11:54:12 2016 +0000

    Bug 17540: (Bug 7216 followup) Fix tests for auth_values_input_www.t
    
    This is caused by bug 17216 which modified the structure of the AV admin
    page
    
    Test plan:
      prove t/db_dependent/www/auth_values_input_www.t
    should return green
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit be9a609870445d5d4a2cc24f78eca2d3c4c7c1f2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 2 11:01:54 2016 +0000

    Bug 17538: (Bug 17216 follow-up) Fix t/db_dependent/Upload.t
    
    The insert into authorised_values failed because of the missing FK
    
    Test plan:
      prove t/db_dependent/Upload.t
    should return green
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b286868ec99341102dd78eaffea832a8d6b635ab
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 2 10:50:54 2016 +0000

    Bug 17537: Fix valid-templates.t for some include files
    
    3 include files do not pass the template validation tests:
     - koha-tmpl/intranet-tmpl/prog/en/includes/admin-items-search-field-form.inc
     - koha-tmpl/intranet-tmpl/prog/en/includes/subscriptions-search.inc
     - koha-tmpl/opac-tmpl/bootstrap/en/includes/opac-topissues.inc
    
    This is because they process a block which has not been declared before.
    As they are include files, they cannot stand on their own.
    We could have added them to the exclude file list of xt/author/valid-templates.t
    but I think it's better to keep them into the validation loop.
    
    Test plan:
      prove xt/author/valid-templates.t
    should return green
    And the library dropdown list should be correctly populated on the pages these files are included
    (opac-topissues for instance)
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 674d3875c81af122eb7f925845fe73cc4d817db4
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Nov 2 11:02:09 2016 +0000

    Bug 17518 - DBRev 16.06.00.047
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit de2ba75c25f9f348a312093483dea52168fa5d6e
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Oct 26 22:53:04 2016 +0000

    Bug 17518: Displayed language name for Czech is wrong
    
    It's "Ceština" and should be "Čeština"
    
    Test plan:
    1) apply the patch
    1.1) update database
    2) install Czech translation for Koha
    3) note the language name in language switcher (in staff client and
        opac) is right: "Čeština"
    
    Signed-off-by: radiuscz <radek.siman@centrum.cz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4a3ead4e5625fac8b2bdf8742676e1d958cf673d
Author: Nightly Build Bot <nightly@abunchofthings.net>
Date:   Sat Oct 29 00:59:58 2016 +0200

    Bug 17084 - Automatic debian/control updates (unstable)
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1191ea4f448dd9ae994cf703e8e0a4970fdbb57e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Oct 26 11:34:08 2016 -0300

    Bug 17504: Make the installer show the right dmbs help if wrong permissions
    
    This patch changes the installer template for step 2 (DB rights check)
    so it correctly displays MySQL-related message.
    The previous code was doing the wrong comparisson, thus yielding
    PostgreSQL documentation.
    
    To test:
    - Run:
      $ sudo koha-mysql kohadev
      > DROP DATABASE koha_kohadev ; CREATE DATABASE koha_kohadev;
      > REVOKE INSERT ON koha_kohadev.* FROM 'koha_kohadev'@'localhost';
      > FLUSH PRIVILEGES; \q
    - Run the webinstaller through step 2
    => FAIL: You get the message in the attached screenshot
    - Apply the patch, reload
    => SUCCESS: You are displayed a different warning message, with a link
    to up-to-date MySQL docs on GRANT
    - Fix permissions for the user:
      $ sudo koha-mysql kohadev
      > GRANT ALL PRIVILEGES on koha_kohadev.* TO 'koha_kohadev'@'localhost';
      > FLUSH PRIVILEGES; \q
    - Reload
    => SUCCESS: All checks are correct and you can move on
    - Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 503a784e603624f7f889610764093d4ba8c1103c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Aug 9 10:14:02 2016 -0400

    Bug 16991: Add subtitle to holds to pull report
    
    This patch adds output of subtitle to the holds to pull report using
    keyword to MARC mapping information.
    
    To test, apply the patch and go to Circulation -> Holds to pull. The
    list of holds to pull should display subtitles.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Subtitle added using keyword to MARC mapping with default framework.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 23f4830095d64d9a421a458fe5582930aa229aa7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 31 14:40:51 2016 +0000

    Bug 17524: Fix datepicker check for iso dates
    
    Iso dates are yyyy-mm-dd, the is_valid JS function
    expects \d{2}-\d{2}-\d{4} when it should be \d{4}-\d{2}-\d{2}
    
    Test plan:
    Switch DateFormat to iso
    Set a due date using the datepicker
    => Should work as expected
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d6de78624e61d602de2ed60f48951af3e4947949
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 13:38:45 2016 +0100

    Bug 16852: Remove GetBorrowerCategorycode
    
    And use Koha::Patron->categorycode instead
    
    Test plan:
    - Restrict a patron attribute to a patron category
    - Use the batch patron modification tool to update a patron of this
      category
    You should not see the the patron attribute
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b3f9232b6acaa0db7eed520a22ca0b07271b27ae
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 8 10:26:34 2016 +0100

    Bug 17274: Display the place where the memcached is picked
    
    The memcached config can be read from ENV or koha-conf.xml
    In order to remove any ambiguity, let's inform the user which config is
    used.
    
    Test plan:
    1/ Define the memcached config in ENV and $KOHA_CONF
    => Go on about page, you should get a warning
    2/ Define the memcached config in ENV and not in $KOHA_CONF
    => Go on about page, you should get a warning
    3/ Do not defined the memcached config in ENV or $KOHA_CONF
    => Go on about page, you should get a warning
    4/ Define the memcached config in $KOHA_CONF and not in ENV
    => Go on about page, you should not get a warning, this is the expected
    config
    
    Followed test plan, works as expected.
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d041018394401a40cc541fd2ae1ea338b14da051
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 13 11:33:43 2016 -0300

    Bug 17261: (followup) Mention the need to start memcached before plack
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6197e5020d8f3b26f50a588191820f341d0fbba4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 8 10:04:13 2016 +0100

    Bug 17261: Memcached may not longer be running
    
    If plack is started with memcached, memcached will be considered as
    running, even if it has been stopped (or crashed).
    This case should be highlighted on the about page.
    Note that I am not sure about the consequences of this specific case!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 605abeb08aa73d366224e481ffb17c72d376979f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 8 09:24:00 2016 +0100

    Bug 17261: The default memcached namespace is "koha"
    
    If no namespace is defined in ENV or the config, "koha" is used as the
    default memcached namespace (See Koha::Cache->new)
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0dfefe73f5961e59104dbde3a2d08ac585f57fac
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Sep 7 12:45:23 2016 -0300

    Bug 17261: (followup) Rebase against 17189 and 11921
    
    This patch adjusts the original one so it works on top of 17189
    and 11921. It adds an 'Effective caching method' text which can
    be useful, when memcached is not available.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eedbb1b7ea4f9b89fbae70b3df7d503f6cce7ac2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 6 16:24:40 2016 -0300

    Bug 17261: Add memcached configuration info to about.pl
    
    This patch adds a row in the About > System information tab, showing
    the current configuration for memcached.
    
    To test:
    - Apply this patch, have memcached configured for the current instance (this is the
      default in kohadevbox)
    - Make sure you have the memcached server running:
      $ sudo service memcached start
    - Open the about page in the browser
    => SUCCESS: You get something like:
      Memcached:    Servers: 127.0.0.1:11211 | Namespace: koha_kohadev | Status: running
    - Stop the memcached server:
      $ sudo service memcached stop
    - Reload the about page
    => SUCCESS: You get something like
      Memcached:    Servers: 127.0.0.1:11211 | Namespace: koha_kohadev | Status: not running
    - Set both MEMCACHED_* variables in the apache config for intranet the empty string:
      $ sudo vim /etc/apache2/sites-enabled/kohadev.conf
    ..
       SetEnv MEMCACHED_SERVERS ""
        #"127.0.0.1:11211"
       SetEnv MEMCACHED_NAMESPACE ""
        #"koha_kohadev"
    ..
    - Restart apache:
      $ sudo service apache2 restart
    - Reload the about page
    => SUCCESS: You get something like:
      Memcached:  Servers: undefined| Namespace: undefined | Status: unknown
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e67c20260948ea974a828ec99a77b9840bbddec7
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Nov 2 10:53:35 2016 +0000

    Bug 15581 - DBRev 16.06.00.046
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 85e95d069d8c072fec355e3c18bd59333e9618f9
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Nov 1 15:53:05 2016 +0100

    Bug 15581: Follow-up - suggested change to the OPAC message
    
    Instead of showing "Automatic renewal" to the user, this
    changes it to show "No longer renewable" when the
    automatic renewal won't happen any longer because of the
    days the item has already been checked out.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e3387862fb19f08d6f1a3cb4f4fbb9b632170986
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Oct 28 16:08:01 2016 +0000

    Bug 15581: Change wording for auto too late
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6e2caf74f85e5d6ea5df8042431a4ade06b60633
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 18 16:33:42 2016 +0100

    Bug 15581: Display the generic "schedule for auto renew" message on the checkouts table
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 15b1f6c7fe472ce4b1c0f73e2f0dbb0fe05a15ad
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 14 14:38:23 2016 +0000

    Bug 15581: Display the latest auto renew date possible when renewing manually
    
    If an issue marked as auto_renew is renewed manually, we want to display
    the latest auto renew date possible.
    
    Test plan:
    1/ Define circ rules as in the previous patch.
    2/ Check a item out, mark it as an auto renewal
    3/ Back date the issuedate and make sure it will be too late to renew it
    4/ Use the Circulation > renew page (circ/renew.pl) to manually renew
    this issue.
    You should get a warning "You barcode has been scheduled for automatic renewal
    and cannot be renewed anymore since DATE."
    If the pref AllowRenewalLimitOverride is set, you will be allowed to
    renew it anyway.
    
    Sponsored-by: University of the Arts London
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 53dfa997276348f70c2924bc588b3668f2dfb519
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 13 19:17:49 2016 +0000

    Bug 15581: Add a circ rule to limit the auto renewals given a delay
    
    This patch adds a new circulation rule (no_auto_renewal_after) to block/allow
    auto renewals after a given delay.
    For instance, if the issue date is 10 days before today, and
    no_auto_renewal_after is set to 10, tomorrow the issue won't be auto
    renewed.
    
    Test plan:
    0/ Execute the update DB entry
    Note: You will have to manually change data in your DB, make sure you
    have access to the sql cli.
    1/ Define a rule with no_auto_renewal_after (10 for instance) and
    norenewalbefore (5 for instance).
    (This new rule will behave the same as norenewalbefore: the unit depends
    on the lengthunit value).
    The automatic renewals will be done from 5 to 10 days ahead.
    2/ Modify the issues.issuedate, to simulate a checkout in the past:
        UPDATE issues
        SET issuedate = "yyyy-mm-dd hh:mm:ss"
        WHERE itemnumber = YOUR_ITEMNUMBER;
    with issuedate = 2 days before for instance
    3/ Execute the automatic renewals cronjob script (misc/cronjobs/automatic_renewals.pl)
    Confirm that the issue has not been renewed (too soon)
    4/ Repeat step 2 with a due date set as 11 days before
    5/ Execute the automatic renewals cronjob script (misc/cronjobs/automatic_renewals.pl)
    Confirm that the issue has not been renewed (too late)
    6/ Repeat step 2 with a due date set as 7 days before
    7/ Execute the automatic renewals cronjob script (misc/cronjobs/automatic_renewals.pl)
    Confirm that the issue has been renewed (issues.renewals has been
    incremented and date_due has been updated according your circ rules).
    
    Sponsored-by: University of the Arts London
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 81eec722da04a0071a5680439a81472ea796c3fc
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 31 16:18:37 2016 -0300

    Bug 14874: (followup) Fix typo introduced in sysprefs.sql
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6001765ba16c5d2f36847254fc8a278023d52022
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Oct 31 10:41:40 2016 +0000

    Bug 17397 - Update Schema Files
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bbcb19a7f6403b53b89e08272f811e533d8c9c14
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Oct 5 12:42:41 2016 +0200

    Bug 17402 Enhance the actions button on serials-search.pl
    
    Test plan:
    1) Apply the patch
    2) Go to serials home page
    3) Search for a subscription
    4) Ensure you have permission to receive serials
    5) In the most right column of table you should see "Receive serial" button with
       caret button, that should work as trigger form dropdown menu with other options
    6) Ensure that all actions work as expected
    7) Login with user without permission to receive serials
    8) repeat 2-3
    9) In the most right column of table you should see normal dropdown mane with label "Actions" and all applicable options
    10) Ensure that all actions work as expected
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f9da6f9739b334a1e14b75a1aa49b2f5569b032e
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Wed Oct 19 08:53:26 2016 +1300

    Bug 17459: Follow up
    
    Adding POD and --userid and --password options
    
    1/ To test, use the same routine as before, with no options.
    2/ You should have a user with koha/koha as userid and passwords
    3/ Delete that user
    4/ Run the script with --userid <userid> --password <password>
    5/ You should have a user in koha with userid/password set
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a462d46b02c01a25ebffb85d3b1e462813c77de1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 17 18:01:07 2016 +0100

    Bug 17459: Add a script to create a superlibrarian user
    
    This is for developers: it's quite long (many clics) to create a new
    superlibrarian user.
    This new script creates a new user with superlibrarian permissions with
    the easy to remember credential koha/koha
    
    Test plan:
      perl misc/devel/create_superlibrarian.pl
    Log in to Koha using koha/koha
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 10b3bb8f46098d8e07a3ba03756d581773a5c495
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 28 16:49:24 2016 +0000

    Bug 17443 - DBRev 16.06.00.045
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 80b4af4d590c2b296f172142c1bec2090338d8d1
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Oct 25 18:27:53 2016 +0000

    Bug 17443: Added tests
    
    Test plan:
    prove t/db_dependent/Koha/Patrons.t
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0a85759d3335c002233d7c7b07a8f8fcaeb22cae
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Oct 13 14:21:48 2016 +0200

    Bug 17443: Make possible to renew patron by later of expiry and current date
    
    Test plan
    1) Apply the patch
    2) Go to system preferences and find the BorrowerRenewalPeriodBase and note there is new option "the later of current and expiry date"
    3) Try all three options and confirm they work as expected
       3.1) The new options should be tested et least with two patrons - one with expiry date in past and one with expiry date in future
    
    Signed-off-by: radiuscz <radek.siman@centrum.cz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 607dac69a95e7bcb454661bfde71a45ee20d0155
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Oct 20 11:58:32 2016 -0300

    Bug 4880: Make koha-remove stop all instance's services
    
    This patch makes koha-remove stop all instance's services before
    attempting to remove the system user,
    
    Before this patch, only zebra was stopped.
    
    To test:
    - Run:
      $ sudo koha-create --created-db favourite_name
    - Run:
      $ sudo koha-remove favourite_name
    => FAIL: koha-indexer is still running for user favourite_name-koha
    - Run:
      $ sudo koha-create --created-db another_name
      $ sudo koha-plack --enable another_name
      $ sudo koha-plack --start another_name
      $ sudo koha-indexer --stop another_name
      $ sudo koha-remove another_name
    => FAIL: koha-plack is still running for user another_name-koha
    - Apply the patch
    - Repeat the previous tests, with new names
    => SUCCESS: Everything works as expected :-D
    - Sign off :-D
    
    Signed-off-by: Lucio Moraes <lmoraes@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e6e09c540fa42c4c3bc3a380494f6ea5637417f3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 11 11:26:35 2016 +0000

    Bug 15803: Koha::AuthorisedValues - Remove C4::Koha::GetAuthorisedValueCategories
    
    The subroutine C4::Koha::GetAuthorisedValueCategories just retrieves all
    the authorised value categories.
    We already have a method in the Koha::AuthorisedValues module to do this
    job, let's use it!
    
    Technical explanations:
    The new subroutine of the AuthorisedValues TT plugin will allow to get
    the authorised value categories from the templates.
    The new html_helpers include file will get rid of the if selected else
    end statements. Bug 15758 already uses this file, see the commit
    description for more informations.
    
    Test plan:
    1/ Create or edit a new fund (aqbudgets.pl), the fields "statistic 1"
    and "statistic 2" should be correctly filled with the list of authorised
    value categories
    2/ Edit subfields for a biblio and authority framework.
    The "Authorized value" dropdown list should be correctly filled on both
    pages
    3/ Create new items search fields (from the administration area), same
    as previously, the authorised value category dropdown list should be
    correctly filled
    4/ Add and edit patron attribute types, check the authorised value
    category list.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d25840fc68bcacd8a8509713549b10753bdcd128
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Sat Sep 10 14:41:54 2016 +0300

    Bug 7039 - Link to existing record from result list in acquisition search
    
    In the Staff client -> Acquisitions, when creating orders from
    existing records the result list should link to the existing
    records so that it's possible to check for existing items.
    
    This patch adds that functionality.
    
    Test plan:
    1) In the Staff client, go to Acquisitions and try to add an order
       from existing records.
    2) Observe that the titles in the Summary column are not hyperlinks.
    3) Apply the patch.
    4) Repeat step 1), and confirm that the titles are now links
       pointing to each biblio's details page.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ade53625863175ffdbc3201de847754fdebf838d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 28 15:43:20 2016 +0000

    Bug 17397 - DBRev 16.06.00.044
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2c5a05b8be84491250fc1c966b5251076fb9533c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 27 09:37:55 2016 +0200

    Bug 17397: Do not display parenthesis if the manager has been deleted
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5833673157d75ba6fbf2caedf7931283b4eabf7d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 27 09:33:10 2016 +0200

    Bug 17397: Simplify code passing the Koha::Object to the template
    
    Instead of creating a new array
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3d63c64915c02c44a5e1a45e9db66be939fd4dae
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Oct 4 13:57:03 2016 +0200

    Bug 17397: Show name of librarian who created circulation message
    
    Test plan:
    1) Apply the patch
    2) Update DB structure
    3) Run update_dbix_class_files.pl
    4) Select patron for checking out
    5) Try to add some circulation and opac messages
    6) Note that now there is creator (you ;) ) shown by every message added (with link to creator profile)
    7) Try to delete messages to confirm that everything works as expected
    
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bd13efd8ac1121286dd565c40111b491b61d54cf
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Jul 21 07:46:23 2016 +0200

    Bug 16952: Czech language definitions for sorting in Zebra
    
    Test plan:
    1) Apply patch
    2) Create new instance with parameter --zebralang cs
    3) Insert some record with basic latin characters and some with "czech" characters (for example: "č" - should be sorted after "c", "š" - should be sorted after "s")
    4) Try to search in katalog (staff and opac) and sort by other field then relevance - title or author for instance
    5) Records should be sorted correctly by Czech rules
    6) Look at code and confirm it is ok
    
    Signed-off-by: radiuscz <radek.siman@centrum.cz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    I did not test this patch, but trust in the author and signoffer
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 98596e91113ee6a8e95e00cde03408e9c6599f59
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 24 09:13:07 2016 +0100

    Bug 16912: Update patron category enrolment fees
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f9654783e2154bfd95cac92ae9b23615d88538e2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 08:31:01 2016 +0100

    Bug 16912: Koha::Patrons - Move and rewrite tests for AddEnrolmentFeeIfNeeded
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9c6f634469de4364d71bc0eb7520d04ead61fd00
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 08:30:13 2016 +0100

    Bug 16912: Koha::Patrons - Move AddEnrolmentFeeIfNeeded to ->add_enrolment_fee_if_needed
    
    This patch moves the code of the C4::Members::AddEnrolmentFeeIfNeeded
    subroutine to the Koha::Patron->add_enrolment_fee_if_needed method.
    The behavior should be unchanged.
    
    Test plan:
    1/ Define enrolment fee for 2 patron categories
    2/ Create a patron using the first category
    => The patron should be charged
    3/ Change the patron category to the other one
    => The patron should be charged again
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eff7d113a0c31e1e1a0d32626d5834b01a902fda
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jun 2 21:24:06 2016 -0400

    Bug 16641: Update Novelist in OPAC to use updated call to fetch content
    
    To test:
    1 - Enable novelistselect content in the opac
    2 - Find a record with novelist content, confirm it displays in tabs ro
    above or below accoring to pref
    3 - Find a record without novelist content, note you get an empty tab
    4 - Apply patch
    5 - Ensure results have not changed for items with content
    6 - Ensure tab does not display for item with no content
    
    Sponsored by:
       Walla Walla Public Library (http://www.wallawallapubliclibrary.org/)
       Los Gatos Library (http://www.losgatosca.gov/42/Los-Gatos-Library)
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>
    Internal signoff.
    
    Signed-off-by: Dwayne Nance <dnance@ebsco.com>
    
    Signed-off-by: Alexis Rodegerdts <arodegerdts@wallawallawa.gov>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 917bdb5dce7a8f4856858f772bfaa5bdf8303fe9
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Oct 27 01:19:06 2016 +0200

    Bug 16123: Remove bold formatting from first level fund
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bb3623815022bb841ed96127ad27e6942b079f3d
Author: Bouzid Fergani <bouzid.fergani@inlibro.com>
Date:   Wed Oct 12 15:52:25 2016 -0400

    Bug 16123 - Add unit tests
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 73d9557b13bcd7354436db6980fb23b6c9a124dc
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Thu Aug 20 11:52:03 2015 -0400

    Bug 16123 - Display budget hierarchy in the budget dropdown menu used when placing a new order
    
    When placing a new order, the budget dropdown will display the budget hierarchy.
    
    TEST PLAN :
    
    1. Go to the Administration module
    2. Add a new budget (ie : Budget 2016)
    3. Add a fund to this budget (ie : Book)
    4. Add a child fund (ie : Adult fiction)
    
    You will have this hierarchy :
    
    Budget 2016
     |____ Book
             |_____ Adult fiction
    
    5. Go to the Acquisition module
    6. Select a vendor and create a new basket
    7. Place an order
    8. Check the budget dropdown menu
    
    BEFORE PATCH
    Book
    Adult fiction
    
    AFTER PATCH
    Book
       Adult fiction
    
    Dropbown menu is hierarchical as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e54186a4ddc1e4980fdabf9db5bf410c84dbcad4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Oct 28 15:22:20 2016 +0000

    Bug 13321: Fix tests in Budgets.t
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b5f9263345b39ef9496f23f11ce119de31db3c6a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 28 15:06:47 2016 +0000

    Bug 13321 / 13323 - Update Schema
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 876743402161fe4e5d08116ed8bd2c8b38678181
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 14 08:38:10 2016 +0200

    Bug 17356: [QA Follow-up] Minor changes to skeleton.perl
    
    Due to the way the snippet is run, there is no need to add a use for
    C4::Installer or define $dbh (just like $DBVersion).
    The suggested code is commented (column_exists is not defined).
    Just as in updatedatabase, CheckVersion is called. The version number
    does not need to contain 16.06; if we do so, we should update this
    number each release. The XXX's work just fine.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4be8768a6ed9d134cca7168f9645dcdb57833582
Author: Liz Rea <liz@catalyst.net.nz>
Date:   Fri Sep 30 09:57:54 2016 +1300

    Bug 17356 - update README
    
    Test plan:
    Look at the README and make sure it makes sense.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3f7098a02ff8c37a19063420f24fdaca6ba141d8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 27 08:30:12 2016 +0100

    Bug 17356: Add atomic update .perl skeleton file
    
    To show devs how it should be written.
    
    Test plan:
    % cp installer/data/mysql/atomicupdate/skeleton.perl
    installer/data/mysql/atomicupdate/bug_XXXXX.perl
    % perl installer/data/mysql/updatedatabase.pl
    
    You should see:
    DEV atomic update: bug_xxxxx.perl
    Upgrade to 16.06.00.XXX done (Bug XXXXX - description)
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    Very good. I'll submit a patch for the readme to make the instructions better.
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 96a112e96103c8392042da90b2104de070a3cf05
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 24 13:03:16 2016 -0300

    Bug 17428: (QA followup) Fix community site in swagger file
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c15db78d3c26903c557b00a35bba329a4022b569
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 24 17:04:11 2016 +0200

    Bug 17428: (QA followup) Remove warning
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e08639129aec34d2228e08e65a0ef8ba008c6efc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 12 21:31:30 2016 +0000

    Bug 17428: [REST] best practice followup
    
    This followup alters a few area's to be aligned more closely with
    RESTfull best practices:
    
    * PUT should always be full objects, and not partial updates (use PATCH
      for partials)
    * Validate query parameters instead of blindly passing them to the model
      * Functional Change: Convert filter params from 'equality' to 'starts with'
        matching
    * Update tests to check for swagger validation errors instead of koha exceptions
    * Mark 'id' as readOnly so swagger may prevent, via validation, id
      changes.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 29ba2720043b493fc96ed4238a4f2a3a76b9192c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 11 13:26:39 2016 +0200

    Bug 17428: [REST] Koha::REST::V1::Cities introduced
    
    This patch introduces full CRUD for Koha::Cit(ies|y) classes through
    the REST api. To test, point your browser to /api/v1/cities to use
    HTTPRequester/Postman (or the like).
    
    And of course, run the unit tests:
    - Apply the patches
    - Update your minified swagger file:
      $ cd kohaclone/
      $ misc/devel/minifySwagger.pl -s api/v1/swagger/swagger.json \
                                    -d api/v1/swagger/swagger.min.json
    - Run:
      $ prove t/db_dependent/api/v1/cities.t
    => SUCCESS: Tests should return green, and no warnings.
    - Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 217d0df5175b4fbd907b747d3f29bf0a1d6d2c2b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 11 13:25:14 2016 +0200

    Bug 17428: [REST] Cities swagger specification
    
    This patch adds the swagger definitions for the /cities endpoint
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ef5b32f942506c487834db4fb6db0493be7f0ea2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 11 13:24:14 2016 +0200

    Bug 17428: [REST] Cities endpoint unit tests
    
    This patch introduces unit tests for the cities endpoint.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 25adf52334917ceb6e67109a4041984dc2837e14
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 28 14:28:40 2016 +0000

    Bug 13323 - DBRev 16.06.00.043
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9beffec5aac0e42247633f5f4f793f40f11b4216
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 28 14:23:24 2016 +0000

    Bug 13321 - DBRev 16.06.00.042
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0fe43b3ad1f797fa502bbeb967c5c76e57774d51
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Oct 13 14:48:38 2016 +0200

    Bug 13323: Recalculate tax_value for partially received orders
    
    Test plan:
    1. Create an order with at least 2 items
    2. Receive only 1 item
    3. Check that the tax value of the received order line is correct on
       the parcel and invoice pages
    4. Check that the tax value of the original order line is correct (on
       the basket page for example)
    5. Cancel the receipt
    6. Check that the tax value of the original order line is correct
    
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ff45a15256a66352b1ab2d32b0cf0e9dc2a9a8ed
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Feb 1 11:47:17 2016 +0100

    Bug 13323: QA fix (trailing whitespace)
    
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 19398f2777c47acb84dc8c33f9dc4f766e42330e
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Wed Nov 19 17:01:17 2014 +0100

    Bug 13323: Tax rate can change on receiving
    
    This commit permits to update the tax rate on receiving.
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Francois Charbonnier <francois.charbonnier@inlibro.com>
    
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1204a7269f967486a140d1ed611f77a4768a9e3c
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Wed Nov 19 16:59:39 2014 +0100

    Bug 13323: Tax rate can change on receiving - DB changes
    
    This patch adds 4 new DB fields to the aqorders table:
     * tax_rate_on_ordering
     * tax_rate_on_receiving
     * tax_value_on_ordering
     * tax_value_on_receiving
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Francois Charbonnier <francois.charbonnier@inlibro.com>
    
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d653e02d32974cda16f7b83a4d7b2f112e526812
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Tue Nov 18 17:07:45 2014 +0100

    Bug 13324: The fund values should be based on tax included values
    
    Now we have a column in DB to easily retrieve the tax included values.
    So the sum must be done this the _tax_included DB field and not on the
    "old" field.
    The old field can be tax excluded or tax included depending the supplier
    configuration.
    
    Test plan:
    Verify that the values in the acqui home and budgets page are the tax
    included values.
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Francois Charbonnier <francois.charbonnier@inlibro.com>
    
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d8da77bd8b57c1957bffe81df5679c096236e104
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 27 00:51:42 2016 +0000

    Bug 13321 - (QA Followup) Restore standing order functionality
    
    Some lines deleted during rebase, restored and updated, tests repaired
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 36fb4a34a67abea080045fab30ac1aa81cd8f786
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Oct 13 16:05:16 2016 +0200

    Bug 13321: Fix table display in invoice page
    
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2a1b68295256852b080ff699283e6cf29e34b9a6
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Sep 9 13:45:36 2016 +0200

    Bug 13321: Update DBIx::Class schema files
    
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1a05ec58cd42093dbb4706375069b12ec420be1a
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 5 11:11:44 2016 +0200

    Bug 13321: Recalculate tax_value for partially received orders
    
    Test plan:
    1. Create an order with at least 2 items
    2. Receive only 1 item
    3. Check that the tax value of the received order line is correct on
       the parcel and invoice pages
    4. Check that the tax value of the original order line is correct (on
       the basket page for example)
    5. Cancel the receipt
    6. Check that the tax value of the original order line is correct
    
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b8872515ccb15a4519d9533da75383e3a234f2b3
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Sat Jun 4 13:46:44 2016 +0200

    Bug 13321: Add missing Price TT plugin in orderreceive.tt
    
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6eaf0c0d201f973722d705b766fb18d217549f3e
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Fri May 20 14:25:44 2016 +0200

    Bug 13321: Adds renaming of gstrate column in kohastructure.sql
    
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8f5ee4c91dba7f2c05a574e2e3639a5eeb86ddc6
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Tue Jan 13 17:03:04 2015 +0100

    Bug 13321: Fix unitprice rounding
    
    We need to display the rounded value, but insert the exact value.
    The unit price can be change on receiving, so the input value can be
    modified.
    But if it's not, we must insert the exact (not rounded) unit price,
    which is the ecost value.
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Francois Charbonnier <francois.charbonnier@inlibro.com>
    
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1c1e6b11f7d09efb18b5f26a5bf45b64bbbfbe18
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Mon Dec 15 16:32:15 2014 +0100

    Bug 13321: Csv export - Display rrp and ecost with and without taxes
    
    If a basketgroup is exported as a CSV file, both prices should be displayed to
    avoid confusion.
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Francois Charbonnier <francois.charbonnier@inlibro.com>
    
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 43f93f2ee822194a215473ddd10d01489cccc7cb
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Wed Nov 19 16:52:01 2014 +0100

    Bug 13321: Tax and prices calculation - DB Changes
    
    This patch adds 7 columns to the aqorders table:
     * unitprice_tax_excluded
     * unitprice_tax_included
     * rrp_tax_excluded
     * rrp_tax_included
     * ecost_tax_excluded
     * ecost_tax_included
     * tax_value
    
    It also renames:
     * aqorders.gstrate with aqorders.tax_rate
     * aqbooksellers.gstrate with aqbooksellers.tax_rate
    
    The new columns are filled with the previous calculation method.
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Francois Charbonnier <francois.charbonnier@inlibro.com>
    
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7e89301ab2eca57aa13256f9ed4c8351834476e3
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Mon Nov 17 12:06:09 2014 +0100

    Bug 13321: Fix the prices calculation method
    
    Well, we have finally arrived here \o/
    
    The method where the prices are calculated uses the equations listed on
    the wiki page (http://wiki.koha-community.org/wiki/GST_Rewrite_RFC).
    
    The ecost is calculated from the rrp (using the discount and the tax
    rate). That's why we removed the ability to edit this value.
    
    That's why we remove the ability to edit the ecost on ordering in a
    previous commit (bug 12840).
    
    The total is now calculated in the scripts. That's why this patch
    removes lines in the test file.
    
    In C4::Acquisition::populate_order_with_prices, the calculation on
    receiving must depend on the 'invoiceincgst' supplier parameter, and not
    listincgst (which is used on ordering).
    It also removes the rounding errors, now we store "exact" values in DB
    (10^-6).
    The values will be displayed using the Price TT plugin it will round the
    values for us.
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Francois Charbonnier <francois.charbonnier@inlibro.com>
    
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 42c8019b4dc29211a76f82b6c95855e5601a6345
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Fri Nov 14 16:44:27 2014 +0100

    Bug 13321: use the populate_with_prices where needed
    
    Now we need to calculate the prices (ecost, rrp, unitprice) and tax
    (tax_rate, tax_value) when the price is set for an order.
    
    This only appends in the 3 files impacted by this patch.
    addorder*.pl on ordering
    finishreceive.pl on receiving
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Francois Charbonnier <francois.charbonnier@inlibro.com>
    
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 20d9ed618fbe3cdcb9c04444a1f8a584b0364069
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Fri Nov 14 16:10:52 2014 +0100

    Bug 13321: Rename variables
    
    This patch renames the variable according to the new DB column names
     * gste => tax_excluded
     * gsti => tax_included
     * gstrate => tax_rate
     * gstvalue => tax_value
    
    This patch also modify the ModReceiveOrder subroutine:
     * Edit vendor note on receiving is not possible, so the code should not
       permit that.
     * Update ModReceiveOrder to pass a hashref
    
    And that's all!
    git grep on gste, gsti, gstrate and gstvalue should not return any code
    that can be executed.
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Francois Charbonnier <francois.charbonnier@inlibro.com>
    
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Sonia Bouis <koha@univ-lyon3.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9a77e0600e0c87f95c098e67f7fcc53c6491f500
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 28 12:11:17 2016 +0000

    Bug 14629 - Fix # of unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b6e51b685ee8c04d4dfaaf4b4f48f76049bff1c9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 11 14:31:26 2016 +0100

    Bug 15801: minor fixes
    
    - Fix a tab
    - Fix a variable name in a template
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    
    With all patches applied no errors.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c8f6794bb104d4f1f597ec6b7f77a8e20372d41f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 10 17:26:35 2016 +0000

    Bug 15801: Koha::BiblioFrameworks - Remove C4::Koha::getframeworkinfo
    
    This was the "Get" subroutine for the framework, it can be easily
    replaced with a call to the Koha::BiblioFrameworks->find method.
    This patch also replaces some confusing wordings (framework vs frameworkcode).
    
    Test plan:
    On the circulation home page, you should see a "Fast cataloguing" link
    if the FA framework exists.
    
    Note that the admin/marctagstructure.pl has already been tested in the
    previous patch.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Link pops Ok
    No errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8f436a50759ae4ca64f85ac5035a933a6d094e3f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 10 16:56:01 2016 +0000

    Bug 15801: Koha::BiblioFrameworks - Remove C4::Koha::getframeworks
    
    C4::Koha::getframeworks returned a hashref of biblio frameworks.
    It was mainly used to generate the dropdown list of frameworks.
    The scripts modified in this patch did not necessary order the element
    by description (frameworktext), the displays were not consistent from
    one screen to another.
    Using the same search method everywhere:
      Koha::BiblioFrameworks->search({}, { order_by => ['frameworktext'] });
    We will know always get the framework in the same order.
    
    Test plan:
    Following the different pages modified by this patch, and make sure the
    frameworks are displayed correctly in the dropdown list:
    1/ acqui/z3950_search.pl - Create an order from an external source.
    2/ admin/fieldmapping.pl - Define some mappings keyword / MARC field
    3/ admin/marctagstructure.pl - On the MARC frameworks admin page, select
    another framework than the default one and click on the 'Search' button
    4/ catalogue/MARCdetail.pl - On the MARC defail page, change the
    framework you want to use to display the record
    5/ cataloguing/addbiblio.pl - Add or edit a biblio record, change its
    framework. When editing, the framework of the record should be selected
    by default
    6/ cataloguing/addbooks.pl - Go on the cataloguing home page and click
    on the "New record" button. You should see all the frameworks
    7/ cataloguing/merge.pl - Select 2 biblio records to merge. On the first
    step (select the merge reference), you should be allowed to select the
    framework to use.
    8/ tools/inventory.pl - On the inventory page, the "Item statuses" part
    should be populated as before this patch
    9/ tools/manage-marc-import.pl - Stage records for import. Before
    importing them into the catalog, you should see the framework dropdown
    list.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Works Ok.
    No errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ddb1ecb9d8b4a29a3c0360a07aa539d378193747
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 10 16:06:14 2016 +0000

    Bug 15801: Koha::BiblioFrameworks - Remove C4::Koha::GetFrameworksLoop
    
    The C4::Koha::GetFrameworksLoop retrieves biblio frameworks and returns
    them ordered by the description (frameworktext). If a parameter is
    passed, a selected flag is set. The selection of the options should be
    done on the template side.
    These 2 calls can be replaced with
      Koha::BiblioFrameworks->search({}, { order_by => ['frameworktext'] });
    
    Test plan:
    1/ Go on a Labeled MARC biblio view (catalogue/labeledMARCdetail.pl)
    You should see a dropdown list with the biblio frameworks. The framework
    of the record should be selected by default
    2/ Create a sql report using the biblio_framework parameter, something
    like:
      SELECT COUNT(*) FROM biblio WHERE frameworkcode=<<framework|biblio_framework>>
    Save and execute the report.
    You should get a dropdown list with the framework list.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Both dropdowns Ok
    No errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c7bc14cead116d7a8737be8da19b688e53049864
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 28 11:59:55 2016 +0000

    Bug 14629 - DBRev 16.06.00.041
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bad06abf77bdb78fa3089b7a9b37eb69dd68245c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 28 12:30:23 2016 +0200

    Bug 14629: [QA Follow-up] Small tidy up
    
    Some cosmetic changes as to whitespace and one call less to Normalize.
    
    Test plan:
    Run t/Koha.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0790de1321ef23c3cd5c94560af7e78e91932791
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Aug 10 18:53:48 2016 +0000

    Bug 14629 - (QA Followup) sysprefs.sql changes
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0963dc4da6b77d02ba798a6605685531ddccfcf4
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 31 16:00:10 2015 +0000

    Bug 14629 - [QA Followup] Pass invalid ISSN through GetVariationsOfISSN
    
    This is an optional follow up depending on community opinion.
    
    While copying over the code form the ISBN portion I noticed that with
    aggressive matching enabled invalid ISBNs (and hence ISSNs) were being
    stripped from the record.
    
    I think in the case of a library exporting records, making changes, and
    reimporting they would expect to get a match on ISSN or ISBN whether or
    not the number is valid.
    
    This patch changes the subroutine to return the original ISSN in the
    case of it being invalid.
    
    To test:
    With first patch only export a record with an invalid ISSN and reimport
    with AggressiveMatchOnISSN enabled and match on ISSN - you should not get a match
    Apply this patch
    reimport the file and you should find a match.
    
    Signed-off-by: Chad Roseburg <croseburg@ncrl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 68ced964fd254e7cba67a9b1b867907c557888c4
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Dec 30 23:14:37 2015 +0000

    Bug 14629 - Add aggressive ISSN matching feature equivalent to the aggressive ISBN matcher
    
    This patch adds a syspref "AggressiveMatchOnISSN" allowing for a match
    of ISSNs with or without hyphens. It uses Business::ISSN in order to
    follow the use of Business::ISBN and allow for validation of ISSNs
    
    To test:
    1 - Find a record in your system with an ISSN (or add one)
    2 - Stage a record containing the same ISSN but lacking a hyphen
    3 - Matching on ISSN should find 0 matches
    4 - Repeat with no hyphen ISSN in system and hyphen ISSN in import
    5 - Matching should find 0
    6 - Apply patch
    7 - Update datbase and install Business::ISSN
    8 - Leave AggressiveMatchOnISSN as don't and repeat original tests- no
    change
    9 - Set AggressiveMatchOnISSN as do and repeat original test
    10 - You should find a match
    11 - prove t/Koha.t - all tests pass
    
    Sponsored by North Central Regional Library System (NCRL) www.ncrl.org
    
    Signed-off-by: Chad Roseburg <croseburg@ncrl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b8f703364c8dcd9a263e9f77596ca0fba1a1bc4
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Oct 26 18:31:06 2016 +0200

    Bug 7679: Follow-up to fix group by hour
    
    Grouping by hour does not work with the collates.
    This patch removes them after talking to Julian on IRC.
    
    This partially reverts one of the earlier patches:
    Bug 7679: Display all table headers (case and accent
     sensitive)
    
    One could argue that this is more of a data problem,
    than something we should fix/'hide' with code.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7e619055e697d7d4da2f1082094b8d3ca8a9cb33
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Oct 26 17:41:49 2016 +0200

    Bug 7679 - Follow-up for terminology
    
    Patch changes "Library" to "Issuing library" and
    "Patron branch" to "Patron library".
    
    It also changes the text of the filters to match
    the terms and spelling on the form itself.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bab92d51e56ade24c89087ded6163ffa43f53915
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 1 17:22:00 2014 +0200

    Bug 7679: Display all table headers (case and accent sensitive)
    
    It appears that we can't assume that a lowercase word is equivalent to
    the same word in uppercase (or a mix of lowercase and uppercase
    letters). And this is also true about accented words.
    So display all values even if they differ only by case or by their
    accents.
    This means that:
    - "foobar" and "Foobar" will be in two separate rows/columns
    - "Etudiant" and "Étudiant" (french) will be in two separate
      rows/columns too
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 13a528f2f3a3630239cc804cd3dcf214cc3412f1
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Mar 24 11:56:58 2014 +0100

    Bug 7679: Various fixes for circulation statistics wizard
    
    - use SQL TRIM functions to avoid having '' and ' ' considered as
      different values
    - use Text::Unaccent to remove accents from columns or rows values when
      accessing %table. This is required as MySQL consider as equals two
      strings that differ only by their accents when using GROUP BY clause.
    - Exclude '' values from the list of columns or rows. Otherwise we could
      have a row 'UNKNOWN VALUE' and a row 'NULL' which both have the same
      values in their cells.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 916e9f4619229da80d7d8c45cecb77fc7db61816
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Feb 19 12:44:29 2014 +0100

    Bug 7679: Fix two SQL queries when using patron attributes
    
    and remove some Perl warnings
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9934dae30d19f48e254c8eb1751d051c32f17b4a
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Feb 5 15:40:34 2014 +0100

    Bug 7679: Fix several bugs in circulation statistics wizard
    
    - Display values in NULL columns/rows
    - Display columns/rows that contain values only in NULL rows/columns
    - "To" filter in period row should be inclusive (YYYY-MM-DD should be
      YYYY-MM-DD 23:59:59)
    - Make it possible to use only the "To" filter in period row (actually
      it results in DBI error (2 bind variables instead of 1))
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d620bbc8872e9d1737d3d045839c1b1f793802fc
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Nov 6 08:47:13 2013 +0100

    Bug 7679: Group different case values in the same row/column
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a3d5b6cd666a8418938ace6507174a054dd7c3f5
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Apr 29 15:07:49 2013 +0000

    Bug 7679: Fix criteria display
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit babc6fbfe9e3ea8ac960609538dfb45da2e79ed9
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Mon Oct 29 16:20:36 2012 +0100

    Bug 7679: Followup: circulation statistics wizard improvements
    
    Signed-off-by: Brendan <brendan@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3b6692bd9500c52ca98a5e007fc20e98806a6255
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Aug 8 17:02:19 2012 +0200

    Bug 7679: circulation statistics wizard improvements
    
    - Add patron branch to the list of possible rows, columns, and filters
    - Add extended patron attributes to the list of possible rows, columns,
      and filters
    - Allow to group period by hour
    - Allow to translate filter names
    
    NOTE: Removed signed off, since I believe I have dealt with the conflicts.
          Retesting required. Found some comments C4::Date that I missed.
          line prepatch 194/ postpatch 233 seems to be where the major
          conflict is.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2354e41b6191d44be1d1e9e8830359335b3b87d6
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 28 11:54:58 2016 +0000

    Bug 5260 - DBRev 16.06.00.040
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cf9efd7312630ce318ab1457654a56ad06e8e931
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 20 09:07:34 2016 +0100

    Bug 5260: Use post params instead of get to avoid putting op=email in the browser history
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1aa88636a6af0d10ac1df01ca41ce3a6eb8bbc81
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 20 08:58:05 2016 +0100

    Bug 5260: simplify script and error handling
    
    No need to redirect, just sent the params to the template directly
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 28ef209c81c5ba21ffd7800e0b94ced051c8c8d2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 20 08:54:50 2016 +0100

    Bug 5260: Insert the new letter for existing installs
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f6bdc2f9378c0f2f932150f75c43fe28b96eb37e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 20 08:54:21 2016 +0100

    Bug 5260: make tests pass even without patron cat 'PT'
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f8472e1686c9822768a38202f62eb98bfc11da31
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Oct 19 23:52:21 2016 +0200

    Bug 5260: QA follow-up - Add sample ACQORDER notice to sample notices
    
    Adds the new notice ACQORDER to all web installers.
    
    Verify by testing the SQL contains no errors and by running:
    perl xt/sample_notices.t
    
    NOTE:
    - de-DE is already translated, others are in English.
    - xt/sample_notices.t doesn't check fr-CA yet. I didn't fix this here
      as the file is missing other notices as well which should be fixed
      separately.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1e120924c2bfd11c4e0bf4a8479897d6cc2cf921
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Oct 19 23:26:22 2016 +0200

    Bug 5260: QA follow-up: Fix error when no notice template is defined
    
    When no notice template ACQORDER was defined, you'r receive a false
    positive "email sent" message. Now it will display a specific
    error message instead.
    
    Also includes 2 unit tests to test for the warn and new error code.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0ca7ac9dd5726bf8f39d3e28eda9a466ac12ff4c
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Oct 16 12:56:48 2016 +0200

    Bug 5260: Follow-up - Reindenting POD of SendAlerts
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fd97c08ee327d8a4d35a06708e16d1344af8af3a
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Oct 14 07:19:40 2016 +0000

    Bug 5260 - Schema changes
    
    Schema changes for new column in the aqcontacts table.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0f72535232d9d5165c0e3dd9e158652cf3504be0
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Oct 14 12:02:33 2016 +0200

    Bug 5260: Unit tests for new functionality in SendAlert
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9af64aa7d5739c0160fe484958921f1294955fb5
Author: Katrin Fischer <Katrin.Fischer.83@web.de>
Date:   Tue Jun 16 00:44:44 2015 +0200

    Bug 5260 - Add option to send an order by e-mail to the acquisition module
    
    With this patch it will be possible to send order information
    to the vendor by e-mail. For now this feature can be triggered
    manually with a button before closing the basket.
    The order e-mail is based on the acquisition claim feature, but
    uses a new notice template.
    
    Test plan:
    
    1) Vendors
    A new checkbox "Contact when ordering?" was added to the vendor
    page.
    - Add a vendor and/or edit an existing vendor
    - Verify the new option is saved correctly
    - Verify the new option displays on the vendor summary page
      after saving
    
    2) Notices
    The feature works with a new notice template: ACQORDER
    It works with the same formatting/fields etc. as the acq claim
    notice.
    - Add a new notice template ACQORDER in module
      'Claim/order aquisition'
    - Make sure to use fields from the various offered tables
      in your notice
    - Verify it is saved correctly
    
    3) Basket
    - Turn on LetterLog system preference
    - Create multiple order lines
    - Click the 'Send order' button in the toolbar
    - Verify error or success message
    - Verify you received the e-mail
    - Verify there is a new entry with about the sent
      notice in your action_logs table
    
    4) Regression testing...
    - Verify order claims still work
    - Verify serial claims still work
    - Verify new serial issue notices still work
    ...
    (I can provide additional test plans if needed)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0bc8f1fd462c4bf9fc37af883c9fb776ab9a0f85
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Oct 24 14:45:18 2016 +0200

    Bug 6934: Fix tiny capitalization issue missed before
    
    Account Management Fee
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 00ea6fb5d147ac2407e4f0cc4e3b42dcf8f6b5c7
Author: Bouzid Fergani <bouzid.fergani@inlibro.com>
Date:   Thu Sep 29 12:43:39 2016 -0400

    Bug 6934 - Fix problem C4::Branch::GetBranchesLoop not exist
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a27b57c32715739a25c69c3ea7b33ea7356a68d4
Author: Bouzid Fergani <bouzid.fergani@inlibro.com>
Date:   Thu Aug 4 14:56:33 2016 -0400

    Bug 6934: rename active transaction with All payments to the library and grouping in it the relevant account types 'Pay' 'C'
    
        rename Patron carnumber on Patron card number
        fix src databales.js
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 337be9f10e07020fd1673ab70836a41f974c8aeb
Author: Bouzid Fergani <bouzid.fergani@inlibro.com>
Date:   Thu Jul 28 09:38:01 2016 -0400

    Bug 6934: fix errors pointed out by the QA script
    
    Also fix forbidden patterns in koha-tmpl/intranet-tmpl/prog/en/modules/reports/reports-home.tt
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eb000bbcdc87cb1898da1e0e0960a72cb93c1bed
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Fri Jul 22 09:12:47 2016 -0600

    Bug 6934: Fix the href for datables in link rel stylesheet
    
    Fix the new path for 'datatables.css'
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 085a2c4834d01d4f223a62482005e3e60250e259
Author: Bouzid Fergani <bouzid.fergani@inlibro.com>
Date:   Tue Jul 19 14:56:41 2016 -0400

    Bug 6934: Make CSV header column translatable and add total amounts in csv file
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 385563ca48dbab787a8a9921a162df79909ab05a
Author: Bouzid Fergani <bouzid.fergani@inlibro.com>
Date:   Tue Jul 19 12:05:14 2016 -0400

    Bug 6934: fix problem when export it open in LibreOffice - show values of itype and use TT plugin
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f4ef34c13603e8f373451b2739dd4528f8aba6df
Author: Katrin Fischer <Katrin.Fischer.83@web.de>
Date:   Thu Apr 28 19:58:32 2016 +0200

    Bug 6934: QA follow-up
    
    - fixed tabs
    - fixed capitalization on reports start page
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 311f6b400b1783dba49950c427832aa46857bef1
Author: Remi Mayrand-Provencher <remi.mayrand-provencher@inLibro.com>
Date:   Tue Apr 19 12:11:50 2016 -0400

    Bug 6934: fixed encoding issue
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Encoding issue fixed
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9346aabd1317c7ca546e3c30a4215adf576022ec
Author: Remi Mayrand-Provencher <remi.mayrand-provencher@inLibro.com>
Date:   Fri Mar 4 16:13:14 2016 -0500

    Bug 6934: second fix to calendars
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 03e654ee2e5763f556372747a50996acb2bdaa87
Author: Remi Mayrand-Provencher <remi.mayrand-provencher@inLibro.com>
Date:   Fri Mar 4 15:10:57 2016 -0500

    Bug 6934: Fixed Calendar and removed used of unexisting and unused C4::Budgets getCurrency
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ed68d1e71f6ab84aa49e59411dfe7bf247b3be8
Author: Remi Mayrand-Provencher <remi.mayrand-provencher@inLibro.com>
Date:   Thu Mar 3 11:14:12 2016 -0500

    Bug 6934: QA Follow-up
    
    Tried to address every single thing that QA mentioned :
    1)Removed isNull function
    2)Changed datepicker properly
    3)We have to fill in two dates not to be flooded with old entries if we don't want to.
    4)The first two fieldsets are now in one bigger field set
    5)Removed the use of $fullreportname variable
    6)Removed the use of dt_from_string when it already recieved a DT.
    7)Removed comments starting with "###" in cash_register_stats.pl
    8)Used Text::CSV::Encoded to generate the CSV file (used guided_reports.pl as an example)
    9)I am not sure if using C4::Reports::Guided is the right choice here. I instead used the same column names as the one recieved by the query in cash_register_stats because this report uses columns from 5 different tables in addition of using both firstname and surname twice.
    
    For the ninth point, I would like to know more about C4::Reports::Guided if you still think using it would be a better solution. Thank you!
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7b10c7ccb613ec969782b801d946b049756e992d
Author: Genevieve Plantin <genevieve.plantin@inlibro.com>
Date:   Fri Nov 13 11:50:01 2015 -0500

    Bug 6934: New features, note added to transaction information, total caculated for negative types of transaction
    
    To be more specific, the column note from accountlines is now displayed in the table of the transactions.
    The grand total is now calculated for neagtive types like Credit or Payment and isn't counted for Write off types.
    Credit (return item) 'CR' has been added to drop down of transaction type
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0c1413d0ff4b26aeddbcdd760ac5ed941af1b72c
Author: Genevieve Plantin <genevieve.plantin@inlibro.com>
Date:   Tue Sep 15 11:18:49 2015 -0400

    Bug 6934: Fix code in CashRegisterStats (dataTables pagination, more accurate descriptions, add a delimiter pull down, change C4::Dates to Koha::DateUtils)
    
    I cleaned up the code according to comment #23. I got rid of DHTMLcalendar_dateformat,
    beacause it wasn't use in cash_register_stats.tt. C4::Dates is deprecated,
    Koha::DateUtils is now used.
    Some column names are changed and the pagination for the dataTables is fixed.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit caf0a0200566091d4294eb552efcbe3c1a59775e
Author: Simith D'Oliveira <simith@inlibro.com>
Date:   Wed Aug 27 14:36:13 2014 -0400

    Bug 6934: New report Cash Register Statistics
    
    This patch creates a new report that outputs cash register stats for a specific period.
    
    Changes:
    
    koha-tmpl/intranet-tmpl/prog/en/includes/reports-menu.inc               - Added cash register report link
    koha-tmpl/intranet-tmpl/prog/en/modules/reports/cash-register_stats.tt  - new file
    koha-tmpl/intranet-tmpl/prog/en/modules/reports/reports-home.tt         - Added cash register report link
    reports/cash-register_stats.pl                                          - new file
    
    Testing:
    
    I Apply the patch
    
    0) Go to reports home page (Home › Reports);
    1) Validate link << Cash Register >> under Statistics wizards;
    2) Click link;
    3) Validate page with three fieldsets;
    4) Chose a date interval, a transaction type, a library and an output;
    5) Validade the result.
    
    Signed-off-by: Nicole <nicole@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f74e467550c4d6f6e8e9becdc61b7df572de5f09
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Oct 12 16:17:04 2016 +0200

    Bug 17435: Gives ability to display stocknumber in search results
    
    Adds stocknumber to data provided for xslt transformation
    
    Test plan :
    1) go to Administration module, MARC default frameworks and add, if not already done, a stocknumber subfield (a priori under the 995 tag). It will be linked to items.stocknumber in the koha.link zone of Advanced constraints section.
    2) edit an item in staff interface and add a number in the stocknumber field.
    3) Edit the xslt opac Results file that you are using and customize it. For a basic test, you can just replace "itemcallnumber" occurrences by "stocknumber".
    4) make a search in a way to get several results including the title from which you modified an item.
    5) You will see the added stocknumber displayed (between square brackets in the default xslt).
    
    Same can be done through staff interface and staff xslt files.
    
    Olivier Crouzet
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e17209de48f3c9d3184dfd430d882a4e8f8d5d4f
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Oct 18 00:03:08 2016 +0000

    Bug 17434: Moremember displaying primary and secondary phone number twice
    
    Test plan:
    1) Create patron category with category code "P" and create a patron
    with this category
    2) Fill in either the primary or other phone number
    3) Go to patron details page (moremember.pl)
    => without patch you see primary/other phone duplicated
    => with patch you should see the number only once as expected
    
    Signed-off-by: Lucio Moraes <lmoraes@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d08076e7e55a7c78a7ab3d79c33151dd4c469101
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Oct 10 08:10:29 2016 -0400

    Bug 17417 [Revised] Correct invalid markup around news on the staff client home page
    
    This patch fixes two minor errors in the markup around displaying news
    on the staff client home page: Adding a missing "class" attribute, and
    changing the container around news items from <p> to <div> (because news
    items might contain <p> and nesting them is incorrect).
    
    To test, apply the patch and view the staff client home page with news
    items showing. Validate the page and confirm that there are no errors.
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Revision for QA removes an extra </div> from elsewhere in the template
    to make the validator return no errors.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dbab260afccc04fac8d088839d6017242c818917
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Aug 24 11:44:55 2016 +0200

    Bug 16935 - launch export_records.pl with deleted_barcodes param fails
    
    When launching misc/export_records.pl with this command line :
    
     misc/export_records.pl --date=`date +%d/%m/%Y` --deleted_barcodes --filename=/tmp/koha.mrc
    
    You get this error message :
    
    DBD::mysql::db selectall_arrayref failed: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '' at line 4 [for Statement " (
                SELECT DISTINCT barcode
                FROM deleteditems
                WHERE deleteditems.biblionumber = ?
            "] at misc/export_records.pl line 189.
    
    This is because of a '(' after 'q|', looks like a typo.
    Also, this patch removes useless var $q.
    
    Test plan :
    - Delete an item with barcode
    - Without patch, run : misc/export_records.pl --date=`date +%d/%m/%Y` --deleted_barcodes --filename=/tmp/koha.mrc
    => You get dirty MySQL
    - Without patch, run the same command
    => No error and the file is generated
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5d5a1509d113ed1ca9ff7e4132fa638dc622ae77
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 28 11:30:38 2016 +0000

    Bug 14598 - DBRev 16.06.00.039
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3660c451a36db128c143b6388d0d1f34babff4ac
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 28 09:54:20 2016 +0200

    Bug 14598: [QA Follow-up] Small changes
    
    [1] Renames the dbrev version to XXX; adding a my for $sth, although
        not strictly necessary it feels better.
    [2] Circulation.t stumbles over:
        Undefined subroutine &C4::Circulation::GetItem called at ... line 1283.
        Somehow this is related to use_ok instead of a regular use.
        Worked around this by require_ok and adding a regular use.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ec96a0cb3f25f53fbe14f6c93a8d28b48d3b7286
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 7 12:03:49 2016 +0100

    Bug 14598: Fix warning from effective_itemtype
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3fa514133b33aca3727111d2ddfdd0bdb3d5d639
Author: Tomás Cohen Arazi <tomascohen@unc.edu.ar>
Date:   Wed Apr 6 11:34:26 2016 -0300

    Bug 14598: (QA followup) use deleted{items|biblioitems} during upgrade
    
    If the 'statistics' table contains circulation information about items
    that are no longer on the DB it will raise a warning. This patch
    makes the updatedatabase.pl script use the deleteditems and deletedbiblioitems
    tables to get information for those items on the statistics table.
    
    To reproduce:
    - Have your sample DB contain some circulation data on the statistics table
    - Make sure some of them have NULL itemtype:
    > UPDATE statistics SET itemtype = NULL WHERE type='return';
    - Check the upgrade query catches them:
    > SELECT s.itemnumber, i.itype, b.itemtype FROM  ( SELECT DISTINCT itemnumber    FROM statistics    WHERE ( type = "return" OR type = "localuse" ) AND itemtype IS NULL ) s  LEFT JOIN  ( SELECT itemnumber,biblionumber, itype      FROM items    UNION    SELECT itemnumber,biblionumber, itype      FROM deleteditems ) i  ON (s.itemnumber=i.itemnumber)  LEFT JOIN  ( SELECT biblionumber, itemtype      FROM biblioitems    UNION    SELECT biblionumber, itemtype      FROM deletedbiblioitems ) b  ON (i.biblionumber=b.biblionumber);
    +------------+-------+----------+
    | itemnumber | itype | itemtype |
    +------------+-------+----------+
    |        732 | BK    | BK       |
    |        731 | BK    | BK       |
    +------------+-------+----------+
    2 rows in set (0.00 sec)
    
    - Delete the items, and some biblio too.
    - Re-run the query
    => SUCCESS: Same results
    - Go reset to NULL the itemtypes
    > UPDATE statistics SET itemtype = NULL WHERE type='return';
    - Run the updatedatabase.pl script:
     $ sudo koha-shell koahdev ; cd kohaclone
     $ perl installer/data/mysql/updatedatabase.pl
    => SUCCESS: No warnings
    
    Note: It is possible that on production sites, if the sysadmin is cleaning the
    deleted{items|biblioitems|biblio} tables, there will be warnings. This is expected
    as they need to know some data lacks information.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@unc.edu.ar>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e31eb08e29f637f90d095df31388bf64f2b685a9
Author: Tomás Cohen Arazi <tomascohen@unc.edu.ar>
Date:   Fri Apr 1 12:25:39 2016 -0300

    Bug 14598: (followup) Remove unused and non-existent C4::ItemType include
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@unc.edu.ar>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c042307db35f59fe2dca8d8fa214be7b39b0277e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jan 19 14:34:20 2016 +0000

    Bug 14598 [QA Followup] - Update localuse statistics also
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ad800ce36e07915628602c4f6ba2ccf83bacdd16
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jan 12 16:04:55 2016 +0000

    Bug 14598 [QA Followup] - Make unit test pass
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 73b85e98755e075044db72b973cb3ebd6c0f4891
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Dec 18 14:59:02 2015 +0000

    Bug 14598 [QA Followup] - Correct the behavior of GetItem
    
    Currently GetItem sets itemtype to the biblio itemtype if no item level
    itemtype exists. Instead, it should only do this if item_level-itypes
    is not set.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4384e081968c7dd9c95c34d78bda2eba199a3243
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Nov 20 14:23:22 2015 +0000

    Bug 14598 [QA Followup] - Only fetch bib data if needed
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 096b6c3938d060ab973e76f6840bd26ec8ef26cd
Author: Brendan Gallagher <brendan@bywatersolutions.com>
Date:   Thu Nov 19 21:13:05 2015 +0000

    Bug 14598 - QA Followup touching CanBookBeIssued subroutine
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2cdec7ff9178fd8f70b5885b7c2936ddf09e69f7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 1 11:52:17 2015 -0300

    Bug 14598: (DB update) fix NULL itemtypes in statistics on 'return' rows
    
    This patch introduces an updatedatabase.pl entry that takes care of
    updating existing statistics rows.
    
    It does so by looping on the statistics rows, collecting itemnumber occurences
    that are have NULL itemtypes.
    It then chooses the right itemtype following what is proposed on bug 14651, and
    then updates the rows in statistics using the calculated itemtype.
    
    Regards
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 34eb4c1fa95ea14047413436b8df42299d029ca4
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jul 27 11:16:56 2015 -0400

    Bug 14598: (QA followup) Don't die on bad barcode
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 285ac7a31eb50262af9c6a51502630ba150b14fa
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 27 11:40:38 2015 -0300

    Bug 14598: Make C4::Circulation::AddReturn store the right itemtype
    
    This patch makes C4::Circulation::AddReturn correctly store the itemtype
    on the 'statistics' table.
    
    To reproduce:
    - Checkout master.
    - Make a checkout.
    - Check the 'statistics' table and notice the itemtype is correctly set
      > SELECT * FROM statistics;
    - Check the item in.
    - Check the 'statistics' table and notice the itemtype is not set
      > SELECT * FROM statistics WHERE type="return";
    => FAIL: itemtype is set to NULL
    
    To test:
    - Apply the regression tests patch
    - Run the tests:
      $ prove t/db_dependent/Circulation/Returns.t
    => FAIL: Tests fail
    - Apply this patch
    - Run the regression tests:
      $ prove t/db_dependent/Circulation/Returns.t
    => SUCCESS: Tests now pass.
    - Repeat the 'To reproduce' steps
    => SUCCESS: itemtype is now correctly set (in real life)
    - Happily sign off :-D
    
    Sponsored-by: Universidad Empresarial Siglo 21
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 357a69b0e174c813ef52d1ee7f47cd810c76938d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Sun Jul 26 02:05:16 2015 -0300

    Bug 14598: (regression tests) AddReturn should store itemtype on 'statistics' table
    
    This patch adds tests for C4::Circulation::AddReturn(). Both tests are wrapped
    inside a subtest, and look for AddReturn storing the right itemtype on the
    'statistics' table.
    
    Note: It also refactors the file a bit, to avoid side effects. And uses TestBuilder
    to make it independent on already-present db data. It also removes warnings by mocking
    C4::Context::userenv
    
    To test:
    - Apply the patch
    - Run the tests:
      $ prove t/db_dependent/Circulation/Returns.t
    => FAIL: Tests fail bacause AddReturn is not storing the itemtype
    - Sign off :-D
    
    Sponsored-by: Universidad Empresarial Siglo 21
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bfcc7cad70bfc23163865b2ff39eb592d6d9d152
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Sep 29 16:19:48 2016 +0200

    Bug 17376 - rebuild_zebra.pl in daemon mode no database access kills the process
    
    When running rebuild_zebra.pl in daemon mode, a while loop runs the script for ever.
    But if something crashes inside the rebuild process, the all daemon crashes.
    For example when it can not access database.
    This problem may be temporary so daemon should keep running.
    
    This patch add eval around the rebuild process to allow a run to fail without killing the daemon.
    Also moves the DB handler get inside daemon loop because it is broken is DB stoppes.
    
    This is a big issue for indexer running in a systemd service.
    
    Test plan :
    - run rebuild_zebra.pl in daemon mode :
    /home/koha/src/misc/migration_tools/rebuild_zebra.pl -daemon -z -a -b -x --sleep 30
    - stop the database
    - wait a minute
    => you see an error on database connexion
    => the daemon is still running
    - restart the database
    - test the indexer by creating a new record (wait for a minute)
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2d4226902d20bc0d3bcd696f34d56ac60ee2c5b6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 25 09:16:56 2016 +0200

    Bug 17495: Fix 'method selected not covered by test' in reports/issues_stats.pl
    
    If you access reports/issues_stats.pl, you will get
    Template process failed: undef error - The method selected is not
    covered by tests! at /home/vagrant/kohaclone/C4/Templates.pm line 121
    http://localhost:8081/cgi-bin/koha/reports/reports-home.pl
    
    Bug 15407 sent objects to the template and the selected method is not
    defined.
    The bug had been highlighted by bug 17425 which dies instead of hides the error.
    
    Not that the "selected" code was not needed, the different elements of
    the page never select a specific value.
    
    Test plan:
    Apply this patch and confirm that the error is no longuer displayed.
    
    Reproduced. Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 239b81c1dd0cfa2e5e1f720ba9b8554536a9bc44
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Oct 27 14:02:19 2016 +0000

    Bug 14874 - DBRev 16.06.00.038
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87f21ae2452b4fbeddcc26f8ff2a7427add3710c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 4 12:57:13 2016 +0100

    Bug 14874: Set default DefaultPatronSearchFields
    
    just in case...
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 65ed212fae5fca9d4ce4efe32e373fe5bea10d3c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Sun May 15 10:44:48 2016 -0400

    Bug 14874 - Add ability to search for patrons by date of birth from checkout and patron quick searches
    
    This patch adds a new syspef 'DefaultPatronSearchFields' which defines
    the fields that should be used when searching for a patron if none are
    defined.
    
    To test:
    1 - Aply patch, updatedatabase
    2 - Ensure patron search has not changed
    3 - Add dateofbirth to new pref
    4 - Ensure things work wll
    5 - Experiment with adding and removing other fields from borrowers
    table
    6 - prove t/db_dependent/Utils/Datatables_Members.t
    
    Tested together with followup. Works as described.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Bug 14874 (QA Followup)
    
        Fix atomicupdate file name
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9b34b07d62588713405f31481cb363661b1a5d0c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 4 11:55:25 2016 +0100

    Bug 17375: Search by dateofbirth - handle invalid dates
    
    Prevent internal software error when searching patron with invalid birth date
    
    To reproduce:
    
    - Go to Home > Patron
    - Expand patron search (click on + at the left of the search button)
    - In drop down 'Search fields', select 'Date of birth'
    - Enter a valid date (e.g. 11.02.1995 if syspref 'dateformat' is set to dmydot)
    Result: Search works OK
    - Enter an invalid date, e.g. 11.02 or abcd...
    Result: Internal server error
    
    - Do a patron search with many results
    - Use filter on results screen, select 'Date of birth' as search field and
      enter an invalid date to search (e.g. 'a')
    Result: Endless message 'Processing'
    
    To test:
    - Apply patch
    - Repeat steps above
    - In both cases, you should get "No results"
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Lucio Moraes <lmoraes@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 12167c57d0608637504a011627a0256e28e515cd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 4 11:55:02 2016 +0100

    Bug 17375: Search by dateofbirth - Add tests
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 33ff59173151dae282a3c787742128991a656290
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 26 12:21:58 2016 +0000

    Bug 14610 - DBRev 16.06.00.037
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d64de2bd0d4807700993727f3164fac1656c95b8
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Oct 26 13:32:40 2016 +0200

    Bug 14610: Follow-up 2
    
    - Fixes typo "Recieve" in the sample notices
    - Adds new notices to it-IT installer
    - Turns off feature for existing installations, leaves it
      on for new installations
    - Fixes typo "cancelation"
    - Fixes ids in <body> of new pages
    - Adds/fixes classes in th elements of tables
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2ae9f783534e7b0410869aafcb25f0c9dd6b2fa6
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Oct 21 02:17:58 2016 +0000

    Bug 14610 - Follow-up
    
    Patch fixes some smaller problems:
    
    - Adds new notices to the it-IT installer (xt/sample_notices.t)
    - Renames one of the classes used in the table to avoid double up
    - Fixes POD of Bilbio.pm by removing a doubled up line
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c541a967d6de9ebac94afa77e23bb99bf523de55
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Oct 24 13:57:10 2016 +0000

    Bug 14610 - Update Schema files
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9f91b2c1f18bf3165d6874774819d69541be4d58
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 11 08:46:14 2016 +0000

    Bug 14610 [QA Followup] - Fix publishercode issue
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ae893b792af98961b799d64407922afaef50fa96
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 11 08:15:37 2016 +0000

    Bug 14610 [QA Followup] - Add classes to table headers
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0db3058b02a6776452b6a6db11dae40f87276060
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 11 08:12:27 2016 +0000

    Bug 14610 [QA Followup] - Add notices to all language files
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bbcb2fbeaf0e463dcb7960336f86dee61f1fb4d8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Sep 14 13:39:19 2016 +0000

    Bug 14610 [QA Followup] - Implement staff patron tab
    
    Also fixes a few other minor issues
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 628b78eda61e89499488396b683011a9c97d8309
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon May 16 11:21:28 2016 +0000

    Bug 14610 - Update opac.css via less
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 56e42bba232242ea9cb0fa23928c4d02647cdd97
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 7 12:26:37 2015 -0400

    Bug 14610 - Add unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 81a04af27804621609004dc370284413baa5caa2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 7 12:26:14 2015 -0400

    Bug 14610 - Add and update scripts
    
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bf1563e60b31244f4ea977eb84954fb8501ed59a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 7 12:23:24 2015 -0400

    Bug 14610 - Add and update modules
    
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d2a4c327466f448d2018b1dbf537d9f588d96604
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 7 12:22:12 2015 -0400

    Bug 14610 - Add ability to place article requests in Koha - Update database
    
    Article Requests are somewhat similar to holds, but are not requests for
    an item to check out. Instead, article requests are requests for a
    photocopy of a particular section of a book ( most often ). This is very
    common in academic libraries where researchers may request a copy of a
    single article found in a journal.
    
    This patch set adds the ability to place article requests in Koha. It
    allows the control of what can be requested via the circulation rules.
    Since article requests of electronic resources are not outside the realm
    of possibility, the feature will check not only the items for
    requstability, but the record itself as well ( i.e. both items.itype and
    biblio.itemtype ).
    
    Article requests can be placed for patrons from the opac and staff
    intranet and can be viewed in most areas where holds are viewed ( e.g.
    patron details, record details, etc ).
    
    There is a script to view article requests in progress within the
    circulation module. Article requests can be Open ( i.e. new ), In
    Processing, Completed, or Canceled. The status of a given request can be
    updated from this script.
    
    Test Plan:
    1) Apply the patch set
    2) Run updatedatabase.pl
    3) Enable the system preference ArticleRequests
    4) Set up some required fields in:
        ArticleRequestsMandatoryFields
        ArticleRequestsMandatoryFieldsItemsOnly
        ArticleRequestsMandatoryFieldsRecordOnly
    5) Edit your circ rules, set article requests to 'yes' for something
    6) Test the ability to add an article request from the opac ( required fields enforced )
    7) Test the ability to add an article request from the staff interface ( required fields no enforced )
    8) Note you can choose item level or record level requests
    9) Change the rule to "record only"
    10) Repeat 6 and 7
    11) Note you cannot choose items
    12) Change the rule to "item only"
    13) Repeat 6 and 7
    14) Note you must choose an item
    15) Note that the 'new request' message is queued for each new request
    16) Browse to /cgi-bin/koha/circ/article-requests.pl
    17) Note requests are split by pickup branch
    18) Test slip printing via the "Print slip" action
    19) Process request vai "Process request" action
    20) Note an email notice is queued for patron
    21) Refresh /cgi-bin/koha/circ/article-requests.pl
    22) Note request has moved to "processing" tab.
    23) Complete request with "Complete request" action
    24) Note message is queued for patron
    25) Cancel a request, add cancelation note.
    26) Note message is queued for patron
    
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c962285e40a9735e6559900fab0d3d619bca0fff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 24 11:46:31 2016 +0000

    Bug 16850: Adjust number of tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 99de777c5090bdf5e4d9b91cb774e9baf8ab20cd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Oct 19 10:09:56 2016 +0000

    Bug 14752 - Followup to fix error if barcode fields undefined
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2578d8cd968fe00d5e413ce7911f7e14e77cf951
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 21 17:44:59 2016 +0000

    Bug 5670 - DBRev 16.06.00.036
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d5dc05c0d0f3500ff385767e1242b8c1d96b5384
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 17 15:14:39 2016 +0100

    Bug 5670: Add a confirmation message on delete
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d05c8e92f895919f8f7182b54f7c9b6b8d5d03df
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 17 14:58:09 2016 +0100

    Bug 5670: Use the fa icon for the save button
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c517689bb69a7356f71d9dc46ead313dec5bbce8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 17 14:49:48 2016 +0100

    Bug 5670: Use Koha.Preference to retrieve syspref from templates
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 56fbbe237fe275c77a38112538bb9baf99d6bacf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 17 14:47:30 2016 +0100

    Bug 5670: Does not return 0 in Koha::Patron->housebound_* methods
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3130827fa6d9bc814c04209656fcf5aa910712de
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 17 14:47:02 2016 +0100

    Bug 5670: Update constraint name to match with the one in updatedatabase
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 20c2ea7d3a6e24dd13cf3e6dd47108984852607d
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Thu Oct 13 12:37:50 2016 +0200

    Bug 5670: [Followup] Add 'step 4' edit button.
    
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/memberentrygen.tt:
      Place housebound role form inside the 'step 4' section.
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/moremember.tt:
      Add 'step 4' edit button for housebound role.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 44524f6a9618baeabf8d1c2785230d1c87ec5484
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Thu Oct 13 11:57:06 2016 +0200

    Bug 5670: Add auth_val_cat to auth_val_cat.sql.
    
    * installer/data/mysql/atomicupdate/housebound_tables.sql: Insert
      HSBND_FREQ in authorised value categories.
    * installer/data/mysql/mandatory/auth_val_cat.sql: Add HSBND_FREQ.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2541ce4555f9c754343a767fff4b16258c13f5d3
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Thu Oct 13 10:05:46 2016 +0200

    DO NOT PUSH: Moar Housebound Schema files.
    
    * Koha/Schema/Result/Borrower.pm: New method.
    * Koha/Schema/Result/HouseboundRole.pm: New file.
    
    https://bugs.koha-community.org/show_bug.cgi?id=5670
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8ef116a9221ff1365fab54e1eeeef8f31dd25f79
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Wed Oct 12 17:26:02 2016 +0200

    Bug 5670: [QA Followup] HouseboundRole CRUD from UI.
    
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/memberentrygen.tt: Add
      HouseboundRole form.
    * members/memberentry.pl: Handle HouseboundRole CRUD.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 88f4b828f57b7ff1defe5017f62af71075994c74
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Wed Oct 12 14:30:36 2016 +0200

    Bug 5670: [QA Followup] Display HouseboundRole info.
    
    * Koha/Patron.pm (housebound_role): New method.
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/moremember.tt: Add
      section for HouseboundRole information
    * members/moremember.pl: Pass HouseboundRole info to template.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 89db872b41f3a73f643a3a06ae30faba5fae2e35
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Mon Oct 10 15:38:04 2016 +0200

    Bug 5670: [QA Followup] Correct housebound role search.
    
    * Koha/Patrons.pm (search_housebound_choosers)
      (search_housebound_deliverers): Use new table.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 950ae065e0c0f3fd32c8d1767afbf09501e1b370
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Mon Oct 10 15:31:19 2016 +0200

    Bug 5670: [QA Followup] Create HouseboundRole objects.
    
    * Koha/Patron/HouseboundRole.pm: New file.
    * Koha/Patron/HouseboundRoles.pm: New file.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 561812597e1b62bb0d78434907a7c396e6769ee8
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Mon Oct 10 12:37:50 2016 +0200

    Bug 5670: [QA Followup] Create housebound roles table.
    
    * installer/data/mysql/atomicupdate/housebound_tables.sql (housebound_role):
      New table.
    * installer/data/mysql/kohastructure.sql (housebound_role): New table.
    * installer/data/mysql/en/mandatory/auth_values.sql: Remove HSBND_ROLE entries.
    * installer/data/mysql/en/mandatory/patron_attributes.sql: Remove
      HSBND_ROLE entry.
    * installer/data/mysql/en/mandatory/patron_attributes.txt: Remove
      explanatory text.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 424cb6ac8014cd17d876c988fec6e35c107ad601
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Wed Sep 28 16:54:53 2016 +0200

    Bug 5670: [QA Followup] More "required" messages.
    
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/housebound.tt: Mark
      houseboundvisit fields as required.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b44b160dc45028d8160768f964b7ae758431ac7a
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Wed Sep 28 16:33:47 2016 +0200

    Bug 5670: [QA Followup] Improve template style.
    
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/housebound.tt: Remove
      toggler class from form, improve look and layout of action buttons.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 47fb829694a0d409552da2e0bef448ca427bf22d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 28 10:21:44 2016 +0100

    Bug 5670: remove useless call to ->new when ->search is enought
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01ebef46e72a5760afb4a8cf939e61d63059bcac
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 28 10:17:46 2016 +0100

    Bug 5670: mv housebound_* to search_housebound_*
    
    I think it's better to prefix the subroutine names used to search with
    'search_'.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3376c54f332d37fff187c405f69773342500bdc5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 28 10:17:24 2016 +0100

    Bug 5670: Add the 'required' class to required fields
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01873ebd51a1b7920760a03a5fbe05b0808c5511
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Wed Sep 21 17:17:25 2016 +0200

    Bug 5670: [QA Followup] Fix `div.patroninfo`.
    
    * members/housebound.pl: Provide full patron hash keys, extended patron
      attributes & picture to template.
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/housebound.tt:
      Refactor to use new information.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9929583a844ff611c9ce13c8c1d4ef4d0c470ed3
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Mon Sep 19 15:21:19 2016 +0200

    Bug 5670: [QA Followup] Small QA fixes.
    
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/housebound.tt: Remove
      `console.log` invocations.
    * members/housebound.pl ($houseboundvisits, $chooser, $deliverer):
      Remove unused variables.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bacb6b7a9fc8d94144610cd8d17d4e17bd047292
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Mon Sep 19 14:18:27 2016 +0200

    Bug 5670: [QA Followup] Housebound link from patron edit.
    
    * koha-tmpl/intranet-tmpl/prog/en/includes/members-menu.inc: Add a link
      to the housebound module view if it is switched on.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 867444c15e897450ccd97287a6ae20d64b18577f
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Mon Sep 19 13:40:46 2016 +0200

    Bug 5670: [QA Followup] Avoid CGI::param in list context.
    
    * members/housebound.pl: Force `borrowernumber` to scalar context.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01b9e646f518c4e4db29ae9e8a6eb1b51c29b8e0
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Mon Sep 19 13:12:21 2016 +0200

    Bug 5670: [QA Followup] Don't force ISO dates.
    
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/housebound.tt: Use
      ".datepicker" class for date input, use `$KohaDates` to filter our iso
      dates.
    * members/housebound.pl: Use DateTime and Koha::DateUtils to parse
      incoming date to ISO format.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 656efcb5364ae09cfffb02a8ad4f13ff8f5d7db7
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Thu Sep 8 12:39:24 2016 +0200

    Bug 5670: [Followup] Refactor .pl; error messages.
    
    * members/housebound.pl: Refactor & store messages for encountered
      errors.
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/housebound.tt: Show
      messages.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cd8e6082c1ef195b94479f39d959601a4edfbf9c
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Thu Sep 8 12:10:45 2016 +0200

    Bug 5670: [Followup] Return Koha::Patron objects.
    
    * Koha/Patron/HouseboundVisit.pm (chooser, deliverer): Use
      `_new_from_dbic` to return Koha::Patron objects.
    * t/db_dependent/Patron/HouseboundVisits.t: Remove TODO section for this.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit afb81e6c0f1e3a81ed54f8b979553cb8c5068f26
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Fri Apr 4 09:55:07 2014 +0000

    Bug 5670: Housebound Readers Module
    
    New module to handle management of circulation to Housebound readers.
    
    - Ability to create housebound profiles & scheduled visits for patrons.
    - Ability to record users as Deliverers or Choosers (or both), using
      extended patron attributes.
    - Ability to link choosers and deliverers to individual delivery runs.
    - 'Delivery Frequencies' are customizable through authorised
      values ('HSBND_FREQ').
    
    * koha-tmpl/intranet-tmpl/prog/en/includes/circ-menu.inc: add
      Housebound menu if appropriate.
    * Koha/Patron.pm (housebound_profile): New method.
    * Koha/Patrons.pm (housebound_choosers, housebound_deliverers): New
      methods.
    * Koha/Patron/HouseboundProfile.pm: New File.
    * Koha/Patron/HouseboundProfiles.pm: New File.
    * Koha/Patron/HouseboundVisits.pm: New File.
    * Koha/Patron/HouseboundVisit.pm: New File.
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/housebound.tt: New file.
    * members/housebound.pl: New file.
    * installer/data/mysql/kohastructure.sql: Add housebound_* tables.
    * installer/data/mysql/sysprefs.sql: Add HouseboundModule syspref.
    * koha-tmpl/intranet-tmpl/prog/en/modules/admin/preferences/circulation.pref:
      Add HouseboundModule syspref.
    * installer/data/mysql/atomicupdate/housebound_tables.sql: New file.
    * t/db_dependent/Patron/Borrower_Housebound.t: New file.
    * t/db_dependent/Patron/Borrower_HouseboundProfiles.t: New file.
    * t/db_dependent/Patron/Borrower_HouseboundVisits.t: New file.
    
    Test plan:
    - Apply patch.
    - Run atomic update script.
    - Run Unit Tests (t/db_dependent/Patron/Housebound*)
    - Optionally, add additional authorised values to 'HSBND_FREQ'.
    - Switch on 'HouseboundModule' syspref.
    - Ensure 'ExtendedPatronAttributes syspref is on.
    - On patron pages, when editing, add some to the Housebound deliverer
      and chooser groups.
    - On a patron page, the Housebound menu should now be present.
      - create housebound profile
        + ensure Frequency values seem pulled from 'HSBND_FREQ'.
      - create 'housebound visits' (deliveries)
        + ensure chooser/deliverer lists are populated with patrons that
          have the Chooser or Deliverer Attribute type.
      - edit visits.
      - delete visits.
    - Switch off 'HouseboundModule'
      - the Housebound menu should disappear
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Bug 5670: [Followup] Rename test files.
    
    * t/db_dependent/Patron/Borrower_Housebound.t: Rename to
      t/db_dependent/Patron/Housebound.t.
    * t/db_dependent/Patron/Borrower_HouseboundProfiles.t: Rename to
      t/db_dependent/Patron/HouseboundProfiles.t.
    * t/db_dependent/Patron/Borrower_HouseboundVisits.t: Rename to
      t/db_dependent/Patron/HouseboundVisits.t.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Bug 5670: [QA Followup] Fix category_type ref.
    
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/housebound.tt: Replace
      references to `category_type` with `categorycode`.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7887cb0d9359df3570d10a4018371682f2214bb6
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Fri May 27 12:08:23 2016 +0000

    DO NOT PUSH: Add Housebound Schema files.
    
    * Koha/Schema/Result/HouseboundProfile.pm: New file.
    * Koha/Schema/Result/HouseboundVisit.pm: New file.
    
    https://bugs.koha-community.org/show_bug.cgi?id=5670
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>

commit e99e05e8d75ba26ebb556746ea8dd4e38b85aa96
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 21 18:15:50 2016 +0000

    Bug 17425 [QA Followup] - Remove superfluous tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 23c86c3769407a2387011ac82ee97685f1841d48
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 13 14:17:13 2016 +0100

    Bug 17425: Add the Object::MethodNotCoveredByTests exception
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 60fc63ef4dd14fc6068ae5cfc202e5c200f0575b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 11 13:33:24 2016 +0200

    Bug 17425: Add Try::Tiny dependency
    
    This patch just introduces Try::Tiny as a core Koha dependency.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 71e7804d2c5b7576a86cfe2234cff34020742d77
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 11 11:52:12 2016 +0200

    Bug 17425: Make Koha::Object raise exceptions
    
    This patch makes Koha::Object raise exceptions in the following
    situations:
    - When a non existent accessor is called
    - When a non existent property is tried to be updated using ->set
    
    On implementing this change, we introduce Koha::Exceptions::Object class
    to contain all Koha::Object-specific exception definitions.
    
    Unit tests for this change are introduced in
    t/db_dependent/Koha/Objects.t
    
    To test:
    - Apply the patches on master
    - Run:
      $ prove t/db_dependent/Koha/Objects.t
    => SUCCESS: Tests return green
    - Sign off
    
    Note: A followup introduces the dependency for Try::Tiny. It needs to be
    present for running the tests.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ff9937a137518feaa7bd7dfcb32d01965da58f91
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Mon Sep 26 12:37:29 2016 +0200

    Bug 17341: Enhance the report action button on guided_reports.pl
    
    Test plan:
    1) Apply the patch
    2) Go to saved reports page
    3) In the most right column of table you should see "Run" button with
       caret button, the first one should run the report, the second one
       should work asi menu trigger
    4) Ensure that all report actions works as before
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bb99c34cb75ae7c2a90c0a7b4676058fcf681e6b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 21 17:34:16 2016 +0000

    Bug 17080 [QA Followup] - Fix number of tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a8907872d13c30b405883ae15aeff896ca0049c4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 8 14:14:36 2016 +0100

    Bug 17080: categories.checkprevcheckout - use the default value defined in the DBIx::Class schema
    
    This patch reverts bug 17069
    
    Test plan:
    Create a new patron category
    
      prove t/db_dependent/Koha/Patron/Categories.t
    should return green
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a09f1d75460b85abbf94a151a40cc1643bd4bcec
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 8 14:13:10 2016 +0100

    Bug 17080: borrowers.checkprevcheckout - use the default value defined in the DBIx::Class schema
    
    This line has been added by bug 16917 to define the default value of
    borrowers.checkprevcheckout.
    As this value is defined in the DBIx::Class schema, we should not have
    to handle it here.
    
    Test plan:
    Confirm that this patch does not reintroduced the bug fixed by bug
    16917.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cbe96a3b70d88c9c2fd43c8b14dd7b6de1283a08
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 8 14:14:03 2016 +0100

    Bug 17080: borrowers table - use default values defined in the DBIx::Class schema
    
    This patch basically just revert bug 16960 - Fix error on validating the
    registration
    
    This job is now done by the Koha::Object constructor, no need to clean
    the hash before sending it to AddMember.
    
    Test plan:
    Make sure there is no regression on bug 16960 (validate a self registration).
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 41a19f420d94427d6d69235732021e6f9ba78611
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 8 14:12:09 2016 +0100

    Bug 17080: Make C4::Members::AddMember uses Koha::Patron->store
    
    These calls have been added from commit e196f19 (Bug 12633: Remove SQLHelper
    in C4::Members) which added a TODO:
    "This patch replaced the calls to SQLHelper to use DBIX::Class.
    TODO: Move them to Koha::Borrower."
    
    This is now done by this patch: instead of calling DBIx::Class directly
    we use Koha::Patron
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0d364dacf6db4b6c4442a264fff4d9de925ab6b2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 8 14:13:40 2016 +0100

    Bug 17080: Handle default values for NOT NULL columns from Koha::Object->new
    
    Recently we face the same issue on different modules after we moved them to the
    Koha namespace using Koha::Object of using DBIx::Class directly.
    
    1/ Koha::Patron::Modification on bug 16960 comment 14 and 15
    2/ Koha::Patron::Category from bug 17069
    3/ C4::Members::AddMember (which does not use Koha::Object) on bug 16917
    
    If a DB column is defined as NOT NULL and has a default value, the DBIx::Class
    $rs->update_or_insert method won't use the default value if the column name
    has been passed to the constructor.
    
    We do that almost everywhere as we retrieve the data from the HTML forms without
    checking/cleaning them.
    
    There are several ways to fix that:
    1/ Continue to fix them case by case (what we did for the recent issues)
    2/ Try to fix them globally (existing ones and the next ones)
    
    This patch propose a global solution to avoid future issues of this kind.
    
    The idea is not to pass the undefined values which cannot be nullable to the
    DBIx::Class constructor.
    
    Tested all patches together. Works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0c9a2ee9da5618764067c3e896a3af5553bf7875
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 13 13:39:09 2016 +0100

    Bug 16965: Allow Koha::Objects->result_class
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b8df96082ec84097aac24e2128e6b8d1a34c463e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jul 28 14:28:43 2016 +0200

    Bug 16965: [Follow-up] Adjust get_object_class
    
    In many cases it should be possible to derive the Koha::Objects class
    name from the DBIx result class name in a trivial manner.
    If not, the DBIx result class should have a class method called
    koha_objects_class providing that non-trivial name, such as Libraries
    for Branch.
    
    Note: We are only interested in the plural form here (Koha::Objects).
    
    Test plan:
    Run t/db_dependent/Koha/Objects.t
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3d110a3c72432249613bc38333d4c0260a4356c4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 25 11:16:59 2016 +0100

    Bug 16965: search_related returns an instanciated Koha::Objects-based object
    
    Koha::Objects->search_related should return a Koha::Objects-based
    object.
    This search_related method should follow the same rules as the search
    method, i.e. take into account what the caller want (scalar or list).
    The problem here is that we do not know (in Koha::Objects) what is the
    kind of objects we want to instanciate. To know it, this patch adds a
    get_object_class, it will return the class of the object and the
    resultset Koha::Object-based object.
    
    The drawback of this method is that we will have to keep it up-to-date
    every time we add a new Koha::Object class.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c84f41624bb8eefa44872e15746cef5393466fb8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 22 17:20:08 2016 +0100

    Bug 16965: Add Koha::Objects->search_related
    
    In order to search on relations, we need this new method.
    
    Test plan:
    Confirm that the changes in Objects.t make sense and that the tests
    pass.
    
    Tested all 3 patches together, followed test plan, result OK
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8b570a880803241a2a87a4f99b5098da681e5c7e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 21 17:28:42 2016 +0000

    Bug 15131 - DBRev 16.06.00.035
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 42cd23ceb908fa23dc49dc228d1b54e5b50c3d15
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 28 13:37:05 2016 +0100

    Bug 15131: Add AllowItemsOnHoldCheckoutSCO to UsageStats
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ed2c2213a72f56236a189deba48ca8fa96acb333
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 11 12:57:29 2016 -0300

    Bug 15131: Make SCO use the new syspref.
    
    This patch just makes SCO use the new syspref (AllowItemsOnHoldCheckoutSCO)
    instead of the old one, thus making it configurable, separate from the
    non-SCO syspref.
    
    Sponsored-by: NEKLS
    
    Signed-off-by: George <george@nekls.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3a73010d094019a389165fecfdf511428302d765
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 11 12:47:49 2016 -0300

    Bug 15131: Instroduce AllowItemsOnHoldCheckoutSCO syspref
    
    This patch introduces a new syspref AllowItemsOnHoldCheckoutSCO, so the current
    AllowItemsOnHoldCheckout syspref can be decoupled for the SCO module, giving
    the library more flexibility.
    
    During upgrade, it gets its value from the original AllowItemsOnHoldCheckout syspref.
    
    Sponsored-by: NEKLS
    
    Signed-off-by: George <george@nekls.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8ebffcdb106d46c9f8b1877a086407ecfb1cbae1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Oct 14 14:26:58 2016 +0100

    Bug 17445: Move the params check after the authentication check
    
    If the user is not authorised to call this route, we would prefer to
    raise a 403 instead of 400
    
    Note that we wanted to submit tests for this change but the city code
    does not let use do that (we are allowed to list/show cities even
    without any permissions). The patrons.t is not complete enought and the
    holds.t tests do not pass...
    
    Tomas plans to submit tests but we reach the end of the hackfest ;)
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 038ad70fb31b787509c30c6499f3fab77356005a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Oct 14 14:23:20 2016 +0100

    Bug 17445: Just some refactoring
    
    The idea is to make the code more readable moving the code to its own
    subroutine
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4cbbe58ad04f515a39e2cd5e5ed5d92e4388da49
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 14 08:57:30 2016 +0000

    Bug 17445: Add 'malformed query' error response
    
    This patch adds to the x-mojo-around action code to give a meaningful
    error given a bad query parameter in the query string for a request.
    
    Test Plan
    1) Submit an api request to an existing restful endpoint with no query
    parameters
    2) Confirm the correct response is being given
    3) Submit an api request to an existing restful endpoint with an allowed
    query parameter
    4) Confimr the correct response is being given
    5) Submit an api request to an existing restful endpoint with a
    malformed query paramter
    6) Note the 400 response code and helpful json api body
    
    https://bugs.koha-community.org/show_bug.cgi?id=17445
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 947ab63bb761cf2948d80ba590566114a2e48c32
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Dec 15 12:07:38 2015 +0100

    Bug 17444: Enable exporting by time, not only date
    
    Test plan:
    1) Apply the patch
    2) Edit a biblio
    3) run export_records.pl with date time few minutes in the past
    for example: --format=xml --record-type=bibs --date="2016-10-14 10:00:05" --filename="koha.xml"
    4) look in the file and cofirm that the right record was exported
    5) Try the same but with time after the biblio was edited, it shouldn't be exported
    
    Signed-off-by: radiuscz <radek.siman@centrum.cz>
    
    Bug 17444: Follow-up, don't change the name of parameter "date"
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b9af2e9731ef17af3d35090e5bae3af65a8d08c4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 10:17:18 2016 +0100

    Bug 16907: Make sure the log will be written only if the patron has been deleted
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c4a923bdf7eacce4de1efd4c5bdd2fe4010ad4b1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 11 21:35:15 2016 +0100

    Bug 16907: Koha::Patrons - Move HandleDelBorrower to ->delete
    
    This job should be done each time patron data are deleted. It's better
    to do it just before deleting the patron than assuming the caller did
    the job by itself.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 26c034d1f50762f0548ce3ee61767d64139cd311
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 11 21:18:56 2016 +0100

    Bug 16907: Koha::Patrons - Move DelMember to ->delete
    
    This patch moves the C4::Members::DelMember subroutine to the
    Koha::Patron module.
    The delete method must be overwritten to permit handling of patron's
    holds.
    
    Test plan:
    (With the 2 patches applied)
    1/ Create a patron with holds and owner of lists
    2/ Delete patrons using the web interface:
     - More > Delete on a patron page
     - Batch patron deletion tools
    3/ and the cronjob script
     - perl misc/cronjobs/delete_patrons.pl -c [more options]
    
    The patron should have been moved to the deletedborrowers table, his/her
    holds and lists should have been deleted.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 20c44f005138d2f585eeb1336a93920629b52d3c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jul 9 16:03:11 2016 +0100

    Bug 16891: Move C4::Members::MoveMemberToDeleted to Koha::Patron->move_to_deleted
    
    This patch removes the C4::Members::MoveMemberToDeleted subroutine in
    order to replace it with the Koha::Patron->move_to_deleted method.
    Next after this change, we will move C4::Members::HandleDelBorrower and
    C4::Members::DelMember to the same module to simplify the code in
    members/deletemem.pl and misc/cronjobs/delete_patrons.pl
    
    Test plan:
    1/ Delete a patron from the staff interface and make sure (s)he has been moved to
    the deletedborrowers table.
    2/ Use the "Batch patron deletion" tool (tools/cleanborrowers.pl) to
    remove patron. Make sure the "Permanently delete these patrons" and "Move
    these patrons to the trash" options work as before
    3/ Same as previously but using the cronjob
    misc/cronjobs/delete_patrons.pl.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Tested the delete_patrons.pl script and cleanborrowers.pl too.
    Tests (are relevant and) pass and the qa scripts are happy too :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6fb994257ecf74f65b0951564341561dd40df3a5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Sep 21 11:40:09 2016 -0300

    Bug 17318: Allow chosing fixed normalization routines
    
    This patch changes the matching-rules.pl page, so it allows the user to choose
    from the different hardcoded normalization routines. It is done using TT blocks
    and the routine descriptions are translatable.
    
    To test:
    - Create some matching rule
    - Have free text values on the 'Normalization rule' field
    - Apply the patches
    - Create a new routine
    => SUCCESS: You can now only choose between fixed option
    - Save the rule
    - Open it for editing
    => SUCCESS: Chosen rules are preserved
    - Edit the original free-text including rule
    => SUCCESS: Rules fall back to 'None'
    - Sign off :-D
    
    TODO: A followup will add a warning about the current value and the fact that
          saving the matching rule will overwrite those, with 'none'.
    
    Sponsored-by: FIT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4579f1ad906b28a78c0ef7a1669b0a08138745d1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 19 12:25:31 2016 -0300

    Bug 17318: Make C4::Matcher::_get_match_keys handle 'norms' param
    
    The current implementation doesn't care about that parameter, and applies
    a default normalization rule that seems counter-productive (in general) for
    its aleged purpose.
    
    This patch makes it handle the following values for 'norms':
    
        - upper_case
        - lower_case
        - remove_spaces
        - legacy_default
        - none
    
    They make it call the relevant Koha::Utils::Normalize routines. 'legacy_default'
    is used only for backwards compatibility, but could be removed if there's consensus.
    
    To test:
    - Run:
      $ prove t/Matcher.t
    => FAIL: most _get_match_keys tests fail
    - Apply the patch
    - Run:
      $ prove t/Matcher.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Sponsored-by: FIT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a0af2d7d5ceb28848488c4f66e486f646341eedf
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 19 12:17:41 2016 -0300

    Bug 17318: Unit tests
    
    The current C4::Matcher::_get_match_keys implementation doesn't take
    normalization rules params into account. This patch makes Matcher.t test the
    proposed behaviour for new hardcoded values, that match string normalization
    routines introduced by Bu 17302.
    
    Possible values are:
    - upper_case
    - lower_case
    - remove_spaces
    - legacy_default
    - none
    
    * 'legacy_default' is left (for now) to catch the current behaviour. So tests which
    did not get a 'norm' param, now are passed 'legacy_default' and they still pass.
    
    * 'none' means no normalization, of course
    
    Note: on introducing 'none', a bug got highlighted, because the subfields traversal loop
    was introducing an unneeded space. The tests from 17304 get adjusted to reflect this.
    
    To test:
    - Run:
      $ sudo koha-shell kohadev ; cd kohaclone
      $ prove t/Matcher.t
    => FAIL: The routine doesn't care about the norms param.
    
    Sponsored-by: FIT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e155029eea393931b56370b57ade8a7f07613ef5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 13 11:09:54 2016 +0100

    Bug 17253: Fetch all the columns instead of only authorised_value
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit baf78b2a332aa5416f7cbf2020609aa753debda2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 31 10:55:25 2016 +0100

    Bug 17253: Koha::AuthorisedValues - Remove GetKohaAuthorisedValues
    
    This patch replaces the call to C4::Koha::GetKohaAuthorisedValues with
    Koha::AuthorisedValues->search_by_koha_field
    
    Test plan:
    AV descriptions should be displayed on the following pages:
    - XSLT view - location and ccode
    - Bibliographic detail, moredetail and OPAC pages - location, ccode, copynumber
    - returns - location
    - opac-basket - ccode, location
    - The 3 reports: catalogue_stats.pl, issues_stats.pl and
      reserves_stats.pl - location, ccode
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cd7b84f6754ca264070afcac6fc8cb65ea0f930e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 17:04:28 2016 +0100

    Bug 17252 - Koha::AuthorisedValues - Remove GetAuthorisedValueByCode
    
    The subroutine C4::Koha::GetAuthorisedValueByCode returned the
    description (staff or opac) for a given authorised value.
    
    Note that we may need a unique key to ->find instead of ->search.
    
    Test plan:
    - Checkin an item that cannot be checked in because it's lost, the
      message should display the AV description
    - Generate a letter with borrowers.streettype equals an ROADTYPE AV, the
      description should be displayed.
    - Edit a patron attribute type, the AV dropdown list should be
      displayed
    - Create the PA_CLASS AV category (see bug 7154) and make sure it
      behaves as before when editing a patron
    - The checkout list should display descriptions for LOC, LOST and
      DAMAGED
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8323db303dd6d1c486574e7750ad58df2c25c744
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 12:29:57 2016 +0100

    Bug 17251: Koha::AuthorisedValues - Remove GetKohaAuthorisedValuesMapping
    
    This subroutine was only used once in GetItemsForInventory.
    It can be replaced with a quite simple search on AV join on
    authorised_value_categories and marc_subfield_structures tables.
    
    Note that the "interface" parameter was always set to "staff" and was
    useless.
    
    Test plan:
    Play with the inventory and confirm that the AV descriptions are
    correctly displayed.
    
    The tests in t/db_dependent/Items/GetItemsForInventory.t cover this
    change and should still pass.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0b6f129ac32e5ea3a2d1357d8e19ba3e24519757
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 12 13:48:09 2016 +0100

    Bug 17250: Do not retrieve marc subfield structure when the authorised value is not defined
    
    GetAuthValCode did not return anything if the authorised_value column
    was not defined. Our new calls to Koha::MarcSubfieldStructures->search
    should behave the same
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d019f86f671771a36006f8847712317e0337c02f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 13:35:13 2016 +0100

    Bug 17250 - Koha::AuthorisedValues - Remove GetAuthValCode
    
    The subroutine C4::Koha::GetAuthValCode returned the authorised value
    category for a given kohafield.
    This can be acchieve easily using a new Koha::AuthorisedValues->search_by_koha_field
    method which will mimic search_by_marc_field.
    
    Test plan:
    Confirm that the description is correctly displayed on the following
    pages:
    - detail and moredetail of a bibliographic page (itemlost, damaged, materials)
    - Set AcqCreateItem=ordering and receiving items.
    The description for notforloan, restricted, location, ccode, etc.
    field should be displayed.
    - Items search form
    - On the checkout list from the circulation.pl and returns.pl
    pages, the description for "materials" should be displayed
    
    Note that GetKohaAuthorisedValuesMapping is going to be removed on bug
    17251.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 15506a7569145cf566aab28e1b7639be56058a26
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 09:10:52 2016 +0100

    Bug 17249: GetKohaAuthorisedValuesFromField - rm GetAuthValCodeFromField
    
    The subroutine GetAuthValCodeFromField was only used from
    GetKohaAuthorisedValuesFromField.
    
    Test plan:
      git grep GetAuthValCodeFromField
    should not return any occurrences.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c913a3482bcca547d371931261a8831f2cd4ecaf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 12:10:46 2016 +0100

    Bug 17249: Remove GetKohaAuthorisedValuesFromField
    
    Remove the subroutine, it's no longer in used.
    
    Test plan:
      git grep GetKohaAuthorisedValuesFromField
    should not return any occurrences.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af224055de23a25a4cae7f4a7e0e047d3e8780f1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Sep 5 16:12:56 2016 +0100

    Bug 17249: Remove GetKohaAuthorisedValuesFromField - (follow-up) inventory
    
    Before this patch set, the tests in
    t/db_dependent/Items/GetItemsForInventory.t were executed in 4s. But
    with the previous patch, it was in 45sec(!)
    To make sure decrease this execution time to what it was before, this
    patch introduces a local to avoid the same query to be executed several
    times.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7ea9b72c67ea2bb8f7ec11388a3a0c62e8384473
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 12:10:09 2016 +0100

    Bug 17249: Remove GetKohaAuthorisedValuesFromField - inventory
    
    This patch deals with the inventory files calling
    GetKohaAuthorisedValuesFromField.
    
    Test plan:
      prove t/db_dependent/Items/GetItemsForInventory.t
    should still return green
    
    Use the inventory tool, on the result page the AV descriptions should
    correctly replace the codes
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1626087562a98b66d24aa190bdf5b3f26b098b09
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 11:36:40 2016 +0100

    Bug 17249: Remove GetKohaAuthorisedValuesFromField - Add search_by_marc_field
    
    This patch adds a new Koha::AuthorisedValues->search_by_marc_field
    method.
    It will permit to replace several subroutine from C4::Koha dealing with
    authorised values.
    It also uses this new methods to replace an occurrence of
    GetKohaAuthorisedValuesFromField in C4::Record::marcrecord2csv
    
    Test plan:
      prove t/db_dependent/AuthorisedValues.t
    should return green
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 54410ca823e2c9a7f24f63422612ec0af5c4a163
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 11:28:40 2016 +0100

    Bug 17249: Remove GetKohaAuthorisedValuesFromField - add tests
    
    This patch adds a few tests to C4::Record::marcrecord2csv
    The subroutine was not covered enough to validate that this patch set
    won't add regressions.
    
    Note that the patch set will fix an issue: If 2 subfields of a field are
    linked to AVs and you want to display them in a CSV, they won't be
    replaced with their descriptions.
    
    Test plan:
    Apply the patch, and make a copy of t/db_dependent/Record/marcrecord2csv.t
    Checkout master and prove marcrecord2csv.t
    Tests should fail
    Checkout the branch with the whole patch set applied
    The tests should pass
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b8c824909ebde8a0d4b39d7340dbb32e7c9856b3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 09:07:26 2016 +0100

    Bug 17249: Remove GetKohaAuthorisedValuesFromField - Add classes MarcSubfieldStructure[s]
    
    This patch adds the 2 Koha::Object based classes for the
    marc_subfield_structure table
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 430a64148207e7c390746060eb9ee31916185738
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 23 18:50:20 2016 +0100

    Bug 17173: Quick jump to subfield edition form
    
    There are too many clicks to jump to the edit form of a specific
    subfield.
    
    This patch adds a hidden feature (i.e. will not be polished or
    documented).
    
    When searching for a tag field from a marc framework structure, it's not
    possible to search for a tag subfield to jump directly to the subfield
    edition form.
    
    Test plan:
    On /admin/marctagstructure.pl?frameworkcode=FRAMEWORKCODE
    Search for a subfield (952$d)
    you will be redirected to the subfield edition form
    
    There is no check if the subfield does not exist.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1e17c92905143f6bc8cac38f00256541c7146fa3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Oct 14 08:52:54 2016 +0000

    Bug 17154 (QA followup) replace tabs with spaces
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 734d08c2af16909f96b19003c4cc1d758b74f11d
Author: Sophie Meynieux <sophie.meynieux@biblibre.com>
Date:   Mon Aug 22 12:02:11 2016 +0200

    Bug 17154 : Note column is missing on account lines receipt
    
        When displaying Fines > Account tab for a patron, you can see on screen a Note column that is missing if you click on Print
    
        Test plan :
        * Find a patron with accountlines or add them manually (Create manual invoice/credit).
        * Be sure some of them got a Note
        * Clik on Print fior those lines
    
        Without patch, the printed receipt does not show the Note column
        with the patch, the printed receipt shows a Note column and Note content is correctly printed for accountline with a note.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9a81a138d45b245b69754f3e61115d5d997510c0
Author: Marc Véron <veron@veron.ch>
Date:   Wed Oct 5 16:08:52 2016 +0200

    Bug 17404: Patron deletion page: Fix title and breadcrumb
    
    Title and breadcrumb of patron deletion page (deletemember.pl) say:
    "Can't Delete Patron". This should be changed to "Delete patron".
    
    To verify:
    - Go to a patron's detail page
    - Toolbar : More : Delete
    Result: You get a question: "Are you sure...", but title and breadcrumb say:
      "Can't Delete Patron" rsp "Cant delete patron"
    
    To test:
    - Apply patch
    - Repeat steps above.
    - Verify that title and breadcrumb display properly, including patron's name
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5939fd72fd6769bb83fa6a993f12d3214082b7b5
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Wed Oct 12 15:15:27 2016 +0200

    Bug 17084 debian/control updates (master)
    
    Dependencies for Bug 16885 and 17425
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f1a8ca13028411384847615fbdeeaaedd9703382
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 18 17:14:58 2016 +0100

    Bug 17411: Remove 3 other occurrences of exit 1
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01636dca2f1bd132fcc8d16f7a91fa4a45a90668
Author: Marc Véron <veron@veron.ch>
Date:   Thu Oct 6 14:37:14 2016 +0200

    Bug 17411 - Change exit 1 to exit 0 in acqui/basket.pl to prevent Internal Server Error
    
    Note: Same situation as in Bug 17403
    
    To test:
    - Verifiy that code change makes sense.
    
    Note: Same situation as in Bug 17403
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Amended patch: Remove unecessary comment
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a5b64708601f58fddf89d328d7f0ed94cfc214f9
Author: Marc Véron <veron@veron.ch>
Date:   Tue Jun 7 17:29:22 2016 +0200

    Bug 16687 - Translatability: Fix issues in Administration preferences
    
    This patch fixes sentence splitting and other translation issues in
    file koha-tmpl/intranet-tmpl/prog/en/modules/admin/preferences/admin.pref
    to avoid odd translations.
    
    To test:
    - Without patch, open Home > Administration > System preferences
      and go to tab 'Administration"
    - Apply patch
    - Open the same page in a new window and compare the text:
      - Verify  that no sentences are splitted
      - Verify that the text changes do not introduce misunderstandings
        and have the same meaning as without patch
    
    Amended for comment #7 2016-07-12/mv
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Rebased to apply on master and re-inserted test (see comment #14) -2016-09-28/mv
    Signed-off-by: Michael Kuhn <mik@adminkuhn.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 556a4870d6beced7df52dbbc2ad472769e79e148
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 14 10:01:12 2016 +0200

    Bug 16245: [QA Follow-up] Replace typeofrecord2 by biblevel
    
    Position 7 of the leader is better referred to as biblevel.
    (Pos 6 is record type.)
    At the same time replacing some regex's by simple eq's.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    It seems that bib level in the UNIMARC leader only allows a subset of
    the possible combinations for MARC21. This does not have bad side-effects
    however in the new code that tests bib level to determine the type tag.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a74329af022eeb857e1f936c13274c0e41497472
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Wed Sep 28 15:29:37 2016 -0600

    Bug 16245: RIS export file type incorrect
    
    When exporting lists to a RIS file, the TY field of the RIS file is always
    'book' even if the item being exported is a journal or serial.
    Since unimarc and marc21 is coded in Koha, just a few references types are
    included. This needs a much better code.
    
    This bug changes only TY BOOK result. Other resources needs a case by case
    basis.
    
    To test:
    -In advanced search limit by itemtype (books, music, continue resources, etc).
    -Search and save result in Cart
    -Export to RIS Format and notice about the new TY change with all materials
    -Export record in bib record details page in OPAC and Intranet.
    -Confirm that works as expected.
    -Bonus test:
    -Try to import the  RIS file in  http://www.myendnoteweb.com if you
    have account or create one.
    NOTE: According with previous comment, some values has changed.
    
    Sponsored-by: Universidad de El Salvador
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6f5ea70f9a20ee0f30057d91a4a23e7f3c04b77e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 28 14:45:21 2016 +0100

    Bug 17368: Update KitchenSinkPlugin.kpz
    
    The KitchenSinkPlugin plugin is used is t/db_dependent/plugins.t to test
    if our system plugin is ok.
    Currently this plugin is broken because it uses subroutines which have
    been removed: GetBranchesLoop and GetBorrowercategoryList
    
    A PR has just been made
    (https://github.com/bywatersolutions/koha-plugin-kitchen-sink/pull/2)
    This kpz has been generated on top of the following commit:
    
      commit 5d109c9e1a5d3d314b346a529f2059176778d05a
        Adapt code for versions > 16.06.00.018
        2 subroutines has been removed and the plugin does not work
        anymore.
    
    with:
    % zip -r KitchenSinkPlugin.kpz Koha
    
    Test plan:
      prove t/db_dependent/plugins.t
    should now be happy
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    prove t/db_dependent/Plugins.t fails before the patch
    and passes nicely after applying the patch.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 35101c91279849ee2df0c4d5bc1c6529feaddf0c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 21 14:37:46 2016 +0000

    Bug 10455 - DBRev 16.06.00.034
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 47b6f454abb45b13a6f405d0517d8f26512a1c71
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Sep 27 17:37:45 2016 +0000

    Bug 10455 (QA Followup)
    
    Fix record matching in misc/cronjobs/delete_records_via_leader.pl
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5de488038d29964f6bd5a29b24e934a3af7c73de
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 16:18:02 2016 +0100

    Bug 10455: Fix tests
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 706f472642d988da2c0a93b5530208d7cc34374b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 14:54:09 2016 +0100

    Bug 10455: Remove MARC21_utf8_flag_fix.pl
    
    Is this script still in use?
    It uses the biblioitems.marc field so if it's still useful it will need
    to be rewritten.
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 25801b44bb8d0c81b05230488842c05906b9d412
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 13:43:44 2016 +0100

    Bug 10455: (follow-up 3) Remove biblioitems.marc
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6a31228172855d08e1cb08d3a3e3a8c7d91ae5a3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 13:31:38 2016 +0100

    Bug 10455: (follow-up 2) Remove biblioitems.marc
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d27cb605ec96f205e141f6bb485e2b6d52913dde
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 11:26:45 2016 +0100

    Bug 10455: (follow-up) Remove biblioitems.marc
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bee79b014b1e9feb8fdada0772165089dcca6a71
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 10:21:37 2016 +0100

    Bug 10455: Remove biblioitems.marc - update delete_records_via_leader.pl
    
    Recently added, delete_records_via_leader.pl reads biblioitems.marc as a
    text field and search for record to delete regarding the leader 5.
    This can be acchieve doing the same thing on biblioitems.marcxml (will
    certainly be slower) waiting for a patch on bug 15537.
    
    Test plan:
    Confirm that this script works as before, to do so the easiest way would
    be to dump your DB before executing the update DB entry, execute the
    script to delete records, reinsert the DB, execute the udpate DB entry
    (remove biblioitems.marc), execute the script to delete records.
    You should get the same number of records deleted.
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 236a8c3ebbcb290c93305364306538c859ef41c7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 10:02:50 2016 +0100

    Bug 10455: Remove biblioitems.marc - rm MARC21_parse_test.pl
    
    This script seems to be unused and it won't be of any usefulness after
    the removal of biblioitems.marc
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c7493439c7fce4cfbba68b4e0b57c0fa47952433
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 10:01:59 2016 +0100

    Bug 10455: Remove biblioitems.marc
    
    Any discussions about biblioitems.marc bring to the same conclusion:
    This field is useless and should be removed.
    We are storing MARC data into 2 different fields, that does not make
    sense.
    
    Test plan:
    Add / update / export / import /delete records
    should work as before
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3e1923070c679d0014fecf093cde6f1f5d50ccce
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 10:01:47 2016 +0100

    Bug 10455: Remove biblioitems.marc - DB changes
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>

commit ede157e9c09e08b772aaaaacd1a7eb64a2ecc9f6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 11 13:15:27 2016 +0100

    Bug 17426: Do not set AutoCommit in tests
    
      git grep AutoCommit t | grep 1
    
    highlights that 1 test use AutoCommit set, it should not
    
    The other change removes the FIXME should has been fixed.
    
    Test plan:
      prove t/db_dependent/BackgroundJob.t
      t/db_dependent/Patron/Borrower_Discharge.t
    
    should still return green
    
    Signed-off-by: Marc <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f060709df0ed07c0ff3dbc20404fa5b3b2aa8651
Author: Rodrigo Santellan <rsantellan@gmail.com>
Date:   Mon Oct 10 04:20:12 2016 -0400

    Bug 17405 Edit record uses Default framework
    
    In detail view (catalogue/detail.pl), when clicking on Edit > Edit
    record button, the record editor should be opened with the biblio record
    framework. It isn't the case. The Default framework is used. Same issue
    with Edit > Edit as new (duplicate).
    
    TO TEST:
    
    1. Find a biblio record using a framework which is not the Default one.
    2. See the biblio record in detail view (catalogue/detail.pl).
    3. Click on Edit > Edit record.
    4. Click on Settings => you can see 'Default' as selected framework.
    5. Apply the patch.
    6. Repeat step 3-4. => the biblio record framework is selected.
    7. Repeat 3-4 using Edit > Edit as new (duplicate).
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
      Added a test plan
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Fix the issue, no errors.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 35de8aa1ef07b04cfc7c977f7168cd36b40d7941
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 4 08:29:30 2016 +0100

    Bug 17393: Fix non-Latin chars handling in self reg
    
    If you fill the patron self reg with non-latin characters, they will be
    encoded with HTML entities (&eacute;)
    This bug leads to generate a userid with weird behaviors:
    é => eacute
    ł => x
    
    Test plan:
    0/ Do not apply the patch
    1/ Set up the Self reg feature
    2/ fill surname, fistname with something like "Michał pouéàç"
    3/ Save
    4/ See the bad encoding/replacement on the screen and look at the data
    The accentued chars are replaced with their html representation and the
    non-Latin chars with a 'x'
    in the DB
    5/ Apply this patch
    6/ Repeat steps 2, 3
    7/ Everything should be ok
    8/ Try to make sure this HTML::Entities escape was not useful:
    fill surname with "surname <script>alert("xss?")</script>"
    Save and look at the data
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fbe75e66ccb93a6a4d973e3066ca1ebad169a5b6
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Thu Oct 20 08:57:46 2016 -0600

    Bug 17477: Duplicating a subfield yields an empty subfield tag
    
    The problem only when clone a textareas in 5XX
    
    Steps to reproduce error:
    - On the cataloging screen (basic screen), create a new record
    - Go to the 5xx fields
    - Put something on the 521$a subfield or other textareas (e.g. 520$u or
     583$x)
    - Clone the subfield
    => FAIL: The subfield correctly doesn't include the original data,
    BUT it doesn't have the subtield tag either.
    
    - Apply patch
    - Clean cache browser and reload page
    - Repeat steps above
    - Verify that works as expected
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 31cb200e0d97106f6e2a009b4cbbd0a295bbaaf5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 18 12:02:25 2016 -0300

    Bug 10337: (followup) Upper case MARC flavour
    
    This patch makes the populate_db.pl script upper case what gets passed
    with the --marcflavour option switch. This is needed in order for this
    to fit ``kohadevbox`` configuration files, and it is harmless for other
    uses.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fab0bc976470ca99646b06b7810954b4e2fd18f1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 18 09:47:26 2016 -0300

    Bug 10337: (QA followup) Allow choosing MARC flavour
    
    This patch enables the --marcflavour option switch so the user
    can specify the desired marc flavour. The code for handling it
    was already in place, just not used.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3635e8f82660ced571af592088a369db698101a3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 17 17:50:50 2016 +0100

    Bug 10337: Add a script to populate devs' DBs with sample data
    
    Executing the installer process and inserting all the sample data take a
    lot of clics and time.
    The idea of this script is to provide a quick way to insert all the
    sample data easily to get a working Koha install asap.
    
    Test plan:
    - Set your database config to a non-existent DB
    - Execute perl misc/devel/populate_db.pl
    You will get an error
    - Create an empty DB
    - Execute perl misc/devel/populate_db.pl
    It will insert all the MARC21 sample data
    - Execute perl misc/devel/populate_db.pl
    You will get an error because the DB is not empty (systempreferences and
    borrowers tables)
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3b34d108e7360d0bfe74dde3d87b2398c9649c83
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 18 09:52:50 2016 +0100

    Bug 17216: Revert changes to ItemsSearchField schema file
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f1298dc7828757fe9277a5128910335d2d6c0f2c
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Sep 28 14:49:32 2016 +0200

    Bug 17367 - Showing all items must keep show holdings tab in OPAC details
    
    In OPAC details page, when record as too many items (depending on syspref OpacMaxItemsToDisplay), they are not displayed in holdings tab.
    You can click on link "Click here to view them all" to show them : page reloads with a new arg viewallitems=1.
    Also you can choose which tab is shown by default using syspref opacSerialDefaultTab.
    
    The bug is that when default tab is not holdings, clicking on link to show all items will show another tab. So one must reclick on holings tab to see all items.
    
    This patch corrects by forcing holdings tab when arg viewallitems is defined.
    
    Test plan :
    - Create a serial record with more items than syspref OpacMaxItemsToDisplay (or decrease this syspref)
    - Select "Subscriptions tab" for syspref opacSerialDefaultTab
    - Go to opac details on this record : /cgi-bin/koha/opac-detail.pl?biblionumber=xxx
    => You see Subscriptions tab selected
    - Click on Holdings tab
    => You see no items but a link "Click here to view them all"
    - Click on this link
    => Without patch you see Subscriptions tab selected
    => Wih patch you see Holdings tab selected and the items
    
    Signed-off-by: Juliette <juliette.levast@iepg.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit e78f81d615a79ad293d599c7395efcabd267662d
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Oct 11 10:00:56 2016 +0200

    Bug 17423 - patronimage.pl permission is too restrictive
    
    Bug 14566 added the permission "borrowers" on patronimage.pl.
    This perm is too restrictive because circulation pages also uses this page.
    
    I propose to simply use "catalogue" perm.
    
    Test plan
    - Set an image to borrower xx
    - Create a user with only catalogue permission
    - Log with this user
    - Go to page (replace xx by borrower number) : /cgi-bin/koha/members/patronimage.pl?borrowernumber=xx
    => Without patch you get the page saying you do not have the permission
    => With patch you get the image
    - Log out and retest the page patronimage.pl
    => You get 403 error
    
    Signed-off-by: remy <remy.gonzalves@iepg.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ba8ee98e1bb3b18f579c0b122b14d43e88cda2c8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 13 15:03:55 2016 +0100

    Bug 16358: Do not redirect to the editor when deleting records
    
    The "Delete record" button goes to addbiblio.pl?op=delete, which
    incorrectly redirects to Rancor when selected.
    
    Test plan:
    0/ Enable EnableAdvancedCatalogingEditor
    1/ Edit a record
    2/ Switch to the Advanced editor
    3/ click on "View the record"
    4/ Delete the record
    => Without this patch you are redirected to the editor
    => With this patch you are redirected to the advanced search
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit d5ca2d0433b75317c5a2b855ee77372ca93d2223
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Oct 12 11:01:54 2016 +0200

    Bug 17430: Make MarkIssueReturned.t create its own data
    
    This patch makes MarkIssueReturned.t use t::lib::TestBuilder to create
    the data it needs.
    
    To test:
    - On master, have a category with categorycode = C
    - Run:
      $ prove t/db_dependent/Circulation/MarkIssueReturned.t
    => FAIL: primary key problems make the tests fail
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Circulation/MarkIssueReturned.t
    => SUCCESS: Tests are green!
    - Sign off :-D
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f75afef59175933f7e93b04bdcbdcf5180b0b024
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 14 11:29:44 2016 +0200

    Bug 17446: Typo seleted
    
    Built on top of bug 17441
    
    Test plan:
    Just have a look at the changes. Trivial.
    Git grep seleted. No results.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 17e2e6c994655aaa927b2579524022a4f24a8d1d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 14 11:07:49 2016 +0200

    Bug 17441: [QA Follow-up] Return value of SendAlerts
    
    This patch makes the return value of SendAlerts more consistent.
    It returns 1 on success, or undef || { error => 'msg' } on failure.
    Needed to adjust one test in Letters.t too.
    Adjusted one typo along the way (seleted).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested by running Letters.t.
    Also tested SendAlerts from the interface with AutoEmailOpacUser and
    memberentry (adding new patron).
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ff495c5fa8c58a7762b3494e97d90618d649f7a8
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Oct 13 19:05:48 2016 +0200

    Bug 17441 - t/db_dependent/Letters.t fails on Jenkins
    
    Run prove t/db_dependent/Letters.t
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    To improve consistency, adding a follow-up.
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 692014c817b58876042ab03d71bde0c2cce7e571
Author: Marc Véron <veron@veron.ch>
Date:   Fri Oct 7 11:03:45 2016 +0200

    Bug 11217: The # in accountlines descriptions makes them un-writeoffable
    
    This patch adds escaping to url params in mambers/pay.pl
    
    To test:
    - Apply patch
    - Go to Home > Patrons > Manual invoice and create an invoice with a
      description containing a #
    - Go to tab "Pay fines"
    - Write off the fine
    Expected result: Fine is written off and does no longer display in pay tab.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 1d0d5f1398687ead3a17cd40f74f879e8ddf9a9d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 29 08:46:49 2016 +0100

    Bug 17365: Fix XSS in moremember.pl and memberentry.pl
    
    There are certainly hundred of places where they are not escaped...
    
    Test plan:
    Create a patron with "Arun <script>alert('code injection');</script>" in
    some of the fields.
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a1dcd2f2e67f2dc998d2eae0fc6097eb9edbb874
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 3 15:23:39 2016 +0100

    Bug 17389: Clear logs
    
    Logs are full of:
    Use of uninitialized value in substitution (s///) at
    C4/ImportExportFramework.pm line 282.
    Use of uninitialized value in concatenation (.) or string at
    C4/ImportExportFramework.pm line 283.
    
    Some field are NULL in DB, we need to init the value to an empty string
    to avoid these warnings.
    
    Note: This fix is not related to the original bug
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Warnings avoided
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a1eeffd8385e5b95ca1d06a8300e5bd42403486a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 3 15:15:40 2016 +0100

    Bug 17389: (bug 16035 follow-up) Fix export non-default frameworks
    
    Trivial patch, no need to explain anything :)
    
    Test plan:
    Export default framework
    Export other frameworks
    => The frameworkcode column should contain the framework code
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f28460bdb7cbb6a1261d8c50af6b10ffacf54ef3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Oct 5 13:26:09 2016 +0000

    Bug 17392 - opac/svc/overdrive_proxy is not plack safe
    
    This patch simply replaces the ';'  in the param passed to OverDrive
    with '&'
    
    To test:
    1 - Enable overdrive (requires an account)
    2 - Perform an opac search
    3 - Note the number of overdrive results reported
    4 - Click the link to view the actual overdrive results
    5 - Note the result numbers don't match
    6 - Apply patch
    7 - Repeat 1-4 and note results numbers match and results are relevant
    8 - Test a search with a ';' to ensure this patch isn't breaking
    searches
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    Verified by reading code - couldn't verify using Overdrive.
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 43418ae9f088f023b1d398ab30faaebb9c00cbf5
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Feb 4 19:41:57 2016 +0000

    Bug 14514 - LocalHoldsPriority and the HoldsQueue conflict with each other
    
    It appears that the LocalHoldsPriority feature and the Holds Queue are
    fundamentally at odds with each other.
    
    The problem appears to be that both are attempting to choose the best
    way to fill holds. When you are using the holds queue and you check in
    an item that has been selected by the holds queue builder, that part of
    Koha where the LocalHoldsPriority feature lives doesn't get to see all
    the holds in order to pick the best one. Instead only the hold selected
    by the holds queue builder is returned so to the LocalHoldsPriority
    feature, that is only one hold to pick from!
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/HoldsQueue.t
    3) All tests should pass
    
    Signed-off-by: Barton Chittenden barton@bywatersolutions.com
    Signed-off-by: Dani Elder <dani@bywatersolutions.com>
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ed63510fdc0e5a8f8681f0c25b442762315c141d
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Fri Oct 7 15:57:50 2016 +0100

    BUG 17414 Add new GIR codes in Edifact
    
    Add the 4 GIR codes which were added by Editeur since 1.2
    So that the list of recognized GIR codes is now complete
    
    And thse codes can be used in future development
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit dbf2f7d6d97686179a1e794e0c74ad8be441a177
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Aug 26 19:20:34 2016 +0000

    Bug 15388 - Show Syndetics covers by UPC in search results
    
    Syndetics code accepts UPC and OCLC numbers, however, we were only passing this if there
    was an ISBN. This patch alters the code to search if either an ISBN or
    UPC is present
    
    To test:
    Enable syndetics (will need an account)
    Search for items with UPCs or OCLC numbers and no ISBN (DVDs)
    Note there are no images in search results but there are in details
    Apply patch
    Note that items with images in details now also have images in results
    
    Signed-off-by: Barbara.Johnson@bedfordtx.gov
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ee719cf10cf2f1c81de485228a98fc33e0f0c81b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 12:21:19 2016 +0100

    Bug 16850: Remove C4::Members::IsMemberBlocked
    
    This subroutine is only called once and can be replaced with a call to
    is_debarred and has_overdues.
    Note that prior to this patch, IsMemberBlocked copy/paste code from
    HasOverdues, which did not make sense.
    
    Test plan:
    Debar a patron and make sure he is not able to checkout (the librarian
    is asked to overwrite if OverduesBlockCirc is set to 'confirmation')
    Remove the debarment and add overdues to this patron, same as
    previously, the checkout should be blocked
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 807ee1daa02f4bafe8da5689e74d76e997e7b5b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 12:19:46 2016 +0100

    Bug 16850: Add test coverage for CanBookBeIssued
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ef0b0f13fcba4605f99386d4c2bdd87e82234493
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 16:26:07 2016 +0100

    Bug 17094: Make Koha::Virtualshelf methods return Koha::Objects-based objects
    
    Instead of DBIx::Class objects.
    
    Test plan:
    1/ Add content to a list and share it with another patron
    2/ Try to view the list with the other patron
    3/ download and send a shelf and check if the biblio list is correct
    4/ prove t/db_dependent/Virtualshelves.t should return green
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit bb1e9c500c810402c64436c53bcc00ffb9a0b857
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 13:04:48 2016 +0100

    Bug 17248 - Koha::AuthorisedValues - Remove GetKohaAuthorisedValueLib
    
    The subroutine C4::Koha::GetKohaAuthorisedValueLib just retrieves a description
    (lib) for a given authorised value.
    
    We can easily replace it using:
      Koha::AuthorisedValues->search({ category => $cat, authorised_value => $av })->lib
    or
      Koha::AuthorisedValues->search({ category => $cat, authorised_value => $av })->opac_description
    
    Test plan:
    - On the detail page of a bibliographic record, the description for notforloan,
    restricted and stack (?) should be correctly displayed
    - View a shelf, the location (LOC) description should be displayed
    - On the search result page, the location description should be displayed in the
      facets
    - Set AcqCreateItem=ordering and receiving items.
    The description for notforloan, restricted, location, ccode, etc. field
    should be displayed.
    - When creating item in the acquisition module, the dropdown list for
      field linked to AV should display the AV' descriptions
    - On the transfers page, the description of the location should be
      displayed.
    - On the checkout list from the circulation.pl and returns.pl pages, the
      description for "materials" should be displayed
    - Fill some OPAC_SUG AV and create a suggestion, the reason dropdown
      list should display the description of OPAC_SUG
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 174769e382dfd5205595a5b9ae7b58c8ebf5d850
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 13 08:35:24 2016 +0000

    Bug 16520 (Follow up) Rebase fixes
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e40f61bc3087727db75d07b02c34545300d153b1
Author: Jesse Weaver <jweaver@bywatersolutions.com>
Date:   Fri May 13 16:40:11 2016 -0600

    Bug 16520: Add new Plack-SetEnv syntax to Apache configuration files
    
    This was not added to the old etc/koha-httpd.conf because that file has
    no infrastructure for Plack anyway.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 27b756eb91e0ce93f46233dabe3957a66e978d4d
Author: Jesse Weaver <jweaver@bywatersolutions.com>
Date:   Fri May 13 16:39:08 2016 -0600

    Bug 16520: Initialize the sysprefs Koha::Caches on demand
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1e6df24d6cbf44c865805712e6a15ecc601273aa
Author: Jesse Weaver <jweaver@bywatersolutions.com>
Date:   Fri May 13 16:27:22 2016 -0600

    Bug 16520: Allow per-VirtualHost environment variables with Plack
    
    This allows OVERRIDE_SYSPREF_* and others to work properly.
    
    Test plan:
    
      1) Add the following line to your plack.psgi (near the bottom, just
         above "mount ..."):
           enable "+Koha::Middleware::Plack";
      2) Load the OPAC advanced search page (under Plack). The title should
        read "Koha online catalog" (or whatever your LibraryName syspref
        contains).
      3) Add the following to your Apache configuration:
           RequestHeader add X-Koha-SetEnv "OVERRIDE_SYSPREF_LibraryName Potato\, Potato"
      4) Restart Apache.
      5) Refresh. The title should now read "Potato, Potato online catalog".
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 8cb65b367b47ffd9a1a362e7261199fefc3628bb
Author: Jesse Maseto <jesse@bywatersolutions.com>
Date:   Wed Oct 12 17:44:42 2016 +0000

    Bug 7143 NEW added Kyle Hall as release manager.
    
    Signed-off-by: Dani Elder <dani@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>

commit 3fe925ee1900d607eca6eb8952430e02a85c4d24
Author: Brendan Gallagher <brendan@bywatersolutions.com>
Date:   Tue Oct 11 11:18:50 2016 +0000

    UPdating the DBREv for Bug 17216 - Add a new table to store authorized
    value categories

commit 493d7c30a194e78d0474f9db4824004fa410c879
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 27 13:44:13 2016 +0100

    Bug 17216: Move the AV cat list file to the top level
    
    This way it will get used for any languages.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 8d40fd2c6ebad16d7f9154bf6d6821d3b7e059de
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 27 09:24:57 2016 +0100

    Bug 17216: Internal AV should be correctly handled when creating a new category
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 5d0dbcaabe833dd0980bffbfd583e071773f8d79
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Sep 19 12:35:40 2016 +0100

    Bug 17216: Do no display the empty string category name
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 610dbfb5dd97fc4f20c6a52696f8f94e03a36312
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Sep 19 10:55:12 2016 +0100

    Bug 17216: Do not display branches, itemtypes and cn_source
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit dc23d944adb9d3fefcd129cde11fb88a18933649
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 17:03:59 2016 +0100

    Bug 17216: Fix other tests
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 4454c85b92790e905b22f07d701bd6b996b81575
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 12:09:03 2016 +0100

    Bug 17216: Fix tests
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 3f72fa15f23fb94eadbd5d3c450b9cc7851df6e5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 12:02:15 2016 +0100

    Bug 17216: Update DBIC schema for MSS
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 1e75506f80a913eae9a903c0bc7eb6b425664da1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 11:56:14 2016 +0100

    Bug 17216: Update DBIC Schema
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 38d4bffa73ed11ab43b2dcf5bbbb94f5d1ba90c3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 11:55:52 2016 +0100

    Bug 17216: Add FK on authorised_values.category
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 62aa3f4292d83bc9304e296de5f0830e28510492
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 29 14:07:45 2016 +0100

    Bug 17216: Use Koha::AVC from mss.pl
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit d0f543bd6cf2fb5209ea622415249fa46a59a09f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 29 14:07:27 2016 +0100

    Bug 17216: Add FK on mss.authorised_value
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f97249f56e7c32745f2d31dd6aa36f724f4cba33
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 29 14:06:46 2016 +0100

    Bug 17216: Update the admin interface
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit d7badeaafa8a7d5643a21478c13911e8c1c9e90b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 29 14:05:51 2016 +0100

    Bug 17216: DBIC Schema changes
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ef19f6705a5fcee0f0027b3a9d09fa2d027907a6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 29 15:15:10 2016 +0100

    Bug 17216: Add some other AV categories
    
    Found in
    installer/data/mysql/en/marcflavour/marc21/mandatory/marc21_framework_DEFAULT.sql
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a79eb3f30a68b1a6b41387e1d47ef65857853112
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 29 14:04:53 2016 +0100

    Bug 17216: Add new table authorised_value_categories and populate it
    
    This patch set adds a new table authorised_value_categories to store
    authori(s|z)ed value categories into a separate table.
    The problematic is explained on bug 15799 comment 4:
    We need FK to the AV categories but some may not have authorized values
    yet.
    
    What does this patch set:
    - Add a new authorised_value_categories table
    - Populate it with known categories
    - Update FK items_search_fields.authorised_values_category
    - Create a new FK marc_subfield_structure.authorised_value (FIXME should
      be authorised_value_categories instead)
    
    They are some problems this patch set do not take into account:
    - The .sql installer files won't insert correctly (will have to be
      updated when this patch set will be ready to be pushed)
    - All the categories (even the ones without authorized values defined)
      are listed when you edit frameworks (marc_subfield_structure.pl)
    - There is no way to delete a category (TODO). But to do so it would be
      good to have a authorised_value_categories.is_internal field to mark
      some categories as "cannot be deleted".
    
    Test plan:
    0/ Execute the DB entry to create and populate the new table and set the FK
    1/ Create a new AV category from the admin module (admin/authorised_values.pl)
    2/ Add/edit subfield linked to a AV category
    (admin/marc_subfield_structure.pl)
    3/ You won't be allowed to add AV for branches, itemtypes or cn_source.
    They are used internally.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 9d5e2aee41dd4a5343f4b16ba7ea8d9736eb4a28
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 29 13:56:02 2016 +0100

    Bug 17216: Add Koha::AuthorisedValueCategory|ies classes
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a8376f99d9c8afea1c68f44e170100c2d703fcb7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 12 11:56:44 2016 +0000

    Bug 17432: Remove minification
    
    The swagger specification file is currently being minified adding
    manual steps to release management and restful api route development.
    The minification is not required; The deferenced version of the
    specification is now internally validated at runtime and relavant errors
    output and the dereferenced schema has been made publically available at
    /api/v1/spec, so it can be copy&pasted into validation tools
    
    Test Plan
    1) Apply patch
    2) Ensure api routes still function (applying the /cities patch might be
        helpful)
    3) Ensure /api/v1/spec page exists (it should be the de-referenced
        swagger.json file)
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a66b0e20d7d1b2602cced006712ce5fc308aeb10
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Oct 10 20:57:26 2016 +0000

    Bug 14899 - Convert links to buttons, add icons
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit bc41b29b6437445c35b71fe4fc623506e3cf6fbf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 29 12:03:22 2016 +0100

    Bug 14899: Add a reset option
    
    For developpers only at the moment, if you want to reset your mappings,
    you can hit:
      admin/searchengine/elasticsearch/mappings.pl?op=reset&i_know_what_i_am_doing=1
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit d8809285ad792d0a2dbab8695a07131fecb27ef1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Sep 25 16:16:28 2015 +0100

    Bug 14899: Add a link to the new page in the admin
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 39bdb865fcf8a9147a891496459e1a7ecd57e30e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Sep 25 16:06:55 2015 +0100

    Bug 14899: Add the mapping configuration page in the admin module
    
    This new page (admin/searchengine/elasticsearch/mappings.pl) will permit
    to manage the ES mappings.
    For the biblios and authorities indexes, the different mappings can be
    managed from this single page.
    The interface let you add, remove and update mappings and search fields.
    It's also possible to reorder the mappings, as the order can be important
    in the indexation process. Note that the table can be displayed in a
    different order that the one it was before saving, but the mappings are grouped
    by search field and the order inside the search field is preserved.
    
    Limitations:
    - If something went wrong during the insertion/deletion/modification,
      the users will loose all these changes.
    
    TODO:
    - Add a specific permission (?)
    - Add some data checks client side (JS)
    - Use checkboxes for facet and suggestible (lazy today...)
    - Understand the difference between the 3 values that sortable can have
      and improve the value for the options in the select box.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 57ffd456ded327b85db1da710345037dc21b5897
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Sep 25 15:49:16 2015 +0100

    Bug 14899: Add tableDND JS lib
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a1a0bdd7983d9baf74dcb4b38ee2cdfea25fb0b2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Oct 10 17:30:43 2016 +0000

    Bug 17226 - Fix unit tests
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit b7d25c83e6a39c75804c18c07ac76231d43b57b9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 16:22:53 2016 +0100

    Bug 17226: Make Koha::Object->get_column available
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit d2510f3e76b1b24ad473944d96141cc0f7a643d4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 16:13:21 2016 +0100

    Bug 17226: Improve Koha::Object's AUTOLOAD method
    
    Following the path of bug 17091, Koha::Object needs to AUTOLOAD the
    methods provided by DBIX::Class.
    We already use in_storage, id and is_changed, but others are coming!
    
    Test plan:
      prove t/db_dependent/Koha/Object.t
    should return green
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 442734b4380dc7326bbd242d021a457acff0e18e
Author: Brendan Gallagher <brendan@bywatersolutions.com>
Date:   Tue Oct 11 04:52:13 2016 +0000

    Uping DBRev.  Bug 17357 - WTHDRAWN is still used in installer files
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ce076e0e757ff812eba21ee6102e6c44076e5595
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 27 10:52:17 2016 +0100

    Bug 17357: Replace WTHDRAWN with WITHDRAWN in installer files
    
    Some installer files still use WTHDRAWN instead of WITHDRAWN as an AV
    category.
    
    Test plan:
      git grep WTHDRAWN installer
    should not return any results
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 75a900d55365dc6a8d1396b68329a0679d9dc430
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 27 13:38:34 2016 +0100

    Bug 17358: Rename COU with COUNTRY and LAN with LANG
    
    Some installer files use COU and LAN instead of COUNTRY and LANG.
    
    To uniformise these AVs, it would be good to use the same code.
    
    Note that I do not think we should update existing installations
    
    Carefully compared code.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 981ad35ce3390d473fcb63ca9cd58996b456ddc0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 16:53:27 2016 +0100

    Bug 17091: Add delete to the Koha::Objects AUTOLOAD method
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 38eee216aef7160d3e60662770a24c10ec9752f6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 16:34:15 2016 +0100

    Bug 17091: In a first phase, restrict the usage of AUTOLOAD in Koha::Objects
    
    To make sure the methods will be covered by tests and devs won't
    overused this method, I think it may be a good idea to restrict its
    usage.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    AUTOLOAD added. No Koha QA errors. Test passed successfully
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit c253af2e519570c4024891dc4d1e81743a2c5fc2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 15:58:31 2016 +0100

    Bug 17091: Remove explicit declaration of Koha::Objects->reset
    
    Test plan:
      prove t/db_dependent/Koha/Objects.t
    should return green
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 4383ec732ef5dd202352ee4ed30c3cb1da24393e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 15:54:58 2016 +0100

    Bug 17091: Remove explicit declaration of Koha::Objects->pager
    
    Test plan:
      prove t/db_dependent/Koha/Objects.t
    should return green
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 228a9ac882e2c716c95a341df298058af5fc7cba
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 15:48:05 2016 +0100

    Bug 17091: Remove explicit declaration of Koha::Objects->count
    
    Test plan:
      prove t/db_dependent/Koha/Objects.t
    should return green
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 1a77758989619086512829a7f7904c9370c6715d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 15:46:48 2016 +0100

    Bug 17091: Remove explicit declaration of Koha::Objects->update
    
    Test plan:
      prove t/db_dependent/Koha/Objects.t
    should return green
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 6a2a15aae803997cb9f090a59e893a7242d56923
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 15:46:11 2016 +0100

    Bug 17091: Add AUTOLOAD to Koha::Objects
    
    Up to now if a Koha::Objects based object needs to call DBIx::Class methods, we
    have to create a new method for Koha::Objects, something like:
      sub method {
        my $self = shift;
        return $self->_resultset->method
      }
    
    To simplify and ease the call to DBIx::Class method, this patch defines an
    AUTOLOAD to call the DBIx::Class method on the resultset we are encapsulating.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit df3df9cf7199c464565742af59bd48006d93cfdf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 29 10:31:11 2016 +0100

    Bug 17372: Standardize Elasticsearch paths
    
    What we currently have:
    Koha/ElasticSearch.pm
    Koha/ElasticSearch/Indexer.pm
    Koha/SearchEngine/Elasticsearch/QueryBuilder.pm
    Koha/SearchEngine/Elasticsearch/Search.pm
    
    What we want:
    Koha/SearchEngine/Elasticsearch.pm
    Koha/SearchEngine/Elasticsearch/Indexer.pm
    Koha/SearchEngine/Elasticsearch/QueryBuilder.pm
    Koha/SearchEngine/Elasticsearch/Search.pm
    
    Test plan:
      % git grep -i Koha::ElasticSearch
      % git grep ElasticSearch|grep -v Catmandu::Store::ElasticSearch
    should not return any result
    
    Do a full reindex and search for records
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a36b6430195310b5198077dd50cdb436ef07ce37
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Sep 29 10:18:27 2016 +0100

    Bug 16838: ES - install mappings for new installs
    
    The yaml file is not used to populate ES mapping tables (search_field,
    search_marc_map and search_marc_to_field) when doing a fresh install.
    
    We need to insert them, otherwise ES will be unusable.
    
    Test plan:
    Create a new install and confirm that the ES tables (search_field,
    search_marc_map and search_marc_to_field) are correctly populated.
    
    Bonus points: Use an older DB (prior to 3.23.00.050), execute the
    updatedatabase.pl script and confirm that the ES table are correctly
    populated
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit b588babdb23bfdc1163864a26c36a61bf8a39ae5
Author: Marc Véron <veron@veron.ch>
Date:   Wed Oct 5 15:43:29 2016 +0200

    Bug 17403: Internal Server Error while deleting patron
    
    This patch fixes a Internal Server Error while deleting patrons.
    
    To reproduce:
    
    - Go to a patron's detail page
    - Toolbar : More : Delete
    - Confirm "Are you sure you want to delete..."
    
    Result: Internal Server Error
    Plack error log:
    exited nonzero: 1 at /home/marc/koha/members/deletemem.pl
    Note: Patron is deleted
    
    Additional tests: Try to delete yourself, to delete a staff member
    without having superlibrarian permission etc.
    
    To test:
    
    - Apply patch
    - Re-start plack
    - Try to reproduce steps above (with other patron)
    Expected result:
    No Internal Server Error, Redirect to Home > Patrons
    
    Amended to include all occurences of 'exit 1'
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Good catch Marc
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 118bff64be868df02b3a2363b3ad72cfcca0d8a6
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jul 27 16:00:43 2016 +0200

    Bug 16769: [QA Follow-up] Remove unsupported deepcopy parameter
    
    Routine C4/Koha/GetAuthorisedValues adds deepcopy => 1 to the options of
    set_in_cache. This makes no sense (anymore?). Is not supported or passed
    further. So better remove it.
    
    Test plan:
    Run t/db_dependent/Koha.t (with Test::Deep available to minimize confusion)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 75a217e672647dd26c14540a7ed0ee1df35532e8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jul 27 16:04:51 2016 +0200

    Bug 16769: [QA Follow-up] Still found an occurrence
    
    Script svc/report did contain one old-style call.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 7aacc32db8e760f25965f29206ce14f8488c57bd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 18 15:01:51 2016 +0100

    Bug 16769: Uniformise calls to Koha::Cache->set_in_cache
    
    From the POD of Koha::Cache->set_in_cache:
     # This is a bit of a hack to support the old API in case things still use it
    
    Let's remove this hack and update old calls.
    
    Test plan:
    Look at the results of
      git grep set_in_cache
    and confirm that there are no more version of the old call (without
    hashref as third param)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 649956b216aa21fee70a75d2f9f9f0ac213415d0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 4 13:58:13 2016 +0100

    Bug 17386: Simplify code
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit d63f02a8c46439d76507bb1b07c40e6a86f4130a
Author: Marc Véron <veron@veron.ch>
Date:   Fri Sep 30 21:30:00 2016 +0200

    Bug 17386: Add opac notes for patron to self checkout screen
    
    Display patron messages from OPAC summary page on SCO screen as well.
    
    To test:
    - Make sure you have patrons with and without OPAC note and OPAC messages
    - Log in to OPAC and go to patrons 'your summary' page to display note
      and messages
    - Apply patch
    - Refresh patrons detail page. Verify that it looks the same as before
    - Go to SCO
    - Log in as such patron
    - Verify that note and messages appear the same as on OPAC summary page
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 884e28fab5e4db86dd9f50f2908519a0cd6650d5
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Sat Sep 17 13:44:47 2016 +0300

    Bug 17310: Broken URLs in 'Item renewed' / 'Cannot renew' messages
    
    In the Staff client, under Circulation > Renew, the message shown after
    successful renewal of an item contains broken URLs. This is also true for
    the message shown when you try to renew an item that is not checked out.
    
    This patch fixes that.
    
    Test plan:
    1) Go to Circulation > Renew, and search for the barcode of a checked-out
       item. In the 'Item renewed:' confirmation message, notice how the URLs
       for the title and the barcode are broken.
    2) Now search for the barcode of an item that is not checked out. In the
       'Cannot renew:' message, notice how the URLs are broken here too.
    3) Apply the patch.
    4) Repeat steps 1) and 2). This time the URLs work fine.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 613b2126f042311805d1ef7eb822231c8f0a4dee
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 4 12:02:03 2016 +0100

    Bug 17396: Remove unnecessary t/DataTables/Members.t is unnecessary tests
    
    The subroutine C4::Utils::DataTables::Members::search is covered by
    tests from t/db_dependent/Utils/Datatables_Members.t
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit bc1e23e1f11e146e282d0e2efa7fd77e2c26d631
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 4 14:49:19 2016 +0100

    Bug 17088: Add tests to cover the changes
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 0eec191ed3ab1ae1bd24972a559d12627b70f681
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Sep 16 11:27:05 2016 +0200

    Bug 17088: [Follow-up] Use Logger for failed exports
    
    Fixes a TODO for logging unsupported record_type in _get_record_for_export.
    Also logs a warning when the record_type parameter is not supplied at all in sub export.
    Replaces a warn by a log message about an invalid record for format iso2709.
    Also adds a log message about an invalid record for format xml.
    Adds a trivial unit test for passing no record_type to export.
    
    Test plan:
    See also first patch.
    Run t/db_dependent/Exporter/Record.t.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Also tested the log messages for iso2709 and xml by manipulating
    the record_type parameter with:
        $params->{record_type}='xx';
    before calling _get_record_for_export in Record.pm.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 44b51ed80224d0361796c1a70cb66bb5096a427c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Sep 16 10:44:47 2016 +0200

    Bug 17088: [Follow-up] Adjust POD in Logger.pm
    
    Not important enough to go on its own.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit e72a8ab260abed11b02266d77bc17d831884ed40
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Aug 9 13:08:17 2016 +0000

    Bug 17088 - Bad MARC XML can halt export_records.pl
    
    If export_records.pl encounters a record that fails to load correctly as
    a MARC::Record the export process will fail and only the records
    encountered up to that point will be exported.
    
    Test Plan:
    1) Pick a record in your database, and replace the biblioitems.marcxml field with some random characters
    2) Export your records using the command:
       misc/export_records.pl  --format xml --record-type bibs --filename /tmp/biblios.xml
    3) Note you get an error and the script ends prematurely
    4) Apply this patch
    5) Repeat step 2
    6) Note the full record set is exported ( except for your bad record )
    7) Note an error is still generated for your bad record ( useful for
        tracking down bad records ).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f2196a2e4f21a9a294c970a1ad067f5c3d1cb4eb
Author: Mason James <mtj@kohaaloha.com>
Date:   Wed Aug 3 16:32:00 2016 +1200

    Bug 17035 - Koha allows system-wide 'read' access to all Koha zebra databases, by default
    
    to test bug...
     1/ make a random user
     2/ change to random user
     3/ access any zebra database with random user and no authentication
     4/ read zebra database
    
    here is a transcript of the bug...
    ---------------------------
    root@xen1:~# adduser bob
    root@xen1:~# su -l bob
    
    bob@xen1:~$ cd /var/lib/koha
    bob@xen1:/var/lib/koha$ ls
    topsecret
    
    bob@xen1:/var/lib/koha$ yaz-client  unix:/var/run/koha/topsecret/bibliosocket
    Connecting...OK.
    Sent initrequest.
    Connection accepted by v3 target.
    ID     : 81
    Name   : Zebra Information Server/GFS/YAZ
    Version: 4.2.30 98864b44c654645bc16b2c54f822dc2e45a93031
    Options: search present delSet triggerResourceCtrl scan sort extendedServices namedResultSets
    Elapsed: 0.001002
    
    Z> base biblios;
    
    Z> find the
    Sent searchRequest.
    Received SearchResponse.
    Search was a success.
    Number of hits: 1130, setno 2
    SearchResult-1: term=the cnt=1130
    records returned: 0
    Elapsed: 0.005518
    
    Z> show
    Sent presentRequest (1+1).
    Records: 1
    [biblios]Record type: USmarc
    01824cam a2200397 a 4500
    001 000045782309
    003 AuCNLKIN
    005 20111013213222.0
    008 100707s2011    maua          001 0 e
    ...
    ---------------------------
    
    5/ apply changes to a Koha instance's config files, that you plan to test
    
    6/ restart zebra for instance
     # sudo koha-restart-zebra topsecret
    
    7/ repeat steps 2 and 3, but receive a 'bad user/passwd ' error from zebra
    
    bob@xen1:~$ yaz-client unix:/var/run/koha/topsecret/bibliosocket
    Connecting...OK.
    Sent initrequest.
    Connection rejected by v3 target.
        1: code=1011 (Init/AC: Bad Userid and/or Password),
    
    NOTE: this patch currently will only fixes newly created instances, it wont fix existing instances
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Good catch Mason
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 421bc4523f150d02e7b1c9ded3ca619bef135d92
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Sep 12 11:30:43 2016 +0200

    Bug 7143: Release team for 16.11
    
    Also adding Marc Veron as bug wrangler (see his mail on the general ml
    dated Oct 5).
    
    Test plan:
    Verify changes by comparing with Roles for 16.11 page on the wiki.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6ff836ab3154a886e0aeedb1152f6caf2e546444
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Sun Sep 18 20:47:33 2016 -0400

    Bug 17292: Follow up - tweak to make it pass cleaner
    
    remove a 'my'
    next if not defined subscriptions.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f11f07a703eca7da2d32c105f8c9f4f46f940b6f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Sep 12 14:20:19 2016 +0000

    Bug 17292 - Use of DBIx in updatedatabase.pl broke upgrade
    
    A recent change in the 'subscription' table structure highlighted a
    problem in a DBRev upgrade (3.23.00.006). As it adds a new column, when
    upgrading from (say) 3.20.00.000 the code/schema (correctly) expects the
    subscription.itemtype column to exist. But it is not created until DBRev
    16.06.00.025.
    
    To reproduce:
    - Have a clean 3.20.00 DB loaded into kohadevbox
    - Checkout current master
    - Run:
      $ perl installer/data/mysql/updatedatabase.pl
      => FAIL: The upgrade procedure fails due to missing colum.
    
      The solution: rewrite the updatedatabase.pl entry using plain DBI
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 0599ab00768e7d2ee487c6d02a0230d4a2a96d9e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Sep 20 19:29:28 2016 -0400

    Bug 17324: Deal with branchcode NULL issue
    
    In a database update we alter the letter table, making a column
    (branchcode) not be able to contain NULL values.
    However if it already does, this SQL fails. So before changing the
    column we change the NULL values
    
    [Tue Sep 20 19:08:10 2016] updatedatabase.pl: DBD::mysql::db do failed:
    Invalid use of NULL value [for Statement "
    [Tue Sep 20 19:08:10 2016] updatedatabase.pl: ALTER TABLE letter MODIFY
    COLUMN branchcode varchar(10) NOT NULL DEFAULT ''
    [Tue Sep 20 19:08:10 2016] updatedatabase.pl: "] at
    /home/mtompset/kohaclone/installer/data/mysql/updatedatabase.pl line
    12638.
    
    Reproduce:
    on an ubuntu 16.04 LTS machine with MySQL 5.7 install git koha
    development environment.
    ...
    git checkout -b my_3.18.x origin/3.18.x
    drop database koha_library;
    create database koha_library;
    quit;
    web install all sample data
    (ignore some issues with sample data, and one with mandatory)
    
    git checkout -b bug_17234 origin/master
    git bz apply 17292
    git bz apply 17320
    git bz apply 17260
    git bz apply 17234
    web install
    Two warning messages are expected output from upgrade process, but
    the above message is not.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Did not follow the test plan, but the changes make sense
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 130534c4241397992521d6da49ebdc761203b3e3
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Sep 25 14:50:09 2016 +0200

    Bug 17345: Fix typo in sysprefs.sql
    
    This fixes a tiny typo in sysprefs.sql that kept all
    systempreferences from being installed.
    
    To test:
    - Create a new koha database, run the web installer
    - Verify that all systempreferences have been loaded
      select count(*) from systempreferences should be
      no less than 553
    
    or
    
    - Truncate your systempreferences table
    - Verify that the repaired sysprefs.sql file loads
      without error
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 6f4f32f4bc1f2176c60fe34cf37b3822f08481aa
Author: Marc Véron <veron@veron.ch>
Date:   Fri Sep 30 17:48:44 2016 +0200

    Bug 17384 - Categories do not display in patron editing form if they have only one category assigned
    
    To reproduce:
    - Go to Home > Administration > Patron categories
    - Make sure that you have only one category for a category type.
      Examples: Only one category "Staff" for category type "Staff" or
      Only one category "Library" for category type "Org."
    - Edit a patron or create a new patron
    - Verify that categories of examples above do not show up in category drop down
    - Go back to Home > Administration > Patron categories and add categories to
      both category types
    - Edit or create a new patron. Veryfy that categories show up in dropdown.
    
    To test:
    - Apply patch
    - Make sure you have a category type with only one category assigned
      (e.g. category taype Staff with category Staff)
    - Edit a patron or create a new patron. Verify that the category
      shows up in categroy drop down.
    
    - Additional test: Verify that template param 'catcode' from removed line
      is not used in template memberentrygen.tt
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit fe0fc226c524d6f63c8d64af7a0c8b2c5ac7198f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 15:05:01 2016 +0000

    Bug 15899 - Remove C4::Accounts::recordpayment
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/Accounts.t
    3) git grep recordpayment should show no calls to the recordpayment sub
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d8a6ffeb2b69b07cabd106d0deefcf93c9e204ae
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 15:05:21 2016 +0000

    Bug 15899 - Fix up unit tests
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit acd0f6f116d0411d6faebaff5b23efcf7298b3d9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 15:25:04 2016 +0000

    Bug 15903 - Remove use of recordpayment in paycollect.pl
    
    Test Plan:
    1) Apply this patch
    2) Pay a fine via the "Pay amount" button
    3) Payment should succeed.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 011d60823b2ab8fd0fb5f28f4b897c5c82798508
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Sep 6 14:05:11 2016 +0000

    Bug 15902 [QA Followup] - Use Koha::Patrons instead of Koha::Borrowers
    
    Since the initial submission of this patch, the module Koha::Borrowers
    has been moved to Koha::Patrons. This patch changes the call from
    Koha::Borrowers to Koha::Patrons.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 94617acef62d38079ed316797700faccd2edc335
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 15:23:32 2016 +0000

    Bug 15902 - Remove use of recordpayment in process_koc.pl
    
    Test plan:
    1) Apply this patch
    2) Create an offline circ payment
    3) Process the offline circ payment
    4) Payment should show in Koha
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f79ad28017df63d6ff8a1abd09ed388870e96c98
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 15:13:24 2016 +0000

    Bug 15901 - Remove use of recordpayment in C4::SIP::ILS::Transaction::FeePayment
    
    Test plan:
    1) Apply this patch
    2) Make a payment via SIP2
    3) The payment should succeed
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d2d65d3b0f413296aef26977aae7e118f1dfe80d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Sep 6 14:08:42 2016 +0000

    Bug 15900 [QA Followup] - Use Koha::Patrons instead of Koha::Borrowers
    
    Since the initial submission of this patch, the module Koha::Borrowers
    has been moved to Koha::Patrons. This patch changes the call from
    Koha::Borrowers to Koha::Patrons.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2a4debf309b5d6fee92e7e21f9b22688e8cd8f31
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Feb 24 15:11:53 2016 +0000

    Bug 15900 - Remove use of recordpayment in ProcessOfflinePayment
    
    Test plan:
    1) Apply this patch
    2) prove t/db_dependent/Circulation.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4176f6fb73e52cbb154e974e882f436a8ceabf50
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 28 11:54:09 2016 +0100

    Bug 15895: Remove useless discard_changes calls
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 547ca4c8c12120d42b06d4a9bc549a887d3f73e1
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 19 19:57:12 2016 +0000

    Bug 15895 - Add Koha::Account module, use Koha::Account::pay internally for recordpayment
    
    This is the first patch in a series to unify all payment functions into
    a single method.
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/Accounts.t
    3) Test fine payment via the "Pay amount" button
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Lari Taskula <larit@student.uef.fi>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 56da7be50ada38bab6ec866f5915d55507c7d821
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Sat Sep 24 19:25:33 2016 +0000

    Bug 17352 - Patron search type is hard coded to 'contain' in circ/circulation.pl
    
    The patron search type is hard coded to 'contain' in
    circ/circulation.pl.
    
    This causes problems because a mis-scanned cardnumber can bring up the
    wrong patron.
    
    The example that our partner gave us involved scanning '1733', which
    doesn't match any borrowers when we do a 'start_with' search, but
    matches the cardnumber 'p291733'.
    
    If we follow the usage in members/member.pl, we can set searchtype in
    HTTP params, which is amenable to fixes in intranetuserjs
    
    Test Plan:
    1) Apply this patch
    2) Use the checkout search, not changes should be noted
    
    Extra credit:
    1) Add javascript to intranetuserjs to add a hidden input named
    'searchtype' with the value 'start_with'
    2) Checkout searches should now give only results where a searched
       field starts with the given string(s)
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5eb4b06f5b892552944d9b9ca7852a332d4b3c3e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Sun Sep 25 15:53:57 2016 +0000

    Bug 16273 - DBRev 16.06.00.031
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3d4dc58da98af4d092b04efa295638aba3f8fdf4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Apr 23 16:05:33 2016 +0100

    Bug 16273: Add the ability not to display the login details for newly registered patrons
    
    When a new patron registers, the confirmation page is displayed with
    login details (login, password, cardnumber) and the login form is
    prefilled.
    In the case of public computer, for security reasons that should not
    appear, patrons might forget to close the window.
    
    Test plan:
    1/ Set PatronSelfRegistrationPrefillForm on
    2/ Register a new patron
    => The login details should not be displayed and the login form should
    not be prefilled.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8d0b412b528f5777aff40a2bb96fa2f7fe504ad9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Apr 23 15:54:59 2016 +0100

    Bug 16273: Add the new pref PatronSelfRegistrationPrefillForm
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d85e80b2516d651d871cf81845ee77020a309afb
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Sep 18 12:15:43 2016 +0200

    Bug 17301: Follow-up - Standardize headings
    
    - Fixes for capitalization
    - Changes 'Item callnumber' to 'Call number' to match
      other pages like advanced search
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fe50f1ef9d4e71db221115378b6ddb4335064a3f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Sep 14 17:33:35 2016 +0000

    Bug 17301 - Add callnumber to label-edit-batch.pl
    
    To test:
    1 - Create a label batch
    2 - Add some items
    3 - Note you do not see callnumber
    4 - Apply patch
    5 - Verify callnumber displays correctly
    6 - Verify batch functions (adding, exporting, removing, etc) work as
    before
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 12beaef4b3acbf9550605bd0f6e44977bced1fba
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Aug 5 15:01:55 2016 -0400

    Bug 17083: Remove more event attributes from tools templates
    
    This patch removes event attributes from several tool-related templates.
    Events are defined instead in the JavaScript.
    
    To test, apply the patch and:
    
    - Go to Tools -> Label creator -> Manage -> Layouts and edit any layout.
      - In the "Font" setting, choose any font which includes the word
        "italic" or "oblique" in the name. Doing so should disable the
        "Oblique title" checkbox.
    - Go to Tools -> Batch patron deletion/anonymization.
      - Submit the form without making any changes. You should be prompted
        to select an action.
    - Go to Tools -> Inventory.
      - Select a batch of barcodes to upload.
      - Submit the form without selecting any filters. This should trigger a
        warning.
      - Also changed: Added Font Awesome icons to the "Select all" and
        "Clear all" links on the inventory results view.
    - Go to Tools -> Notices and Slips.
      - Click "New notice"
      - Change the selection under "Koha module." The page should reload
        with the correct available message body fields. For instance,
        selecting "Holds" should make available reserves.* columns.
    - Go to Tools -> Upload.
      - In the search form, enter a search term and click the 'Search'
        button. The form should submit.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised. Event attributes removed
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3d84252c0457708191adc23790d13dbf87e18a81
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Aug 4 14:36:41 2016 -0400

    Bug 17056 - Remove event attributes from various templates
    
    This patch removes event attributes from several templates, moving event
    definitions into the JavaScript instead.
    
    To test, apply the patch and:
    
    - View the MARC detail page for any bibliographic record. Changing the
      framework selection should reload the display using the selected
      framework.
    
    - Perform the same test on the labeled MARC view. (Set the
      viewLabeledMARC system preference to "Allow" if necessary).
    
    - To test the changes to Reports you should have at least one report
      group and at least one report subgroup.
      - Create a new saved SQL report.
      - Select a report group. Doing so should trigger the display of report
        subgroups. Deselecting the report group should hide the subgroups.
    
    - In Acquisitions -> Suggestions, create a new suggestion.
      - In the 'Acquisition information' section, changing values for
        copies, currency, and price should change the value in the total
        field.
    
    - In Circulation -> Upload offline circulation file:
      - My patch for Bug 16602 added the required code but forgot to remove
        the corresponding onclick attributes.
      - Browse for an offline circulation file.
      - Clicking the 'Upload file' button should work correctly.
        - After uploading a file, both the 'Add to offline circulation
          queue' and 'Apply directly' buttons should work to trigger their
          corresponding processes (keeping Bug 16603 in mind).
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5e0f55fac841270e159ce230f478f28a2ff12d91
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 22 13:56:36 2016 +0100

    Bug 16961: Add Koha::Objects->update
    
    In order to update several rows in a single query, we need this new
    method.
    
    Test plan:
    Confirm that the changes in Objects.t make sense and that the tests
    pass.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Test passed successfully
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 82af4da8113881fcaece13537eb3e2a7ee1a0879
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Sun Sep 25 15:45:25 2016 +0000

    Bug 16552 - DBRev 16.06.00.030
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bd7e4fb0d9fb90050a908f4162dfc0351aad1320
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 19 09:42:48 2016 +0100

    Bug 16552: Add the ability to change the default holdings sort
    
    This new enhancement will add the ability to change the default holdings
    sort on OPAC displays to be by library, instead of item type.
    
    This patch adds a new pref OPACHoldingsDefaultSortField with 3 different
    possible values:
     - Item type
     - Home library
     - Holding library
    
    Note that if OpacLocationBranchToDisplay is set not to display home libraries,
    unexpected behaviors might happen if OPACHoldingsDefaultSortField is set to
    "Home library", same for "Holding library".
    
    Test plan:
    - Confirm that the default value for OPACHoldingsDefaultSortField is
      'first column' after executing the DB entry and that there is no
      change in the behavior (first column is used to sort the holdings
      table on the detail page).
    - Set OpacLocationBranchToDisplay to both and play with the different
      values of OPACHoldingsDefaultSortField
      => Confrm that the default column used to sort the table is correctly
      changed
    - Set the pref SeparateHoldings on
      => Confirm that both tables (Holdings and other holdings) are sorted using
      the OPACHoldingsDefaultSortField value.
    
    Sponsored-by: University of the Arts London
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 19acaedf10c9e5180b040b0bafef4f3457bd6221
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Sun Sep 18 22:12:52 2016 +0000

    Bug 16551: Follow-up - Regenerated opac.css file
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c39eaca298a4e287f2cc6790ab15fb58c04d8280
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 17 16:31:11 2016 +0100

    Bug 16551: Display the name of lists to the search results at the OPAC
    
    This new enhancement will allow to add the name of lists containing a
    biblio to the search results at the OPAC.
    
    Test plan:
    0/ Regenerate the css file to get the style change:
     % lessc --clean-css="--s0 --advanced --compatibility=ie7"
       koha-tmpl/opac-tmpl/bootstrap/less/opac.less >
       koha-tmpl/opac-tmpl/bootstrap/css/opac.css
    1/ Create some lists and add items to them
    2/ On the search results you should see the name of the lists which
    contains the record.
    
    Note that we could add a syspref to make this new behavior optional.
    
    Sponsored-by: University of the Arts London
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Field <jonathan.field@ptfs-europe.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f89400a8ffe976c0cd0fc9ea982a791d0906bee6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 13 20:57:33 2016 +0100

    Bug 16519: Replace 'our' with 'my' in [opac-]addbybiblionumbers.pl
    
    To avoid bug like bug 16518 and to ease the readability/maintainability
    of these scripts, this patch replaces the use of 'our' with 'my' to
    avoid the use of global variables.
    
    Basically the code has been moved from subroutines to the appropriate places.
    
    Test plan:
    At the intranet and OPAC sides
    1/ Add items to a list
    2/ Add items to a list using an existing name
    3/ Add items to a list you don't have right on it (by modifying the
    biblionumber in the url)
    4/ At the OPAC, use the opac-addbybiblionumber.pl without being logged
    in to add items to a list
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ae543d475828d82b07b41738935f2acdb1bd81a6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Sep 15 13:20:41 2016 +0000

    Bug 15975 (QA Followup) Fix colspan for footer
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 99bdb7edbd6d284417fead443e88a3a1f20afffd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jul 14 10:40:51 2016 -0400

    Bug 15975 - Add Owning Library Column to Checkouts
    
    To test:
    1 - Checkout some items to a patron
    2 - Note there is no 'Home library' column
    3 - Apply patch
    4 - Note there IS an 'Home library' column
    5 - Use the columns configuration and ensure you can hide/display column at
    will
    
    Sponsored by: Coeur d'Alene Public Library (http://www.cdalibrary.org/)
    
    Works as expected (after clearing browser cache).
    Commit message amended (as of comment #7)
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d44d0acfec4e0b9a7f5dac33677e759e0fd69ab0
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Thu Sep 22 11:24:40 2016 -0600

    Bug 14668: (follow-up) JSON fails if single quotes are used
    
    Change single quotes to double quotes also add brackets to serial
    enumeration.
    
    To test follow previous test plan for intranet.
    Fix double semicolon
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ad0cd505eb71634d2a3798463ce1c8ebc7a2459c
Author: Charles Farmer <charles.farmer@inlibro.com>
Date:   Fri Jul 15 14:18:29 2016 -0400

    Bug 14668: Show serial enumeration in INTRANET circulation.tt and OPAC patron's relatives' checkouts
    
    TEST PLAN
    
    1. THE CHECKOUT TAB, INTRANET
        1.1. Add a value to the 'h' subfield of an item. ie: 'volume #42'
        1.2. Check out the item to a patron
        1.3. Display this patron's issues in his checkout page
            1.3.1. The enumchron should be concatenated with the title
    
    2. A PATRON'S RELATIVE, INTRANET + OPAC
        1.1. Add somebody to a patron's guarantee list
        1.2. Checkout a serial to this guarantee
        1.3. Visit the guarantor's OPAC and INTRANET checkout page
            1.3.1. You should see the enumchron in his guarantee's issues
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cf9031711282f4be23e4a639797d0fd178940e1f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 2 11:50:04 2015 +0100

    Bug 14435: Add the ability to store result's report
    
    At one time it was possible to store the results of a report into the
    saved_reports table.
    This allowed the librarians to compare different results, from the Koha
    interface.
    
    This patch is a proof of concept and is not very polished (understood:
    it cannot be pushed like that).
    
    Test plan:
    Execute the runreport.pl cronjob script with the new --store-results
    option.
    This will serialize into json the results and put it into the
    saved_reports table.
    
    On the "Saved report" list, the "Saved results" column is now populated
    with a date (note that you can have several date for a given report).
    If you click on this link, the data will be displayed in a simple table.
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f57df28f96898f47a3c4c6e6a5520bcaaf7afe2e
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Tue Sep 13 17:41:16 2016 +0300

    Bug 9896 - Show vendor in subscription search when creating an order for a subscription
    
    In the staff client, when creating an order from a subscription
    the vendor name should be shown in a separate column.
    
    This patch adds that feature. The 'Vendor' column is added before
    the 'Library' column since they appear in that order in Advanced
    search.
    
    Test plan:
    0) [PREREQUISITES] In the Staff client, under Acquisitions, create
       a Vendor and associated Basket if you don't already have them.
       Then, under Serials, add a new Subscription using the Vendor
       you've just created.
    1) Go to Acquisitions, and under 'Manage orders' search for a vendor,
       then click on 'Add to basket' and select 'From a subscription'.
    2) Click 'Search' on the left hand side to search for all subscriptions.
       Notice how there is no 'Vendor' column in the results table.
    3) Apply the patch.
    4) Repeat step 2. Confirm that the patch works, i.e. there is now
       a 'Vendor' column which displays the vendor name.
    
    Followed test plan, works as expected.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 98bca8f34b5fb739167d49868b317cbf16922bb1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Sep 21 23:09:55 2016 +0000

    Bug 17331 - Show holding branch in holds awaiting pickup report
    
    This patch adds a holdingbranch column to waitingreseves.tt and
    separates 'Location' into Home branch and callnumber columns
    
    To test:
    1 - Have some holds waiting and holds over
    2 - View the report before the patch
    3 - Note that location contains homebranch and call number
    4 - View the report after the patch
    5 - Note the new columns
    6 - Ensure data is correct and no info has been lost
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Fixed 2 capitalization issues.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5135b1a0a14ca958fe73505ed019bafe944dabc7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Sep 14 16:00:19 2016 -0300

    Bug 17304: Introduce C4::Matcher::_get_match_keys unit tests
    
    This function is used in several places, but it's behaviour is not covered by tests, thus trying to patch it can be problematic without introducing regressions.
    
    This patch introduces unit tests for it, in the t/Matcher.t file.
    
    To test:
    - Apply the patch
    - Run:
      $ prove t/Matcher.t
    => SUCCESS: Tests pass
    - Sign off :-D
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ab9a082b5f418c17063def1b0fa678b59f247fe2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Sun Sep 25 14:06:38 2016 +0000

    Bug 14707 - Remove atomic update
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7322563aa08cb557713a45131b527b28143aa6bb
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Sep 16 09:39:15 2016 +0200

    Bug 17302: [Follow-up] Make Normalize.pm undef-resistent
    
    Trivial changes for passing undef to the norm routines.
    Added a few dumb tests too.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bbf2aff7d270905e7e21ccdc4d0729fe3e3586e8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Sep 14 14:48:00 2016 -0300

    Bug 17302: Add Koha::Util::Normalize for normalization functions
    
    This patch introduces Koha::Util::Normalize, which includes the following normalization routines
    that need no explanation:
    
    - remove_spaces
    - upper_case
    - lower_case
    
    and it also includes:
    
    - legacy_default: which basically does what C4::Matcher::_normalize does.
    
    All routines functionality are fully tested with the included in the included tests.
    
    To test:
    - Apply the patch
    - Run:
      $ prove t/Koha/Util/Normalize.t
    => SUCCESS: All tests pass
    - Sign off :-D
    
    Edit: Added Exporter to explicitly export the routines.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7cb3a607d8a194268758889198db1b610b2beb85
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Sun Sep 25 14:02:13 2016 +0000

    Bug 14707 - DBRev 16.06.00.029
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 66d669d0735f244cb30e9cfdf53f91c77953b30f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 14 11:07:58 2016 +0100

    Bug 14707: Update existing installations and correct wrong values
    
    See http://hea.koha-community.org/, the countries are filled is wrong
    values.
    If we decide to update the free text with a dropdown list, we need to
    handle these wrong data.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 233dfb8c74ce85bdb70bd1eb17231a234387d3c9
Author: Julian Fiol <julian.fiol@biblibre.com>
Date:   Tue Aug 18 17:16:53 2015 +0200

    Bug 14707 : Replace UsageStatsCountry syspref from free text to a dropdown list.
    
    This will avoid syntax problems with Hea when a user will fill this 2 sysprefs
    
    The default choice for UsageStatsLibraryType and UsageStatsCountry is 'empty'
    
    Test Plan
    ---------
    
    1. Create a new Koha install
    2. Go to the 'Administration' page
    3. Go to 'Global system preferences'
    4. Go to 'Administration'
    5. At the end of this page you should see a dropdown menu for
    - UsageStatsCountry with all countries
    - UsageStatsLibraryType with all type of library
    They both should be empty by default.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Not a complete list but is a start
    Lots of new strings to translate :)
    No errors
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cdac530034a6b478b95e2d99ddc171529ee1a6c7
Author: Zeno Tajoli <z.tajoli@cineca.it>
Date:   Mon Sep 19 17:03:20 2016 +0200

    Bug 13405 - System information has misleading information about indexing mode
    
    With this patch when <zebra_bib_index_mode> or <zebra_auth_index_mode> are set to 'grs1'
    it appears a link to https://wiki.koha-community.org/wiki/Switching_to_dom_indexing
    instead of a misleading information.
    
    To test:
    a)Insert 'grs1' in <zebra_bib_index_mode> or <zebra_auth_index_mode> (file koha-conf.xml)
    b)It appers a  misleading warning
    c)Apply the patch
    d)It appears a link to https://wiki.koha-community.org/wiki/Switching_to_dom_indexing.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0f4644a5bf7a43b117fbf6642b6db0479fdc58ed
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Fri Sep 16 18:49:19 2016 +0300

    Bug 17312 - Typo in members-toolbar.inc / moremember-brief.tt / moremember.tt
    
    The following three templates are using [% guarantorborrowernumber %]
    while they should be using [% guarantor.borrowernumber %]:
    
    members/members-toolbar.inc
    members/moremember-brief.tt
    members/moremember.tt
    
    This doesn't result in any breakage; just a couple of 'Edit' links that
    do not pass the guarantorid in the URL, and one case where guarantor
    information is not shown in the staff client.
    
    This patch fixes that.
    
    Test plan:
    0) [PREREQUISITE] Create a patron with a guarantor if you don't have one.
    1) Go to Home > Patrons and search for a patron that has a guarantor. In
       the Details page for that patron, the 'Edit' link in the toolbar does
       not pass the guarantor's id in the URL (...&guarantorid=&...).
    2) In the same page, the 'Edit' link under the patrons name (immediately
       under 'Guarantor') again does not include the guarantor id in the URL.
    3) Go to Home > Patrons and click on 'New patron'. Pick any category from
       the drop down menu. Enter the Surname, First name, and Date of birth
       of the patron you used in step 1). This triggers the 'Duplicate patron
       record?' warning -- click on 'View existing record' and notice how the
       guarantor information is missing.
    4) Apply the patch.
    5) Repeat steps 1), 2), and 3) above. The URLs are fixed and patron info
       is showing.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f9e3639da7ef02a6ca08014179d216e1d938a401
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Sat Sep 10 11:54:06 2016 +0300

    Bug 17289: Holds awaiting pickup shows date unformatted
    
    In the Staff client, under Circulation -> Circulation reports,
    the date shown in the heading of the 'Holds awaiting pickup'
    report is not formatted according to the 'dateformat' system
    preference.
    
    This (trivial) patch fixes that.
    
    Test plan:
    1) In the Staff client, go to Circulation and under 'Circulation
       reports' click on 'Holds awaiting pickup'
       (cgi-bin/koha/circ/waitingreserves.pl).
    2) Observe that the date shown in the heading is always formatted as
       yyyy-mm-dd regardless of the value of the 'dateformat' syspref.
    3) Apply the patch.
    4) Re-visit the 'Holds awaiting pickup' report. Confirm that the patch
       worked, i.e. the date shown in the heading is formatted according
       to the 'dateformat' system preference.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4da3bf5e48fa3462d2f3eca0f3c45f64dc9bb5b2
Author: Rafal Kopaczka <rkk0@poczta.onet.pl>
Date:   Sat Sep 3 18:06:47 2016 +0200

    Bug 17245: Untranslatable abbreviated names of seasons.
    
    Because seasons strings are not available through DateTime module,
    names of them where added in code, and templates. Bug 16289 adds new
    abbreviated form to the code, but not to the templates. This patch
    should fix the problem.
    
    To test:
    1. Apply patch.
    2. Run "misc/translator/translate update" for you language.
    3. Check if names are in po/ file for language.
    4. Check if generating next issue for serial and prediction patterns
    works correct.
    
    NOTE: or "create {language code}" instead of update.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 756c0f93187174f22d95825f51c4dfa21b11803a
Author: Marc Véron <veron@veron.ch>
Date:   Tue Sep 20 16:11:22 2016 +0200

    Bug 17322 - Translation breaks opac-ics.tt
    
    This patch adds newlines to opac-ics.tt that are preserved by the translating process.
    
    To test:
    - Apply patch
    - Create a translation (perl translate xy-XY)
    - With a text editor or poedit, translate misc/translator/po/xy-XY-opac-bootstrap.po
      (it is enough to translate "%s %s %s %s is overdue %sYour copy of........")
    - Install language xx-XY and select it for OPAC (perl translate install xy-XY)
    - Make sure you have at least a couple of loans, including one overdue
    - Go to /cgi-bin/koha/opac-user.pl and click on the link labeled "Download as
      iCal/.ics file"
    - Inspect the file in a text editor and/or view the result in a calendar
      appplication. Make sure the data makes sense. Compare it to the english version.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6fc03f1968f9e405d745b854577c953106fdbdfe
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Thu Sep 15 11:37:19 2016 +0300

    Bug 10768 - Improve the interface related to itemBarcodeFallbackSearch
    
    When the itemBarcodeFallbackSearch syspref is on, the wording in the
    interface should reflect that you can enter a barcode OR a keyword.
    Additionally, in the results of a keyword search the "Fast cataloging"
    link should be more descriptive. This patch fixes these issues.
    
    Test plan:
    
    0) [PREREQUISITES] Ensure you have a Fast Add ('FA') framework defined,
       and that your itemBarcodeFallbackSearch syspref is set to 'Enable'.
    1) Go to Circulation -> Check out, search for a patron, then select a
       patron to Check out. Notice how the text above the textbox reads
       "Enter item barcode:".
    2) Type something generic (not a barcode) in the textbox so that you'll
       get at least one item as a result. Notice how the text in the yellow
       warning box reads "The barcode was not found: <terms> Fast cataloging".
    3) Apply the patch.
    4) Repeat step 1), now the text above the textbox should read
       "Enter item barcode or keyword:".
    5) Repeat step 2), now the text in the yellow warning box should read
       "The barcode was not found: <terms> Add record using fast cataloging".
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 50a37fbf5bc22bed843447be6a6603e7705fd28d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 13 14:41:51 2016 +0100

    Bug 16816: Do not copy parameters used when duplicating a report
    
    If a report is duplicated from the report list, the new report will
    contain the tag (<<YEAR>> for instance), but from the reports results
    page it copies the values used for the results.
    
    Test plan:
    Create a new sql report with tags
    Duplicate it from the report list: no expected changes
    Run it and duplicate it: the tags must not have been replaced
    
    Signed-off-by: Andreas Roussos <arouss1980@gmail.com>
    Ran and duplicated a report, the tags remained intact.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f020babef0efa089df7f5937587319d41d2ef01b
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon Sep 19 12:38:43 2016 -0400

    Bug 17307: Smaller counter-patch
    
    Given that the issue is trying to call a method on something that isn't
    an object, because the category code doesn't exist, then why is it
    even trying to change the expiry date? A simple postfix if fixes it.
    
    Applied counter-patch by M. Tompsett. All three patron 'Edit' links
    mentioned in previous patch's test plan work fine.
    
    Signed-off-by: Andreas Roussos <arouss1980@gmail.com>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 613c83f4e3e92d9f5a51fd2d5eccefd0dd6d00de
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 14 14:41:20 2016 +0100

    Bug 17300: Fix serials search
    
    Since bug 16157, the location value is always "All" and the serial
    search won't return anything.
    
    Test plan:
    Search for some serials.
    Without this patch, it won't return any results
    With this patch applied, the result search should be consistent
    
    Reproduced with serial's "Advanced search" and search filter in
    left hand column. Fixed by this patch.
    Signed-off-by: Marc <veron@veron.ch>
    
    Advanced search works fine again.
    Signed-off-by: Andreas Roussos <arouss1980@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1a2d804a8094ea05199803593698b4294f029913
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 14 13:39:34 2016 +0100

    Bug 17296: Display warning if AnonymousPatron is not correctly set
    
    Bug 14655 added a warning to the about page ("System information" tab)
    if the AnonymousPatron feature is not correctly configured.
    But actually there is one case when it's not displayed.
    
    Test plan:
    Set AnonymousPatron to a non existing patron
    Set at least 1 borrowers.privacy == 2
    go on the about page.
    Without this patch you do not get the warning
    With this patch you will see "Some patrons have requested a privacy on
    returning item but the AnonymousPatron pref is not set correctly. Set it
    to a valid borrower number if you want that this feature works
    correctly."
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f66cc4dfcca243e6210c3323586efbfbd6cfe0cd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 13 09:44:41 2016 +0100

    Bug 17294: Make reserves_stats.pl plack safe
    
    Lot of errors are raised by this script under plack because of var scope
    issues:
    
    Variable "$ccodes" is not available at
    /home/koha/src/reports/reserves_stats.pl line 337.
    Variable "$locations" is not available at
    /home/koha/src/reports/reserves_stats.pl line 338.
    Variable "$itemtypes" is not available at
    /home/koha/src/reports/reserves_stats.pl line 339.
    Variable "$Bsort1" is not available at
    /home/koha/src/reports/reserves_stats.pl line 344.
    Variable "$Bsort2" is not available at
    /home/koha/src/reports/reserves_stats.pl line 350.
    Variable "@patron_categories" is not available at
    /home/koha/src/reports/reserves_stats.pl line 356.
    
    The lazy way to fix that is that reinit them from the subroutines they
    are used.
    
    Test plan:
    Execute the report, after this patch applied you won't see the error in
    the log.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b1daa66aadead2fb781cd3ba2d71592e73a57ec2
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Aug 29 10:54:30 2016 +0000

    Bug 17213 - Add HTML5 validation to cardnumber field on patron self registration
    
    To test:
    Verify that different values in 'CardnumberLength' system preference
    display correctly in the self reigstration form
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dc9c5721a7586ff89fd3ca068dbb857b860872e9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Aug 29 10:28:25 2016 +0000

    Bug 17213 - Self registration cardnumber is not editable if errors found when form submitted
    
    To test:
    Enable self registration
    Make sure cardnumber is not in
    'PatronSelfRegistrationBorrowerUnwantedField'
    Enter an invalid or used cardnumber
    Submit form
    Note errors appears correctly but cardnumber is not editable
    Apply Patch
    Enter an invalid or used cardnumber
    Submit form
    Note errors appears correctly and cardnumber is editable
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a055abe7c06e2efc9f0cdae89c2cbef28b7f3cb3
Author: Marc Véron <veron@veron.ch>
Date:   Thu Aug 18 14:14:47 2016 +0200

    Bug 17144: Fix variable scope issues in edi_account.pl
    
    To reproduce:
    - In Staff client, go to Administration > EDI accounts
    - Click "+ New account"
    Result: Internal Server Error
    Plack error log says:
    Can't call method "param" on an undefined value at /home/marc/koha/admin/edi_accounts.pl line 157
    
    To test:
    -Apply patch
    - Add an EDI account
    - Edit an EDI account
    - Delete an EDI account
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 53f8916fe70f9401923872b7fcd05f63a1e5fdf1
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Tue Aug 9 12:58:47 2016 +0200

    Bug 17085 - Specify libmojolicious-perl min version
    
    Set min version for libmojolicious-perl to 6.0 and regenerate debian/control
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d26cda6f9e7e52bb899717ffe5f84c31b46feefc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 20 10:03:42 2016 +0100

    Bug 17316: Do not display the list's name if the user does not have permission - Staff
    
    Same as previous patch but for the staff interface
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 31ca4849efd5539c6b287047ce2da560be7e1c53
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 20 09:55:25 2016 +0100

    Bug 17316: Do not display the list's name if the user does not have permission - OPAC
    
    At the OPAC, if a user manipulate the URL to show a list (s)he is not
    allowed to view, the list's name will be displayed anyway.
    
    Test plan:
    - Create a private list with user A
    - Copy the op=view URL and access it with user B logged in
    => Without this patch, you will see the rss icon, the list's name and
    the "add list" button
    => Without this patch, only the "unauthorized" box will be displayed
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e422de7b62322b2637ac5623d102563dd3e82b36
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 20 11:06:23 2016 +0100

    Bug 17315: (Bug 17210 follow-up) Fix "Save to lists" links from the result page
    
    On bug 17210, the selector .addtoshelf should not have caught the
    .addtoshelf nodes from the result list.
    To fix this, we just need to make the selector more specific (and cannot
    reuse it without more changes, the biblionumber variable is not the same
    - vs SEARCH_RESULT.biblionumber).
    
    Test plan:
    Make sure the 2 links (from detail and search result) "Save to lists"
    and "Save to your lists" work as expected.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9734726846f6fa652d88c8bc39c7b43595422465
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 14 09:20:01 2016 +0100

    Bug 16800: Fix XSS in additem.pl
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 79cd9e9fd460b7376ee06fe51eed1e3ed9392d81
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 16:05:09 2016 +0100

    Bug 16800: Fix XSS in catalogue/*detail.tt - isbn
    
    Test plan:
    catalogue a bibliographic record with a isbn=
      </title><script>alert('XSS')</script>
    
    Go on the detail pages.
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3169434cfa7295025e4ff5fea58f7e9730a96650
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 16:03:37 2016 +0100

    Bug 16800: Fix XSS in catalogue/*detail.tt - author
    
    Test plan:
    catalogue a bibliographic record with a author=
      </title><script>alert('XSS')</script>
    
    Go on the detail pages.
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 515208d5ec308ade967efe04388bbedbf5f2b057
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 16:02:07 2016 +0100

    Bug 16800: Fix XSS in catalogue/*detail.tt - title
    
    Test plan:
    catalogue a bibliographic record with a title=
      </title><script>alert('XSS')</script>
    
    Go on the detail pages.
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    This of course means that any html in the title will no longer be
    evaluated. :
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 69cbea8e0c2bbb59b052bc355e805be16969f789
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Fri Sep 16 21:01:58 2016 +0300

    Bug 17308 - 'New patron attribute type' button does not work
    
    In the Staff client, the 'New patron attribute type' button in the Patron
    attribute types page does not work. This patch fixes that.
    
    Test plan:
    1) In the Staff client, go to Home > Administration > Patron attribute types,
       and click on the 'New patron attribute type' button. You cannot create a
       new patron attribute type and you get the following Software error:
       Not a HASH reference at [...]
    2) Apply the patch.
    3) Repeat step 1). The 'New patron attribute type' button now works.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 242722e99df77be9ce0e4c6d52ff402e0a77d604
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 23 11:56:40 2016 -0300

    Bug 17336: Add api_secret_passphrase entry in packages setup
    
    Bug 13799 introduced the api_secret_passphrase on source installs, but missed to do so on packages.
    
    This patch introduces the entry on the template koha-conf-site.xml.in file, and
    patches koha-create so it generates a randomized string (64 chars) to put in it.
    
    To test:
    - Apply the patch
    - Grab the new template file:
      $ sudo cp kohaclone/debian/templates/koha-conf-site.xml.in \
                /etc/koha
    - Create a new instance:
      $ kohaclone/debian/scripts/koha-create --create-db blah
    => SUCCESS: The script runs fine, /etc/koha/sites/blah/koha-conf.xml
       contains the api_secret_passphrase entry.
    - Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ea5ec8c4d521e4138f63ddde133b6c7250005435
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 23 11:33:19 2016 -0300

    Bug 17332: Remove memcached config from apache files
    
    This patch removes Memcached configurations from the shipped apache files.
    
    Note: testing is not actually needed for this patch, as it is really trivial. But I
    include testing steps, just in case QA members require it.
    
    To test:
    - Apply the patch
    - Do a (standard/dev/single) Koah install
    => SUCCESS: Verify the resulting koha-httpd.conf file doens't include memcached data
    - Have a packages install
    - Replace
      * /etc/koha/apache-site-https.conf.in
      * /etc/koha/apache-site.conf.in
      with the ones from this patch
    - Create an instance
    => SUCCESS: The apache configuration doesn't include memcached configurations
    - Sign off :-D
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1c957af7bc0b701412cf5846d878523a553f79e0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 23 11:28:58 2016 -0300

    Bug 17332: Include memcached configuration in koha-conf files
    
    This patch introduces the memcached_servers and memcached_namespace
    configuration entries as expected by 11921.
    
    Note: better test this one and the followup together to ease the process.
    
    To test:
    - Do a source Koha install (dev, standard, single)
    => SUCCESS: The resulting koha-conf.xml file includes the memcached_* entries
       which are filled with the right values.
    - In kohadevbox (packages setup):
    - Replace /etc/koha/koha-conf-site.xml.in with the one from this patch
    - Create a new koha instance
    => SUCCESS: The instance's koha-conf.xml includes the relevant entries
    - Sign off
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0901758f498aaa2f1711380916255db23709aa8d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 26 14:55:16 2016 -0300

    Bug 17327: (QA followup) Remove Carp::Always which is not used
    
    This patch removes the need for Carp::Always in .../Reserves/MultiplePerRecord.t
    which is not actually used.
    
    It also removes 'undef' from Koha::Holds::forced_hold_level's last return, to comply with
    our QA rules.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 91b23e09bbb57284e65578491ea226a407420a0b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Sep 21 02:15:02 2016 +0000

    Bug 17327: Item level holds no longer enforced
    
    Reported by Katrin:
    
    Example:
    - on shelf holds allowed
    - holds allowed 5
    - holds on same record allowed 5
    - FORCE item level holds
    
    On a record with only one item, you can only place a record level hold
    in OPAC now - which is against your circulation conditions.
    
    Another example:
    - record with 2 items
    - circulation rules as above, 1 hold allowed on the record
    - Item level holds: forced
    
    I can only place record level holds in OPAC and staff. At the moment, I
    am not able to place item level holds in any circumstances in my
    installation.
    
    Test Plan:
    1) Apply the unit test patch
    2) prove t/db_dependent/Reserves/MultiplePerRecord.t
       should fail
    3) Apply the second patch
    4) prove t/db_dependent/Reserves/MultiplePerRecord.t
       should pass
    5) Attempt to replicate one of the examples above, you should be unable to
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit aa62448897f769f31604796494644e3171ef902b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Sep 21 02:13:47 2016 +0000

    Bug 17327: Add unit test for regression
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9e22a9ced3db2ba0f27d45a551b455095cb910e5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 13 14:42:32 2016 -0300

    Bug 2389: (followup) Add documentation and fix use case
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Barton Chittenden <barton@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 71454b4263f6e883f7e6246de06291531a7d5757
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 15 10:18:13 2016 -0300

    Bug 2389: Add --test switch to overdue_notices.pl
    
    This patch adds the --test option switch to the overdue_notices.pl script
    so it can be ran without doing any actual action.
    
    To test:
    - Have a patron with overdue items (simulate a checkout for a past date. Note it implies
      that the circ rules are defined so the patron is overdue)
    - Run:
      $ sudo koha-shell kohadev
      koha-dev$ misc/cronjobs/overdue_notices.pl --test
    => SUCCESS: The script is ran but the patron isn't debarred and no notice messages are queued.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Barton Chittenden <barton@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0254fd7a1ffb54cba942a95e23c24619ec6b25c1
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 16 10:50:33 2016 +0000

    Bug 17135 - DBRev 16.06.00.028
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bc647bc21b3496fb6f7b509d57f516116178222d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Sep 9 10:53:48 2016 +0200

    Bug 17135: [QA Follow-up] Changes as to reporting
    
    We should at least report some grand totals when fixing fine records.
    This patch also includes some cosmetic whitespace swapping.
    Turned one last into an if statement.
    
    Added a copyright statement too.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8a7a7a034490ced2c2e7de062813645169c5cb71
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Sep 9 09:53:53 2016 +0200

    Bug 17135: [QA Follow-up] Change location of new script to fix fines
    
    The location of the script in misc/maintenance would be fine for
    running it from the command line. But it will be a problem for several
    install types when running it from the web installer.
    Files from misc/maintenance go to bin/maintenance in a package install,
    not to mention other installs than a dev install.
    
    This patch moves the script to installer/data/mysql. Already there are two
    other scripts run by upgradedatabase. I would rather move these three
    scripts somewhere else, but we c/should do that on another report.
    
    Fixed a small typo in a message too.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3ada0d104de609ae39f58a86d6406b9a1200d758
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Wed Aug 31 19:46:00 2016 +0200

    Bug 17135 - Maintenance script execution added as part of an atomic DB upgrade
    
    (plus warnings for 16.05+ production setups possibly already affected)
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ddc8635347f978a354e6e332aede0abeeea310b
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Wed Aug 31 16:18:50 2016 +0200

    Bug 17135 - Some minor changes & fixes in the script
    
    - all non-fatal output redirected to STDOUT (as there is an intention
    to run this script from updatedatabase.pl)
    
    - added borrowernumber and itemnumber equality checks to the SELECT
    statement in getFinesForChecking() - accountlines.issue_id alone is not
    entirely trustworthy (because InnoDB forgets it's highest auto_increment
    after server restart), in some rare cases it may point to some random
    issue for different patron and different item
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 812379bbc237e5c5fe6e954f666a7b1f0961a21c
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Mon Aug 29 12:51:21 2016 +0200

    Bug 17135 - Fine for the previous overdue may get overwritten by the next one
    
    External maintenace script for fixing unclosed (FU), non accruing fine
    records which may still need FU -> F correction post-Bug 15675.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1eaa8f047694b78c1c9ab18e3b98fd23e781a4f3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jun 15 10:51:34 2016 -0400

    Bug 16752 [Revised] Remove the use of event attributes from some acquisitions templates - Uncertain prices
    
    This patch modifies the acquisitions uncertain prices template to remove
    event attributes onclick and onchange.
    
    Also changed on the uncertain prices page: Added a label to the orders
    filter, removed redundant form submit function.
    
    - Locate a vendor which has orders with uncertain prices
    - Click the 'Uncertain prices' tab in the left-hand sidebar
    - Enter invalid data in the "price" field for any order. Confirm that an
      error is triggered when the field loses focus.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    QA Revision: Corrected input type of submit button.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 968159af51e23bc1977cfd2da57a66ce13f4ea7c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jun 15 10:23:41 2016 -0400

    Bug 16752 - Remove the use of event attributes from some acquisitions templates - Transfer order
    
    This patch removes the use of 'onclick' from the acquisitions transfer
    order process. The patch also modifies the style of some links and
    buttons to conform with current guidelines.
    
    - Locate an open basket with items in it
    - Click the 'Transfer' link for a title in the basket
    - In the pop-up window:
      - Confirm that the 'Cancel' button at the bottom of the window is a
        Bootstrap-style button.
      - Search for a vendor; Confirm that the 'Choose' link is a
        Bootstrap-style button.
      - Choose a vendor; Confirm that the 'Choose' link on the following
        page is a Bootstrap-style button.
      - Confirm that clicking the 'Choose' button transfers the item to the
        correct basket.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cc790858206f5a8dac9ea5c79cdb0770c49d7752
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jun 15 12:14:12 2016 -0400

    Bug 16752 - Remove the use of event attributes from some acquisitions templates - Funds
    
    This patch modifies the funds administration page and other files
    related to the process of searching for and selecting fund owners and
    users in order to remove the use of event attributes like 'onclick.'
    
    Also changed in this patch: I have revised the way the "select owner"
    and "select user" controls look. They are now links with Font Awesome
    icons.
    
    - Go to Administration -> Funds and open a fund for editing.
    - Test the process of adding and updating an owner:
      - Click the 'Select owner' link.
      - Search for and select an owner in the pop-up window.
      - Save the fund and verify that the owner was saved correctly.
      - Perform the same test with the 'Remove owner' link.
    - Use the same process to test the addition and removal of users.
      - Confirm that the 'Remove' link works correctly before and after
        submitting the form to save changes to the fund.
    
    This patch changes a file which is used by both the funds template and
    the template used when setting a guarantor on a patron. To test the
    changes in that context:
    
    - Open a 'child' type patron record.
    - Under 'Guarantor information,' test the process of setting and
      removing a guarantor to confirm that data is saved correctly.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9fdd7603bfc4c2a03926292d710f5ee68a4ed6ea
Author: Marc Véron <veron@veron.ch>
Date:   Wed Aug 10 22:16:10 2016 +0200

    Bug 13134: Fix template file to make category appear
    
    This is a followup to rescue the bug.
    
    To test: Follow test plan from comment #1
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f3322257d5a2fe003656a25ce3f519c9c5690f70
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 14 10:37:56 2011 -0400

    Bug 13134 - Add patron category to returns confirmation dialogs
    
    Some librarians find it useful to know what category a patron is before
    confirming a reserve or transfer from the checkin screen.
    
    This patch adds the patron category to the hold and transfer popups
    to the patron information already displayed. The li tags that contain
    the patron category have the class "patron-category" to allow this data
    to be easily hidden.
    
    Test Plan:
    1) Apply this patch
    2) Trap a hold for a patron, note the patron category is now displayed
    3) Trap a hold for pickup at another loation, note the patron category
       is now displayed
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a5806c21d0ab58cf2879cb26b1fe52ba4e4c2139
Author: Magnus Enger <magnus@libriotech.no>
Date:   Thu Sep 8 15:10:33 2016 +0200

    Bug 17266 - Update man page for koha-remove with -p
    
    Bug 9754 added the -p|--purge-all option to koha-remove, but this
    was not documented in the man page. This patch fixes that.
    
    To test:
    Run these commands and look at the formatted man page:
    $ xsltproc /usr/share/xml/docbook/stylesheet/docbook-xsl/manpages/docbook.xsl \
      debian/docs/koha-remove.xml
    $ man -l koha-remove.8
    
    Make sure this test passes:
    $ prove -v xt/verify-debian-docbook.t
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e8fcc651a3aa9af9d1a49a6cec64fc9bde737a86
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jul 23 12:43:54 2014 -0400

    Bug 12629 - Software error when trying to merge records from different frameworks
    
    Test Plan:
    1) Choose a bib record that has the default framework.
    2) Add a second record using that fast add framework.
    3) Merge the records; switch to "Using framework: Default", and choose the original record (i.e. the one that had the default framework) as the merge reference. Clicking 'Next' will trigger the error.
    4) Apply this patch
    5) Repeat steps 1 - 3, no error should occur
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a9eb4005811882da0eb5e20b52861a3c85556dff
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Thu May 19 17:12:06 2016 +0300

    Bug 16556 - KohaToMarcMapped columns sharing same field with biblio(item)number are removed.
    
    REPLICATE ISSUE:
    
    1. Map biblio.frameworkcode to 999$b
    2. Map biblio.biblionumber to 999$c
    3. Add a record with something in 999$b
    4. 999$b is removed by C4::Biblio::AddBiblio()
    
    After this patch, the field used by biblio.biblionumber or biblioitems.biblioitemnumber
    is not removed and created anew, thus dropping all existing additions.
    
    There is no point in dropping the field in any case, since we can just replace
    the existing subfields in-place with no need to recreate the whole field.
    
    UNIT TESTS INCLUDED
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2e79c211db318969b7c9d5ff538dfd54ba1aaed2
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Aug 9 12:56:46 2016 -0400

    Bug 17010 [Follow-up] Canceling a hold awaiting pickup no longer alerts librarian about next hold
    
    This patch makes a minor change to the markup to make the button in the
    confirmation dialog conform to the appearance of similar buttons.
    
    To test, follow the original test plan for this bug and verify that the
    "OK" button in the dialog looks correct.
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b80a18ee2f059309a78087e48b9464d2352d444f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Aug 1 07:17:04 2016 -0700

    Bug 17010 - Canceling a hold awaiting pickup no longer alerts librarian about next hold
    
    In previous versions of Koha, if a hold canceled from the "Holds over" tab had other holds on it,
    the librarian would be alerted with the message "This item is on hold for pick-up at your library"
    and directed to check it in to fill the next hold. This no longer happens.
    
    Test Plan:
    1) Apply this patch
    2) Find a hold that has been waiting too long
    3) Cancel that hold via waitingreserves.pl
    4) Note you get the message "This item is on hold for pick-up at your library"
    5) Confirm the ok button redirects you to the correct tab
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit be2b61f9e510a3bca629e12422a4e3529a9e473d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Sep 5 10:44:06 2016 +0100

    Bug 17146: Raise Wrong CSRF token warnin for the 'Delete' action
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 11bf7e7bef856d5d90126c19f897d060cb4c9d9d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 18 15:52:38 2016 +0100

    Bug 17146: Fix CSRF in picture-upload.pl
    
    If an attacker can get an authenticated Koha user to visit their page
    with the
    url below, they can change or delete patrons' images
    /tools/picture-upload.pl?op=Delete&borrowernumber=42
    
    Test plan:
    1/ Hit /tools/picture-upload.pl?op=Delete&borrowernumber=42
    And confirm that you get a "Wrong CSRF token" error
    2/ Go on the patron detail page with a patron's image
    3/ Click on the Delete link (note the csrf_token param)
    4/ The image will be deleted and you are redirected to the patron detail
    page.
    
    Regression tests:
    Upload an image from the patron detail page and from the "upload patron
    images" tool.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit da03dbd458c59da0b9213efacd3425e89b453332
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 12 10:42:28 2016 +0100

    Bug 17114: Fix XSS in picture-upload.pl
    
    To reproduce:
    1/ cp your_image.jpg 'test<svg onload=alert(1)>.jpg'
    2/ Use the upload picture tool to upload this file
    => Without this patch, the alert is show
    => With this patch, the filename is correctly displayed and no alert
    
    Note that the cardnumber var was not escaped neither, it's now.
    
    Signed-off-by: Colin Campbell <colin.campbell@ptfs-europe.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a9caebc288463689d6c2a732ee8b900a3ab34a21
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Fri Aug 12 16:28:41 2016 -0300

    Bug 16554: Fix encoding on it-IT file
    
    This patch only fixes encoding of file
    installer/data/mysql/it-IT/necessari/sample_numberpatterns.sql
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9261fb4f5bd6fd4b25ce97de7be9262b3719544a
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue May 24 22:14:13 2016 -0300

    Bug 16554: rewrite mandatory and sample data - de-DE
    
    More changes to de-DE files
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit be4cd79aea6908e0c3bb13b032edaf7a15d2e66e
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue May 24 22:25:56 2016 -0300

    Bug 16554: rewrite mandatory and sample data - it-IT
    
    More changes to it-IT files
    
    Checked marc21 and unimarc files
    unimarc_relatorterms.sql had bad encoding, others minor
    errors
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6dc2f1ae7c8e60534b4d6dec979c96034aa17f5d
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Sat May 28 12:54:30 2016 -0300

    Bug 16554: More i18n changes - en, es, nb and pl files
    
    Mostly fixes bad values in auth files ( '' -> 0 )
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 28191a538b8f3bed698f1e67acca156c5b64ebea
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue May 24 23:31:25 2016 -0300

    Bug 16554: rewrite mandatory and sample data - pl-PL
    
    More changes to pl-PL files
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4742f1035b9748dd869653f1c608fff1408353f9
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue May 24 23:30:14 2016 -0300

    Bug 16554: rewrite mandatory and sample data - nb-NO
    
    More changes to nb-NO files
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8cfa6f633a1be9a12a3a98524b05fae47fb4aa02
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue May 24 22:22:24 2016 -0300

    Bug 16554: rewrite mandatory and sample data - es-ES
    
    More changes to es-ES files
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e38cad45e8ef2df88dc4a2c8345ac1d92f8dd8e8
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed May 18 22:59:27 2016 -0300

    Bug 16554: Fix I18N sample files
    
    Needs Bug 13669
    
    This patch fix web installer for
    de-DE, es-ES, fr-CA, nb-NO and pl-PL
    
    To test:
    1) Apply patch
    2) Try web installer for any/all listed languages.
    a) de-DE, es-ES, fr-CA and pl-PL
    There must be no problems for marc21 + all sample files
    b) nb-NO
    There must be no problems for normarc + all sample files
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b5ae31e7fdcdd932d1475e30fa73fba15c2b2815
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed May 18 23:55:41 2016 -0300

    Bug 16554: Fix fr-FR sample files
    
    Needs Bug 13669
    
    Rewrite autorites_norme_unimarc.sql to
    use only one INSERT IGNORE.
    
    New load method complains about duplicate keys,
    and both auth files are mandatory!
    
    Also removed blank space from sample_labels.sql
    
    Tested with unimarc_complet and all sample files.
    
    To test
    1) Apply the patch
    2) Try fr-FR web installer, unimarc_complet + all sample files
    There must be no errors
    
    Don't know if fr-FR marc21 and unimarc_lecture_pub are used,
    need a look from french users.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 386f7ae9af012c4cb13a87f686915fc95d65585c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 14 13:25:58 2016 +0100

    Bug 17299: Display date due correctly on SCO
    
    Unless it's an hourly loan, date due should not display the time part
    (23:59).
    Because of bad code in GetPendingIssues, date_due is replaced with a
    DateTime object and is copied into date_due_sql.
    We need to use this date_due_sql to correctly display the date due in
    the sco module.
    
    Test plan:
    1/ Enable WebBasedSelfCheck syspref
    2/ Check out an item to User A -- Do not use an hourly loan.
    3/ Log in to Koha self check ( {OPAC URL}/cgi-bin/koha/sco/sco-main.pl).
    4/ Enter User A's cardnumber.
    Without this patch, checkouts are
       MM/DD/YYYY 12:00 AM (Timeformat: 12 hour)
    or MM/DD/YYYY 00:00    (Timeformat: 24H)
    With this patch applied, only the date is displayed
    
    Followed test plan, works as expected.
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3ee3c3198ae0c79a698f9037975a17c6fca31a69
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Sep 13 17:36:14 2016 +0000

    Bug 16276 - Update schema
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 89bae5f368bb9bf2e28172945852a1cd0e42a120
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Sep 13 17:30:41 2016 +0000

    Bug 16276 - DBRev 16.06.00.027
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 95fe4347581cba70bdf36c3f3f1c43e1b765c2d7
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 19 12:23:01 2016 +0200

    Bug 16276: [QA Follow-up] Only track when pref is enabled
    
    Do not track when the pref has not been enabled.
    This patch moves the conditional update in Auth.pm to Koha::Patron.
    And adds a test for the new track_login method.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 183fdc83f04484eab831be58b5bdef9f14aec963
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 19 11:16:33 2016 +0200

    Bug 16276: [QA Follow-up] Number of tests corrected
    
    Applies to t/db_dependent/Members.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b6fe9f23ccb678917bfb90950668cd1efbc4848f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Apr 24 16:03:49 2016 +0100

    Bug 16276: Add a new pref TrackLastPatronActivity and new column borrowers.lastseen
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    https://bugs.koha-community.org/show_bug.cgi?id=12276
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7acb7e14faed07ff987e58356d3faaa95a2cf194
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Apr 24 17:51:56 2016 +0100

    Bug 16276: Make the batch patron deletion tool deal with last_seen
    
    This patch adds the same change as the previous one to the batch patron
    deletion tool.
    
    If the pref TrackLastPatronActivity is enabled, the librarians will be
    able to delete patrons who do not have been connected since a given
    time.
    
    Test plan:
    Define a date for the "who have not been connected since" options and
    confirm that it works as expected.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    https://bugs.koha-community.org/show_bug.cgi?id=12276
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1d50d8cc0c4190bd5dd3ba8a555fba916e946c88
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Apr 24 17:38:57 2016 +0100

    Bug 16276: Change to GetBorrowersToExpunge to take last_seen into account
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    With small change: number of tests in t/db_dependent/Members.t
    
    https://bugs.koha-community.org/show_bug.cgi?id=12276
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 93ff61c10d671afb6c7be2dd24076383b839f182
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Apr 24 17:39:13 2016 +0100

    Bug 16276: Make delete_patrons.pl deal with --last_seen
    
    This patch modify the delete_patrons.pl cronjob to deal with the
    last_seen option.
    
    To test it, you just have to use the --last_seen option and pass a valid
    date (iso format)
    
    Example:
      perl misc/cronjobs/delete_patrons.pl --last_seen="1984-02-04" --confirm
    will delete all the patrons who do not have been active since this date.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    https://bugs.koha-community.org/show_bug.cgi?id=12276
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f234d1586bff62d2c4e58807cd62ec3187d94f69
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Apr 24 16:04:16 2016 +0100

    Bug 16276: Update borrowers.lastseen when a patron is active
    
    In order to add the ability to delete patrons who have been inactive for
    more than a given time, we need to track down the last time they were
    active.
    To do that, we need a new DB column in the borrowers table (lastseen).
    Note that the borrowers.lastseen column will not be initialised for existing
    installations (set to NULL) so inactive existing patrons will never be
    deleted.
    A workaround would be to init them at the date when the new column will
    be added.
    
    Test plan:
    0/ Set the new pref TrackLastPatronActivity on
    1/ Log in as a patron (staff or OPAC)
    2/ Check that the borrowers.lastseen field has been updated with the
    current time
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    https://bugs.koha-community.org/show_bug.cgi?id=12276
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c78c927695fdcb0dfa060f9dba2fc2933eb57b8b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Aug 18 11:04:38 2016 -0400

    Bug 17147 [Revised] Streamline messages following batch record modification
    
    This patch changes the display of informational messages during and
    after the batch record modification process. Instead of showing a
    separate dialog for each record modified, messages are now grouped into
    one dialog.
    
    To test, apply the patch and clear your browser cache if necessary. You
    must have at least one MARC modification template defined.
    
    - Go to Tools -> Batch record modification.
    - Submit a list of biblionumbers which contains at least one number
      which doesn't exist in your database.
    - Confirm that warning and success messages are grouped instead of
      showing in separate dialogs.
    - Submit a list of biblionumbers using a MARC modification template
      which contains no actions. Confirm that the resulting error message is
      correctly formatted.
    
    Revision formats the error messages without the unordered list, which
    was giving them padding which didn't look correct inside a dialog.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Edit for QA: Removed obsolete changes to CSS.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 57f66d5132fe059c76740b5e2e743d3082d25303
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 13 09:06:12 2016 +0100

    Bug 16949: Simplify the checkbox checked condition
    
    It's easier to use jQuery selector to know if checkboxes are checked.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 645b1f52379966e489f417e0173d5950e4ebc8f9
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Jul 20 22:14:05 2016 +0000

    Bug 16949: Batch record deletion says success when no records have been passed in
    
    The reason this happens is because the page will say success when the
    total number of records given equals the total number of successful
    deletions. If you pass in no records, there are no successful deletions
    --> 0 = 0 --> it thinks it has been successful. This patch adds a check
    that validates if any checkboxes were selected before submitting the
    final form.
    
    I have removed the check for if any records were selected AFTER the form
    has been submitted because it seemed unnecessary if the form can't be
    submitted without selection of records anyway.
    
    To test:
    1) Go to Tools -> Batch record deletion
    2) Put in a record number and click Continue
    3) Deselect the record so that it doesn't actually delete and click
       Delete selected records
    4) Page says 'All records have been deleted successfully!'
    5) Apply patch. Go back and repeat step 3
    6) Form should not submit and you should receive an alert saying that no
       records have been selected.
    7) If you try selecting and deleting a record after this alert, it
       should still work
    
    Note: Have also changed the wording of error in Step 1 when you are
    entering record numbers to delete.
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 99f6116f3595f4d58307fc3249f3be98550d99a9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Aug 15 19:58:52 2016 +0000

    Bug 16732 - Add audio alerts (custom sound notifications) to web based self checkout
    
    This patch adds the infrastructure needed to allow audio alerts, as
    configured in administration, to affect the sco module
    
    This patch allows only for the use of sounds with a full URL to be used
    and does not allow for the Koha standard sounds to be accessed via the
    SCO
    
    To test:
    Ensure you have the preference AudioAlerts enabled
    Ensure you can hear normal sounds from the staff module
    Define an audio alert such as:
        Selector: .sco_entry
        Sound: https://archive.org/download/Doorbell_1/doorbell.ogg
    Load the SCO module
    You should hear the doorbell noise (everytime you reload even!)
    Test that the default sounds are not activated for the SCO, you must
    sepcifically define them
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1d546c57b1be3677263639ff330061fce33dde34
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jun 6 10:11:36 2016 -0400

    Bug 14752 - (QA followup) Remove annoying modal, use dialog box instead
    
    - Uses a dialog box to warn of unique fields not copying, dialog was in
    place for barcode generation so removed the extar modal completey
    - Fixes a problem when barcode was undefined and autobarcode on
    - deleted an extra space in Barcodes/hbymmincr.pm
    
    Signed-off-by: sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bdcbada8b892c3e322c1a9378d9343b4eb9f2089
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 24 14:53:16 2015 +0000

    Bug 14752 - Add multiple copies to a basket at once
    
    This patch add an 'Add multiple copies' button on the new order page in
    acquisitions.  While processing the multiple copies a modal is
    displayed.
    
    To test:
    1 - Add an order to an acquisitions basket
    2 - Choose to add multiple items
    3 - A modal shouold warn about ignoring UniqueItemFields from syspref
    4 - When submitting the modal should popup until all items are processed.
    5 - The modal should disappear after items are added.
    6 - Items should be cloned, minus unique fields
    7 - Enable autoBarcode for various formats, ensure you are warned that
    barcodes will be generated, and ensure they are generated correctly
    
    Sponsored by: Middletown Township Public Library (http://www.mtpl.org)
    
    Signed-off-by: sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 75c61b94f34d406aaa8ac862024ccfd3d9030cc8
Author: Sophie Meynieux <sophie.meynieux@biblibre.com>
Date:   Wed Aug 24 14:56:54 2016 +0200

    Bug 10227 : Fix GetMessagingPreferences when digest is possible
    
    This bug is a bit tricky to test, as the result is somehow  random, depending on the order of rows returned by sql request. You've got to change the preferences several times to see bad results.
    
    Enable EnhancedMessaging preferences
    Set preferences for a borrower or a category.
    run misc/cronjobs/advance_notices.pl and look in message_queue table the letter_code of the generated messages.
    Change digest selection and do the test again several times
    
    Without patch, for message where digest is allowed (Advance_Notice, Item_Due), for a borrower or a category with 'wants_digest' selected, GetBorrowerMessagingPreferences returns sometimes letter_code with DGST and sometimes not.
    
    With the patch, letter_code returned is always correct depending on digest selected or not
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af2918045f3323f9a558eb463165bb4ef331e477
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Sep 13 14:08:23 2016 +0000

    Bug 17295 - Missed variable removal in subscription-add.pl from Bug 15758
    
    To test:
    Load subscription-add.pl
    Get an error
    Apply patch
    Reload
    Koha is less sad (page loads okay)
    Verify that normal functions work
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7535b28f77269a3f0efecf9055477a345c9a63c4
Author: Sophie Meynieux <sophie.meynieux@biblibre.com>
Date:   Wed Aug 10 16:06:35 2016 +0200

    Bug 13914 : Fix UNION in SQL request for reserves statistics
    
    Test plan
    =========
    On Reports > reservations, select all statuses as line, pickup library as column (empty) and a range of hold date. Keep the results
    Run the same reports but with statuses as column and pickup library as line
    You should get the same results on another display.
    
    * Without patch, if you've got representative data, most of the time you can observe significant differences between both results
    
    * With the patch, results are always the same (and right if you request directly your database)
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e330b6923aafa0c68b44eec6cacfbe1d8ff9d378
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 13 09:47:14 2016 +0100

    Bug 15407: Remove 'No method selected!' warnings
    
    From reserves_stats.pl, there is no library pre-selected.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8a74bb24f521b2112979325fd3b6342d48788951
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Sep 12 15:38:46 2016 +0000

    Bug 16274 - DBRev 16.06.00.026
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 85288b8f157c7699ccb7e4e1bc277d5200582f65
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Apr 23 16:37:26 2016 +0100

    Bug 16274: Limit the patron self registration to some libraries
    
    Currently a patron can select a home library in the list of all
    libraries defined in the system.
    However some of these libraries might not accept self registration.
    This patch adds a new pref to display only the allowed libraries.
    
    Test plan:
    0/ Apply the patch, do not fill the new pref
    1/ Self register a new patron
    => All the libraries defined should be displayed in the "Home library"
    dropwdown list
    2/ Fill the pref PatronSelfRegistrationLibraryList with some of the
    branchcode defined in the system
    => Self register a new patron and confirm that the dropdown list has
    been filtered.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 38422f1af6501e3777d647cd28f38aa5d92e1d6f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Apr 23 16:17:06 2016 +0100

    Bug 16274: Add the new pref PatronSelfRegistrationLibraryList
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>

commit 9707a439cbf152752f9f39ebee17c6976f6f7dc6
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jul 22 14:48:36 2016 -0400

    Bug 16967: Remove the use of "onclick" from serial frequency and numbering management
    
    This patch removes instance of "onclick" from the templates for serial
    frequency and numbering management. Events are now defined in the
    JavaScript.
    
    To test, apply the patch and go to Serials -> Manage frequencies.
    
     - In the list of frequencies, click the "Delete" button for a frequency
       which is in use by at least one subscription. In the confirmation
       dialog, clicking the "Show subscriptions" link should display a list
       of titles.
     - Edit or create a frequency.
     - To test that the form submission validation is still working
       correctly, enter non-numeric data in the "issues per unit" field and
       submit the form. This should trigger an error.
    
    In Serials -> Manage numbering patterns:
    
     - In the list of numbering patterns, click the "Delete" button for a
       pattern which is in use by at least one subscription. In the
       confirmation dialog, clicking the "Show subscriptions" link should
       display a list of titles.
     - Edit or create a numbering pattern.
     - Confirm that the "Test pattern" button works correctly.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 062a70cb61f0604e3c79c3f2c08dbf1e218c9a20
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Sep 12 16:45:22 2016 +0100

    Bug 17285: (15758 follow-up) Fix advanced editor
    
    Little mistake from df97814, $branches is a hash { branchcode =>
    branchname }
    
    Test plan:
    Edit a biblio with the advanced editor
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    The advanced editor works as expected
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6d8869e3b0e54456b23913e84bd701d3beab4b10
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 14:46:21 2016 +0100

    Bug 17197: Remove misc/batchupdateISBNs.pl
    
    This script has not been updated for ages and is UNIMARC specific.
    Since I am working on bug 17196 to move marcxml out of biblioitems
    table, I'd like not to rewrite unused scripts (and lost my time...)
    So if someone complains later, I will rewrite it on top of bug 17196.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0b086d5f9c62f781370c26b3da2755cd155ed03e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Sep 12 09:44:48 2016 +0000

    Bug 7677 - Remove atomic update
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6123856b2561a94254fc1f9a3f94179a4793b7ed
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Sep 12 09:39:54 2016 +0000

    Bug 7677 - Schema update
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e63d445e081c81c0a464f7ade9fb1a1b3f847593
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Sep 12 09:38:06 2016 +0000

    Bug 7677 [QA Followup] - Fix issues with kohastructure
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8ff8e0b8dd363f3b2c61130190ddb7227e3daec4
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Sep 12 09:15:38 2016 +0000

    Bug 7677 - DBRev 16.06.00.025
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5e4b351f1e82ccfde9c81e054aa452d7bd4c7760
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Sep 8 09:15:48 2016 +0200

    Bug 7677: UT: Remove $dbh->rollback
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4fce42faf4973c6a15067df941ec85c3017162e3
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Tue Aug 30 10:41:56 2016 +0200

    Bug 7677: QA followup
    
     - Fix tests
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 381dd46c36260f20a18b054bff142ea9eb519f3a
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Aug 25 16:08:45 2016 +0200

    Bug 7677: QA followup
    
    Fix 'unique contraint primary' error when receiving serials
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7e55d09c420f946d6c214ade287bc80fcb9f3e9c
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Fri Jun 3 15:56:36 2016 +0200

    Bug 7677 [QA Followup] - Replace GetItemnumberFromSerialId with use of Koha::Serial::Item(s)
    
     - use _type instead of type (see https://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=15446 )
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5fc1c11198c74ae2921be7c365dd7b1198f6325b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jan 29 01:46:02 2016 +0000

    Bug 7677 [QA Followup] - Replace GetItemnumberFromSerialId with use of Koha::Serial::Item(s)
    
    GetItemnumberFromSerialId has no unit tests. It would be better to start
    using our object system here.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c3a95f92da64582f5556b861687c65ba7e012cf3
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Mon Sep 28 16:29:16 2015 +0200

    Bug 7677 [Follow-up]: New areas in subscriptions and new functions when receiving.
    
     - Various fixes.
    
    Test plan:
    
    Once the makePreviousSerialAvailable syspref is enabled, receive a serial, and then another, then check that:
    
     - the first received itemtype has been set to the "previous item type" value (set in the subscription).
    
     - the first received has been made available.
    
     - the last received serial itemtype has been set to the "item type" value (set in the subscription).
    
     - 995$l is automatically prefilled.
    
    Configure the serialsFieldsToAV syspref. When creating or editing a subscription, check that:
    
     - the domain and/or origin and/or support fields are correctly displaying the authorized values configured in the syspref.
    
    Signed-off-by: Chris <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f56aa16a931e2a70818dc29df46050eac74c6253
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Tue Dec 23 16:51:41 2014 +0100

    Bug 7677: Fix tests
    
    They don't pass since bug 12098 has been pushed.
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    
    http://bugs.koha-community.org/show_bug.cgi?id=7767
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5ea3962600d0433a2106047ca24ade3ef7e0ac34
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Mon Mar 10 11:58:33 2014 +0100

    Bug 7677: FIX QA issues
    
     FAIL    C4/Serials.pm
       FAIL      forbidden patterns
        forbidden pattern: trailing space char (line 1501)
        forbidden pattern: trailing space char (line 921)
    
     FAIL    serials/serials-edit.pl
       FAIL      valid
            "my" variable $dbh masks earlier declaration in same scope
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    
    http://bugs.koha-community.org/show_bug.cgi?id=7767
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b11c8722cb90909b94dd53c8dcf5cf390258ebb8
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Wed Aug 21 14:38:34 2013 +0200

    Bug 7677: UT: add unit tests for GetPreviousSerialid
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    
    http://bugs.koha-community.org/show_bug.cgi?id=7767
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 99c25135599c99bb1f1c83d390eca4628a26f4cf
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Thu Jan 9 17:06:14 2014 +0100

    BZ7677: New areas in subscriptions and new functions when receiving.
    
    When enabling the makePreviousSerialAvailable syspref, the previously
     received serial's itemtype is set as defined in the subscription.
     (Please note that the item-level_itypes syspref must be set to specific item.)
     It is also made available.
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    
    http://bugs.koha-community.org/show_bug.cgi?id=7767
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 259679e9dece15b69b216b8e39f8e4ebd0b58800
Author: Frédéric Demians <f.demians@tamil.fr>
Date:   Fri Sep 9 08:06:19 2016 +0200

    Bug 17281 Warning when saving subfield structure
    
    TO TEST:
    
    1. Home > MARC Framework > Default > Actions > MARC structure
    2. On 073 field (for example), click Edit
    3. Click on Edit subfield button
    4. Click on Save changes
    5. Take a look in intranet logs. You find:
       Use of uninitialized value in string eq at
       ../admin/marc_subfields_structure.pl
    6. Apply the patch, and repeat steps 3-5
       => no more warning in log
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1da2bceb851049521154fb37708761d28f7911e7
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Sep 12 09:09:59 2016 +0000

    Bug 16311 - Fix DBRev description
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5eaa1cb2ab37cdae3da638aad20e594884272380
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Sep 12 09:08:27 2016 +0000

    Bug 16311 - DBRev 16.06.00.024
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fc9279774f69e8eb10e9d26202b43252fc777f28
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Fri Sep 9 19:46:33 2016 +0300

    Bug 16311 - Advanced search language limit typo
    
    In the OPAC -> Advanced Search, the Language drop down menu incorrectly
    lists Romanian as "Român (Romanian)" while the correct value (as reported
    by Barry Cannon) is "Română (Romanian)".
    
    This patch fixes that:
    a) for _new_ installations by modifying
       installer/data/mysql/mandatory/subtag_registry.sql (loaded by the web
       installer when koha is installed), and also
    b) for _existing_ installations by adding an atomicupdate file in
       installer/data/mysql/atomicupdate/
    
    Test plan:
    1) In the OPAC, go to Advanced search (cgi-bin/koha/opac-search.pl).
    2) In the 'Language' drop down menu, observe that the value for Romanian
       is "Român (Romanian)".
    3) Apply the patch, and run installer/data/mysql/updatedatabase.pl.
    4) Refresh the Advanced search page in the OPAC. Confirm that the patch
       worked, i.e. the Language drop down menu lists Romanian as
       "Română (Romanian)" (notice the added 'ă').
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 777355089a3d10c7b72a4a21d9aaeb32ad8999f9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 14:24:31 2016 +0000

    Bug 17284 - Patron details page ( moremember.pl ) show logged in library as patron's home library
    
    The patron details page always show the logged in library as the
    patron's home library instead of the true home library. This bug is
    particular to moremember.pl and does not affect other patron pages.
    
    Test Plan:
    1) Find a patron with a home library other than the logged in library
    2) Note the patron home library as shown on moremember.pl matches
       the logged in library and not the patron's true home library
    3) Apply this patch
    4) Reload moremember.pl, the correct home library should display!
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bd0d1dd6b1eeb51540a6121c8ed84330e5f48eff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 7 10:26:12 2016 +0100

    Bug 17206: Fix switch to default framework
    
    When editing a bibliographic record, if you switch the framework to
    default, the page is reloaded but the framework is not changed.
    From the pl script, you can see that the frameworkcode is set to the one
    of the biblio if set to false. The empty string, which means default,
    should be taken into account.
    
    Test plan:
    - Create a record using the Fast add framework
    - Save the record
    - Open the record for editing
    - Use the "Settings" pull down to change the framework to default
    - Try another framework
    - Try changing to default from there
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6a78f6d0de242b0d6daa166a3b858ecbbb11371e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Sep 8 10:11:56 2016 -0400

    Bug 17194 - When edit record, Button "Z39.50/SRU search" not work
    
    Bug 15859 introduced a problem in the basic cataloging editor by
    removing a form field which the Z39.50 search button tries to use when
    triggering the search window pop-up. This patch corrects the error by
    changing where the script looks for the required framework code.
    
    To test, apply the patch and got to cataloging.
    
    - Edit a record which uses the default framework.
      - Confirm that the Z39.50/SRU search button works correctly to trigger
        the pop-up window.
    - Repeat the test with a record which uses a different framework.
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    Working again, great!
    
    Signed-off-by: Andreas Roussos <arouss1980@gmail.com>
    Patch works fine.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 989904c7ab0a24ddbe29264671fc8b5ebb175af2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Sep 12 08:58:02 2016 +0000

    Bug 6852 [QA Followup] - Tidy AddItem
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 48aba1533c7c55ed0f4b9e528ceccc9e0dd3d795
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Sep 8 12:06:05 2016 +0200

    Bug 6852: Staged import reports wrong success for items
    
    If we import items that have a wrong branch code, the items will not
    be imported but manage-marc-import reports them as imported. (A wrong
    branch code probably occurs most, but other causes are possible too.)
    
    The underlying cause is that AddItem does not look at the error
    returned from _koha_new_item in Items.pm.
    
    This patch deals with that omission in the most economical way. It adjusts
    AddItem so that it returns undef if no item was added.
    In ImportBatch.pm I check if an item was added and adjust the totals
    accordingly instead of just always counting them.
    
    Note: Several scripts like additem.pl use AddItemFromMarc to call
    AddItem. They do not report an error, but fail silently. With this patch,
    these scripts get undef and will still fail silently. (No change.)
    Adding error checks around calls of AddItemFromMarc is outside the scope of
    this report. Here we are taking care of correct imported item numbers.
    
    Test plan:
    [1] Verify that additem.pl still works by adding a new item.
    [2] Run t/db_dependent/Items.t
    [3] Add a new branchcode, say XXX.
    [4] Pick a biblio record with a few items (n) and set one item to branch XXX.
    [5] Export this biblio with items to a MARC file.
    [6] Change the XXX item to the original branch and remove branch XXX.
    [7] Import the MARC file. Verify that one item was not imported and that
        the number of imported items reflects that (equals n-1).
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b93ca8a281ae7522844fb05c790017e60ebda32d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Sep 9 16:35:49 2016 +0000

    Bug 8030 - (QA Folllowup) Use Koha::Libraries
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9f7a55f3f267e5ea731cc442c9834a497f5f5fd0
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Aug 22 15:43:57 2016 +0000

    Bug 8030 - (QA followup) Remove svc file no longer user Use animated gif for waiting as elsewhere Remove confirmation
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e46ff189992b5322d17aaad6ba3a69fb9bd9b716
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Aug 19 20:51:07 2016 +0000

    Bug 8030 (QA Followup) - Use REST api and provide feedback
    
    Use REST API
    If cancelled return to previous selection
    If fail return to previous selection
    Use fa spinning icon while waiting
    Disable select while waiting
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bc152d8ba2bde09efb45c3637197eb98084b4ccd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jul 1 15:27:19 2016 -0400

    Bug 8030 - Change pickup location of a hold from patron record
    
    To test:
    1 - Place some holds for a patron
    2 - Load the patron into checkout module
    3 - View thier holds tab, should have a dropdwon for location
    4 - Alter the location
    5 - You should recieve a confirmation box
    6 - Confirm that pressing cancel does not update holds
    7 - Confirm that pressing Yes does update the hold
    8 - Confirm that waiting holds are not updateable
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 85adee702147e7112ed41a440ad4f13d2ed9fd36
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 14:52:52 2016 +0000

    Bug 16911 [QA Followup] - No need to 'use C4::Members'
    
    For some reason, this is causing t/db_dependent/Circulation.t to fail if
    run independently.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1614ba843462cc19bddd39ffedebc2da29dc88f3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 9 12:32:16 2016 -0300

    Bug 15758: (QA followup) Remove leftover reference to C4::Branch
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e87cf98c2e9220f8a2fdcee39d60054a3ef6836e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Aug 17 13:43:01 2016 +0000

    Bug 15164 - Allow editing of the invoice number after initial saving
    
    When you notice a typo in your invoice number after finishing with the
    receiving process, the only way to correct it right now is in the
    database - or by undoing all the steps and starting over.
    
    It would be nice if the invoice number could be edited.
    
    Test Plan:
    1) Apply this patch
    2) Browse to acqui/invoice.pl for an invoice
    3) Note the new "Invoice number" field contains the existing invoice
    4) Alter the invoice number
    5) Save the invoice
    6) Note the invoice number has been updated
    7) Edit the invoice again
    8) Attempt to save the invoice with an empty invoice number field
    9) Note that you cannot save the invoice without having an invoice number
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d356e71ecbc5cfb3980d4593ed490b99fe909606
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Aug 15 14:54:16 2016 -0400

    Bug 13949 - Item search should have holding library
    
    This patch adds holding library ("current location") to the list of
    fields available in the item search form.
    
    To test, apply the patch and go to Search -> Item search.
    
    - Perform a search using the "current location" option and verify that
      it returns the correct results.
    - Try other searches to confirm that they work as before.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 68f84d9626747f6cf7e48ff812f07234bde73b2a
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Aug 29 06:33:08 2016 +0000

    Bug 17211: Remove use of onclick from OPAC fines page
    
    To test:
    1) Set the EnablePayPalOpacPayments syspref to Allow and the
    PayPalSandboxMode to the appropriate mode
    2) Go to OPAC fines
    3) Confirm clicking the PayPal image link works the same before and
    after the patch (opens pop up window)
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 974bcdf260dc1892a75e8798f76a2fd5d654a5a0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 25 10:41:52 2016 +0100

    Bug 17193: Remove C4::Search::SearchAcquisitions
    
    This subroutine is not used and can be removed
    
    Test plan:
      git grep SearchAcquisitions
    should not return any results.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 470d76c635a621907ea8fffa8850cac27e96ef34
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Aug 24 20:51:32 2016 +0000

    Bug 17191: Confirm message on deleting tag in OPAC
    
    Edit: removing use of onclick
    
    To test:
    1) Log into OPAC, go to your tags
    2) Click Delete
    3) Confirm message should pop up
    4) Ensure clicking Cancel works as expected, ensure clicking OK works as
    expected
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cc1c82edb6f1e7d93412ede157303e65d342e859
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 14:06:17 2016 +0000

    Bug 17187 - DBRev 16.06.00.023
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1f4ea9c627eea7b6330bcd8b56004f270afc9386
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Aug 24 15:45:54 2016 +0200

    Bug 17187: Lower the timeout preference from 139 days to 1 day
    
    Default timeout is now 12000000 seconds == almost 139 days !
    Surely, your session will be shorter. But we should lower this
    value.
    Balancing usability and security, I propose 1d (1 day) now.
    Current pref value will be affected only if it is NULL or equal
    to the old default.
    
    Test plan:
    Check your current value. Optionally change to NULL or 12000000.
    Run the dbrev and see what happens.
    Beware of cached values while testing or flush the cache.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b3b85da7bc6f1a712efb3435d597525ee4bd28cc
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Aug 24 03:43:22 2016 +0000

    Bug 17183: Check if any checkboxes have been checked for 'Delete Selected' button in Koha News
    
    To test:
    1) Go to Tools -> Koha News
    2) Click 'Delete selected' button without selecting anything
    3) Notice you are asked to confirm if you would like to delete ... but
    you didn't choose anything to delete
    4) Apply patch and refresh page
    5) Click 'Delete selected' button without selecting anything
    6) Should see alert.
    7) Select one or more news items to delete and click 'Delete selected'
    button
    8) Should be asked to confirm
    9) Confirm that the delete works as expected
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 836937b70146abc36490852d6373d3822af6fe84
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Aug 23 23:51:43 2016 +0000

    Bug 17174: Making z39.50 Authority search actions buttons
    
    Have changed the wording of the MARC button to Show MARC to be
    consistent with other places in Koha.
    
    To test:
    
    1) Go to Authorities -> New from Z39.50
    2) Put in any search terms and click Search
    3) Confirm that both options (MARC and Import) now show as buttons "Show
    MARC" and "Import" under one "Actions" column with approriate icons
    4) Confirm buttons work as expected
    5) Confirm buttons do not wrap on narrower browser
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cc4bcd85db21a570b49a4611781ac3dc1616b33e
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Aug 23 03:28:20 2016 +0000

    Bug 17165: Improve heading on vendor search when searching for all vendors in Serials
    
    To test:
    1) Go to Serials
    2) Click New subscription or edit an existing one
    3) Click Search for a vendor
    4) Make a search that will return no results (i.e. has a typo etc.)
    5) Confirm there is an appropriate message
    6) Go back and make a search that will return results (i.e. putting in one letter
        'a' etc.)
    7) Confirm that heading is worded better and search term is displayed
    8) Go back and make search without entering any search terms
    9) Confirm that heading is worded better, no search term is displayed
    
    Sponsored-by: Catalyst IT
    
    Patch behaves as dexcribed.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 159bf7dafca1d05be2301cfba70c9a3736fce709
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Aug 23 01:28:32 2016 +0000

    Bug 17163: Making MARC subfields structure actions buttons
    
    To test:
    1) Go to Admin -> MARC bibliographic framework
    2) Go to Actions -> MARC structure for any framework
    3) Click Subfields
    4) Confirm Edit and Delete links show as buttons with appropriate icons
    in one column called 'Actions'
    5) Confirm buttons do not wrap on narrower browser
    6) Confirm buttons behave as expected
    
    Sponsored-by: Catalyst IT
    
    Patch behaves as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b9cabb23c3e9b242b69a22464afe185496bdfb17
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Aug 23 01:22:05 2016 +0000

    Bug 17162: Moving MARC tags structure actions into a drop down menu
    
    To test:
    1) Go to Admin -> MARC bibliographic framework
    2) Go to Actions -> MARC structure for any framework
    3) Confirm that three links, Subfields, Edit and Delete, now show in
    drop-down menu with appropriate font awesome icons
    4) Confirm that Subfields takes you to the right page and Edit and
    Delete work as expected
    
    Sponsored-by: Catalyst IT
    
    Patch behaves as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8abf2e5a40789ea6ea6ceb068ab290a152d783f1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 9 11:26:03 2016 -0300

    Bug 11921: (followup) Don't die on non-existent koha-conf.xml
    
    This patch wraps the XMLin call on an eval block. It also adds unit
    tests (mocked) for Koha::Config->read_from_file()
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0f516c7efbad8b29f70dd950f4fe6b5f01e7abee
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 23 13:49:06 2016 +0100

    Bug 17161: Add missing td tag
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9dcebe402ad8d8d39c78ae39650eda22197a92a4
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Aug 23 00:02:56 2016 +0000

    Bug 17161: Making 'Preview MARC' links show as buttons in batch record modification
    
    This patch removes the column heading and makes all links show as font
    awesome buttons. I have also changed the wording from Preview MARC to
    Show MARC to shorten the button and be consistent with other places in
    Koha
    
    To test:
    1) Go to Tools -> Batch record modification
    2) Put in some record numbers and click Continue
    3) Ensure column heading 'Preview' no longer shows, and buttons are
    showing with an appropriate icon. Confirm button still works as
    expected.
    4) Confirm button does not wrap on narrower browser
    
    Sponsored-by: Catalyst IT
    Works as described
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 247486b7854d0ee9ed0e1f0921f63527127be0dd
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jul 18 14:44:13 2016 -0400

    Bug 16938: Remove the use of "onclick" from batch patrons modification template
    
    This patch revises the batch patrons modification template, removing
    "onclick" attributes from the markup and defining those events in the
    script.
    
    To test you should have at least one extended patron attribute
    configured.
    
    - Apply the patch and go to Tools -> Batch patron modification.
    - Submit a batch of patrons for modification.
    - Confirm that the checkbox next to any required field is disabled.
    - Select a date in the registration date and expiry date fields. Confirm
      that the "Clear" link next to each empties the correct field.
    - Click "New" next to a patron attibute. A copy of the patron attribute
      line should be created.
    - Click "Delete" next to a cloned patron attribute. The correct line
      should be removed.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a4e4c975217f0aa36ea8265a314eabba13d37f00
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 12 08:09:50 2016 +0200

    Bug 17110: Add unit test for MaxAge parameter in Token.t
    
    Test plan:
    Run t/Token.t
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6107e91f142f1498e718365fd8be09a18168e700
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Aug 11 15:25:44 2016 +0200

    Bug 17110: Lower CSRF expiry in Koha::Token
    
    Default expiry in WWW:CSRF is one week.
    This patch sets it to 8 hours by default in Koha, and allows to
    change the expiry period individually by passing MaxAge.
    
    Test plan:
    [1] Put items in your cart.
    [2] Apply the example patch too.
    [3] Send the cart from opac within the allotted 10 seconds.
    [4] Send again, but wait some 10 seconds before submitting. Too late!
    
    Tested 3 patches together, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 130733a0130d4cf2e522956165ee1d2c0557cceb
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Aug 16 14:20:36 2016 +0200

    Bug 17109: [QA Follow-up] Die when wrong token
    
    Removes template var csrf_error and associated handling.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Restested with opac and intranet: Still sends or dies elegantly..
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1a3b92bc76c3db628d2ffcf6d086840952ad9283
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 12 08:29:42 2016 +0200

    Bug 17109: Use Koha.Preference in sendbasket template
    
    No need to send OPACBaseURL to the template, if you load the Koha TT
    plugin inside the template.
    
    Test plan:
    Send a few items in your cart from OPAC and intranet.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dc4617ba3b57913123689b7bb9cf1342fcc7c84c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Aug 11 14:17:14 2016 +0200

    Bug 17109: Add CSRF token to [opac-]sendbasket
    
    If you have no (valid) token, you will not be able to send the message.
    
    Test plan:
    [1] Verify if you can still send the cart from opac and intranet.
    [2] While still being logged in, try to send the cart from opac by
        using the following URL:
        /cgi-bin/koha/opac-sendbasket.pl?email_add=you@somedomain.com&comment=csrf_test&bib_list=doesnotmatter&csrf_token=justsomeguess12345
        This should now result in a csrf error.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 36b9fa32b16d5928dd9a35b04ff2144b4f77f314
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Aug 11 13:10:21 2016 +0200

    Bug 17109: Remove second authentication from (opac-)sendbasket
    
    Patch deals with opac and intranet variant.
    If we authenticated the first time, it is not necessary to do it
    a second time rightaway.
    
    Replaces a call to get_template_and_user (including checkauth) by
    gettemplate.
    
    Also removes duplicate use C4::Biblio statements.
    
    Test plan:
    [1] Put a few books in the cart.
    [2] Send the cart from OPAC.
    [3] Send the cart from intranet.
    
    Tested 3 patches together. Works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a9d3eb233bffab3b974e51f34adf502548341c3c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 08:46:33 2016 +0100

    Bug 17099: C4::Koha - Remove GetSupportName and GetSupportList
    
    Since bug 9468, these 2 subroutines are no longer in used and can be
    removed.
    
    Test plan:
      git grep GetSupportName
    and
      git grep GetSupportList
    should not return entries (unless 1 in release notes)
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87d53fa2e5a9db74a95b7aad0a30033f05c64f8a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Aug 1 11:15:33 2016 -0400

    Bug 17012 - Remove more event attributes from administration templates
    
    There are several administration templates which still contain event
    attributes. This patch move event definition to the JavaScript.
    
    To test you must have the SMSSendDriver system preference set to
    "Email." Apply the patch and go to Administration.
    
    - In Global system preferences, change the value of any input or select
      and then click the "Cancel" link for that section. After confirming
      your choice, the page should reload with your changes reset.
    
    - In Circulation and fine rules, edit any existing rule. In the editing
      row, click the "Clear" button. The data for that rule should be
      cleared.
    
    - In Transport cost matrix, make any change to the matrix. Submitting
      the form should work correctly.
    
    - In MARC bibliographic framework, choose 'MARC structure' for any
      framework.
      - Checking or unchecking the 'Display only used tags/subfields'
        checkbox should reload the page and change the display according to
        your choice.
    
    - In Did you mean?, make changes to the existing configuration.
      - Clicking "Cancel" should reload the page and discard your changes.
      - Clicking "Save configuration" should correcly save your changes.
    
    - In SMS cellular providers, click to edit any existing provider.
      Clicking the "Cancel" link should cancel the editing process and
      return you to the list of providers.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8984ea2f411227e8b7261fd1df53341005a14441
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jul 28 14:33:16 2016 -0400

    Bug 16995 - Remove event attributes from two include files
    
    This patch removes event attributes from two include files:
    cat-toolbar.inc and members-toolbar.inc.
    
    In cat-toolbar.inc an unused <form> tag with an "onsubmit" attribute has
    been removed.
    
    To test, apply the patch and:
    
    - View the detail page for any bibliographic record. All toolbar buttons
      ("New," "Edit," "Save," etc.) should work as expected.
    - View the detail page for any patron. Click the "Add message" button in
      the toolbar. Selecting a predefined note should correctly populate the
      textarea with your selected message.
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8b89364b38cc95b2f3cca852eb6199b8130e1379
Author: Nicole C. Engard <nicole@bywatersolutions.com>
Date:   Tue Jul 26 16:02:32 2016 +0000

    Bug 16981: Add EDI Admin to Acq Menu
    
    This patch adds the links to EDI Accounts and Library EANs
    to the menu on the left of the Acq module.
    
    To test:
    * Log in to Koha
    * Visit Acquisitions
    * Confirm that EDI links show on the menu on the right
      if you have permissions to access EDI.
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1b43b3d7acaf04e1822cdb199946aa04215b84fb
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 13:26:20 2016 +0000

    Bug 16978 - DBRev 16.06.00.022
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b2ba2fa5ef2994f06cb583d6a82ee4fcb72fcc0e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon Aug 1 19:38:10 2016 -0400

    Bug 16978: Followup - Copy create_report permissions for delete_report
    
    This patch should deal with comment #6's point of where a user who
    has create, but not execute permissions, would lose delete ability.
    Users with create and execute permissions would already have delete
    as well.
    
    TEST PLAN
    ---------
     1) Back up db
     2) drop database koha_library;
     3) create database koha_library;
     4) web install with all sample data with system user
     6) log into staff client as system user
     7) make sample koha admin user a superlibrarian
     8) set username and password for sample koha admin user
     9) log out and log in as koha admin
    10) Create a user (USER_A) with permissions:
            create_reports   and execute_reports.
    11) Create a user (USER_B) with permissions:
            create_reports,  but not execute_reports.
    12) Create a user (USER_C) with permissions:
            execute_reports, but not create_reports.
    13) Create a user (USER_D) with no report permissions.
    14) Run the atomic update.
    15) Check USER_A permissions
        -- should have delete_reports
    16) Check USER_B
        -- should have delete_reports
    17) Check USER_C
        -- should NOT have delete_reports
    18) Check USER_D
        -- should NOT have delete_reports
    19) run koha qa test tools
    20) restore db
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f56d6530bc7ea00db0d2b158a8b2667d5ba16a41
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Jul 26 09:50:52 2016 -0400

    Bug 16978: Add delete reports user permission
    
    This splits off the delete capability from the create reports permission.
    From a UI perspective there were CSS issues, that this patch set hackily
    bypasses. Perhaps someone else can amend this enhancement with the required
    changes so that the extra column at the beginning of the table can be
    removed when the user does not have delete capability.
    
    TEST PLAN
    ---------
    1) back up db
    2) apply patch
    3) ./installer/data/mysql/updatedatabase.pl
       -- should run without issue.
    4) in mysql:
       > drop database ...
       > create database ...
       -- totally blanks it for fresh web install
    5) run web install
       -- installing should have no issues
    6) go to a patron
    7) set permissions
    8) expand the reports permission
       -- should have delete reports now
    9) click help and scroll down to
       'Granular Reports Permissions' right at the bottom.
       -- there should be a new delete_reports section
    10) Head over to guided reports and build a few reports.
        -- as system account user, delete stuff should all be visible.
    11) Find a patron, set all permissions, except delete reports.
    12) log out and then log in as the modified patron
    13) Head over the save reports
        -- none of the delete options should be available to the user.
    14) run koha qa test tools
    15) restore db
    
    Followed test plan. Additionally tried to delete using params in URL
    (not possible, OK)
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c585c9cf9d1bb1792741bbb0f36e3bc6bcde68b3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jul 22 15:24:03 2016 -0400

    Bug 16968 - Remove the use of "onclick" from serial patron and vendor search templates
    
    This patch removes instances of "onclick" from the serials templates for
    patron and vendor search.
    
    To test, go to Serials and click "New subscription."
    
    - In the new subscription form, click the "Search for a vendor" link.
    - In the popup, search for a vendor. Confirm that clicking "Choose"
      selects the correct vendor.
    
    - From the detail page of an existing subscription, click "Create
      routing list."
    - Search for a patron and test that the "Add" button in search results
      works correctly to add patrons to the routing list.
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1fccc1ea5d6e753fb689c83d12764e3c599e0b5e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jul 22 11:32:54 2016 -0400

    Bug 16963 - Remove the use of "onclick" from subscription add template
    
    This patch removes the use of event attributes from the subscription add
    template and the template for testing prediction patterns. Events are
    now defined in the JavaScript.
    
    To test, go to Serials -> New subscription.
    
    - Test that the "Search for vendor," "Search for record," and "Create
      record" links work correctly.
    - Test the "Next" button without entering a vendor or a biblionumber.
      You should be warned about selecting a vendor and biblionumber.
    - After selecting a bibliographic record to link to the subscription,
      click the "Next" button. The second section of the subscription add
      form should be displayed.
    - Under frequency, choose "1/day."
    - Confirm that the "Show advanced pattern" link correctly toggles
      display of the advanced pattern form.
    - Under the advanced pattern form, test the "Modify pattern" button. It
      should enable editing in the form.
    - Test the "Cancel modifications" and "Save as new pattern" buttons.
    - Test the "Test prediction pattern" button.
      - In the "Prediction pattern" box, test that the checkboxes next to
        each day of the week, when checked, trigger the corresponding issue
        number to be marked as "not published."
    - Finally, confirm that your subscription is saved correctly.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 031219935c41643734de7836ed86b59ed6be5fd1
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Jul 20 23:39:42 2016 +0000

    Bug 16950: Serials subscriptions advanced search shows '0 found' pre-search
    
    To test:
    1) Go to Serials
    2) Click Advanced Search in the toolbar at the top
    3) Notice heading says Serials subscriptions (0 found) before a search has even happened
    4) Apply patch and click Advanced Search again
    5) Heading should now say Serials subscriptions search
    6) Submit search
    7) Heading should say how many subscriptions your search found (like before)
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit df1fb7540433a6a35736f5ffb74ac53a79d4ee02
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jul 20 10:51:30 2016 -0400

    Bug 16946 [Revised] Remove the use of "onclick" from several serials templates
    
    This patch modifies several serials module templates to remove the use
    of event attributes. Events will now be defined in JavaScript.
    
    Also changed:
    
    - In Serials -> Check expiration, custom form validation has been
      removed in favor of validation with the plugin.
    - In Serials -> Claims, the "Clear filter" button has been replaced with
      a link. Error messages are now styled with the standard "alert" class.
    - In Serials -> New subscription -> Search for record, the "choose" link
      is now a Bootstrap button. Pagination links are now styled like other
      similar links. The "Close" button is now styled as in other popup
      windows. The "no results found" messages is styled as an informational
      dialog.
    - In Serials -> Subscription -> Edit routing list, the "add recipients"
      and "delete all" controls are now links with Font Awesome icons.
    
    To test, apply the patch and:
    
    - Go to Serials -> Check expiration.
      - Try to submit the form without filling in a date. The form
        validation plugin should warn you that the date field is required.
      - Submit the form using data which will return results.
      - Click the "Renew" button for any result. The subscription renewal
        popup should be triggered for the correct title.
    
    - Go to Serials -> Claims.
      - Select a vendor with missing issues.
      - Confirm that the date filter works correctly, and that the "Clear
        filter" link works.
      - Select one or more result and click the "Send notification" button.
        The notification should be sent.
    
    - Go to Serials -> New subscription.
      - Click the "Search for record" link to trigger the bibliographic
        search popup.
      - Perform a search. Confirm that the "Choose" button selects the
        correct record and populates the fields in the parent window.
    
    - Go to Serials -> Subscription -> Edit routing list.
      - Confirm that the process of adding recipients to the list works
        correctly.
      - Confirm that changing the rank of any recipient works correctly.
      - Save the routing list and click the "Save and preview routing slip"
        button on the confirmation page. The slip preview should open.
      - In the slip preview window, test that the print button works
        correctly.
    
    Signed-off-by: Aleisha <aleishaamohia@hotmail.com>
    
    QA revision: Removed stray '// -->' and corrected clear filter function
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 75d7a8c07f6fea51090fe5fd4be89a78bd10ab74
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jul 12 11:55:51 2016 -0400

    Bug 17112: Action buttons for course reserves detail page
    
    This patch revises the edit and delete buttons on the course reserves
    detail page so that they are styled as Bootstrap buttons with Font
    Awesome icons.
    
    To test, apply the patch and choose or create a course reserve which has
    in it at least one lost item and at least one item which is checked out.
    
    - In the list of items on the course reserve detail page, confirm that
      the 'Edit' and 'Delete' buttons are correctly styled.
    - Confirm that for the checked out item the delete button is disabled.
      Hovering over the button should trigger a tooltip. Clicking the button
      should trigger an alert.
    - Confirm that for the lost item the same is true.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Buttons styled as Bootstrap. Works as expected.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit caf6102db8e0e7fbb75be2c8c90b7ff07001a9f8
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jul 18 12:20:33 2016 -0400

    Bug 16937 [Revised] Remove "onclick" from the manage staged MARC records template
    
    This patch revises the manage staged MARC records template, removing
    "onclick" attributes from the markup and defining those events in the
    script.
    
    To test, apply the patch and go to Tools -> Manage staged MARC records.
    
    - If necessary, stage a MARC file for import.
    - Click the name of the staged file and then the "Import this batch into
      the catalog" button. The batch should be correctly imported.
    - Return to the list of staged MARC files.
    - Click the name of an imported file and then the "Undo import into
      catalog" button. The import should be reverted.
    - Return to the list of staged MARC files.
    - Click the "Clean" button for any record. Confirm that the batch is
      cleaned.
    - For any cleaned record, click the "Delete" button. The batch should be
      deleted.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    QA revision: Corrected class name so that "delete" button triggers the
    correct warning.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 453e8e723508463f57577bbbc21a4ea7cc4befb7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 11 22:06:46 2016 +0100

    Bug 16908: Koha::Patrons - Remove GetSortDetails
    
    This subroutine was only used in one script and its job is the same as
    GetAuthorisedValueByCode.
    It's better to use the AuthorisedValues TT plugin to retrieve AV
    descriptions.
    
    Test plan:
    Edit a patron with sort1 and/or sort2 defined.
    On the patron details page (members/moremember.pl) you should see the
    sort1 and/or sort2 info displayed.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d8aae99a1cf69a019139debbbb18906956b0702a
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Jul 7 23:26:12 2016 +0000

    Bug 16875: OPAC - removing link to records if authority is not used by any records
    
    To test:
    1) Do an authority search. Notice that authorities not used by any records have a clickable link (under Biblio records) which redirects to a catalog search with no results
    2) Go back to the authority search and click View full heading for an authority with no records. Notice that under the auth name, it says Number of records used in: 0, with a link to a catalog search
    3) Apply patch
    4) Repeat steps 1 and 2. Authorities not used in any records should no longer have clickable links nd authorities which have records should work as expected.
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4d417521c0c51d9b65da6e274db4e1c5be29cc1d
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Jul 7 22:20:55 2016 +0000

    Bug 16874: Making serials collections actions buttons
    
    To test:
    1) Go to serials -> Search a subscription (or make a new one)
    2) Ensure that subscription has an end-date that has passed or will pass soon
    3) Go to Serials collection (left sidebar menu)
    4) Ensure that Subscription summary table has two buttons, Create routing list and Renew. These buttons should be bolded and the table cell highlighted
    5) Ensure 'Print list' is a button in year tables below
    6) Edit subscription to have a later end-date (will not expire soon)
    7) Go back to serials collection
    8) Ensure that table cell is no longer highlighted and buttons not bolded. Renew button should not be there.
    9) Ensure that both buttons do not wrap when the browser is narrow
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 33f670f5b314c2e73567ce0cbc7bcd2302127634
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Jul 4 01:34:19 2016 +0000

    Bug 16842: Help for EDI accounts
    
    To test:
    
    1) Go to Admin -> EDI accounts
    2) Click Help in top-right corner
    3) Confirm that Help window opens with appropriate help text
    4) Confirm links work as expected
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Fixed link to the manual: cat -> acq
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9e477baa5eec37719a184812b3aeb12025176437
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 13:00:09 2016 +0000

    Bug 17032 [QA Followup] - Update path to swagger.json file
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 09a76c0f8f97adde937fb9b8922be665e61835f4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 5 11:21:34 2016 +0100

    Bug 17032: Remove warning "keys on reference is experimental"
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 07cfcc77c580e8a16a9f12982525c5b1f6ff8c38
Author: Lari Taskula <larit@student.uef.fi>
Date:   Wed Aug 3 14:55:08 2016 +0300

    Bug 17032: Make sure Swagger object definition is up-to-date with Koha-object
    
    If a definition in api/v1/definitions/*.json has a corresponding Koha-object by
    filename, compare properties of the definition and columns of the Koha-object
    and ensure that all columns are defined inside properties of the definition.
    
    To test:
    1. Run t/db_dependent/api/v1/swagger/definitions.t
    2. See that all of the tests pass. (If not, file a bug report to fix missing
       properties in the Swagger definition.)
    3. Remove a property from api/v1/swagger/definitions/patron.json
    4. Repeat step 1
    5. See that test fails and lets you know that the property you just removed
       is missing from the definition.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0a92669c229a04dc50b17569ae5d0c132a983fe2
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Jul 4 01:24:58 2016 +0000

    Bug 16841: Help for library EANs
    
    To test:
    
    1) Go to Admin -> Library EANs
    2) Click Help in top-right corner
    3) Confirm that Help window opens with appropriate help text
    4) Confirm link to manual works as expected
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Katrin Fischer <Katrin.Fischer.83@web.de>
    Fixed link to the manual.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7293d812904ec0bae78d5ced5afd6c879063912f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Aug 1 10:20:00 2016 -0400

    Bug 17011 - Remove "onblur" event attribute from some templates
    
    Several templates have an "onblur" event attribute in the markup. This
    patch moves the onblur event definition into the JavaScript.
    
    To test, apply the patch and clear your browser cache if necessary.
    
    In Administration -> Authority types:
    
      - Choose "New authority type."
      - Enter any text into the "Authority type" field.
      - Moving the cursor focus away from this field should convert your
        text to uppercase.
    
    In Administration -> MARC bibliographic framework:
    
      - Choose "New framework."
      - Enter any text into the "Framework code" field.
      - Moving the cursor focus away from this field should convert your
        text to uppercase.
    
    In Administration -> Currencies and exchange rates:
    
     - Choose "New currency."
      - Enter any text into the "Currency" field.
      - Moving the cursor focus away from this field should convert your
        text to uppercase.
    
    In Administration -> Item types
    
     - Choose "New item type."
      - Enter any text into the "Item type" field.
      - Moving the cursor focus away from this field should convert your
        text to uppercase.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4e52b81247b852f9cda9838825148bb2696dc064
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Apr 26 14:09:58 2016 -0400

    Bug 16738 - Improve EDIFACT messages template
    
    This patch makes several improvements to the EDIFACT messages template
    to make it more consistent with similar interfaces in Koha. Changes to
    edimsg.tt are made to simplify the display of the data in a modal.
    
    This patch also corrects a couple of markup errors.
    
    To test you must have multiple rows of data in the edifact_messages
    table. I tested with dummy data I inserted manually. Should should have
    some rows which use 'QUOTE' and 'ORDERS' as the message_type.
    
    To test deletions you may need to apply the patch for Bug 16737.
    
    - Apply the patch and go to Acquisitions -> EDIFACT messages.
    - In the table of messages, the date should be displayed according to
      your system preference.
    - Sorting by date should work correctly regardless of date format
      setting.
    - The 'Actions' column should contain 'View message' and 'Delete'
      Bootstrap-style buttons with Font Awesome icons. The column should be
      unsorted.
    - Clicking the 'Delete' button should prompt you to confirm.
    - Clicking the 'View message' button should trigger a modal which loads
      the message data.
    - Test the page with no messages or when all messages have been
      deleted. The page should display a standard message dialog instead of
      an empty table.
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7ac1bc35372990520a7c67870b2c702c41bbebcc
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jun 27 15:56:58 2016 +0000

    Bug 16685 [QA Followup] - Use Path::Tiny::slurp instead of File::Slurp
    
    Path::Tiny::slurp is considered better to use than File::Slurp.
    
    RM Note: The package version in wheezy is too old, the package version
             in jessie is just fine and should be added to the community
             repo if wheezy will be supported for the coming release.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 954ed8053490ed735429b0ca5efd9b6c00d832d5
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jun 7 14:07:19 2016 +0000

    Bug 16685 - Use eval instead of do for .perl atomicupdates
    
    If we use eval instead of do for our .perl atomic update files, it will
    allow developers to put in the exact code that should go into
    updatedatabase.pl. The problem with do is that none of the variables
    defined in updatadatabase.pl are available, whereas with eval they are.
    
    Test Plan:
    1) Apply this patch
    2) Create a .perl file in atomicupdates with the following in it:
    say "DBversion: $DBversion";
    3) Run updatadatabase.pl
    4) Note the output
    5) Add a syntax error to your atomic update
    6) Run updatedatabase.pl
    7) Note the error is displayed
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 748ad2355ea3dd4e404ec664b0d50b544db179e6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 25 16:10:34 2016 +0100

    Bug 16586: [QA Follow-up] Simplify code
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Amended this patch: Replaced none by any. Exists test adjusted.
    This effectively makes the test pass.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3cb3836ee035f40f110f26f40d6d9fe4ebd0e3a0
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jul 26 13:54:31 2016 +0200

    Bug 16586: [QA Follow-up] Add test for two metadata conditions
    
    Run the test and see..
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a3a1ec57aaa3b008cc21a0150f08ab1a4248c179
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed May 25 13:37:49 2016 +0200

    Bug 16586: Koha Plugins: Limit results of GetPlugins by metadata
    
    It would be helpful if we could find a plugin based on some metadata
    tag as returned by the plugin. This extends the use of GetPlugins that
    already supports searching on method.
    
    GetPlugins is used in: admin/edi_accounts.pl, plugins/plugins-home.pl and
    tools/stage-marc-import.pl. The changes in these three scripts are
    minimal and just related to parameter passing.
    
    Test t/db_dependent/Plugins.t includes another test for GetPlugins. In this
    regard a metadata tag has been added to t/Koha/Plugins/Test.pm.
    
    NOTE: This adjustment will also be used in a redesign for bug 15545.
    
    Test plan:
    Run t/db_dependent/Plugins.t.
    Enable pref UseKohaPlugins and config var enable_plugins.
    Go to plugins-home.pl. Verify that it still lists your plugins.
    Bonus: Check edi_accounts or stage-marc-import.pl if you have a working
    plugin for that.
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b118074fe480ac2028d474d322713303648eb7d0
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 24 09:18:37 2016 -0400

    Bug 16576 [Revised] Remove the use of "onclick" from label templates
    
    This patch updates several label creator templates to remove the use of
    "onclick" in favor of defining click events in JavaScript.
    
    Also changed:
     - Replaced the non-existant element <icon> with <i>
     - Removed the use of <center> and 'align="center"';
     - In the item search results template:
       - The use of the checkboxes jQuery plugin has been replaced with
         straight jQuery for simplicity's sake.
       - Output of table headers has been modified so that translatable
         strings are in the template instead of having English strings
         passed from the script.
       - Moved the 'Add checked' and 'Done' buttons into a floating toolbar.
    
    To test, apply the patch and go to Tools -> Label creator.
    
    - Choose New -> Label batch
      - Click 'Add items'
        - Perform a search for items.
        - Confirm that 'select all' and 'clear all' links work.
        - Confirm that clicking an individual 'Add' button works.
        - Select multiple items and click the 'Add checked' button. Confirm
          that the selected items were added to your batch.
      - Click 'Add items' again to save the selected items to your batch.
      - Test that the 'Delete' and 'Export' buttons next to any item work
        correctly.
    - Choose Manage -> Label batches
      - Test that the 'Delete' button works correctly.
      - Select one or more batches and test that the 'Export selected'
        button works correctly.
    
    Revision: Removed changes to pagination in the item search results
    template since it didn't work.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7da5fb81758777d4e8000c9688fab2814e82506d
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Jun 30 00:03:23 2016 +0000

    Bug 16507: Show play media tab first if record has no holdings
    
    To test:
    1) Go to Admin -> Global sysprefs
    2) Turn on HTML5MediaEnabled and HTML5MediaYouTube
    3) Go to Cataloging and create a new record
    4) Catalogue a YouTube link in 856$u and save record. Do not add any items (click Normal tab)
    5) Confirm that Play media tab is the selected tab by default
    6) View record on OPAC and confirm Play media tab is selected by default
    7) Go back to staff client, add an item then go back to Normal tab
    8) Confirm that Holdings tab is now selected by default
    9) Confirm Holdings tab is selected by default on OPAC
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b8046995ee28538f15e22cd8d9781171d0057463
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 12:04:50 2016 +0000

    Bug 16275 - DBRev 16.06.00.021
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 23d5d0fbd37ea1d9598487c368db4424e4f281e4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Apr 23 17:01:24 2016 +0100

    Bug 16275: Do not allow a self registration with an existing email address
    
    To avoid multiple registrations, it would be good to check the unicity
    of the primary email address.
    This patchset adds a new pref PatronSelfRegistrationEmailMustBeUnique.
    If on, a patron will get "This email address already exists in our
    database" if he try to register with an existing email address.
    
    Test plan:
    1/ Register a new patron with an email address
    2/ Make an other registration using the same email address
    => With the pref PatronSelfRegistrationEmailMustBeUnique on, you won't be allowed
    => With the pref off, no change should be noticed.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Work as described, no errors.
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f835f1f3bd939f13088904e426601fb98e9e767a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Apr 23 16:45:04 2016 +0100

    Bug 16275: Add the new pref PatronSelfRegistrationEmailMustBeUnique
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    No errors
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 884954f977e4df701d7b458e48f7d12e77c8eed9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 11:53:32 2016 +0000

    Bug 16272 - DBRev 16.06.00.020
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c4ab843429ae56df34c69b3ed76a77fe9b7d3fb2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Aug 18 16:33:00 2016 +0000

    Bug 16272 [QA Followup] - Indexer fails on indexing temparary testing records
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c4fcb0d2a1855d8503a7584e8d7ff053af56aa25
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 16 16:59:38 2016 +0100

    Bug 16272: Add description for tests
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 666f79ed7412e495726ff65fa4b03f9286abbc97
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 16 16:52:27 2016 +0100

    Bug 16272: (follow-up) Specific case when switching an on-site checkout to a regular checkout
    
    Same as previous patch but if another circ rule exists
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fe563f591102ce54ddcceed443cf8b32d88adf0f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 21 21:42:11 2016 +0100

    Bug 16272: Specific case when switching an on-site checkout to a regular checkout
    
    In the case on-site checkouts are considered as a regular checkout in issuing
    rules (i.e. ConsiderOnSiteCheckoutsAsNormalCheckouts is on):
    When after the on-site checkout the maximum limit of checkouts is
    reached and the patron wants to switch an on-site checkout to a regular
    checkout, the C4::Circulation::TooMany subroutine will return a
    TOO_MANY_CHECKOUTS error.
    To avoid that, we need to allow an extra checkout in this subroutine.
    
    Test plan:
    0/ Switch ConsiderOnSiteCheckoutsAsNormalCheckouts and
    SwitchOnSiteCheckouts on
    1/ In the issuing rules, set the total number of checkouts (maxissueqty)
    to 2 and the number of on-site checkouts to 2 (maxonsiteissueqty)
    2/ Check 2 items out ticking the 'on-site checkout' checkbox
    3/ Check one of these items out, to automatically switch it to a regular
    checkout
    => The checkout should be allowed.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e018b69dca6e702c4abd2fd58e6e99868eada9aa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 21 11:00:20 2016 +0100

    Bug 16272: Automatically switch an on-site checkout to a regular checkout when checked out
    
    Use case: A patron checks some items out on-site and want to take it home.
    To facilitate the librarian work the checkout is directly switched from
    on-site to regular when checked out if the new pref SwitchOnSiteCheckouts is on.
    
    Test plan:
    0/ Let the new pref SwitchOnSiteCheckouts off
    1/ Checkout one items to a patron and tick the "on-site checkout"
    checkbox
    2/ Check the same item out without ticking the "on-site checkout"
    checkbox
    => You should get "This item can not be renewed, it's an on-site checkout"
    3/ Switch the pref on
    4/ Repeat 2
    => The on-site checkout should be automatically switched to a regular checkout
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    With small changes to apply to master.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d57d09549eae73b425ce977ed1748f962d42c9e6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 7 11:38:43 2016 +0100

    Bug 17222: Use jQuery selector instead
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 167be41dcc42f8456a69700475eb927593f78fb2
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Aug 29 23:22:11 2016 +0000

    Bug 17222: Remove use of onclick from OPAC member entry page
    
    There is only one instance on onclick here, and that is the clear date
    function.
    
    To test, make sure clicking 'Clear date' next to Date of Birth works the
    same before and after the patch.
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 80981941256bab8ea5f921b7411d254c918e6b3a
Author: Lee Jamison <ldjamison@marywood.edu>
Date:   Mon Aug 29 16:24:49 2016 -0400

    Bug 17220: Change hold confirmation string from 'Place hold' to 'Confirm hold'
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1c80cef03260351ef8b2f129e10c01f88986875a
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Jul 4 01:41:57 2016 +0000

    Bug 16843: Help for EDIFACT messages
    
    To test:
    
    1) Go to Acqui -> EDIFACT messages
    2) Click Help in top-right corner
    3) Confirm that Help window opens with appropriate help text
    4) Confirm link to manual works as expected
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f246af0adf900456d34fcd4abdcbeeae64c81027
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 7 11:19:15 2016 +0100

    Bug 17210: Add missing return false for print-large
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac44b732e871808dab5e581f6ac6c4371dcef8b0
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Aug 29 06:07:53 2016 +0000

    Bug 17210: Remove use of onclick from biblio detail sidebar in OPAC
    
    Four instances of onclick here:
    1) Print
    2) Save to your lists
    3) Add to your cart
    4) Remove from cart
    
    To test:
    Find a biblio detail page in OPAC and confirm all four events above work
    as expected before and after the patch.
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6378027fd29cf0b208850a4bff33b7c81f51f35d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jul 28 08:43:48 2016 +0200

    Bug 16365: [QA Follow-up] Add some comment lines to Cache.pm
    
    Resolve typo inifinite too.
    Adds a few lines in order to stress that the thawed key of the L1
    cache SHOULD ONLY be used for unsafe calls, and not be mixed with
    regular (safe) calls.
    
    Test plan:
    Nothing to test, but verify the quality of the added comments.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 82ffd2812c94760e080a400007c803819f0618be
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jul 28 10:29:18 2016 +0200

    Bug 16365: Adding additional unsafe call-candidates from Acquisition
    
    [1] Candidate 1 is FillWithDefaultValues.
    This routine in Acquisition.pm does not autovivify the tagslib
    structure but first collects the keys at tag and subfield level.
    So, unsafe can be safely added here :)
    
    [2] Candidate 2 is script acqui/neworderempty.pl.
    It only (!) uses GetMarcStructure to know if there is a ACQ framework.
    There should be cheaper ways to do it, but when we use the fast cache,
    it does not matter that much anymore.
    
    [3] Candidate 3 is script acqui/orderreceive.pl. Same reason as [2].
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested with neworderempty.pl
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2b84e18575efbd5edb0552a016f1a4aab3093444
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Wed Jul 27 11:38:00 2016 +0200

    Bug 16365 - GetMarcStructure() "unsafe" variant in PrepareItemrecordDisplay()
    
    This sub is a good candidate for the "unsafe" treatment too, it doesn't
    modify nor autovivify anything in the marc structure.
    
    Added a warning in the code regarding the $tagslib usage by the
    custom item plugins, plus a small change to prevent possible
    "Use of uninitialized value" warnings in the future.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested with neworderempty.pl and itemrecorddisplay.pl.
    Amended slightly: Made warning less dramatic.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7bdc106c986fb2ca57426797b3f9b85d2abab4a3
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Wed Apr 27 13:19:10 2016 +0200

    Bug 16365: Selectively introduce GetMarcStructure() "unsafe" variant for better performance
    
    GetMarcStructure() currently uses Koha::Cache in the "safe" mode
    (returning deep copy of the result data structure by default), which
    causes numerous performance issues in many Koha scripts. Switching
    it to the "unsafe" mode globally (2nd patch from Bug 16140) resolves
    those issues, but ensuring that it is regression-free (and that it
    will stay that way in the future) is far from easy. This patch
    proposes a bit more manageable solution, it introduces
    a possibility to use "unsafe" variant selectively (only in those
    places in the code where GetMarcStructure() is called repetitively).
    That way, amount of the code that needs to be audited for possible
    problems gets vastly reduced, without any performance trade-offs.
    
    Test plan:
    1) Have a look at the code and audit the parts affected by this patch
    for possible regressions
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Amended the POD of GetMarcStructure, removing a TODO.
    
    NOTE: GetAuthorisedValueDesc, as called in C4::XSLT::transformMARCXML4XSLT
    and by GetISBDView, GetMarcAuthors in C4::Biblio, may autovivify some hash
    entries in tagslib.
    Same for Koha/Filter/MARC/ViewPolicy.pm, sub filter.
    
    No reason however to worry; our use of this structure in Koha does not
    depend on the existence of intermediate hash keys. (We seem to be safe as
    long as $tagslib->{$tag}->{$subfield}->{tab} and/or hidden are not filled.)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d6fba2e2f35a840c9cff8b0c05869e0a21ca09e2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 10:38:43 2016 +0000

    Bug 15839 - DBRev 16.06.00.019
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 177542bf5208e5e053ac9b1500d2536e1eff5ae2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 29 10:24:44 2016 +0200

    Bug 15839: [QA Follow-up] Error checking in opac-review.pl
    
    [1] Adds a check on biblionumber. (Prevents a DBIx error.)
    [2] If you have a reviewid, search on that and check results.
        Add an unauthorized error in template.
    [3] If you add a new review, check that there is no review yet.
        If so, edit the existing one.
        This supports the added FIXME on a unique constraint.
    
    Note: This script could receive further attention.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested all crud ops with opac-review.pl (incl URL manipulation).
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b5c3b1c9747693c284c3c0e8fdb2df94d256088e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 29 09:27:58 2016 +0200

    Bug 15839: [QA Follow-up] Paging on opac-showreviews
    
    Paging is kind of messy here. This patch at least improves somewhat.
    The page number should be rounded.
    The results per page should be passed to the template too.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested a number of reviews and played with count parameter in URL.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac59bed98ac980efaa789fa46fad1225c12bc7ce
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 29 08:16:47 2016 +0200

    Bug 15839: [QA Follow-up] Update existing rows in dbrev
    
    Adding the default is fine for new records; we also should take care
    of the pending existing ones.
    Trivial addition to atomic update file.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested the dbrev again with existing unapproved reviews.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 54044e05c56580d34473887f46385aca008200c5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 16:32:15 2016 +0000

    Bug 15839: Koha::Reviews - Remove C4::Review residue
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 092ae340cef375cc66c8511fd34c1a4eec9c7ba6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 16:30:07 2016 +0000

    Bug 15839: Koha::Reviews - Remove savereview
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 41fa333ec98a492f9a509d3a05f747ac38ac7c79
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 16:28:33 2016 +0000

    Bug 15839: Koha::Reviews - Remove updatereview
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3cf4d92a5f2b7cd4a15913e96108f79323978000
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 16:28:09 2016 +0000

    Bug 15839: Koha::Reviews - Remove getnumberofreviews
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 48fe93e945a3fcb55adaa17a44bd5963c5a9f3f4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 16:15:55 2016 +0000

    Bug 15839: Koha::Reviews - Remove getreview
    
    Note that this (biblionumber, borrowernumber) pair should be defined as
    a unique key at the DB level (FIXME added)
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f3b57dfb023f81c57719ed31f91ada40a40fb165
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 16:06:46 2016 +0000

    Bug 15839: Koha::Reviews - Remove deletereview
    
    Note that a future enhancement should take into account the possible
    error returned by ->approve, ->unapprove and ->delete
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7a10e15dae3e4ae7733e466976e6b393069615ab
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 16:53:41 2016 +0000

    Bug 15839: Koha::Reviews - Change default value for approved to 0
    
    The reviews.approved column had a default value set to NULL.
    It does not make sense, the default value should be 0, this will avoid
    to have to specify the approved value when creating a new review.
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eb950f4cc4d0ea759673deb8f272e0e043248b8f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 16:06:27 2016 +0000

    Bug 15839: Koha::Reviews - Remove approvereview & unapprovereview
    
    This patch adds 2 new methods to Koha::Review: approve and unapprove.
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f1e4e83008d2a4be992352242f75e7fa663e34a0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 15:56:03 2016 +0000

    Bug 15839: Koha::Reviews - Remove getallreviews
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ba8f552ab605739ca9a9ea3a2c4c9d0a93871c96
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 15:09:01 2016 +0000

    Bug 15839: Koha::Reviews - Remove getreviews
    
    The C4::Reviews::getreviews subroutine retrieved the reviews for a given
    record, depending on their status.
    This can be achieve with a call to Koha::Reviews->search.
    There were 2 calls to this subroutine. The one from opac-ISBDdetail.pl
    does not look in used: the reviews are not display on this page. It
    certainly comes from an old copy/paste from opac-detail.pl.
    The one from opac-detail only asked for the approved reviews. So the
    logged in user does not see its own review if it is pending approval.
    Actually this pending approval review is only displayed when the user
    submits it (because of a unecessary complex text replacement done in
    JS).
    With this patch, the approved reviews AND the unaproved review from the
    logged in user will be displayed.
    It will allow a future enhancement to add a way to delete our own
    reviews.
    
    Moreover, the reviews were retrieved even if they were not displayed (if
    reviewson is off), it's now fixed.
    
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 86395f2282f526ff51965e6a129c24b811dbbabd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 16 16:41:22 2016 +0000

    Bug 15839: Koha::Reviews - Add Koha::Review[s] classes
    
    The subroutines in C4::Reviews are only doing CRUD operations.
    This patch set moves them to 2 new Koha::Review[s] classes.
    
    Test plan for the whole patch set:
    0/ Set the reviewson syspref
    1/ At the OPAC, create a couple of reviews for a record
    Try and create a review without html tags different that br b i em big
    small strong: You should get a warning.
    2/ Edit a review
    3/ On the Staff interface, you should see a "Comments pending approval"
    link on the mainpage
    4/ Approve 1 review and delete the other
    5/ At the OPAC you should only see 1 review (the approved one) in the
    "Comments" tab
    6/ Modify the review
    7/ The review should appear again in the "comments awaiting moderation"
    tab.
    Note that even the comment has not been changed, it will have to be
    reapproved (FIXME later). This behavior already existed prior to this
    patch.
    
    Tested all patches together (with database updated)
    Signed-off-by: Marc Veron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac13b03ff21e169b492a260a3eced21500c43fd2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 10:21:33 2016 +0000

    Bug 16851 [QA Followup] - Fix Unit Tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7e4e4c06e67c455c9b429d6b619ec502d17a753a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 17:56:54 2016 +0100

    Bug 16851: Move HasOverdues to Koha::Patron->has_overdues
    
    This patch just move C4::Members::HasOverdues to
    Koha::Patron->has_overdues and updated callers
    
    Test plan:
    No change in behavior is expected.
    1/ If a patron is debarred and does not have overdues and
    AutoRemoveOverduesRestrictions is on, the debarment will be removed on
    checkin
    2/ Add overdues and make sure the patron cannot renew
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dc847cabdfd5a90289b6f883a495537af2445643
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 09:47:33 2016 +0000

    Bug 16911 [QA Followup] - Fix number of categories to look for after deleting one
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 07c246ba78b92599c949c18d746a43ed836087e6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 5 15:18:57 2016 -0300

    Bug 16911: (QA followup) CGI->param should not be called in list context
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dde9fe1e98a314b06a160a75018abcf5261aaebb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jul 20 19:03:53 2016 +0100

    Bug 16911: ->get_expiry_date accepts strings
    
    To make sure nothing else will be broken, it's certainly better to
    handle date strings in a first phase.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f48409bb8dbe9f011be6d448301fe1db03de9ec1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 20:29:15 2016 +0100

    Bug 16911: Rename extend_subscription with renew_account
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e4e90ea0dae0b93978cf450d48a26f9da0be7587
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 11 23:28:19 2016 +0100

    Bug 16911: Koha::Patrons - Move ExtendMemberSubscriptionTo to ->extend_subscription
    
    This patch moves the code from C4::Members::ExtendMemberSubscriptionTo
    to Koha::Patron->extend_subscription.
    
    The expected behavior is:
    When a new patron is created, the enrolment period defined for the
    patron category is used unless an enrolment period date is defined. In
    that case, this date is used.
    When an account is renewed, the pref BorrowerRenewalPeriodBase is used to
    determine if the subscription is renewed from today or from the day when his/her
    account has expired.
    
    Test plan:
    Confirm that the behavior is correct before this patch and that it's
    still the same after this patchset applied.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 076ef1e22e1156fe582eb30ae981c5b98a8ec00d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 00:18:56 2016 +0100

    Bug 16911: Koha::Patrons - Add tests for ->extend_subscription
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 92bfc28eb0fd15aefccaef300943de9e7b161c40
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 11 23:45:55 2016 +0100

    Bug 16911: Koha::Patron::Categories - Move GetExpiryDate to ->get_expiry_date
    
    This patch moves the code from C4::Members::GetExpiryDate to
    Koha::Patron::Categories.
    Nothing much exiting, please follow test plan in next patches.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5bbcaf215eb0ffef18db3163f19fd140bd78da3c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 00:14:56 2016 +0100

    Bug 16911: Koha::Patron::Categories - Add tests for ->get_expiry_date
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f6bf8c55a40bb60998b3d696b25eaeb6a75fe4e9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 12 10:12:18 2016 +0200

    Bug 17089: [QA Follow-up] Add some test descriptions to Ratings.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 09d00bf04002988169fa43b84ea52fa5e7d30415
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 17:06:56 2016 +0100

    Bug 17089: Improve errors handling
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e4136c2b3ad4730255f8c39409756c82948f0cfd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 15:08:55 2016 +0100

    Bug 17089: Mark out the boundaries of ratings
    
    In the doc of C4::Ratings, it was written that the rate values should be
    >=0 and <=5, but it was not taken into account.
    This bug should be fixed on stable releases as well.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b9d5cbedc4b61579ae3a245ad2f7ae779d12d36b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 15:01:05 2016 +0100

    Bug 17089: Koha::Ratings - Remove C4::Ratings
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 70a31874a73fdfaf83371ecd0c80359301dbd45c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 15:01:21 2016 +0100

    Bug 17089: Koha::Ratings - Remove GetRating
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6f67992ffa893de3f17641f739064f748c200cf8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 11:28:57 2016 +0100

    Bug 17089: Koha::Ratings - Remove DelRating
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a7f831404eba0e38c10cc60dde337e7470e09572
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 11:06:07 2016 +0100

    Bug 17089: Koha::Ratings - Remove ModRating
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d9af985de6dc21ad1bed99c4fed536f377c255d9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 11:04:41 2016 +0100

    Bug 17089: Koha::Ratings - Remove AddRating
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 172b4b54a131cafc7996290347edbcda531e05f8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 11:28:42 2016 +0100

    Bug 17089: Koha::Ratings - move tests
    
    Rewrite and move the tests.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 01631b6e3146906984aa497a2937365dd3b3ab9e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 11:28:25 2016 +0100

    Bug 17089: Koha::Ratings - Add Koha::Rating[s] classes
    
    The subroutines in C4::Ratings are only CRUD operations.
    This patch set moves the entire module to Koha::Rating[s] based on
    Koha::Object[s]
    
    Test plan for the whole patch set:
    0/ Set OpacStarRatings to "results and details"
    1/ Log in at the OPAC
    2/ Launch a search, you should see the star ratings
    3/ Go on a detail page, you should see the star ratings
    4/ Rate the record
    5/ Log in with another patron
    6/ Go on the same detail page, you should see the previous rating
    7/ Rate the racord, you should see "2 votes" and the average rating
    value.
    8/ Cancel your rate
    9/ Disable JavaScript and repeat 7
    
    Note: You cannot cancel your rate if JavaScript is disabled (not a
    regression).
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eaa11da5624f308768c4eb2c7016b5cd32c35fb1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jul 26 10:23:43 2016 -0300

    Bug 16822: Make koha-common call koha-plack without --quiet
    
    This patch removes the --quiet option switch in koha-common.init so
    problem information is not hidden for sysadmin users.
    
    To test:
    
    - Have plack enabled for a koha instance:
      $ sudo koha-plack --enable kohadev
      $ sudo koha-plack --start  kohadev
    - Run:
      $ cd kohaclone
      $ debian/koha-common.init {start|stop|restart}
    => SUCCESS: No behaviour change
    - Disable the 'cgi' apache module:
      $ sudo a2dismod cgi
    - Run:
      $ debian/koha-common.init {start|stop|restart}
    => FAIL: No warning is shown
    - Apply the patch
    - Run:
      $ debian/koha-common.init {start|stop|restart}
    => SUCCESS: Warnings show up
    - Sign off :-D
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    Perfect thanks :)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f31d3175b3f00dde49fced00e169cd2ea3cabcf5
Author: Magnus Enger <magnus@libriotech.no>
Date:   Thu Sep 8 14:55:58 2016 +0200

    Bug 17267 - Document koha-create --adminuser
    
    A description of --adminuser was missing from debian/docs/koha-create.xml
    This patch adds a description in the Options section, as well as under
    DEFAULTSQL in the list of configuration variables.
    
    To test:
    Run these commands and look at the formatted man page:
    $ xsltproc /usr/share/xml/docbook/stylesheet/docbook-xsl/manpages/docbook.xsl \
      debian/docs/koha-create.xml
    $ man -l koha-create.8
    
    Make sure this test passes:
    $ prove -v xt/verify-debian-docbook.t
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    Edited commit message to fix typo - koha-mysql -> koha-create as that's what we're testing. :)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6ca6fb45b6122d8d31a8e9d5e3168127373bb1f6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Sep 8 16:19:08 2016 +0000

    Bug 16918 (QA Followup) - Add reverse proxy and fix intranet vs opac typo
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Amended the patch to adjust a typo: ndex should be index.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 23365556ad67fc820d0193c0be4bfe579cf4afbe
Author: Jesse Weaver <jweaver@bywatersolutions.com>
Date:   Thu Jul 21 16:29:13 2016 -0600

    Bug 16918: Serve OPAC/intranet homepage via Plack
    
    Test plan:
      1) Shut down the Plack server.
      2) The OPAC and staff side homepage should still load (as it is
         mistakenly being loaded via CGI).
      3) Apply patch.
      4) Both homepages should now not load.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d331b6de455c289989929b41bfd80725e85a3b6b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 9 09:06:51 2016 +0000

    Bug 7045 - Fix DBRev 16.06.00.016
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 28a4d1414a49ac0313b3171c0e7b38fbadc530f1
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Aug 31 14:20:34 2016 +0200

    Bug 15758: [QA Follow-up] Final touch?
    
    From qa tools:
    reports/cat_issues_top.pl: pod: =over on line 39 without closing =back
    
    Note: qa tools does also report "options_for_libraries: not found" on two
    template includes. Considering this as a false alarm, since the block is
    defined in another include loaded in doc-head-open.
    [1] koha-tmpl/intranet-tmpl/prog/en/includes/subscriptions-search.inc
    [2] koha-tmpl/opac-tmpl/bootstrap/en/includes/opac-topissues.inc
    
    Found a template where a USE Branches was missing:
    koha-tmpl/intranet-tmpl/prog/en/modules/serials/subscription-add.tt
    Easy to spot since the libraries combo was empty.
    Tried to find similar occurrences with few greps, but couldn't find any.
    
    I did find duplicate USE Branches though in:
    koha-tmpl/intranet-tmpl/prog/en/modules/admin/smart-rules.tt
    koha-tmpl/intranet-tmpl/prog/en/modules/serials/checkexpiration.tt
    This patch removes them.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62f4186f881e8eb08373d51e06c45769b41856b5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 26 14:05:42 2016 +0100

    Bug 15758: Fix variable name, it's a branchcode
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 632c78c073cc7f658442252e9d69cd689bcb2730
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 26 13:22:31 2016 +0200

    Bug 15758: [QA Follow-up] Corrections related to GetBranches
    
    [1] C4/Search
    A call to Koha::Libraries is added to routine pazGetRecords, but the
    results of that call are not used. So removing it again.
    
    [2] catalogue/itemsearch.pl
    Although A=>B=>C=>D works, we'd better use here A=>B, C=>D.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0079ca7c72403059ca89f564cd6814c6dfb4312a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 26 09:02:04 2016 +0200

    Bug 15758: [QA Follow-up] Some corrections related to GetBranchName
    
    [1] Acquisition.pm
    The lines filling $row in GetBasketGroupAsCSV may have side-effects when
    the library name is not found. This change restores former behavior. Just
    theoretically more safe.
    Note that it also contained a typo: $row->{deliveryplace} should have been
    $row->{$place}.
    
    [2] Auth.pm
    checkauth: $branchname = Koha::Libraries->find($branchcode)->branchname;
    Should normally be fine, but I rather have an empty string here than
    crashing on "Can't call method branchname on undefined value".
    Same for sub check_api_auth.
    Note that this holds for a larger number of calls, but I am adding a check
    here because it is checkauth.
    Also removed a duplicate use Koha::Libraries-statement.
    
    [3] Search.pm
    Also removed a duplicate use statement for Libraries.
    
    [4] svc/holds
    Added an (explicit) use statement for Koha::Libraries.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f435d83c0c5283f49cf4089b17c298860e6168ac
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 26 08:01:07 2016 +0200

    Bug 15758: [QA Follow-up] Remove onlymine from Plugin/Branches.pm
    
    Hard to miss that one:
    Template process failed: plugin error - Bareword "C4::Branch::onlymine" not allowed while "strict subs" in use at Koha/Template/Plugin/Branches.pm line 59.
    Compilation failed in require at /usr/lib/perl5/Template/Plugins.pm line 206.
    
    Removed OnlyMine from Plugin/Branches. Replaced by a template var in
    cleanborrowers; it was used only once.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f1e5d61b461b1569399742bd491996f672ba293b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 8 17:17:31 2016 +0000

    Bug 15758: Koha::Libraries - Do not select an option if selected is defined
    
    This will certainly need a few more tweaks.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9d49e0d2c874292b553d7e0e0a878cd48ee75e09
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 8 15:20:18 2016 +0000

    Bug 15758: Koha::Libraries - Add tests for the Branches TT plugin
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c840c9383558db8ebabfb9b84efccf72904ac061
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 5 12:34:08 2016 +0000

    Bug 15758: Koha::Libraries - Ultimate duel for C4::Branch
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b95cb48b30a3e128d7b41ef1756efc12cd823ba
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 5 12:30:29 2016 +0000

    Bug 15758: Koha::Libraries - Move onlymine to C4::Context::only_my_library
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit df97814f3034a3d5015546c4eca21f08ae951e37
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 4 15:24:23 2016 +0000

    Bug 15758: Koha::Libraries - Remove GetBranches
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 79f4afe26a54061eb74d97e4753f6b73cb9e703e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 4 15:24:12 2016 +0000

    Bug 15758: Koha::Libraries - Move mybranch to C4::Context
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9b9803b69c8bde879768ccfa3cc4688ef46b7799
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 3 15:58:08 2016 +0000

    Bug 15758: Koha::Libraries - Remove GetBranchesLoop
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 19a977dc7b779173c4a3e96b6b06dc35db663601
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 2 17:28:30 2016 +0000

    Bug 15758: Koha::Libraries - Remove GetBranchName
    
    This is the fourth and last patch set to remove C4::Branch.
    The real purpose of this patch is to standardise and refactor some code
    which is related to the libraries selection/display.
    Its unconfessed purpose is to remove the C4::Branch package.
    
    Before this patch set, only 6 subroutines still existed in the C4::Branch
    package:
    - GetBranchName
    - GetBranchesLoop
    - mybranch
    - onlymine
    - GetBranches
    - GetBranch
    
    GetBranchName basically returns the branchname for a given branchcode.
    The branchname is only used for a display purpose and we don't need to
    retrieve it in package or pl scripts (unless for a few exceptions).
    We have a `Branches` template plugin with a `GetName` method which does
    exactly this job.
    To achieve this removal, we will use this template plugin and delete the
    GetBranchName from pl and pm files.
    The `Branches.all()` will now select the library of the logged in user
    if no `selected` parameter has been passed.
    This new behavior could cause regressions, for instance there are some
    places where we do not want an option preselected (batch item
    modification for instance), keep that in mind when testing.
    
    GetBranchesLoop took 3 parameters: $branch and $onlymine.
    The first one was used to set a "selected" flag, for a display purpose:
    select an option in the libraries dropdown lists.
    The second one was useless: If not passed or set to 0, the
    `C4::Branch::onlymine` subroutine was called.
    This onlymine flag was use to know if the logged in user was able to see
    other libraries infos.
    A patron can see the infos from other libraries if IndependentBranches
    is not set OR if he has the superlibrarian permission.
    Prior to this patch set, the "onlymine test" was done on different
    places (neworderempty.pl, additem.pl, holidays.pl, etc.), including the
    Branches TT plugin. In this patch set, this test is only done on one
    place (C4::Context::only_my_library, code moved from
    C4::Branch::onlymine).
    To accomplish the same job as this subroutine, we just need to call the
    `Branches.all()` method from the `Branches` TT plugin. It already
    accepts a `selected` parameter to set a flag on the option to select.
    To avoid the repetitive
      [% IF selected %]<option selected="selected">[% ELSE %]<option>[% END %]
    pattern, a new `html_helpers` TT include file has been created, it
    defines an `options_for_libraries` block, which takes a `selected`
    parameter. We could imagine to use this include file for other
    selects.
    
    The 'mybranch` and `onlymine` subroutines of the C4::Branch package have
    been moved to C4::Context. onlymine has been renamed with
    only_my_library. There are only 4 occurrences of it, against 11 before
    this patch set.
    There 2 subroutines are Context-centric and it makes sense to put them
    in `C4::Context` (at least it's the least worst place!)
    
    GetBranches is the tricky part of this patch set: It retrieves all the
    libraries, independently of the value of IndependentBranches.
    To keep the same way as the existing calls of `Branches.all()`, I have
    added a `unfiltered` parameter. If set, the `Branches.all()` will call
    a usual Koha::Libraries->search method, otherwise
    Koha::Libraries->search_filtered will be called. This new method will
    check if the logged in user is allowed to see other libraries or only
    its library.
    Note that this `GetBranches` subroutine also created a `category` key:
    it allowed to get the list of groups (of libraries) where this library
    existed. Thanks to a previous patch set (bug 15295), this value was
    not used anymore (I may have missed something!).
    
    Note that the only use of `GetBranch` was buggy (see bug 15746).
    
    Test plan (for the whole patch set):
    The best way to test this whole patch set is to test with 2 instances: 1
    with the patch set applied, 1 using master, to be sure there is no
    regression.
    It would be good to test the same with `IndependentBranches` and the
    without `IndependentBranches`.
    No difference should be found.
    The tester must focus on the library dropdowns on as many forms as
    possible.
    You will notice changes in the order of the options: the libraries will
    now be ordered by branchname (instead of branchcode in some places).
    A special attention will be given to the following page:
    - acqui/neworderempty.pl
    - catalogue/search.pl
    - members/members-home.pl (header?)
    - opac/opac-topissues.pl
    - tools/holidays.pl
    - admin/branch_transfer_limits.pl
    - admin/item_circulation_alerts.pl
    - rotating_collections/transferCollection.pl
    - suggestion/suggestion.pl
    - tools/export.pl
    
    Notes for QA:
    - There are 2 FIXMEs in the patch set, I have kept the existing behavior,
    but I am not sure it's the good one. Feel free to open a bug report and
    I will fill a patch if you think it's not correct. Otherwise, remove the
    FIXME lines in a follow-up patch.
    - The whole patch set is huge and makes a lot of changes.
    But it finally will tremendously reduce the number of lines:
    716 insertions for 1910 deletions
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9b8b18151d7773fe811742cdbf7998a15b70bf27
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 12 12:56:22 2016 +0100

    Bug 15407: Uniformise calls in patron-attr-types
    
    Does not make sense to call first in list context and later in scalar
    context.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a3a2dbb8cda01f9dc6fb3f3ed015998794869719
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 12 13:26:46 2016 +0200

    Bug 15407: [QA Follow-up] Confusing cathash removed
    
    One of the patches removed %cathash. Some kind of silly remainder
    was left in a string. Just used as a text field to explain the
    filters used on borrowers_stats.pl. The filter name cathash is not
    really easy and also was confusing in relation to the variable.
    
    So just a string patch, replacing it with Patron category.
    
    NOTE: The output of borrowers_stats.pl with the filters listed, is
    not one of the most beautiful Koha screens.
    Furthermore, translatibility of these filters is still an issue to
    be handled on another report.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 82c98ad23495f18af7cba32a3d02d1dd34cdda01
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 12 11:05:46 2016 +0100

    Bug 15407: (follow-up) Koha::Patron::Categories - replace C4::Category->al
    
    Categories.GetName should not have been removed in the previous patch
    (merge conflict issue).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8a6e7b4a768fc78997bc533c380bfb4bba57cbf3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 12 11:20:11 2016 +0200

    Bug 15407: [QA Follow-up] Joubu, add your tests
    
    Trivial fix (yes again).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 703bebe92368a23cc30a067cff1b5b7ae9e63b6e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 12 10:49:32 2016 +0200

    Bug 15407: [QA Follow-up] Fix POD in reserves_stats.pl
    
    Trivial fix.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cae4b980607be083e5e0fb163c4949c73d6347db
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 22 10:12:48 2015 +0000

    Bug 15407: Koha::Patron::Categories - replace GetborCatFromCatType
    
    This unnecessary complicated subroutine returned an arrayref and an
    hashref of the patron categories available for the logged in user, for a given
    category_type, ordered by categorycode.
    This can now be done with the search_limited method.
    
    Test plan:
    - Same prerequisite as before
    For the following pages, you should not see patron categories limited to other
    libraries. They should be ordered as before this patch, by categorycode.
    - Add/edit a patron, change his/her patron category value.
    - On the 3 following reports:
        reports/bor_issues_top.pl
        reports/borrowers_out.pl
        reports/cat_issues_top.pl
    The display for these 3 reports are different than the 2 from the first
    patch (borrowers_stats.pl issues_avg_stats.pl): they are ordered by
    categorycode and the ones limited to other libraries are not displayed
    (should certainly be fixed).
    
    Note that the big part of this patch has already been tested before
    (update child related: CATCODE_MULTI).
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6239bbd35f31bac5b9c98ab96bad9617c68b5de3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 21 17:27:08 2015 +0000

    Bug 15407: Koha::Patron::Categories - replace GetBorrowercategoryList
    
    C4::Members::GetBorrowercategoryList returned all the patron categories,
    ordered by description.
    This can be done using the search method of the Koha::Patron::Categories
    module.
    
    Test plan:
    - Same prerequisite as before
    For the following pages, you should not see patron categories limited to other
    libraries. They should be ordered as before this patch, by description.
    - On the "patron attribute types" admin page (admin/patron-attr-types.pl).
    - On the "Batch patron deletion/anonymization"
      (tools/cleanborrowers.pl), the dropdown list should be filled
      correctly.
    - On the import patron tool
    - On the following report:
        reports/reserves_stats.pl
    Confirm that the patron categories are displayed and that the report
    still works as before.
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a5a23bcebcb0cfce65b72f9ccef484e9d44fe33a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 21 17:13:12 2015 +0000

    Bug 15407: Koha::Patron::Categories - replace GetBorrowercategory
    
    The purpose of C4::Members::GetBorrowercategory was to return the patron
    category for a given categorycode. This can be done easily with the
    Koha::Patron::Categories->find method.
    
    Test plan:
    - Same prerequisite as before
    - Edit a guarantor and confirm the information will be updated for his/her
      guarantee(s).
    - Update a child to adult patron (Note: Should not we hide the patron
      categories limited to others libraries? If yes, it must be done on another
      bug report).
      There is a special behavior if there is only 1 adult category, the
      user does not need to select a category. So the same as before with
      only 1 adult patron category.
    - Import a patron with a category_code which does not exist. You should
      be warned.
    - Modify some patron using the batch patron modification tool. The
      patron category descriptions should correctly be displayed.
    
    Note that the overduerules page has already been tested in a previous
    patch.
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6ee8dd3a597d08ccc5122473e55790d3f21d5163
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 21 17:04:30 2015 +0000

    Bug 15407: Koha::Patron::Categories - replace C4::Category->all
    
    The C4::Category module contained only 1 method to return the patron
    categories available for the logged in user.
    The new method Koha::Patron::Categories->search_limited does exactly the
    same thing (see tests) and must be used in place of it.
    
    Test plan:
    - Same prerequisite as before
    For the following pages, you should not see patron categories limited to
    other libraries.
    - On the 'Item circulation alerts' admin page
      (admin/item_circulation_alerts.pl), modify the settings for check-in
      and checkout (NOTE: Should not we display all patron categories on
      this page? If yes, it must be done in another bug report to ease
      backporting it).
    - Search for patrons in the admin (budget) and acquisition (order) module.
    - On the patron home page (search form in the header)
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3bb1578354e75ae160830a410340c6fbb9faaf3a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 21 15:04:45 2015 +0000

    Bug 15407: Koha::Patron::Categories - remove sql queries in some pl and pm
    
    This patch replaces sql queries done in some pl script and in
    C4::Reports::Guided.
    Since we have now a Koha::Patron::Categories module, we should use it
    where it is possible.
    
    Test plan:
    - Prerequisite: Be sure you have several patron categories created, with
      different option enabled, and limit some to certain libraries.
    - On the 'Circulation and fine rules' admin page (admin/smart-rules.pl),
      all the patron categories should be displayed (even the ones limited to
      another library), ordered by description. Try to add/update existing rules.
    - On the overdue rules page (tools/overduerules.pl), all the patron
      categories with overduenoticerequired set should be displayed.
      Try to add/update existing rules.
    - On the following reports:
        reports/borrowers_stats.pl
        reports/issues_avg_stats.pl
    The patron categories should be displayed. Note that there is an
    inconsistency with these 2 reports: the patron categories limited to
    other libraries are displayed on them, when they are not on the other
    reports. This should certainly be fixed (on another bug report).
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7523ef878d432fccf905d68fa5e10fcd8ef30dcb
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Sep 8 12:47:25 2016 +0000

    Bug 14695 - DBRev 16.06.00.018
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 408c7bf001d5b9b8c2ab9118a2f67b564e79e085
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Sep 8 09:45:27 2016 +0000

    Bug 14695 [QA Followup]
    
    * Add tests for CanItemBeReserved returns 'itemAlreadyOnHold' to t/db_dependent/Holds.t
    * Don't let GetReserveId explode
    * Use search instead of map
    * Remove instances of resbarcode
    * Fix badly formed li closing tag
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 53ee852749c8d15cdddddbeaf12e88279792cfe6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 7 14:20:00 2016 +0100

    Bug 14695: Fix GetHardDueDate.t tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c85292db5a5f5ec661c6978c2a0841783061b223
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Sep 8 12:19:30 2016 +0000

    Bug 17189 [QA Followup] - Missing $ on $key var for unsafe variant
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 705097f938ba9334c21b3e6f006bd7c9ba38763c
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Aug 24 21:24:45 2016 +0000

    Bug 16035: MARC default bibliographic framework Export fix
    
    This patch makes sure that, if there is no framework code,
         $frameworkcode is set to 'default'. This fixes the format issue.
         Then, if $frameworkcode = default, an empty string (rather than
         null) is passed to the ExportFramework method, as the framework
         code in the DB for default codes is "".
    
    To test:
    1) Go to Admin -> MARC Bibliographic framework
    2) Try to export default framework in all formats, notice the file is
    only exported as .ods and is an empty file. Notice warns in intranet
    error log.
    3) Apply patch and refresh page
    4) Confirm exporting default framework works in all formats and
    spreadsheet has data
    5) Notice warns in error log are gone
    6) Confirm export still works for other frameworks
    
    Sponsored-by: Catalyst IT
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 20fcac24e8c798fb2fb79bf84ebe39c18161d9b0
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Sep 7 13:03:43 2016 +0000

    Bug 17231 - (QA Followup)
    
    Nicer grep
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b1dc5092d82fd0952ce4e9b586842f5ccb7a4377
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Aug 31 17:37:56 2016 +0000

    Bug 17231 - HTML5MediaYouTube should recognize youtu.be links from youtube as well at the full links
    
    To test:
    Enable HTML5MediaYouTube and ensure WWW::YouTube::Download is installed
    Add an 856$u to a record like: https://www.youtube.com/watch?v=tu0qtEwb9gE
    Verify you can see the embedded player
    Use the youtube shortened like (from the share button) like:
    https://youtu.be/tu0qtEwb9gE
    Verify you can see the embedded player
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eab75d0aa48759e8f2ec017b643e0ca6f985c937
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 6 12:58:31 2016 +0100

    Bug 14060: Improve regex to limit year to 4 integers
    
    01/01/01984 should not be considered as a valid date.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 61d819caef44700b2b1a85c9c27e47913a165a4f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Sep 5 09:16:02 2016 +0100

    Bug 14060: Consider an empty string as a valid date
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 08653cca9bd9d5185293c56326ec35a6e875550c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 09:56:46 2016 +0100

    Bug 14060: Add the datepicker class to dateofbirth
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit db3df548b6a6385ea17d2db49f49f8d4c9f2969f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 30 09:54:55 2016 +0100

    Bug 14060: Force leading zeros on date
    
    If a date does not contain leading zeros for day and month, the date
    will be refused.
    parseDate function considers 1/1/1990 as a valid date, but our perl code
    does not. We must refuse it.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 26fdc96c5ea824b5529da846b63a8e4e62d486e8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 26 08:44:06 2016 +0100

    Bug 14060: Display date format pattern instead of date format name
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit edd555df4dc40f9ee3f8625240564fcc65c2935f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 4 11:03:43 2016 +0000

    Bug 14060: Add support for dmydot
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 363e45a5eb89b25e47165bb815d6dc901744f977
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 1 17:33:15 2015 +0000

    Bug 14060: Force the input to contain a valid date
    
    Before this patch, the user was still allowed to enter a valid date.
    Now, if the date is not valid, the input is emptied.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2a3966946131992ceeb125be3a852b9893bfd708
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Mon Apr 27 10:42:51 2015 +0200

    Bug 14060: Display the date format on the warning popup
    
    The date format is now displayed on the warning popup.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d53fb6db6a0cb0d239e7849c902a3dce4966c709
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Mon Apr 27 10:39:14 2015 +0200

    Bug 14060: Add OnClose event on missing datepicker
    
    The "suspend until" inputs (hold list on circ/circulation.pl and
    members/moremember.pl) were not set in the same way.
    The minDate option should be set for both (bug 10703 removed it for
    circ/circulation.pl).
    This patch reintroduces the option and add the OnClose event on both.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f91ed3d8bf19533a4a92e67c0b1fe394e84e67bf
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Fri Apr 24 15:36:34 2015 +0200

    Bug 14060: Remove readonly attributes on date inputs
    
    In order to remove accessibility issues due to the readonly attributes
    on date inputs, this patch will remove them and introduce a javascript
    validation on them.
    
    This patch is not perfect for some reason:
    I didn't manage to force the user to select a valid date. One solution
    would be to reopen the datepicker plugin until a valid date is inserted.
    But it could be annoying for users (and for me: I did not manage to
    implement this solution).
    You will note that input is emptied if the date is not valid. This is a
    quick and efficient solution to prevent submitting invalid date and make
    Koha explodes. A proper solution would be to implement the check server
    side send a friendly message to the user.
    
    Test plan:
    For all inputs, try an invalid and a valid date.
     1/ Debar a patron
     2/ On the checkout tables (circulation and moremember), add a renewal
    due date (at the bottom of the tables)
     3/ On the checkout page, specify a due date
     4/ On the return page, specify a return date
     5/ On the invoice page (acquisition module), enter a shipment and
    billing date
     6/ On the invoice search page (invoices.pl) use filters shipment and
    billing dates
     7/ On the offline circ page, specify a due date
     8/ On the edit patron page (memberentry), add a debarment
     9/ On the reserve page (reserve/request.pl), use the date inputs to
    suspend until a defined date
    10/ Edit patrons in a batch (tools/modborrowers.pl) and use the
    registration and expiry date inputs
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 451fd67dd15b967471983c7c8dc601e0d1f65228
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Wed Aug 31 13:33:53 2016 -0600

    Bug 17152: Do not copy value when duplicating a subfield
    
    When cataloguing, if you want to duplicate a subfield that is not
    empty, the new subfield is created with a copy of data in it.
    This is not the case when you duplicate an whole field. The new one is
    created with subfields but without data in it.
    
    Test plan:
    Add or edit a bibliographic record
    Fill a subfield
    Duplicate the subfield
    => Without this patch the value of the input will be copied
    => With this patch the new input will be emptied
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a1fd726157c5857ecde1b66e79284f48142be7e5
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Thu Sep 1 18:13:50 2016 +0200

    Bug 17072: 006 not filling in with existing values
    
    When you use the 006 builder to view the existing values in the 006
    tag, Koha is not pulling these existing values into the builder
    window. Instead, Koha appears to be using defaults.
    
    To reproduce:
    
    1. Open a record in the editor
    2. Switch from BKS to another material type.
    3. Change as many settings as possible.
    4. Close plugin.
    5. Reopen plugin - notice your selections are not shown.
    
    Trivial patch, heavilly inspired by Bug 9093.
    
    To test:
    
    1. Apply patch
    2. Ensure that issue described above is no longer reproductible
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 39487d634ecb2fbfe5819852ef295cdd3d214737
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Aug 30 12:44:14 2016 -0300

    Bug 11592: (QA followup) Add missing framework code to ViewPolicy filter calls
    
    This patch adds the frameworkcode option param, using each record's frameworkcode
    as expected by the filter. Otherwise the ViewPolicy filter falls back to the
    default framework.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ea275693348b7d7e7a230de1cdbd3cf3a0ecb826
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 22 11:00:41 2016 -0300

    Bug 11592: (QA followup) Simplify code
    
    Koha::RecordProcessor and the defined filters are supposed to bring us
    joy and happiness. Let's keep the code compact, simple and clean.
    
    This patch removes record cloning all over the place.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cadf5aea814636ccccd85fcc38aa30f751d779c0
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Apr 20 21:49:41 2016 -0400

    Bug 11592: MARCView and ISBD followup
    
    There are still some leaks, but it is not as a result
    of the filter, but rather a result of poorly written
    template files.
    
    Bug fixing template files is beyond the scope of this
    set of patches.
    
    TEST PLAN
    ---------
     1) Backup your DB
     2) run the following SQL on your DB.
        > UPDATE marc_subfield_structure set hidden=-8;
        -- this should set EVERYTHING to hidden across the board.
     3) In staff client, set OPACXSLTDetailsDisplay to blank
     4) In OPAC, view any detail.
        -- Normal view may mostly leak values still.
        -- MARC view may leak values.
        -- ISBD view may leak values.
     5) In staff client, set OPACXSLTDetailsDisplay to default
     6) In OPAC, view any detail.
        -- same issues as step 4
        -- 'View Plain' may leak too.
     7) 'Save record' -> 'Dublin Core'
     8) Apply this patch
     9) run koha qa test tools
        -- should be fine
    10) prove -v t/db_dependent/Filter_MARC_ViewPolicy.t
        -- should pass
        -- this proves Koha/Filter/MARC/ViewPolicy.pm tweaks too
    11) In OPAC, view any detail.
        -- Normal view:
           -- Material type comes from the LEADER field.
           -- Lists this is on will still display
           -- 'Tags from this library' will still display
           -- Item information in table will still display
              (THIS IS BEYOND SCOPE)
        -- MARC view:
           -- Record number is leaked
              (THIS IS BEYOND SCOPE)
           -- 'View plain' leaks LEADER field.
        -- ISBD view may leak field headings, but not values.
           (THIS IS BEYOND SCOPE)
    12) In staff client, set OPACXSLTDetailsDisplay to blank
    13) In OPAC, view any detail.
        -- same kind of output as step 10
    14) 'Save record' -> BIBTEXT
        -- Should be next to nothing leaked.
    15) 'Save record' -> Dublin Core
        -- Should be the same or less leaked between the two versions.
        -- (XML FILTERING IS BEYOND SCOPE)
    16) In the staff client, go view the same record.
        -- it should be mostly hidden in ISBD View.
    17) run the following SQL on your DB.
        > UPDATE marc_subfield_structure set hidden=1;
        -- this should set EVERYTHING to hidden in OPAC, but not
           the STAFF across the board.
    18) Refresh the staff ISBD page
        -- values should reappear.
    19) View the ISBD details in the OPAC
        -- values should still be hidden.
    20) Check out the OPAC Cart and List
        -- while the intermediate pages may still leak
           the download links should leak very minimally.
        -- (CARTS AND LISTS ARE BEYOND SCOPE, THOUGH
            THE INTRANET ISBD AND SOME CART/LIST STUFF
            WERE FIXED BECAUSE OF THE GetISBDView REFACTOR)
    
    Expectations:
    Before Patch - all the OPAC Detail pages will display things
    After Patch - all the OPAC Detail pages will display much less,
                  and hopefully nothing (though there are known limits).
                  the ISBD detail page in the Staff client will be
                  filtered as well based on STAFF settings.
                  The saving/exporting should generate nearly empty
                  files.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b1c703ac5c10b40b4dd275904dc44bbafadebd5e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Mar 9 14:39:08 2016 -0500

    Bug 11592: Biblio tweak for MARCSUBJECT
    
    https://bugs.koha-community.org/show_bug.cgi?id=11592
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6cbae9c3cb0cb3675dc2620e149eace979a78e01
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Feb 19 11:02:59 2016 -0500

    Bug 11592: Applying filtering to opac interface.
    
    Applying the filtering and then...
    Debugging opac/opac-detail.pl filtering
    Debugging opac/opac-ISBDdetail.pl more
    Debugging opac/opac-export.pl
    Tweak opac/opac-export.pl fix variable declarations, conditional assignments
    Debugging opac/opac-showmarc.pl
    
    https://bugs.koha-community.org/show_bug.cgi?id=11592
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dd8352bb8b4718393f25038086d0128c9671e970
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Mar 16 17:10:02 2016 -0400

    Bug 11592: Add should_hide_marc method to filter
    
    Add should_hide_marc to ViewPolicy filter
    Add should_hide_marc tests to t/db_dependent/Filter_MARC_ViewPolicy.t
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 16f74b546e2eafa3e887aa33000954052156a5d2
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Jan 23 22:31:08 2014 -0500

    Bug 11592: Updated License Text and use Modern::Perl
    
    Why not clean up the License Agreement stuff while the files
    are being changed? Used the current one found at:
    http://wiki.koha-community.org/wiki/Coding_Guidelines#Licence
    
    Changed the strict and warning lines into just a Modern::Perl.
    
    Signed-off-by: Robin Sheat <robin@catalyst.net.nz>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1ebb3c386631359c5265a2bd31503c97bf2c4982
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Sep 7 11:37:24 2016 -0300

    Bug 11921: (QA followup) Remove remaining unused var
    
    This patch removes an occurence of an unused var in Context.pm and
    also prevents a warning if memcached_servers is not set:
    
    Use of uninitialized value in split at /home/vagrant/kohaclone/Koha/Cache.pm line 91.
    
    t also tidies small things.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8814b79bd74d1967fc1d10368b3ae401719ccb80
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 6 15:20:28 2016 +0100

    Bug 11921: Fix logic in C4::Context->new to init the config
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b1a9db08a9ecda1e62c11fcc1aada96933141e2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 6 15:20:25 2016 +0100

    Bug 11921: C4::Context->memcached does no longer exist
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 99fd6d31ce120a6c2d0c4c1399ef9d1140cc9d9a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jun 23 06:33:23 2016 +0100

    Bug 11921: Update remaining occurrences of ->ismemcached
    
    TODO: Would be better to provide a better way to know if memcache is correctly set
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 06628b95575c859edf21858ac0f043eed294e650
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jun 23 05:12:39 2016 +0100

    Bug 11921: Restore memcached infos to koha-conf - Koha::Config
    
    Move C4::Context->read_config_file to Koha::Config
    That permits to reuse it from Koha::Cache without needing C4::Context
    (and introduce a circular deps).
    
    TODO: Add decent POD to Koha::Config
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4fc3750f9a16d65d93fd24b9fbb93dc05b3a1824
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 22 16:53:32 2016 +0100

    Bug 11921: Restore memcached infos to koha-conf
    
    MEMCACHED_SERVERS and MEMCACHED_NAMESPACE should be moved back to
    koha-conf instead of an ENV var to let command line scripts use
    the cache mechanism.
    
    TODO:
    - Add the entries to koha-conf.xml
    - Remove occurrences of MEMCACHED_SERVERS in package, apache and plack files
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b537ba198c7c8565db446b79153c6727b8864aef
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 7 12:03:00 2016 +0100

    Bug 17189: Use Koha::Caches instead of Koha::Cache in Koha::MetaSearcher
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    https://bugs.koha-community.org/show_bug.cgi?id=11921
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 658f603511e119fbcfa3d2581c804d0a0edd985f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 7 11:58:05 2016 +0100

    Bug 17189: Replace occurrences of 'use Koha::Cache'
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    https://bugs.koha-community.org/show_bug.cgi?id=11921
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 55cdfd2da3fae609643a16d40af6905f867dead2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 7 11:43:32 2016 +0100

    Bug 17189: Use delete to flush a L1 cache namespace
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    https://bugs.koha-community.org/show_bug.cgi?id=11921
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f75322070182ec67076137b80173523fd3215173
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 22 16:02:08 2016 +0100

    Bug 17189: Add the ability to define several memcached namespaces - replace existing occurrences
    
    s/Koha::Cache->get_instance/Koha::Caches->get_instance
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    https://bugs.koha-community.org/show_bug.cgi?id=11921
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9d1dbb96cb751632b8959c99a51ab75031ed2294
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 22 16:01:46 2016 +0100

    Bug 17189: Add the ability to define several memcached namespaces - Koha::Caches
    
    We need to define several namespaces for our cache system.
    For instance sysprefs, koha conf (koha-conf.xml) and unit tests
    should be defined in a separate namespace.
    This will permit to
    - launch the tests without interfering with other cache values
    - and flush the sysprefs cache without flushing all other values
    
    To do so, we need to store different Koha::Cache objects at a package
    level. That's why this patch adds a new Koha::Caches module.
    
    FIXME: There is an architecture problem here: the L1 cache should be
    defined in Koha::Cache
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    https://bugs.koha-community.org/show_bug.cgi?id=11921
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ba9b55d5ca56231c887cc3d818071f72e390a8a7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 22 16:10:23 2016 +0100

    Bug 17189: Add the ability to define several memcached namespaces - tests
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    https://bugs.koha-community.org/show_bug.cgi?id=11921
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 514282d04c4494ca5eee02b18c775db74a6bbb91
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Sep 6 09:37:14 2016 +0000

    Bug 16573 - Update Schema
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c2645c0ef83d88b36ed45d6a0b82053191c9b1ce
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Sat Sep 3 00:26:03 2016 +0000

    Bug 14695 [QA Followup] - Fix issues found by QA script

commit 6a5377533ffad409f6fa47e13b82641a01485c10
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 2 10:34:57 2016 +0000

    Bug 14695 [QA Followup] - Unit Tests

commit 32857ba014c2f9f64d67fc6b163f025403c920dc
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 16 11:53:28 2016 +0000

    Bug 14695 [QA Followup] - Tell librarian if item doesn't allow or forces item level holds in the OPAC

commit e1775fe1d5ffae3411d64c4d69fca75ad5641293
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 29 17:34:48 2016 +0000

    Bug 14695 [QA Followup] - Disable "Holds to place (count)" unless "Hold next available item" is checked
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit 8e22663fcd5da34df9529e5f3b2526784f7a2c96
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Tue Apr 19 12:06:44 2016 +0200

    Bug 14695: Fix typo in template
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit 0867d492192419e80caf2716f15ce1af6447a6f4
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Apr 18 14:18:07 2016 +0000

    Bug 14695 [QA Followup] - Fix method names 'type' to '_type'
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit 648a53a373270606207714b23f9bcbc108dcc29f
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Jan 28 10:41:27 2016 +0100

    Bug 14695 - Don't use holds_to_place_count when checking an item.
    
    This fix the following bug:
    If you select 2 in "Holds to place (count)" and finally
    check an item, so you get 2 holds for the same item.
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit f3316db4dfff955c940e63e31f186bf3b2a02297
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Jan 27 16:48:02 2016 +0100

    Bug 14695 - Warn librarian if max_holds_per_record is reached
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit e1b1a67fddaea0eba80a42bf04e7fef7be0d322d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jan 22 15:25:20 2016 +0000

    Bug 14695 [QA Followup] - Fix clearing of all holds by patron at checkout
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit 8e338c3ae1d1f69210c9b9a2209db1c7afc1e44a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jan 19 17:49:44 2016 +0000

    Bug 14695 [QA Followup] - Make existing unit tests pass
    
    * Removes tests no longer needed
    * Updates rules to work with existing tests
    * Fixes code issues revealed by unit tests
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit 6e76e342cb6ac6036738d79418ff068ad84346cc
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jan 19 17:10:29 2016 +0000

    Bug 14695 [QA Followup] - Filling one hold fills all of them
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit bc39f0392bbebaad4c083f81308f652a325be042
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Dec 29 19:14:19 2015 +0000

    Bug 14695 - Add ability to place multiple item holds on a given record per patron
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit abeed5b5f1f2ac4dd657842c03a7a36d425a1949
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Dec 28 17:11:46 2015 +0000

    Bug 14695 - Tidy C4::Reserves::CanItemBeReserved
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit 24740fb2fafc20c27aafae760ad4eca1c14a85df
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Dec 29 19:13:51 2015 +0000

    Bug 14695 - Add new circulation rule
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit e53cf965424ce283cd520ff1adb93a05eecec921
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Dec 29 19:13:25 2015 +0000

    Bug 14695 - Update DB Schema file
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit e825b081d9d9f77fcbabc6e1ef259b31edff7c61
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Dec 29 19:11:47 2015 +0000

    Bug 14695 - Update database
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jason M. Burds <JBurds@dubuque.lib.ia.us>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>

commit 3a2048eeff57548a7d9b557b0e94d36d1c58e6ef
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Sat Sep 3 00:17:20 2016 +0000

    Bug 11360 - Fix merge conflict
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8a7a953e5b6c03da01963b47eb963bab73643245
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Aug 19 15:26:11 2016 +0200

    Bug 13501: Fix behavior of 'Delete subfield' button on select2 controls
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0ad9dbb1d78cb418ef16f39b3f370c67065b5f51
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Aug 19 13:48:13 2016 +0200

    Bug 13501: Highlight select2 control if field is required and value is missing
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 59c964f3644fa56f1ce08a54af898f7c17f42d8c
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Oct 30 13:49:56 2015 +0100

    Bug 13501: Move "Required" and checkbox after input/select
    
    Signed-off-by: Aleisha <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ab14e051b8828fbebdd724f906d3505275021364
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Oct 30 13:45:13 2015 +0100

    Bug 13501: Indentation fix (batchMod-edit.tt)
    
    Signed-off-by: Aleisha <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d15dac15c877da994b5d0a55131c1038cbb5670a
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Tue Dec 30 14:40:44 2014 +0100

    Bug 13501: Add JS library select2 3.5.4
    
    use it on cataloguing and batch items edit pages
    
    Signed-off-by: Aleisha <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c4a0be0a68916718d5e4c1daee011630bd02fb25
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 2 16:18:38 2016 +0000

    Bug 10848 - Fix DBRev description
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b26abb0d526c68c9f94d9b919b80935f9ce0046d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jul 20 15:58:20 2016 +0000

    Bug 11360 [QA Followup] - Fix styles and button order
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 872892b03cbc4de4e2be1c33e2e07b0bf72883a3
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Nov 18 18:53:03 2015 +0000

    Bug 11360 - Disable barcode field and submit button when a hold is found
    
    At the moment when scanning in returns, it can be easy to miss a hold
    trap due to the fact that the barcode and submit are still active and
    the barcode field is focused on. A librarian who is focused on scanning
    can easily scan another item and pass over the form, which is equivalent
    to clicking the "ignore" button.
    
    Test Plan:
    1) Apply this patch
    2) Trap a hold, note the new modal
    3) Check the hold in a second time
    4) Note the new modal
    5) For each modal, test each button
    
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit aef77798a98ed89ebf2200a23b7bfc17760d77e2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 2 16:09:23 2016 +0000

    Bug 7045 - DBRev 16.06.00.017
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 33557a28477258f489207ad8825e14d07d7e6b99
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 2 16:04:09 2016 +0000

    Bug 7045 - DBRev 16.06.00.016
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8d02469abfc6160d473ff486b59ea5c7adb83990
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Fri Aug 12 11:42:48 2016 +0200

    Bug 10848 - [QA Followup] Add missing branch option and fix pattern for copyrightdate
    
    - HTML5 input pattern for copyrightdate was not taking into an account
    the database field type, which is smallint(5)
    - added title="..." for the year field so the acceptable date format
    should be displayed as a hint/tooltip in the browser
    - added an missing option for configuring branch/library as mandatory
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 219c0eac8cb89008219947a3ff0f78a1a3f5f407
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Fri Aug 5 11:01:25 2016 +0200

    Bug 10848 - Allow configuration of mandatory/required fields on the suggestion form in OPAC - part 2
    
    Add 'OPACSuggestionMandatoryFields' syspref definition plus
    an atomic DB update for the new preference.
    
    Signed-off-by: barbara johnson <barbara.johnson@bedfordtx.gov>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c1d75885a6df4cc1317d3c0d95b59478613f28a8
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Fri Aug 5 10:47:11 2016 +0200

    Bug 10848 - Allow configuration of mandatory/required fields on the suggestion form in OPAC
    
    This patch adds a configuration option which allows to define which
    fields should be mandatory for a patron purchase suggestion form in OPAC.
    
    Test plan:
    
    1/ Apply patch.
    2/ Play with the new OPACSuggestionMandatoryFields system preference
    (select some fields as manadatory, select all, deselect all, try to
    submit some suggestions with mandatory fields filled and/or not
    filled etc.) to ensure that required fields (and only required fields)
    are enforced in the browser to be filled.
    3/ With all options deselected, 'Title' field should still be
    mandatory (by default).
    
    Signed-off-by: barbara johnson <barbara.johnson@bedfordtx.gov>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d0f850b51a28afa6ae5ca41a54f43feea972c8d3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jul 12 14:40:35 2016 +0200

    Bug 10407: [QA Follow-up] Hashref process_batch params
    
    As requested by Mark Tompsett. Hope this guarantees a signoff now..
    
    Note: For consistency four additional parameters were needed to no longer
    use file level vars in this subroutine.
    
    Test plan:
    Import a file with stage_file.pl.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Imported a marc file and a marcxml file with stage_file.pl.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8513c24c33876a5dfcecf5950dfd74fb0dd63b67
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 8 13:17:36 2016 +0200

    Bug 10407: Add two subtests to t/ImportBatch.t
    
    Creates a few simple tests for the two new subroutines in ImportBatch.pm.
    
    Test plan:
    Run t/ImportBatch.t.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3badc57c9339e37e5d6ec660ff0b323614ab045d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jul 7 14:13:16 2016 +0200

    Bug 10407: Add marcxml import (follow-up)
    
    This patch makes the following changes:
    
    [1] Based on the groundwork of the former patch, add call to
        RecordsFromMARCXMLFile in stage-marc-import. Use format param.
    [2] Add format to the template. Use file extension to determine.
        If you use .xml or .marcxml as extension, MARCXML is selected.
    [3] In stage-marc-import.tt mark UTF-8 encoding as UTF-8 not as utf8.
    [4] BatchStageMarcRecords: do not call plugin if you have no records.
    [5] RecordsFromISO2709File: also return errors in an array.
    [6] In misc/stage_file.pl also use UTF-8. Handling of errors from [5].
    
    Test plan:
    [1] Import an empty file as MARC or MARCXML (with Tools/Stage..import).
    [2] Import an non-empty file with invalid contents as MARC or MARCXML.
    [3] Export a few records with Tools/Export as MARC and MARCXML.
    [4] Import these two files. Check selected format versus file extension.
    [5] Import a MARCXML file with misc/stage_file.pl.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3e541866cdd00389dc3f28a401911ebd4f5699e9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 8 08:34:00 2016 +0200

    Bug 10407: Resolve warnings from child process
    
    After the staging job finishes, the child tries to print results to
    STDOUT (which is closed). This creates warnings like:
    
    stage-marc-import.pl: binmode() on closed filehandle STDOUT at C4/Templates.pm line 120.
    stage-marc-import.pl: Filehandle STDOUT reopened as FH only for input at /usr/lib/perl5/Template/Provider.pm line 964.
    
    Resolving it is simple: the child should exit after marking the job
    as finished.
    
    Test plan:
    Import a marc file.
    Observe that you do no longer have such warnings.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit aa5bf4d3cc0e4d57b958e665ad1c6efa8a76a9fb
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Fri Apr 17 20:12:49 2015 +0300

    Bug 10407: Allow MARCXML records to be imported via GUI (groundwork)
    
    Patch from Olli, manual rebase by Marcel (July 7, 2016).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Needs follow-up. Test plan in the third patch.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 11315ef090948b22d0cb424e4119011eff8f5036
Author: Magnus Enger <magnus@libriotech.no>
Date:   Sat Jul 23 20:31:11 2016 +0200

    Bug 5456 - Create a link to opac-ics.pl
    
    opac-ics.pl was added to Koha back in 2007, but there has not been a link to it
    from anywhere. This patch adds the link from the main view on
    /cgi-bin/koha/opac-user.pl, and makes some changes to opac-ics.pl itself.
    
    Changes to opac-ics.pl:
    - Update the code to use date and time for when a loan is due
    - Use dt_from_string to turn a MySQL time and date into a DateTime
    - Add a timestamp and a UID (these were reported as necessary by a couple of
      iCal validators)
    - Remove DTEND from events, since we now have time as well as date for when a
      loan is due
    - For loans that are overdue, set the DTSTART to now(), to avoid creating
      calendar events in the past
    - Use a template to generate text strings, to make them translatable
    
    To test:
    - Apply the patch
    - Make sure you have at least a couple of loans, including one overdue
    - Go to /cgi-bin/koha/opac-user.pl and click on the link labeled "Download as
      iCal/.ics file"
    - Inspect the file in a text editor and/or view the result in a calendar
      appplication. Make sure the data makes sense.
    - Sign off and go thee merrily on thine way.
    
    Update 2016-07-25
    - Force date_due to UTC to avoid problematic timezone info like this:
      DTSTART:TZID=Europe/Zurich:20160724T235900
    - Remove quotes from summary and description
    
    Followed test plan, koha.ics file successfully imported to Thunderbird calendar
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bf053f3bfb82b2e70fe09a132add5283cbbd110e
Author: Marc Véron <veron@veron.ch>
Date:   Thu Aug 18 20:42:44 2016 +0200

    Bug 17149 - EDI accounts: Add missing '>' to breadcrumb
    
    To verify:
    Breadcrumb on "EDI accounts" pages reads
    Home > Administration EDI accounts > Modify account
    instead of:
    Home > Administration > EDI accounts > Modify account
    
    To test:
    - Apply patch
    - Add, edit and delete an EDI account
    - Verify that breadcrumb displays properly
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ea13ea00830a8061842fa13b6110e0a4e75aa444
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Aug 24 00:16:43 2016 +0000

    Bug 17175: Typo in patron card images error message
    
    To test:
    1) Go to Tools -> Patron Card Creator -> New Image
    2) Click Upload without attaching anything
    3) Notice typo
    4) Apply patch and refresh page (resend information if prompted)
    5) Notice typo fixed
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit add90157eb859143dc782fded4b00a47a39d8abe
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Wed Aug 24 17:10:29 2016 +0300

    Bug 17185: Staff client shows "Lists that include this title:" even if item is not in a list
    
    In the staff client, the text "Lists that include this title:"
    is always shown, regardless of whether the item is in a list
    or not. This patch fixes that.
    
    Test plan:
    1) Log in to staff client.
    2) Go to biblio details view:
       /cgi-bin/koha/catalogue/detail.pl?biblionumber=X
       Confirm that "Lists that include this title:" is
       shown even if the item is not in a list.
    3) Apply the patch.
    4) Repeat step 2. Confirm that the patch works, i.e.
       "Lists that include this title:" is only shown
       for biblios that are actually in a list.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Only applies to non-XSLT view.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 377feb9cdf5b4d490dee7640b50c374e28f4550f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Aug 17 15:14:12 2016 +0200

    Bug 16809: Follow-up for scalarizing biblionumber
    
    Still resolves another multi_param warning.
    
    Test plan:
    Look at your logs before and after this patch when saving a biblio
    record (you may have to start plack again).
    If your biblionumber is mapped to 999c, you should no longer have a warn
    about line 2563 (disclaimer: line numbers are subject to change).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 28ad0ab51321955878082d363be2210589a8261f
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Jun 24 11:29:19 2016 -0400

    Bug 16809: Silence authority warnings C4::Biblio::TransformHtmlToMarc
    
    Most of the floodiness is caused by accessing the cgi parameters
    in a context which is hard to determine. By purposefully saving
    the value to a scalar variable and using the variable, the issue
    disappears, and it will likely be a tiny tad faster as variable
    access is faster than multiple function calls.
    
    TEST PLAN
    ---------
     1) Back up your intranet error log
        -- for example:
           cp ~/koha-dev/var/log/koha-error-log ~/koha-error-log.backup
     2) Blank your intranet error log
        -- for example:
           echo > ~/koha-dev/var/log/koha-error-log
     3) Log into your staff client
     4) Click 'Authorities'
     5) Click 'New from Z39.50'
     5) Type 'Seuss' into 'Name (any):' and press enter
     6) Click 'Import' beside the first link
     7) Click 'Save'
     8) Check your koha-error-log
        -- floody!
     9) Apply patch
    10) repeat steps 2-8
        -- blank!
    11) restore your intranet error log
       -- for example:
          mv ~/koha-error-log.backup ~/koha-dev/var/log/koha-error-log
    12) run koha qa test tools
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested with addbiblio.pl. I would have preferred the scalar option in terms
    of simpler code, but this works too.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ead7b938d8da426798eb7337aa1b623fa545da5c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Aug 18 13:08:33 2016 -0400

    Bug 14612 - Overdue notice triggers should show branchname instead of branchcode
    
    This patch adds the Branches template plugin to the overdue notice
    triggers template so that the library name can be shown instead of the
    branchcode.
    
    Also changed: Updated page title to match the name used in tools menus.
    
    To test, apply the patch and go to Tools -> Overdue notice/status
    triggers.
    
    - Select a library.
    - When the page reloads, the 'Defining overdue actions for...' and
      'Rules for overdue actions: ' headings should show the library name
      instead of the branchcode.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 931ed0ec9bbad4baa18547d361e2bed52140b637
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 23 14:17:53 2016 +0100

    Bug 16464: Add FIXME
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e67fc1806cbcb9fbe038b67ad0862f3f163a4313
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Aug 9 09:49:33 2016 -0400

    Bug 16464 - If a patron has been discharged, show a message in the OPAC
    
    This patch adds a message to the patron home page in the OPAC to be
    shown if the user is restricted because of a discharge.
    
    To test, apply the patch and log into the OPAC as a patron who has been
    discharged.
     - You should see a message which says so, including a link to
       the discharge notice.
     - Log in to the OPAC as a patron with a manual restriction and confirm
       that the correct notice is displayed.
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af49b42219c6c2fb2f2a52cfb229d37b20b79e84
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Wed Aug 17 17:30:55 2016 +0100

    Bug 17141: Call config method to retrieve logdir
    
    Incorrect method call is causing runtime error and not
    retrieving the correct logdir value
    Change retrieves the value correctly
    
    To test:
    1) Run edi_cron.pl, notice error
    2) Apply patch and run edi_cron.pl again, should work as expected
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Note: I did not test but changes make sense.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d0d8bd18225483c3c28ba9e0bd368301c6835a66
Author: Magnus Enger <magnus@libriotech.no>
Date:   Wed Aug 31 10:47:43 2016 +0200

    Bug 17228 - Make two versions of SIPconfig.xml identical
    
    Several bugs have made changes to etc/SIPconfig.xml but not
    updated debian/templates/SIPconfig.xml. This means that an admin
    using the Debian packages who enables SIP2 for a site and looks at
    /etc/koha/sites/<instance>/SIPconfig.xml will not see an up-to-date
    version of that file, with the risk of missing possible config
    opportunities.
    
    Since debian/templates/SIPconfig.xml contains no placeholders or
    other magic stuff related to the Debian packaging, this patch simply
    copies etc/SIPconfig.xml to debian/templates/SIPconfig.xml
    
    To test: diff etc/SIPconfig.xml debian/templates/SIPconfig.xml
    There should be no difference between the files
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cb72420b4672ec41ebaeb9a51b6387e6f8bb5313
Author: Magnus Enger <magnus@libriotech.no>
Date:   Wed Aug 31 10:45:32 2016 +0200

    Bug 17228 - Fix whitespace in etc/SIPconfig.xml
    
    Remove trailing whitespace and replace tabs with 4 spaces.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 77b03f1e8b2afe0e9063b06785a0eb468fb029ed
Author: Holger Meißner <holger.meissner@hs-gesundheit.de>
Date:   Thu Aug 11 11:22:00 2016 +0200

    Bug 14434: Display "Not renewable (on hold)" in OPAC
    
    This patch makes the OPAC display "Not renewable (on hold)" when
    a hold is placed.
    
    Test plan:
    1) Do not apply patch.
    2) Issue an item with automatic renewal.
    3) Issue an item with manual renewal.
    4) Place a hold on both items.
    5) Log in as patron and note that the column "Renew" says "Automatic
       renewal (x of y renewals remaining)" for the auto renewed item
       and "(On hold) for the other item.
    6) Apply patch.
    7) Refresh OPAC and note that now "Not renewable (on hold)" is displayed
       for both items.
    8) Cancel the holds, then log in as patron again and confirm that the
       correct renewal conditions are displayed.
    
    Sponsored-by: Hochschule für Gesundheit (hsg), Germany
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3f585d44e8f5f04b47a9f949dc6dcd8a1b3cbf7a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 19 12:43:24 2016 +0100

    Bug 16990: Display branch names instead of code in patron mod requests
    
    To test:
    - change your homebranch in the OPAC, submit
    - change patron modification request in the staff client
    - Verify that it shows the old and new branch name instead of the
      code
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2cf1e97e5cb6531f0d1d504dda35a836d86466c2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 15 15:45:38 2016 +0100

    Bug 17128: Make summary-print.pl plack safe
    
    $borrowernumber is used in build_issue_data but not correctly defined
    (Variable "$borrowernumber" is not available)
    
    That may cause wrong charge displayed in the summary slip.
    
    Test plan:
    - Set rental charge for an item type
    - Define a rental discount for that item type in the circ rules
    - check in an item matching this rule
    Without this patch the charge displayed in the summary slip won't be
    calculated with the discount
    With this patch applied, the warning in the logs will no longer appear
    and the values will be correctly calculated.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 762415a2ff18e5a1b783f8eff2275e7d47216343
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jul 9 13:13:35 2016 +0100

    Bug 16886: Make the 'Upload patron images' tool plack safe
    
    Some vars are accessed from subroutine, but defined with my.
    It causes at least the 2 followings errors:
    Variable "$filetype" is not available at
    /home/koha/src/tools/picture-upload.pl line 240.
    Variable "$uploadfilename" is not available at
    /home/koha/src/tools/picture-upload.pl line 241.
    
    To avoid that, they are now declared with our.
    
    Test plan:
    Upload image for a patron and confirm that you get a "Result" table and
    the errors do not longer appear in the logs.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 547b5f95f62a00e360c5cac4e416d30365429fcb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 16 09:18:19 2016 +0100

    Bug 7045: Update default value placeholders for existing installs
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 50abf24ff04aae0c9010411fa6e98561c2ccc66f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 16 09:09:53 2016 +0100

    Bug 7045: Use <<tag>> for default value placeholders
    
    When adding a biblio, the default value of a MARC subfield defined in
    the frameworks can be used as placeholders to set the current date or
    the surname of the logged in user (use cases?).
    The different placeholders are 'YYYY', 'MM', 'DD', 'user'.
    When adding an item, same behavior except that 'user' is not replaced.
    
    This patch makes behaviors consistent between the 2 editors and
    surrounds placeholders with << >>
    We will now have: <<YYYY>>, <<MM>>, <<DD>> and <<USER>>
    
    Test plan:
    Define default values for biblio and item subfields.
    Create a bibliographic record and attach it an item.
    The default values should be used and replaced if you used placeholders.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1c87129971ddcd4289c42083a6005638b0d5370d
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Wed Aug 17 18:42:37 2016 +0200

    Bug 17142 - Don't show library group selection in advanced search if groups are not defined
    
    Even if library groups/search domains are not defined in the system,
    (empty) select for "Groups of libraries" under "Location and
    availability" section in OPAC advanced search is still visible; it
    shouldn't. Side effect of Bug 15295 - 'searchdomainloop' variable
    in the template is now an object, it needs a different kind of statement
    (.count) for checking if it's empty or not.
    
    To test:
    
    1) apply patch
    2) when there are no groups of libraries defined in Administration ->
    Libraries and Groups, "Groups of libraries" selection should be
    no longer visible in OPAC adavanced search page
    3) add library group or two: "Groups of libraries" selection should
    reappear.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f17b491f357267aa037480593158b13c426051ab
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Aug 25 14:06:11 2016 -0400

    Bug 17200 - Badly formatted "hold for" patron name on catalog detail page
    
    This patch adds a space between first name and surname on the
    bibliographic detail page when there is "hold for" information in the
    status column of the holdings table.
    
    To test, apply the patch locate a title in the staff client catalog
    which has one or more confirmed holds on it. Verify that the patron's
    name in the "status" column of the holdings table looks correct, with a
    space between first and last name.
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a5b0aa20e553d7444778b2ca3d90c6e067d6fce1
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Aug 18 11:58:42 2016 -0400

    Bug 11019 - Require some fields when adding authorized value category
    
    This patch modifies the form for adding an authorized value so that
    the category is a required fields.
    Previously a new authorized value category could be saved with no data.
    
    To test, apply the patch and go to Administration -> Authorized values.
    
    - Click the "New category" button.
    - Click the save button without filling in the category.
      You should be prevented from submitting the form.
    - Verify that filling in the required field allows the form to be
      submitted.
    - Perform the same test when editing an existing authorized value.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Follow-up for QA: Allow a blank authorised value to be created.
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    Amended test plan.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8850540deafc471b9b356e35ae67780a51829271
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Aug 19 10:08:38 2016 -0400

    Bug 13921 - XSLT Literary Formats Not Showing
    
    This patch adds some missing literary formats to the staff client and
    OPAC's search results XSLT display.
    
    To test you must have DisplayOPACiconsXSLT and DisplayIconsXSLT system
    preferences enabled.  XSLTResultsDisplay and OPACXSLTResultsDisplay
    should be set to 'default.'
    
    Perform searches in the staff client and the OPAC and confirm that the
    following literary forms (defined in 008 position 33) display correctly:
    Not fiction; Fiction; Dramas; Essays; Novels; Humor, satires, etc.;
    Letters; Short stories; Mixed forms; Poetry; Speeches.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bfc72c91849b75a7ab4349f5d6a6798f3c6d0814
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 22 13:48:59 2016 +0100

    Bug 17157: Same for "More"
    
    Here I decided to redirect to the mainpage.
    
    Works as dexcribed.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1fe9c40da4e71bde460133ee6248503ce1025999
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 22 13:36:39 2016 +0100

    Bug 17157: Fix middle click on "Search" drowndown menu
    
    If you save an item and right click on "Search" or "More" you will get
    a software error:
    Can't call method "fields" on an undefined value at
    /usr/share/koha/intranet/cgi-bin/cataloguing/additem.pl line 742
    
    You will now be redirected to the adv search form.
    
    Wors as described.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a2a56ca441f33fb3772b89b85b0b40873b60e4e6
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jul 12 09:24:59 2016 -0400

    Bug 16903 - Multiple class attributes on catalog search tab
    
    cat-search.inc contains an element with two class attributes, which is
    invalid. This patch corrects it.
    
    To test, apply the patch and view any page which uses the cat-search
    include file to display the header search boxes. For instance, the
    bibliographic detail page.
    
    In the header, the "Search the catalog" box should be selected, and any
    text you type in the box should be carried over when you switch to
    different search tabs.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 58661d9b4be3398c24bbac8147a2d0b3f1f95d45
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 19 16:09:55 2016 +0100

    Bug 17118: (follow-up 15381) Fix regression when clearing a linked authority
    
    Changes made on bug 15381 assumed that the authid was always set.
    But if the user wants to clear the field of the authority, the script is
    called with authid=0 (FIXME...)
    
    To fix this issue, it's better to move the new calls to
      Koha::Authorities->find($authid)->authtypecode
    and
      Koha::Authority::Types->find($authtypecode);
    at the correct place
    
    Test plan:
    1. Edit a record which has a field linked to an
       authority record (100a for instance).
    2. Click the link which triggers the tag editor.
       A pop-up window should be displayed.
    3. In the pop-up window, click the "Clear field"
       button.
    => Without this patch A second pop-up window opens and displays an error:
      Can't call method "authtypecode" on an undefined value at /authorities/blinddetail-biblio-search.pl line 61.
    => With this patch applied the field is correctly cleared.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ff51ec00833dcd26af762d872075ab927921fe21
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 26 12:33:32 2016 +0000

    Bug 17201: (bug 16431 follow-up2) Remove occurrence of marcfromkohafield
    
    I really don't know how these tests passed before 16431, the mapping was not complete.
    
    Test plan:
      prove t/db_dependent/Search.t
    should return green
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b043eac50c024e9e2f5a79f6a0dc92d78a82efc8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 26 13:32:00 2016 +0100

    Bug 17201: (bug 16431 follow-up) Remove occurrence of marcfromkohafield
    
    I am not sure this code is called so I don't know how to test it.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1133d318c422d7fdfa4b1b093988e373ebb71222
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Tue Aug 30 20:20:17 2016 +0200

    Bug 17223 Follow-up: updated control file
    
    This is the control file change for the master branch triggered by
    the first patch.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2be60d395fe2062b503c0ae0cf96f7b0428881b7
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Aug 30 15:52:16 2016 +0200

    Bug 17223: Add Cache::Memcached to PerlDependencies
    
    Test plan:
    Check about page, perl modules.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a3082158e46cf643c99721052268e762e7050868
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 5 15:25:50 2016 +0100

    Bug 16449: Remove "no method selected" warning from unimarc_field_4XX
    
    Because of bug 14828, the unimarc_field_4XX now raises a warning:
    "No method selected!"
    
    There are no need to select an item type on this page, the default (all)
    is always selected.
    
    Test plan:
    Link the unimarc_field_4XX value builder with on of the subfield
    Edit a record, click on the value builder icon
    Note the warning without the patch and that it's gone with the patch
    applied
    
    NOTE: Code fix that I derived was identical. Ran
     prove t/db_dependent/FrameworkPlugin.t
    to confirm it works.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e31de618ddfb6f627d93a6bd5cffcdce570dfc4d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 7 18:07:32 2016 +0100

    Bug 16686: Add test for Koha::Item::Transfer[s] and Koha::Item->get_transfer
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 58b62864766c1e1edf9a5787ebe161a38916ea95
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 7 18:06:57 2016 +0100

    Bug 16686: Add Koha::Object based class for Koha::Item::Transfer[s]
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e023f838683f32f93516b33ce36780bd2669de12
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 7 18:04:27 2016 +0100

    Bug 16686: Rename the transfer method to get_transfer
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ecb11eaa1e69a461f34ecd4875071d2c7c69e3f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jul 3 15:32:47 2016 +0100

    Bug 16686: Fix "Item in transit from since" in Holds tab
    
    POC, tests needed.
    
    Alternative patch works for me.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eee1f59db3488508768df5c553d3b444588fb1b7
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 2 13:54:47 2016 +0000

    Revert Bug 17177 - This bug was for 3.20.x only
    
    This reverts commit b239aa988a1e5475236257d9af67417372d45923.

commit b239aa988a1e5475236257d9af67417372d45923
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Wed Aug 24 12:53:23 2016 +1200

    Bug 17177 - about.pl references a module that doesn't exist
    
    To test
    1/ Go to the about page, notice error
    2/ Apply patch
    3/ Notice error gone
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 30a0df493dc35e3aa9186f3b3c4c212d3b396a65
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 24 15:18:04 2016 +0000

    Bug 11144 [QA Followup] - Let each script run in sequence even if one fails
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Tested the A;B;C variant here. If A fails, B will run. Since we can safely
    assume that A (or B) will not fail on a daily basis, this seems to be better
    than running them in the wrong order every day.
    
    As the comments on Bugzilla show, several people support this improved
    (reordered) scheme and look forward to improved error handling on another
    report (obviously not that simple).
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 596ddef3c33f675f9daad675512fb119f80a23fa
Author: Katrin Fischer <Katrin.Fischer.83@web.de>
Date:   Tue Jun 9 23:13:15 2015 +0200

    Bug 11144: Fix sequence of cronjobs: automatic renewal - fines - overdue notices
    
    The patch changes the sequence of cronjobs in the crontab example
    file and in the cron.daily file of the packages.
    
    This is why:
    1) Renew automatically
       ... only when we can't renew, we want to
    2) Calculate fines
       ... once the fine are calculated and charged
       we can print the amount into the
    3) Overdue notices
    
    Before the change it could happen that you'd charge for an item,
    that would then be renewed. Or that you'd try to print fine
    amounts into the overdue notices, when they would only be
    charged moments later.
    
    To test:
    - configure your system so you have items that should
      - be charged with fines
      - renew automatically
    - configure your crontabs according to the example file
      or switch the cron.daily in your package installation with
      the new one
    - configure your overdue notices so that one should be generated
      <<items.fine>>
    - Wait for the cronjobs or schedule them to run earlier
    - Verify all is well and as it should be
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bff08b9962318f6eca873693936e369456f428e5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 19 14:36:23 2016 +0100

    Bug 17048: Fix pagination offset for authority searches
    
    At the intranet, the pagination has been broken by bug 12478 (Elastic
    Search). There was a confusion between the offset and the page number.
    
    At the OPAC, it is broken since bug 2735 which has mimicked the intranet
    script.
    
    Test plan:
    Search for a term which will return more than 1 page of results.
    Click on the second page
    => Without this patch, the first result of the second page is the second
    result of the first page
    => With this patch applied, the offset will be corrected
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6f5e2f8a865ebe07d4745171dda86c2cbb0e6fe1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 12 11:36:06 2016 +0100

    Bug 17116: Fix CSRF in import_borrowers.pl
    
    If an attacker can get an authenticated Koha user to visit their page
    with the url below, they can change patrons' information
    
    The exploit can be simulated triggering
      /tools/import_borrowers.pl?uploadborrowers=42
    
    In that case it won't do anything wrong, but it you POST a valid file,
    it could.
    
    Test plan:
    Trigger the url above
    => Without this patch, you will the result page
    => With this patch, you will get the "Wrong CSRF token" error.
    
    Regression test:
    Import a valid file from the import patron form, everything should go
    fine.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0646478be01a63fa0b6dc666f23a915ceefd5619
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 2 12:25:59 2016 +0000

    Bug 14868 - Update swagger.min.json
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f2da856d754119ee40014f4b83c046e5dc4ce5a0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Aug 31 20:21:12 2016 -0300

    Bug 14868: (QA followup) POD fixes
    
    To make the QA scripts happy, the POD needed a fix, and also
    keys applied to a hashref needs to be avoided.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1fc17eacc5418a3dcde25aa45d82adb825034fad
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Aug 31 20:11:05 2016 -0300

    Bug 14868: (QA followup) Change permission check order
    
    This patch changes the permission check order because haspermission
    is the smaller check, and going through the patron/user and its guaranteed
    before checking if it is (say) a staff member or even a superlibrarian doesn't
    seem right.
    
    Bonus: Remove unneeded C4::Auth import in Patron.pm
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 985265c0be182342374f50d95493ec3d50bdd5e0
Author: Lari Taskula <larit@student.uef.fi>
Date:   Tue Aug 23 15:38:44 2016 +0300

    Bug 14868: Display required permissions in permission error response
    
    When user does not have required permissions to use API operation, it would be
    useful to let them know which permissions he is missing. Since they are now
    defined in Swagger, we can easily render them into the response.
    
    To test:
    1. Use a patron without any permissions
    2. Make GET request to http://yourlib/api/v1/patrons
    3. Observe permission error and see that required_permissions are displayed.
    4. Run t/db_dependent/api/v1/patrons.t
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 00a50a9400fd606fdaed59574d0ae5bdf8fe3f2a
Author: Lari Taskula <larit@student.uef.fi>
Date:   Thu Aug 11 14:45:16 2016 +0300

    Bug 14868: Use x-koha-authorization in current routes
    
    To test:
    1. Run t/db_dependent/api/v1/holds.t
    2. Run t/db_dependent/api/v1/patrons.t
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cac40ca7027f9701d4f820481c3b1a577ca3eb61
Author: Lari Taskula <larit@student.uef.fi>
Date:   Fri Jun 17 11:43:52 2016 +0300

    Bug 14868: Give users possibility to request their own object
    
    Allow access to user's own objects even if they do not have required permissions.
    This will be very useful in many cases where an user wants to request their own
    object, for example renewing their checkouts or placing a hold for themselves.
    
    First, this patch renames "x-koha-permission" to "x-koha-authorization" in order
    to describe the new functionality better.
    
    Second, we can now add two extra parameters under "x-koha-authorization":
    - "allow-owner"; Allows the owner of object to access it (without permission)
    - "allow-guarantor"; Allows guarantor of the owner of object to access it
                         (without permission)
    
    Third, since permission checking is outside of actual controller, we need a way
    to find out ownership from different types of parameters, e.g. checkout_id from
    /checkouts/{checkout_id}, borrowernumber from /patrons/{borrowernumber} etc.
    A solution is to match the parameter with a subroutine that is designed to verify
    the ownership for that object. See the new subroutines in Koha::REST::V1.
    
    To use this functionality you will simply define it in Swagger:
    "/patrons/{borrowernumber}": {
      "get": {
        ...,
        "x-koha-authorization": {
          "allow-owner": true,
          "permissions": {
            "borrowers": "1"
          }
        }
      }
    }
    
    If a parameter that is not yet defined in Koha::REST::V1::check_object_ownership,
    you also need to define it and implement a subroutine that determines ownership.
    
    Tests are provided in a following patch that adds this functionality for current
    API operations.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac1286dacdf92239ee91bf7932356adca7c486d2
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Mon Sep 14 15:20:20 2015 +0300

    Bug 14868: Swagger2-driven Permission checking
    
    Define 'x-koha-permission' for the Swagger2 Operation Object, to automatically
    authorize against the required permissions.
    
    This way we immediately tell the API consumer in the Swagger2-definition, which
    permissions are needed to access defined resources.
    Also we don't need to maintain permissions in multiple locations and we can build
    a smart testing framework to help a lot in creating tests for the new REST API.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 49df1cc10f45c1e7d9b15808a302df2a67dbb876
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jul 26 15:00:58 2016 +0000

    Bug 16942 [QA Followup] - Add unit test
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 49af4e0ddf7ffa666ee055b80c7c4a66a995629d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jul 19 16:57:25 2016 +0000

    Bug 16942 - Confirm hold results in ugly error
    
    Confirming a hold to set it to waiting will result in an DBIC error in
    master.
    
    Test Plan:
    1) Attempt to check in an item on hold and confirm the hold
    2) Note the error
    3) Apply this patch
    4) Repeat step 1
    5) Note there is no error!
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    https://bugs.koha-community.org/show_bug.cgi?id=14942
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 53631f9ffdc86c1afbcc3108ac3ddf1f73fef40e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Aug 25 14:52:47 2016 -0300

    Bug 16699: (QA followup) Move minified swagger file into the swagger/ dir
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eeab7d0666677e3bb7ec4e56bcb5a7164aeab48e
Author: Lari Taskula <larit@student.uef.fi>
Date:   Thu Aug 11 15:51:38 2016 +0300

    Bug 16699: Remove requirement from borrowernumberQueryParam
    
    borrowernumberQueryParam shouldn't be required as also changed in Bug 16271.
    
    To test:
    1. Don't apply the patch yet, but first minify Swagger and run
       t/db_dependent/api/v1/holds.t
    2. Observe that some tests fail with response code 400 when expecting 200.
    3. Apply patch and minify Swagger
    4. Run t/db_dependent/api/v1/holds.t
    5. Observe that tests pass.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7b8c7b038f4e40b53bcc861a3f265691a2ccb74d
Author: Lari Taskula <larit@student.uef.fi>
Date:   Tue Jun 14 17:27:36 2016 +0300

    Bug 16699: Move Swagger-related files to api/v1/swagger
    
    This patch separates Swagger-specifications and the minifySwagger.pl from other
    api-files by moving specifications & minifier into api/v1/swagger.
    
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    My name is Olli-Antti Kivilahti and I approve this commit.
    We have been using the Swagger2.0-driven REST API on Mojolicious for 1 year now
    in production and I am certain we have a pretty good idea on how to work with
    the limitations of Swagger2.0
    We participated in the development of the Mojolicious::Plugin::Swagger and know
    it well. We have made an extension to the plugin to provide full CORS support
    and have been building all our in-house features on the new REST API.
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    
    My name is Johanna Räisä and I approve this commit.
    We have been using Swagger2.0-driven REST API in production successfully.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c523c1e0563a51087d901cbeed0cd93c839fc9cb
Author: Lari Taskula <larit@student.uef.fi>
Date:   Tue Jun 14 14:24:42 2016 +0300

    Bug 16699: Reference new x-primitives in currently defined objects
    
    Since we have defined some basic x-primitives in x-primitives.json, we can now
    start to reuse them in our currently defined objects.
    
    To test:
    1. Apply patch
    2. Run minifySwagger.pl
    3. Validate your Swagger specifications
    4. Observe that validation passes
    
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    My name is Olli-Antti Kivilahti and I approve this commit.
    We have been using the Swagger2.0-driven REST API on Mojolicious for 1 year now
    in production and I am certain we have a pretty good idea on how to work with
    the limitations of Swagger2.0
    We participated in the development of the Mojolicious::Plugin::Swagger and know
    it well. We have made an extension to the plugin to provide full CORS support
    and have been building all our in-house features on the new REST API.
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    
    My name is Johanna Räisä and I approve this commit.
    We have been using Swagger2.0-driven REST API in production successfully.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 55a8389bb3ad28151b0eaeaa3d0d2ff32ad09c24
Author: Lari Taskula <larit@student.uef.fi>
Date:   Tue Jun 14 12:53:58 2016 +0300

    Bug 16699: Support multiple types in primitive definitions
    
    Currently it is not possible to define multiple types for primitive definitions
    in /definitions/*. If you try to use the following
    "firstname": {
      "type": ["string", "null"],
      "description": "patron's first name"
    }
    in definitions.json, online.swagger.io validator will not validate it:
    {"messages":["attribute definitions.firstname.type is not of type `string`"]}
    
    One way to get around this issue is to extend definitions with custom
    "x-primitives" object, where we will define all reusable primitive definitions.
    
    To test:
    1. Add the "firstname" example above to definitions.json
    2. Run minifySwagger.pl
    3. Validate your specification
    4. Observe that error with description mentioned above is given
    5. Apply patch
    6. Repeat step 2 and 3
    7. Observe that validation passes
    
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    My name is Olli-Antti Kivilahti and I approve this commit.
    We have been using the Swagger2.0-driven REST API on Mojolicious for 1 year now
    in production and I am certain we have a pretty good idea on how to work with
    the limitations of Swagger2.0
    We participated in the development of the Mojolicious::Plugin::Swagger and know
    it well. We have made an extension to the plugin to provide full CORS support
    and have been building all our in-house features on the new REST API.
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    
    My name is Johanna Räisä and I approve this commit.
    We have been using Swagger2.0-driven REST API in production successfully.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2aa333fb5fefe3f5fb2eca7bdb435b12cb6ab4cc
Author: Lari Taskula <larit@student.uef.fi>
Date:   Fri Jun 10 17:25:40 2016 +0300

    Bug 16699: Fix mixed-up indentation from 2-4 spaces to 2 spaces
    
    These definitions had indentation of 4 spaces, while rest of the specification
    uses 2 spaces. This patch simply maintains the consistency in indentations and
    provides no other modifications to code.
    
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    My name is Olli-Antti Kivilahti and I approve this commit.
    We have been using the Swagger2.0-driven REST API on Mojolicious for 1 year now
    in production and I am certain we have a pretty good idea on how to work with
    the limitations of Swagger2.0
    We participated in the development of the Mojolicious::Plugin::Swagger and know
    it well. We have made an extension to the plugin to provide full CORS support
    and have been building all our in-house features on the new REST API.
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    
    My name is Johanna Räisä and I approve this commit.
    We have been using Swagger2.0-driven REST API in production successfully.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit baaeb725d2fced741c84efedb506ab54df3a7f97
Author: Lari Taskula <larit@student.uef.fi>
Date:   Fri Jun 10 16:52:54 2016 +0300

    Bug 16699: Add borrowernumberQueryParam for reusability
    
    The borrowernumber as a query parameter should be defined in parameters.json
    in order to allow its reusability.
    
    To test:
    1. Apply patch
    2. Run minifySwagger.pl
    3. Validate swagger.min.json in online.swagger.io/validator/debug?url=url_to+
       _your_swagger_min_json or your local swagger-api/validator-badge validator
    4. Observe that validation passes
    
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    My name is Olli-Antti Kivilahti and I approve this commit.
    We have been using the Swagger2.0-driven REST API on Mojolicious for 1 year now
    in production and I am certain we have a pretty good idea on how to work with
    the limitations of Swagger2.0
    We participated in the development of the Mojolicious::Plugin::Swagger and know
    it well. We have made an extension to the plugin to provide full CORS support
    and have been building all our in-house features on the new REST API.
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    
    My name is Johanna Räisä and I approve this commit.
    We have been using Swagger2.0-driven REST API in production successfully.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0eaf72ab26457929a8485e5f3dc183452300794b
Author: Lari Taskula <larit@student.uef.fi>
Date:   Thu Jun 9 16:13:53 2016 +0300

    Bug 16699: Split parameters and paths in Swagger
    
    Parameters and paths should be split in our Swagger specification, because
    otherwise swagger.json would become messy with all the paths and their
    further specification in the same file. Also parameters should be split
    for the same reason.
    
    Instead of using index.json for definitions, parameters and paths, we define
    new files "definitions.json", "parameters.json" and "paths.json" in order to
    simplify the references. If we kept using index.json and try to reference
    "/definitions/error.json" from "/paths/holds.json", reference would be
    "../definitions/index.json#/error" instead of now simplified version,
    "../definitions.json#/error".
    
    Here is the proposed structure:
    
    .
    ├── swagger.json
    ├── definitions.json
    ├── paths.json
    ├── parameters.json
    ├── definitions
    │   └── error.json
    │   └── patron.json
    ├── parameters
    │   └── patron.json
    ├── paths
    │   └── patrons.json
    ├── minifySwagger.pl
    └── swagger.min.js
    
    The swagger.json paths, definitions and parameters will look as follows:
    ...
      "paths": {
        "$ref": "paths.json"
      },
      "definitions": {
        "$ref": "definitions.json"
      },
      "parameters": {
        "$ref": "parameters.json"
      }
    ...
    
    A problem with splitting specification into multiple files directly from
    swagger.json (e.g. "paths": { "$ref": "paths.json" }) is that it is not
    following the Swagger specification and an error will be thrown by the
    Swagger-UI default validator (online.swagger.io/validator).
    
    To overcome this problem, we use the minifySwagger.pl script from Buug 16212.
    This allows the developers to work with the structure introduced in this patch
    thus allowing developers to split the specification nicely, and still have a
    valid Swagger specification in the minified swagger.min.json.
    
    To test:
    -2: Apply the minifier-patch in Buug 16212.
    -1: Make sure you can validate your specification with Swagger2 validator at
        online.swagger.io/validator/debug?url=url_to_swaggerjson, or install it
        locally from https://github.com/swagger-api/validator-badge.
    
    1. Don't apply this patch yet, but first validate swagger.json
       with swagger.io-validator (or your local version, if you installed it)
    2. Observe that validation errors are given
    3. Run minifySwagger.pl
    4. Validate swagger.min.json with the validator you used in step 1
    5. Observe that validation passes and we overcame the invalid specification
       problem in swagger.min.json
    6. Apply this patch
    7. Run minifySwagger.pl
    8. Repeat step 4
    9. Observe that validation passes with new structure
    10. Run REST tests at t/db_dependents/api/v1
    
    (11. Study the new structure of our Swagger specifications :))
    
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    My name is Olli-Antti Kivilahti and I approve this commit.
    We have been using the Swagger2.0-driven REST API on Mojolicious for 1 year now
    in production and I am certain we have a pretty good idea on how to work with
    the limitations of Swagger2.0
    We participated in the development of the Mojolicious::Plugin::Swagger and know
    it well. We have made an extension to the plugin to provide full CORS support
    and have been building all our in-house features on the new REST API.
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    
    My name is Johanna Räisä and I approve this commit.
    We have been using Swagger2.0-driven REST API in production successfully.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d368059fd5f25a1b1946d0bb6ce4b87d8ebe6691
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 22 10:34:48 2016 -0300

    Bug 14504: (followup) Make deletion conditional on --commit
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b14b7988f92785734e78c55ceb4ce9137af78ca2
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Tue Aug 16 20:36:49 2016 +0000

    Bug 14504: (QA followup) Change argument --criteria to --where
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d28562c60f1e36f5336a5b2899ee22eb1a8b6977
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Tue Aug 16 20:27:16 2016 +0000

    Bug 14504: (QA followup) Fix error causing item not to be deleted
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7514aeb7fb53a58fc15d8631e5bcd5d6fa886f24
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Aug 16 16:40:46 2016 +0000

    Bug 14504: Changes missed while fixing patches
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 11ddbc817d899755cc27b18133c5a46d865c1831
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 8 09:51:18 2016 -0300

    Bug 14504: (QA followup) Fix delete_records_via_leader.pl call to DelItemCheck
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0519b6a6bc73195ab598fa533a48f603bf6aab17
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 8 09:45:12 2016 -0300

    Bug 14504: (QA followup) Tidy tests
    
    This patch re-introduces the transaction into t/db_dependent/Items_DelItemCheck.t
    and does some cleaning on the touched tests so they raise less warnings.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6e452b520f69b7cfea65f682f0821af395362b46
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Wed May 25 07:12:43 2016 -0700

    Bug 14504: (QA followup) fix test transaction, book_on_loan
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c02b33e4254c72d20941f87fe7a5c58bcb5838f9
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Thu Oct 29 06:06:08 2015 -0700

    bug 14504: (QA followup) fixing DelItemCheck arguments
    
    Remove $dbh as argument to C4::Items::DelItemCheck
    and C4::Items::ItemSafeToDelete, also change all
    calls to these functions throughout the codebase.
    
    Also remove remaining reference to 'do_not_commit' in
    t/db_dependent/Items_DelItemCheck.t
    
    Fixed doubled "$$" in C4/ImportBatch.pm
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 59ac9be07e70b23c2dfcd009f6d5f689d1065c9b
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Mon Oct 26 09:01:50 2015 -0700

    Bug 14504: (QA followup) use TestBuilder, remove do_not_commit
    
    Use t::lib::TestBuilder in t/db_dependent/Items_DelItemCheck.t
    
    Remove the option 'do_not_commit' from C4::Items::DelItemCheck.
    
    Whitespace cleanup.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5aa18084238d7cafc2a02c734b88b165011f59a0
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Thu Oct 22 14:06:10 2015 -0700

    bug 14504: use C4::Items::DelItemCheck in delete_items.pl
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8911bd6afff34c62aa92c87b005f52a09d62331d
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Thu Oct 22 12:24:33 2015 -0700

    bug 14504: split logic from DelItemCheck() into ItemSafeToDelete()
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 93504aea26054f436a9e98fcbef0274a0ac64f38
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Thu Oct 15 13:40:29 2015 -0700

    Bug 14504: (QA followup)
    
    * Fix POD warning.
    * Remove redundant 'use stric' and 'use warnings'
    * Remove $VERSION and --version option.
    * Remove --dry-run option
    * Split test for --help and check for @criteria into two separate pod2usage calls,
        enabling -msg on the latter.
    * Fix 'target_tiems' typo.
    * Test for holds on items to be deleted.
    * Fix whitespace
    * Fix test for holds.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c8eeadf6644ea3a5c15ba488db28ee2c2725c9ec
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Tue Jul 7 13:07:52 2015 -0700

    Bug 14504: Add delete_items.pl: a command line batch deletion tool
    
    http://bugs.koha-community.org/show_bug.cgi?id=14504
    
    Signed-off-by: Heather Braum <hbraum@nekls.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4b140a2e914f76fd283de50fb1c061376e22f444
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Aug 25 12:50:01 2016 +0000

    Bug 16212 - Generate initial swagger.min.json file
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit acee02948831d9105e4a7e31a003cf74dfd421be
Author: Lari Taskula <larit@student.uef.fi>
Date:   Tue Jun 14 16:01:24 2016 +0300

    Bug 16212: Use swagger.min.json insted of swagger.json
    
    Our current approach with splitting the Swagger specification brings problems.
    For example, in swagger.json, if we split the whole "definitions" object with
    $ref, validations will fail with online.swagger.io validator.
    
    (See http://online.swagger.io/validator/debug?url=url_to_your_swagger_json)
    
    The problem also occurs with "paths" (Paths Object), because simply $ref to all
    paths for example in /paths/index.json does not meet the Swagger2 specification.
    
    The problem is solved by using the minification script and the minified version
    of swagger.json after which the swagger.min.json is valid Swagger2 specification,
    because the minifier resolves the problematic $refs of swagger.json file in the
    minified version.
    
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    My name is Olli-Antti Kivilahti and I approve this commit.
    We have been using the Swagger2.0-driven REST API on Mojolicious for 1 year now
    in production and I am certain we have a pretty good idea on how to work with
    the limitations of Swagger2.0
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    
    My name is Johanna Räisä and I approve this commit.
    We have been using Swagger2.0-driven REST API in production successfully.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1f71fe9eb5cc3de869643f565392a6705cea8c40
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Apr 6 13:16:50 2016 +0200

    Bug 16212: Add script minifySwagger.pl
    
    This patch introduces the misc/devel/minifySwagger.pl script that
    loads the Swagger files, follows references and produces a compact
    ("minified") version of the swagger file which is suitable for
    distribution.
    
    The wiki page should be updated with instructions on how to regenerate
    it so the Release Manager does it on each spec upgrade.
    
    Signed-off-by: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
    
    My name is Olli-Antti Kivilahti and I approve this commit.
    We have been using the Swagger2.0-driven REST API on Mojolicious for 1 year now
    in production and I am certain we have a pretty good idea on how to work with
    the limitations of Swagger2.0
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    
    My name is Johanna Räisä and I approve this commit.
    We have been using Swagger2.0-driven REST API in production successfully.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fa48df281d68fe1d27cc6fb10b41e4504a70afb9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Aug 23 16:33:10 2016 +0200

    Bug 14390: [Follow-up] Only update FU record in UpdateFine
    
    Exclude O, F and M when outstanding == 0.
    Check if the issue_id points to a FU record.
    
    Note: We only warn now when we see a second FU record with this issue id.
    That should be a rare exception. As before, we are just counting it in
    our total. Added a FIXME.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested fine on overdue. Renewed and backdated for a second fine. The F
    and FU can be seen on the Fines tab and are totaled on Check out.
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4fa4b8a30649381523fec729b0ee5d40f896155b
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 19 09:57:13 2016 +0200

    Bug 14390: [QA Follow-up] UpdateFine should be passed a hash
    
    Renewing an overdue would not work.
    Log shows:
    renew: Can't use string ("2144746608") as a HASH ref while "strict refs" in use at C4/Overdues.pm line 508., referer: /cgi-bin/koha/circ/circulation.pl?borrowernumber=1
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 59d2cd97573c2caa9142bdfdc2be328f9e865429
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Dec 1 17:59:25 2015 +0000

    Bug 14390 [QA Followup] - Fix warning
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 57e5c70ed4004fe501840db97cc4ffdd47687247
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Dec 1 16:53:03 2015 +0000

    Bug 14390 [QA Followup] - Unit Test
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fe71eb0811a6271fff568ca6b599514a57ff3206
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Nov 6 13:20:56 2015 -0500

    Bug 14390 - Fine not updated from 'FU' to 'F' on renewal
    
    Test Plan:
    1) Find an overdue checkout with a fine
    2) Renew item, note fine is not closed out (Account type F)
    3) Apply this patch
    4) Find another overdue checkout with a fine
    5) Renew item, note fine is now correctly closed out
    6) Backdate a checkout to be already overdue ( but not have a fine since
        fines.pl hasn't run yet )
    7) Renew item, note a closed out fine is created
    
    Signed-off-by: Sean Minkel <sminkel@rcplib.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d44732bacd87fb304990b91d06786eda82b46cba
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 27 12:24:15 2016 -0300

    Bug 15023: (followup) Remove warnings
    
    By setting 'use Modern::Perl' some previously hidden warnings arised.
    This patch removes them by testing the variable $balance for undef
    before using it in a comparisson.
    
    Sponsored-by: VOKAL
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 38c461f258292adb6199f2b0f261ecc3280b6aa5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 27 12:12:52 2016 -0300

    Bug 15023: Allow patron anonymize/bulk delete tool to be limited by branch
    
    This patch makes the bulk patron delete/anonymize functionality be limited
    by branch. It does so by adding a branch selection dropdown and using the
    already defined APIs for filtering by branch.
    
    It makes use of C4::Branches::onlymine for the IndependentBranches use case
    and it adds a way to call it from the Branches template plugin.
    
    To test:
    - Apply the patch
    1) Have a superlibrarian user
    - Go to Tools > Batch patron deletion/anonymization
    => SUCCESS: Verify you can pick a branch (or all of them)
    - Try doing some operations
    => SUCCESS: Verify the selection is respected, and carried around all steps
    2) Have a user with tools/delete_anonymize_patrons permissions
    - Set IndependentBranches on
    - Go to Tools > Batch patron deletion/anonymization
    => SUCCESS: It picks the librarian's branch and doesn't let us choose another one
    - Try doing some operations
    => SUCCESS: Verify the user's branch is respected, and carried around all steps
    - Sign off :-D
    
    Sponsored-by: VOKAL
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit adbcaa99f4f1a0dc3c739cb15b4d3039d2a79c9e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Aug 19 14:59:04 2016 -0300

    Bug 17050: (QA followup) Use Mojo::Transaction to get the remote address
    
    While the original patch fixes the issue, reading at Mojolicious source code, revealed
    that Mojo::Transaction already has proper processing for detecting the remote address:
    
    sub remote_address {
      my $self = shift;
    
      return $self->original_remote_address(@_) if @_;
      return $self->original_remote_address unless $self->req->reverse_proxy;
    
      # Reverse proxy
      return ($self->req->headers->header('X-Forwarded-For') // '') =~ /([^,\s]+)$/
        ? $1
        : $self->original_remote_address;
    }
    
    Without this patch, if there's a request without HTTP_X_FORWARDED_FOR, then the remote
    address would be empty. Such would be the case of a dev/standard setup without Plack.
    
    This patch makes Koha::REST::V1::startup use tx->remote_address instead of dealing with the
    headers on its own.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b5fc3d29373d2b6eecd9f3d26c798d603dae7d84
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 5 15:03:28 2016 +0000

    Bug 17050: Do not kick the session out when accessing the REST API
    
    Mojolicious does not set $ENV{REMOTE_ADDR} (neither $ENV{HTTP_*}) as
    it may share ENV between different requests.
    Fortunately for us, Plack does not!
    
    This is a dirty patch to fix this issue but it seems that there is not
    lot of solutions. It adds a remote_addr parameter to
    C4::Auth::check_cookie_authin order to send it from
    Koha::Rest::V1::startup reading the headers sent by Mojolicious.
    
    Test plan:
    Hit /cgi-bin/koha/mainpage.pl
    Hit /api/v1/patrons/42
    Hit /cgi-bin/koha/mainpage.pl
    
    With this patch applied, everything will be fine and you won't be
    logged out.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3315a883ed055554627c26ace0581e8fd6426b83
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 22 13:07:54 2016 +0100

    Bug 17023: Repair "cancel" link
    
    The basketno param has been removed in previous patch.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 68407f4cf06b4063241582183c65cc66278f2c37
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 19 13:39:35 2016 +0100

    Bug 16960: Delete previous patron modifications
    
    If a patron edit his/her details a second time, we need to delete the
    first ones to avoid a "duplicate entry for key PRIMARY" error.
    
    Test plan:
    Log in at the OPAC
    Edit your details
    Edit them again
    => Without this patch, Koha will crash
    => With the patch applied, everything should work as expected
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7a33e3ba75cdfdf60e3c1403ecc542f084ffc851
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 8 13:46:43 2016 +0100

    Bug 16960: Fix error on validating the registration
    
    Followed steps in comment #14, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5c2f4cc7e08f5be6bbaabc6c86e87050189472cc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Aug 5 11:43:52 2016 +0100

    Bug 16960: Update 1 missing occurrence of GetModifications
    
    Signed-off-by: Bob Birchall <bob@calyx.net.au>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1016139132000fbbb44ded12eda279d676f260f9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jul 22 16:50:50 2016 +0000

    Bug 16960 - Patron::Modifications should be fixed
    
    The changes from opac-memberentry do not reach the table, since the
    Patron::Modifications object does not work well.
    
    Test Plan:
    1) Apply this patch
    2) Create some patron modification requests
    3) Ensure you can approve and deny modifications
    4) Ensure patron self registration works
    
    Signed-off-by: Bob Birchall <bob@calyx.net.au>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 29b4ee5c74949d9706387b1d02b858cd697a57d6
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Aug 11 10:39:31 2016 +0200

    Bug 17106 - DataTables patron search defaulting to 'starts_with' - doc
    
    Bug 15930 modified default value for DataTables patron search.
    
    The doc text should also be modified :
    "Can be 'contain' or 'start_with' (default value). Used for the
    searchmember parameter."
    
    Test plan :
    - install Koha with patch
    - look at man page man/man3/C4::Utils::DataTables::Members.3pm
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 97552074f028eefe81d27a4cba681bd5f0f1cd95
Author: Marc Véron <veron@veron.ch>
Date:   Wed Aug 10 10:12:55 2016 +0200

    Bug 16741 - Remove dead code "sub itemissues" from C4/Circulation.pm
    
    To verify:
    - git grep itemissues
    Result: Appears in C4/Circulation.pm only
    
    To test:
    - apply patch
    - git grep itemissues
    Expected result: No occurences
    - prove t/db_dependent/Circulation.t
    Expected result: Pass OK
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f8230d5d0a6f20f0e054744221d5ad4b1ca467e3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 15 15:11:19 2016 +0100

    Bug 17100: Restore previous logic
    
    There is no need to change the previous logic here, so let's restore it.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 492a64cef95c6afb1644cbb4f1be181c2442cbd8
Author: Marc Véron <veron@veron.ch>
Date:   Wed Aug 10 11:42:28 2016 +0200

    Bug 17100: Do not display payments if patron has nothing to pay
    
    This alternative patch moves logic and formatting to the template file.
    
    To test:
    * without patch
      1/ find a patron with no lines in accountlines table : print summary shows no "account fines and payments" => OK
      2/ find a patron with some lines in accountlines table and the total amount > 0 : print summary shows a table "account fines and payments" with fines to recover => OK
      3/ find a patron with some lines in accountlines table but the total amount = 0 : print summary shows a table "account fines and payments" with nothing in it => NOK
    
    * with the patch, same cases as before :
      1/ same as without patch
      2/ same as without patch
      3/ print summary does not show "account fines and payments"
    
    - Additionally, verify that formatting follows syspref 'CurrencyFormat'
    - Verify that amount column is right-aligned
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 761001add1a95d147a23b74e8d817890ffc08ac5
Author: Galen Charlton <gmcharlt@gmail.com>
Date:   Fri Jul 29 20:41:19 2016 +0000

    Bug 17001: fix due date filter on the overdue report
    
    When the TimeFormat system preference is set to "12 hour",
    setting a filter on the due date can result in:
    
    - no overdue loans being reported, even if there are some
      that meet the criteria
    
    OR
    
    - overdue loans being omitted from the report if they
      are due on the "until" date in the filter
    
    This patch fixes this by replacing output_pref() with
    DateTime::Format::MySQL to format the date filter values
    to pass to the SQL query.
    
    To test
    -------
    [1] Run the overdue report (circ/overdue.pl) and set a filter
        on due date, using values that should bring up one or
        more overdue loans.
    [2] Note that zero overdue loans are returned (if using MySQL
        5.5, 5.6, or 5.7 or MariaDB 5) or that loans due on the
        "until" date are omitted (if using MarioDB 10).
    [3] Apply the patch and repeat step 1. This time, the correct
        set of overdue loans should be reported.
    
    Signed-off-by: Galen Charlton <gmcharlt@gmail.com>
    
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4884f3a00a99c959059b7d12544c271a1e1ab616
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Aug 11 10:58:40 2016 +0200

    Bug 17107 - Add ident and Identifier-standard to known indexes
    
    Add ident and Identifier-standard to known indexes in C4::Search::getIndexes().
    Those indexes can be very useful, for example for IdRef feature.
    
    Test plan :
    - Make sure some records have a field indexed with Identifier-standard, ISBN=1234 for example
    - Perform a search /cgi-bin/koha/opac-search.pl?idx=ident,phr&q=1234
    => you find the record
    - Perform a search /cgi-bin/koha/opac-search.pl?q=ident:1234
    => Without patch : you get no results
    => With patch    : you find the record
    Idem for 'Identifier-standard'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5ec898b401670c822e159e3ae6f0e0ecb36bc789
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 20:08:54 2016 +0100

    Bug 17095: (bug 16849 follow-up) Fix regression if patron does not exist
    
    Bug 16082, 'Display a friendly "patron does not exist" message if that's the
    case - circulation.pl' changed the behavior of the checkout page so that if
    you hit that page with a borrowernumber which doesn't exist a nice message will
    tell you so.
    
    Now when you do that you get an error message:
      Can't call method "is_debarred" on an undefined value at /circ/circulation.pl line 300.
    
    Test plan:
    confirm that the friendly message is back :)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 739eaa82e8b52a1ef83e995badc7ddfa3a32e3fc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 1 13:46:49 2016 +0100

    Bug 17009: Speed up the framework duplication
    
    To duplicate frameworks, the code retrieve all the subfields, then
    execute 1 insert per subfield.
    It's unnecessary slow, we can use the DBMS to do it.
    
    Test plan:
    Create a new framework and duplicate the structure of another framework.
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fb449aaede3f23ee71e9e50286a26035bb3ef640
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Fri Aug 12 16:19:52 2016 +0200

    Bug 17117: Patron personal details not displayed unless branch update request is enabled
    
    In patron acount ("your personal details" tab, which serves as a form
    for submitting update requests as well) it's not possible to display
    some account details like expiration date etc., without enabling
    the field for branch / library update requests too.
    
    To reproduce:
    
    1) set OPACPatronDetails to "Allow"
    2) clear PatronSelfModificationBorrowerUnwantedField preference
    - all possible fields in the update requests form are visible
    in patron account, including some extra details (card number,
    expiration date, category) in the "Library" section on top
    3) put 'branchcode' in PatronSelfModificationBorrowerUnwantedField preference
    4) the whole 'Library' section disappears
    
    To test:
    
    1) apply patch
    2) put 'branchcode' in PatronSelfModificationBorrowerUnwantedField,
    'Library' section should remain visible (sans branch selection option)
    3) put 'branchcode|cardnumber|datexpiry|categorycode' in the same
    preference, 'Library' section should now disappear
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1bc34e31e9c371d8f60a074f13e933d15a31e20e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 15 09:26:16 2016 +0100

    Bug 17124: Fix tests in DecreaseLoanHighHolds.t
    
    One test of DecreaseLoanHighHolds.t does not pass,
    A hashref representing a patron has a 'borrower' key defined, instead of
    'borrowernumber'.
    
    Test plan:
      prove t/db_dependent/DecreaseLoanHighHolds.t
    must return green
    
    Signed-off-by: Claire Gravely <claire_gravely@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 23a4b3163128592a464d910d94942087da7990f9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 12 09:15:01 2016 +0200

    Bug 17097: [QA Follow-up] Exit after redirect
    
    Adds one exit statement, and some whitespace.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Verified deleting a patron again.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0316fc730907c66cdab8e5ee5530a39dcbc4d6fd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 10 12:18:04 2016 +0100

    Bug 17097: here the var is 'member', not 'borrowernumber'
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fcf38896bd738767c3a9c4c1e8909a199f480a30
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 22:29:25 2016 +0100

    Bug 17097: Fix CSRF in deletemem.pl
    
    If an attacker can get an authenticated Koha user to visit their page
    with the url below, they can delete patrons details.
    
      /members/deletemem.pl?member=42
    
    Test plan:
    
    0/ Do not apply any patches
    1/ Adapt and hit the url above
    => The patron will be deleted without confirmation
    2/ Apply first patch
    3/ Hit the url
    => you will get a confirmation page
    4/ Hit /members/deletemem.pl?member=42&delete_confirmed=1
    => The patron will be deleted without confirmation
    5/ Apply the second patch (this one)
    6/ Hit /members/deletemem.pl?member=42&delete_confirmed=1
    => you will get a crash "Wrong CSRF token" (no need to stylish)
    7/ Delete a patron from the detail page and confirm the deletion
    => you will be redirected to the patron module home page and the patron
    has been deleted
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 13a61279523b35370f7b3adeb0f47ad30bfa937d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 22:18:14 2016 +0100

    Bug 17097: Add a confirmation page when deleting a patron
    
    It won't hurt to have a confirmation page when deleting a patron.
    Moreover it's the more easy way to protect against CSRF attacks :)
    
    Test plan:
    Make sure you get a confirmation page when deleting a patron
    Confirm that approving or denying the confirmation work as expected
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 84812129c979557cd2232c3a8b5b0f01c368a634
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 09:43:01 2016 +0100

    Bug 16955: Do not clear from cache when adding a new framework
    
    There are several issues with these lines:
    1/ $cache is not defined correctly and it not visible inside
    duplicate_framework
    2/ $frameworkcode is a wrong c/p, it should be $newframeworkcode
    3/ these calls are not needed. As we are creating a new framework, the cache
    should be empty...
    
    This patch will simply remove these calls
    
    Test plan:
    Duplicate a framework and confirm that you do not get any error in your
    logs.
    
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6cd1891ffe5903a09e2deb04e852e967a2187ba0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 8 15:11:56 2016 +0100

    Bug 16996: (follow-up) Do not explode if mandatory fields are missing
    
    When registering a new patron, if something went wrong, the form is
    resent to the template but without the categorycode (not a dropdown list
    anymore, but just displayed as a readonly value # TODO LATER).
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8c5cb134ee75aad77a9ba9b9fd84005fc0a9feb3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 3 16:28:24 2016 +0100

    Bug 16996: Do not explode if mandatory fields are missing
    
    At the OPAC, if a patron modify his/her information and at least 1
    mandatory field is missing, Koha will crash with
      Template process failed: undef error - Can't call method "description"
    
    It is raised by Koha::Template::Plugin::Categories::GetName called with
    an undefined categorycode.
    The problem is that the values sent originaly are not sent back to the
    template if the user missed something.
    This patch makes that all info are resent to the template in order to
    show the same form to the user.
    
    Test plan:
    0. Apply patch
    
    1. Make sure that the categorycode is not hidden in the OPAC in:
         PatronSelfRegistrationBorrowerUnwantedField or PatronSelfModificationBorrowerUnwantedField
    
    2. Add a required field in PatronSelfRegistrationBorrowerMandatoryField, for example email.
    
    3. Go to Your Personal Details in the OPAC (opac-memberentry.pl) and leave blank the required field of point 2
    
    4. Press "Submit update request"
    
    There should be no software error.
    
    NOTE: The warns will be floody on the logs.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8a7266cd0d12f8933e9598a4e954ecd2977b89b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 15 13:15:22 2016 +0100

    Bug 16615: Update OPACSearchForTitleIn to access openlibrary.org via https
    
    Note that we could also update the syspref for existing installs
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c0ac389c1ec5422795bd6976a29e140a945f967d
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Sun Aug 14 13:01:47 2016 -0400

    Bug 16615: Follow up - missed a spot
    
    Also, it is recommended to apply bug 17103 before this.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Oliver Bock <oliver.bock@aei.mpg.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 40b9645bf6d822e7e1895587b44889c193af14ac
Author: Oliver Bock <oliver.bock@aei.mpg.de>
Date:   Mon May 30 07:35:26 2016 +0000

    Bug 16615: Open Library API fails for full-site-SSL
    
    When running Koha in a full-site-SSL configuration accessing
    external resouces like Open Library cover images via HTTP
    doesn't work (mixed SSL/non-SSL content). It thus breaks a
    core feature of Koha. Referencing such resources always via
    HTTPS resolves the problem and also enhances privacy as a
    side-effect.
    
    Previous tickets took care of Amazon resources. This ticket
    is supposed to address the remaining external resource providers,
    starting with Open Library.
    
    TEST PLAN
    ---------
    1) Over https access your OPAC with the Enhanced Content system
       preferences 'OpenLibraryCovers' set to 'Add', and
       'OpenLibrarySearch' set to 'Show'.
    2) Search for something (e.g. Mo Willems)
       -- Your browser console log will show messages about
          mixed content.
    3) Apply the patch
    4) Making sure to reload the java script, attempt steps 1 & 2
       again.
       -- no mixed content messages should be given
    5) run koha qa test tools
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 090c0fc6c49e448b1ee506808e5f157c4ba88414
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Aug 17 18:40:27 2016 +0000

    Bug 14642 - DBRev 16.06.00.015
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b4a08cad608b8b8aebfebd5a6e058554a7b4bf59
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 9 10:14:44 2016 +0100

    Bug 14642: Make sure the log will be written only if the hold has been deleted
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a61e0a3324ce61f358d51ab882f42539ec82232a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 8 23:46:48 2016 -0300

    Bug 14642: (QA followup) Add tests for Koha::Hold->delete
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fde83bd73def033cd7f5059e58ca84621ec25fef
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jul 26 16:04:16 2016 -0300

    Bug 14642: (QA followup) Make HoldsLog default to 0
    
    After a couple comments regarding the default value I picked for the
    new syspref, I've decided to set it 0, as libraries interested on the
    fetarue will just enable it.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d1eb7061536d11b382c3256aaefb48fc447bfa72
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jun 15 14:48:57 2016 -0300

    Bug 14642: Add logging for Holds
    
    This patch adds logging for several holds actions. Specifically for:
    
    - CREATE
    - CANCEL
    - DELETE
    - RESUME
    - SUSPEND
    - MODIFY
    
    To test:
    - Enable the HoldsLog syspref
    - Add a hold on a record/item
    => SUCCESS: The log view shows the CREATE action
    - Click on the <Suspend> button
    => SUCCESS: The log view shows the SUSPEND action
    - Click on the <Unsuspend> button
    => SUCCESS: The log view shows the RESUME action
    - Click on the red cross, to delete the hold
    => SUCCESS: The log view shows the CANCEL action
    
    Note: The DELETE action is logged when DelMember is called, with bug 16819 patches applied.
    
    Sponsored-by: NEKLS
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    I also wonder about this going in defaulted on, but since the other logs are as well it seems ok to me.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a6bc706ad1fac9e9343c04a9c8ac142d493629a8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 24 11:34:01 2016 -0300

    Bug 14642: Add HoldsLog syspref
    
    This patch introduces a new syspref 'HoldsLog' which is to be used for controlling
    holds actions logs.
    
    Sponsored-by: NEKLS
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0caed05779b886229d2a02c168bdb38453c67bb4
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Aug 17 18:03:50 2016 +0000

    Bug 16829 - DBRev 16.06.00.014
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3a7aaf1339247689405e769349faaca6fe359950
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 1 18:53:00 2016 -0300

    Bug 16829: Unit tests for logaction's 'interface parameter'
    
    This patch introduces tests for the new 'interface' parameter for the
    C4::Log::logaction and C4::Log::GetLogs functions.
    
    In logaction, it falls back to C4::Context->interface if ommited.
    
    To test:
    - Run
      $ prove t/db_dependent/Log.t
    => SUCCESS: Tests pass
    - Sign off
    
    Sponsored-by: NEKLS
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 25cdf478958b4fd6c0e6d2510dce4963cf183f29
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 1 18:33:15 2016 -0300

    Bug 16829: DBIx update
    
    Sponsored-by: NEKLS
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 95fff37db888ce73a20f0506d5158fb57bcfe1c0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 1 18:27:03 2016 -0300

    Bug 16829: Add 'interface' to the log viewer
    
    This patch introduces the 'interface' filter to the log viewer.
    
    To test:
    - Apply the patch
    - Open the log viewer
    => SUCCESS: As default, 'All' interfaces are chosen. OPAC, Intranet and SIP are presented
    - Do a lot of log searches, verify that the interface column shows what is expected.
    => SUCCESS: The chosen 'interfaces' are kept when rendering results.
    
    Sponsored-by: NEKLS
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit baeba970f77dbc75ae859e9cc6ba04afa410f17a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 1 18:26:13 2016 -0300

    Bug 16829: make logaction and GetLogs aware of the interface column
    
    This patch changes the logaction API so it accepts a new 'interface' param.
    Current code calling logaction is not changed, and this parameter can be ommited
    in most contexts, and it will correctly fall-back to C4::Context->interface.
    
    Unit tests are provided on a different patch.
    
    GetLogs gets patched as well, so it can be required to filter by 'interface' param.
    
    Sponsored-by: NEKLS
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8a135fd21a06045075b49b465082dae74086f53f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 1 17:48:37 2016 -0300

    Bug 16829: Add 'interface' column to action_logs
    
    This patch introduces a new column for the action_logs table. It is
    called 'interface' and it is intended to store the interface in which
    the action was performed.
    
    Sponsored-by: NEKLS
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9237fe676336f5908a9acc26a3b70b70d25602ae
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Thu Sep 17 13:23:49 2015 +0300

    Bug 14844: Corrupted storable string. When adding/editing an Item, cookie LastCreatedItem might be corrupted.
    
    No idea how to replicate this issue but we have been getting several reports
    about the following error:
    
    Software error:
    
    Corrupted storable string (binary v2.9) at /usr/lib/perl/5.18/Storable.pm line
    417, at /home/koha/kohaclone/cataloguing/additem.pl line 375.
    
    TEST PLAN:
    1. Add or modify an Item.
    2. No observed changes.
    ?. We don't know what causes this but we know that add/modify Item occasionally
       crashes due to failure of a cookie thawing.
    
    This patch prevents the whole program from dying, because this error is not
    critical enough to warrant dying.
    Also there is no centralized mechanism in Koha for showing messages to the
    user, so there is no easy and convenient way to warn the user that the:
    'LastCreatedItem'-cookie or the systempreference 'PrefillItem' is
    malfunctioning.
    
    So we instead just warn to the server logs with the malfunctioning cookie in
    hopes of nailing down what causes the issues.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6fcd32a75c41c7815a883cc4952899ea24045b3c
Author: Indranil Das Gupta <indradg@l2c2.co.in>
Date:   Sat Aug 13 05:55:14 2016 +0530

    Bug 17103 - Google API Loader jsapi called over http
    
    This patch replaces the hardcoded protocol ("http") from the URI with
    https since that is what Google defacto uses to serve JS resources
    Prevents MIXED CONTENT failure, allowing GoogleIndicTransliteration
    to function correctly when used in SSLized OPACs.
    
    Test plan
    ---------
    
    1/ Make sure your OPAC is being served both over HTTP and HTTPS
    2/ Set GoogleIndicTransliteration syspref to "Show"
    3/ Access the OPAC over http, Google transliteration element will
       show up in masthead searchbox.
    4/ Access the OPAC over https. The element will not show. Console
       will show MIXED CONTENT error and failure of google loader.
    5/ Apply patch. Repeat steps #3 and #4 again. Now in both cases
       GoogleIndicTransliteration will work.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 21593d8e1d92201f581d7168dbf9392dcb65ed7d
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Thu Aug 11 06:35:47 2016 +0200

    Bug 17084 - Automatic debian/control updates (master)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 007d2feee6b2fec92f2d6518a3e84de0f6476b3d
Author: Tomás Cohen Arazi <tomascohen@unc.edu.ar>
Date:   Mon Jul 25 15:08:00 2016 -0300

    Bug 16974: Make koha-plack should check and fix log files permissions
    
    This patch adds a function to the koha-plack script so it checks for log file
    existence and its permissions. This function is called from the start_plack function.
    
    If some of this conditions are not fulfilled, it solves the situation by either
    touching and/or changing the permissions accordingly for the instances' plack log files.
    
    To test:
    - Run (on kohadevbox):
      $ cd kohaclone
      $ debian/scripts/koha-plack --start kohadev
      $ debian/scripts/koha-plack --stop  kohadev
      $ ls /var/log/koha/kohadev/plack*
    - Verify ownership of the created files (they might belong to the root user)
    - Apply the patch
    - Run:
      $ chown root:root /var/log/koha/kohadev/plack*
      $ debian/scripts/koha-plack --start kohadev
      $ ls /var/log/koha/kohadev/plack*
    => SUCCESS: Files belong to kohadev-koha:kohadev-koha
    - Run:
      $ debian/scripts/koha-plack --stop  kohadev
      $ rm /var/log/koha/kohadev/plack*
      $ debian/scripts/koha-plack --start kohadev
      $ ls /var/log/koha/kohadev/plack*
    => SUCCESS: Files are created and belong to kohadev-koha:kohadev-koha
    - Sign off :-D
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ac4a058b05fc1a1a6955d025328cca6ae369baeb
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Aug 2 23:26:03 2016 -0400

    Bug 16885: koha-stop-zebra should be more sure of stopping zebrasrv
    
    This patch follows Galen's suggestion in comment #7.
    
    TEST PLAN
    ---------
    1) Back up your koha logs as desired.
    2) add something to /var/log/koha/{instance name}/intranet-error.log
    3) ps aux | grep zebra
    4) logrotate -f /etc/logrotate.d/koha-common
    5) ps aux | grep zebra
       -- the zebrasrv and daemon process for zebra indexing
          didn't restart.
    6) apply this patch against /usr/sbin/koha-stop-zebra
    7) sudo koha-start-zebra {instance name}
    8) ps aux | grep zebra
       -- the processes should have started up again.
    9) add different junk to /var/log/koha/{instance name}/intranet-error.log
    10) ps aux | grep zebra
    11) logrotate -f /etc/logrotate.d/koha-common
    12) ps aux | grep zebra
        -- the process ids for the zebrasrv and daemon processes should
           be different, but the number of processes is the same as before.
    13) sign off, because its less ugly than comment #3
    
    Sponsored-by: Tulong Aklatan
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Works as expected, no regressions found.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6df86141425c5d781b3387331c5716b3be0a7a6b
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Tue Aug 9 11:52:15 2016 +0200

    Bug 15200 - t/Creators.t fails when using build-git-snapshot
    
    ttf-dejavu was missing from the build dependencies.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e16019f27b19c23a78eb2a955552e0a9d639b4fa
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Aug 10 14:20:06 2016 +0000

    Bug 7741 - DBRev 16.06.00.013 - Add IGNORE to insert in case of backporting
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 71d20a8c3b48a4dd1c7fb569b3baf2352d9757ac
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Tue Jul 19 14:58:58 2016 -0600

    Bug 16944: Add "email" and "url" classes when edit or create a vendor
    
    When edit or create a new vendor the two fields "email" and "website" don't test
    if the data provided is right. When you add a direction like
    "koha-community.org" without the protocol "https" the program redirect to an
    404 error.
    
    To reproduce the issue:
    1-Go to Acquisition and create a new Vendor
    2-Fill the field Website with koha-community.org
    3-Use an email without at sing (@)
    4-Notice that there is no error
    5-Save
    6-Go to the vendor created (/cgi-bin/koha/acqui/supplier.pl?booksellerid=1)
    7-Click in Website: koha-community.org -> redirect to an 404 error
    8-Notice the bad mailto:
    
    To test:
    -Apply patch
    -Reproduce step 1 to 8 with the same vendor or create a new one
    -Enter multiple wrong and valid urls
    -Enter urls with and without protocols http, https, ftp
    -Enter wrong and valid emails
    
    NOTE: The classes used are taken from 'branches.tt'
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    no longer allows entering of improper website urls or incomplete email addresses.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 865557e05c0fa1951478fbc1551c50b9b928619a
Author: Marc Véron <veron@veron.ch>
Date:   Thu Jul 21 11:42:42 2016 +0200

    Bug 16953: Acquisitions home: Remove trailing &rsaquo; from breadcrumbs
    
    The breadcrumb on the Acquisition's home page reads: Home > Acquisitions >
    This tiny patch removes the trailing > (&rsaquo;)
    
    Amended: Remove the link on 'Acquisitions' as well...
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 67a65ba16f9c56161fa936a4f80e3f93cfaef167
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Fri Jul 22 10:04:48 2016 -0600

    Bug 16964: Fix capitalization for "Report Plugins" in reports-home.tt
    
    Fix capitalization for "Report Plugins" in reports-home.tt according with
    Coding Guidelines <https://wiki.koha-community.org/wiki/Coding_Guidelines#HTML4:_Upper_and_lower_cases_in_strings>
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4a691fda1622a4702ab34c0a55a56b344d07f109
Author: Marc Véron <veron@veron.ch>
Date:   Wed Jul 27 21:19:16 2016 +0200

    Bug 16989 - Advanced search form does not display translated itemtype
    
    In Staff client, the advanced serach form does not display the
    translations of item types.
    
    (Note: It is not necessary to have translations installed to verify
    this bug.)
    
    Prerequisites:
    - Go to Home > Administration > Item types administration
    - Edit e.g. item type "BK" (Book)
    - Near "Description", click link "Translate into other languages
    - If you have other languaes installed, add translatons for those
    - If you have an Englis only installation, add a "translation" for
      English, make sure that you can identify it while testing (I
      used "BOOOOOOOOOOOOKS")
    
    Verify:
    - Go to Home › Advanced search
    - Verify near "Limit to any of the following" that the description for
      itemtype BK reads "Book" instead of "BOOOOOOOOOOOOKS"
    
    Test:
    - Apply patch
    - Verify that the item type description now reads ""BOOOOOOOOOOOOKS"
    - If you have a multi language installaton, verify that item types
      you translated display as appropriate
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c3badb0c570beada485cc71ea6b494da1d59f1b0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 4 17:19:37 2016 +0100

    Bug 17052: Display patron category description in the sidebar of paycollect
    
    The patron category description is not passed to the template in
    paycollect.pl
    
    Note: The Categories TT plugin should be used here...
    
    Test plan:
    Go on paycollect.pl and confirm that the patron category description is
    now displayed in the sidebar.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Brendon Ford <brendon.ford@manhattan.edu>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dbfda36767c113b8e515e8d2bfedd435ed7bd133
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Aug 5 13:56:52 2016 +0000

    Bug 17055 - Add classes to different note types to allow for styling on checkins page
    
    Returned items may have 3 kinds of notes, patron, item public, and item
    non-public. However, the html markup for them does not allow us to
    distinguish which type we are seeing. It would be good to add classes
    for each of these note types.
    
    Test Plan:
    1) Check out an item to a patron
    2) Add a patron note, a public item note, and a non-public item note
       to the patron and item you used
    3) Check in the item and instead the html, note the each note span
       now has a class to distinguish which type of note is being displayed.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d76737ba7d41bc261b59a2ea2cf4c591a62a0bc4
Author: Marc Véron <veron@veron.ch>
Date:   Mon Aug 8 14:04:44 2016 +0200

    Bug 17078 - Format fines on opac-account.pl
    
    To verify:
    - Log in to OPAC as a user who has fines or credits
    - Go to page "your fines"
    - Verify that values for "Fine amount", "Amount outstanding"
      and "Total due" are not formatted as defined in syspref CurrencyFormat
      (e.g. for FR)
    
    To test:
    - Apply patch
    - Repeat steps above
    - Verify that values are formatted as appropriate with different
      settings for syspref CurrencyFormat
    
    Note: This patch does not force text alignment to the right.
          Text alignement can be done using syspref OPACUserCSS
          (td.sum, td.credit, td.debit)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6359922847aa9437bccc1d28fd429d5432517e9a
Author: Marc Véron <veron@veron.ch>
Date:   Mon Aug 8 11:33:50 2016 +0200

    Bug 17076 - Format fines in patron search results table
    
    Format the values in patron search results following syspref CurrencyFormat.
    
    To verify:
    - Search for patrons who have fines or credits
    - In result table, column 'Fines' does not respect syspref CurrencyFormat
      (e.g. for FR)
    
    To test:
    - Apply patch
    - Repeat steps above, verify that fines display as appropriate
    - Change syspref Currencyformat, verify display
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cc6fc0800cb3446ebe482b7dbb2f6ec4a543d869
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Mon Aug 8 16:13:37 2016 +0100

    Bug 17081 Incorrect comparison operator used in edifactmsgs.pl
    
    Numeric comparison operator is used where string comparison required,
    resulting in the following warning in the log: 'Argument "delete" isn't
    numeric in numeric eq (==).'
    
    This patch corrects it to use 'eq' not '==' to compare strings.
    
    To test, apply the patch and go to Acquisitions -> EDIFACT messages.
    
    Delete an EDIFACT message. There should be no error in the error log.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0ef3b19dbd414539dbc8c45ecc595e399df31781
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Sun Jul 24 19:18:51 2016 +1200

    Bug 16969 cgi->param used in list context in opac-memberentry.pl
    
    To test
    1/ Hit the page, notice the warning in the log
    2/ Apply patch
    3/ Hit page, notice no warning in the log
    4/ Test functionality all still works
    
    Works as expected. (Note: See Bug 16960 for updating patron details).
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 72150ee7596e2644febbab248e6b3c9b7b3af69b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 3 15:48:42 2016 +0100

    Bug 17040: Fix translation on context menu when editing items
    
    Test plan:
    update and install translated language files
    On the item list (cataloguing/additem.pl) the context menu should be
    translated (Edit item/Delete item)
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5995bd77a630521c360735b22c8573717515e62a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 28 12:58:30 2016 +0100

    Bug 17020: Do no pass findborrower to the template
    
    Indeed, it's not used!
    
    Test plan:
      git grep '\[% findborrower'
    should not return any result.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 034f939a44287ae7078d95c15b55368aa98b4216
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 3 16:41:48 2016 +0100

    Bug 16894: Regression - Display email on patron search results
    
    Bug 10318 added the email to the patron search results but it has been
    removed later.
    This patch reintroduced it where it was (no new column).
    
    Test plan:
    Search for patrons and confirm that the emails are displayed.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit aa2f56fa1a76d98ab9543a100810c354c4d23554
Author: Eric Phetteplace <phette23@gmail.com>
Date:   Thu Jun 23 16:06:59 2016 -0700

    Bug 16806: no error message for 'too_soon' renewal
    
    To test:
    -  for a particular item type & patron category, configure a non-zero
    "no renewal before" date so items can't be immediately renewed
    - sign in as a patron in aforementioned patron category
    - check out an item of aforementioned item type
    - go to your renewals page in OPAC /cgi-bin/koha/opac-user.pl
    - an error messages appears in the div.alert.dialog up top
    
    Sponsored-by: California College of the Arts
    Signed-off-by: Brendon Ford <brendon.ford@manhattan.edu>
    
    Signed-off-by: Irma Birchall <irma@calyx.net.au>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62d16aa6b750aaade2267596c19292659333f8c8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 25 16:37:03 2016 +0100

    Bug 16776: Do not forget external language choice in language switcher
    
    If language is set by external link language switcher does not work
    
    To reproduce:
    
    - Have a multilingual koha installation, let's say en, de-CH, fr-FR and it-IT
    - Create external links e.g. from your multilingual library website to each language variant of OPAC:
    
    ...cgi-bin/koha/opac-main.pl?language=en
    ...cgi-bin/koha/opac-main.pl?language=de-CH
    ...cgi-bin/koha/opac-main.pl?language=fr-FR
    ...cgi-bin/koha/opac-main.pl?language=it-IT
    
    Each link opens fine displaying the language as appropriate.
    
    Now try to switch language on the page you just opened via the external link.
    
    It won't work, it will always stay on the language defined by the external link.
    
    To test:
    - Apply patch
    - Repeat steps above
    - Verify that the language switcher works
    - Verify in browser address field that after switching language, the param 'language= 'has vanished from url string
    - Try links with multiple params and with params containing 'language', e.g.
      ...cgi-bin/koha/opac-search.pl?language=fr-FR&q=language&mylanguage=test
    - Verify that only the parameter 'language=' vanishes
    
    Tested counter patch, works as well.
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5dd9a2546aea0870674bf2190a8f46c280b9beb2
Author: Marc Véron <veron@veron.ch>
Date:   Mon Aug 8 17:47:31 2016 +0200

    Bug 17082: Translatability: Fix sentence splitting in member.tt
    
    This patch fixes sentences splitting in file
    koha-tmpl/intranet-tmpl/prog/en/modules/members/member.tt
    
    Fix is done with a new .inc file because the code is the same as in
    koha-tmpl/intranet-tmpl/prog/en/modules/members/memberentrygen.tt
    
    To test:
    - Carefully review code changes
    - Test on a fresh install without example data (or save database
      and test with empty tables 'branches' and 'categories')
    - Go to Home > Patrons (members-home.pl)
    - Verify that a warnings appears aubout missing libraries and patron
      categories
    - Try to add a new patron (memberentry.pl)
    - Verify that the same messages are triggered
    - Verify that messages disappear as appropriate as soon as a library and
      a patron category are defined.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Note: Filed Bug 17093 for JS error on patron entry form.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c31213ba4fab0082c6ad556aae424918b62205d0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 11:53:39 2016 +0100

    Bug 16848: Prevent invalid warning to be carped from output_pref
    
    From Koha::DateUtils::output_pref:
    
       $dt = eval { dt_from_string( $str ) } if $str;
       carp "Invalid date '$str' passed to output_pref\n" if $@;
    
    This second line is wrong: if $str does not exist, the first line is not evaluated and $@ could be filled with previous error.
    
    To reproduce:
    
    Then:
      prove t/DateUtils.t
    will display:
    t/DateUtils.t .. 20/60 Use of uninitialized value $str in concatenation (.) or string at Koha/DateUtils.pm line 217.
    Invalid date '' passed to output_pref
     at t/DateUtils.t line 233.
    t/DateUtils.t .. ok
    All tests successful.
    Files=1, Tests=60,  2 wallclock secs ( 0.02 usr  0.00 sys +  1.40 cusr  0.00 csys =  1.42 CPU)
    Result: PASS
    
    Test plan:
    Without this patch, you should not see the carp
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 09d7a47f1fb1c645d0e3ffb93fb88409b3310363
Author: Katrin Fischer <Katrin.Fischer.83@web.de>
Date:   Mon Aug 8 01:15:23 2016 +0200

    Bug 17074: Follow-up: fixing encoding issues with multiple search terms
    
    If there was more than one search term you could see that that it
    was url encoded. Also problems with search terms with umlauts and
    other diacritics.
    
    Patch should fix that.
    
    https://bugs.koha-community.org/show_bug.cgi?id=17074
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8d7e62b808522b1871d6b704e0ae5def3be886ee
Author: Katrin Fischer <Katrin.Fischer.83@web.de>
Date:   Sun Aug 7 16:03:13 2016 +0200

    Bug 17074: Fix links in result list of 'scan indexes' and keep search term visible
    
    The 'scan indexes' search that can be reached from the
    advanced search has 2 problems to begin with:
    
    - The search term you searched for is not displayed
      in the input field.
    - The links in the result list are missing the index
      and because of that, are not giving the correct results.
    
    To test:
    - Go to the advanced search, select an index to search in
    - Enter a search term and check 'scan indexes'
    - Submit search
    - Check if the search term is visible in the input box
    - Check if the result links contain your selected index
      and give you correct results (count and the number of
      results should match)
    
    Tested both patches together, works as expected.
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit aa0e27ea08cf0d9a1ff46b061cc38d2b15fa66e7
Author: Frédéric Demians <f.demians@tamil.fr>
Date:   Sat Aug 6 10:13:18 2016 +0200

    Bug 17053 Clearing search term in Reports
    
    If you click the clear button to clear the search term it does take the search
    term away. However, the next time you click on "Saved reports" the search term
    is still there.
    
    TO TEST:
    
    1. Reports > Use saved
    2. Filter on anything (date/author/keyword). Let say "foo" in keyword.
    3. Click the Clear link on the Filter form. You can see that "foo" is removed
       from keyword, and all the saved reports are displayed.
    4. Click "Saved Reports" on the left. You can see that "foo" reappears in
       keyword filter.
    5. Apply the patch, and repeat steps 2-4.
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 06d1259e56e7a662b1449fa54b9b408afdbf6cc8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 28 11:54:11 2016 +0100

    Bug 16992: FIX CSRF in member-password.pl
    
    If an attacker can get an authenticated Koha user to visit their page with the
    url below, they can change patrons' passwords
    /members/member-password.pl?member=42&newpassword=hacked&newpassword2=hacked
    
    Test plan:
    
    Trigger
    /members/member-password.pl?member=42&newpassword=hacked&newpassword2=hacked
    
    => Without this patch, the password will be updated
    => With this patch applied you will get a crash "Wrong CSRF token" (no
    need to stylish)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2785183a6b3c1bc231f78a0e506617379ea3998e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 29 13:16:40 2016 +0200

    Bug 16992: [QA Follow-up] Member-password should pass an userid
    
    If we do not fill a new userid, we should keep the old one.
    Script member-password should pass that to Koha::Patron.
    Otherwise things go wrong.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Without this patch, you could effectively disable a login.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>

commit 01e041ca40606c48a507bc64a8e3edf7ea11b2c5
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Aug 10 13:28:20 2016 +0000

    Bug 7441 - DBRev 16.06.00.013
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 86144a65e0a674c80737f31dcc81f984dd4744e5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 29 12:35:22 2016 +0200

    Bug 16929: [QA Follow-up] Add dependency for Bytes::Random::Secure
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0fe7a4aa8e168f173835ddf54cddff898830a270
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jul 21 08:48:01 2016 +0200

    Bug 16929: [QA Follow-up] Shortcut methods and use statements
    
    Resolves the following comments:
    
    I'd prefer to see a generate_csrf method than a CSRF flag.
    It'd be better to use instead of require the 2 modules.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 523d0be9dc795a676aae907736394e64e33350a3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 15 14:16:07 2016 +0200

    Bug 16929: Prevent opac-memberentry waiting for random chars
    
    Move calls to WWW::CSRF to Koha::Token.
    Send a safe random string to WWW::CSRF instead of letting CSRF make a
    blocking call to Bytes::Random::Secure. If your server has not enough
    entropy, opac-memberentry will hang waiting for more characters in
    dev/random. Koha::Token uses Bytes::Random::Secure with the NonBlocking
    flag.
    
    Test plan:
    [1] Do not yet apply this patch.
    [2] If your server has not enough entropy, calling opac-memberentry may
        take a while. But this not may be the case for you (no worries).
    [3] Apply this patch.
    [4] Verify that opac-memberentry still works as expected.
    [5] Run t/Token.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Yes, my server had entropy trouble (reason for finding the problem).
    This patch resolves the delay.
    
    Tested all 3 patches together, works as expected.
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 09d0b1310bda677b6939b59ea8a68f84e2ec93f6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 28 12:55:43 2016 +0100

    Bug 16993: Fix CSRF in memberentry.pl
    
    If an attacker can get an authenticated Koha user to visit their page
    with the url below, they can change patrons' passwords or other
    patrons'details
    
    members/memberentry.pl?op=save&destination=circ&borrowernumber=3435&password=ZZZ&password2=ZZZ&nodouble=1
    
    Test plan:
    
    Trigger
    members/memberentry.pl?op=save&destination=circ&borrowernumber=42&password=ZZZ&password2=ZZZ&nodouble=1
    
    => Without this patch, the password will be updated
    => With this patch applied you will get a crash "Wrong CSRF token" (no
    need to stylish)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Amended: removed the commented use Digest::MD5-line.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 893f6cc2633744d4f539fd1b6b9f4b8837277d2d
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Tue Aug 9 14:55:43 2016 +0200

    Bug 17087 - Set Test::WWW::Mechanize version to 1.42
    
    This was set to a version that is not available in Wheezy or Jessie.
    The version is not required, the only change to 1.42 (packaged for
    Wheezy and Jessie) is a fix for Windows, see
    http://cpansearch.perl.org/src/PETDANCE/Test-WWW-Mechanize-1.44/Changes
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 22c851cc2fea3c3868f7643132392f0a34439c65
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Sun Apr 10 23:18:26 2016 -0400

    Bug 10148: Marc21 field 007 builder improper reload values
    
    The more correct solution is fix that template file.
    However, in the mean time, this works.
    
    TEST PLAN
    ---------
     1) find a record
     2) edit record
     3) click value builder for 007
     4) change everything to pipes as much as possible.
        (use Motion Picture to get all 00-22 values)
     5) save
        -- should save just fine.
     6) click the value builder again
        -- OOPS! Bad reload.
     7) prove t/db_dependent/FrameworkPlugin.t
        -- NOISY 007 messages.
     8) apply patch
     9) click the value builder again
        -- good reload
    10) prove t/db_dependent/FrameworkPlugin.t
        -- No noise related to 007.
    11) run koha qa test tools.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b543fa74fe888b9e53cfc06ac58e2f7ac1689ae5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 3 13:57:43 2016 +0100

    Bug 17038: Fix XSS in catalogue/search.pl
    
    Test plan:
    Search for something like:
      \";alert(1)//135
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Note that this fix the parameters idx, q and op
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 96a9c2715ee2e4388e105e86e221bc280e1d757f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 3 08:49:10 2016 +0100

    Bug 17036: Fix XSS in circulation.pl
    
    Test plan:
    Enter the following in the "Check out" tab:
    "><script>alert('XSS')</script>
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 12b4c83f5a5c11af635cae83e6837ff80dc02da7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 28 13:01:43 2016 +0100

    Bug 17021: Fix XSS in circ/returns.pl
    
    Test plan:
    Enter the following in the barcode input:
    <script>alert('XSS')</script>
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1ea1504c30c5c34dd763027caee55dcf359e94cf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 14:46:11 2016 +0100

    Bug 17025: Fix XSS in serials-search.pl
    
    Test plan:
    Hit
      /serials/serials-search.pl?ISSN_filter="%2F><script>alert('XSS')<%2Fscript>&searched=1
      /serials/serials-search.pl?title_filter="%2F><script>alert('XSS')<%2Fscript>&searched=1
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f3a8e5a4117a0e95969ff2856dfcd95a6935ec55
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 15:46:06 2016 +0100

    Bug 17029: Fix XSS in catalogue/*detail.pl
    
    Hit
      /cgi-bin/koha/catalogue/detail.pl?biblionumber=1<script type="text/javascript">alert("XSS")</script>
      /cgi-bin/koha/catalogue/ISBDdetail.pl?biblionumber=1<script type="text/javascript">alert("XSS")</script>
      /cgi-bin/koha/catalogue/MARCdetail.pl?biblionumber=1<script type="text/javascript">alert("XSS")</script>
      /cgi-bin/koha/catalogue/moredetail.pl?biblionumber=1<script type="text/javascript">alert("XSS")</script>
      /cgi-bin/koha/catalogue/labeledMARCdetail.pl?biblionumber=1<script type="text/javascript">alert("XSS")</script>
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 821cb91a80942a85f4d22e6b1a8c700add7bab7d
Author: Katrin Fischer <Katrin.Fischer.83@web.de>
Date:   Wed Aug 10 07:15:03 2016 +0200

    Bug 7441: QA follow-up - Add note about missing NORMARC support
    
    Adds a note about missing support for NORMARC (only supports
    MARC21 and UNIMARC) to the system preference text.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 492d79a7df18efb294bd9bd9da5fa5b4efe1e592
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jun 24 16:08:23 2016 +0100

    Bug 7441 - Followup search results showing wrong branch [UNIMARC]
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
      Playing with OPACResultsLibrary syspref, biblio with items having different
      home/holding library are displayed properly.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4db2e745e244bfc9e8315b4903c30e21142d9cb4
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 2 14:01:56 2016 +0000

    Bug 7441 - search results showing wrong branch?
    
    When you search in the OPAC it shows you the HOME branch on the location
    in XSLT, but if you click through to the detail page it shows you the
    CURRENT BRANCH in the holdings table which is very confusing to patrons.
    I don't know what's the right solution - home or holding branch, but they
    should be the same in both places for the patron's sake. If you do the same
    search in the staff client you see the right branch info on the search results
    and on the detail page.
    
    Test Plan:
    1) Apply this patch
    2) Run updatedatabase.pl
    3) Search the catalog, you search should include results with items
       that have different home and holding libraries.
    4) The results should look the same as before the patch
    5) Change the system preference OPACResultsLibrary to "current location"
    6) Refresh your page of search results
    7) The results show now show the holding library instead of the home library
    
    Signed-off-by: Barbara Walters <bwalters@ncrl.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 26f20d64cb6336b4911f91befa736539946a0a0c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 8 10:48:36 2016 +0100

    Bug 17069: Koha::Patron::Category->store must default checkprevcheckout to 'inherit'
    
    Creating a new patron category raises an error "An error occurred when updating
    this patron category. Perhaps it already exists."
    DBIx::Class does not default to the value defined at the DB devel if the
    key checkprevcheckout has been passed to the constructor.
    We may need to provide a global fix for this kind of issue: if a column
    is defined as "not null" but has a default value, the constructor
    (Koha::Object->new) should not pass it to the DBIx::Class constructor
    (even if assuming that null means default is a terrible mysqlism).
    
    Test plan:
    Create a new patron category.
    
    Works as expected.
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5b4259be9c237c7773f6af9f6c83894718be603d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Aug 20 11:29:01 2015 +0200

    Bug 6499: [QA Follow-up] Trivial adjustments
    
    Removes commented line from bib1.att.
    Adjust OCLC-number to Other-control-number in comment of ccl properties.
    No need to explicitly add 035$a and $z if you index 035 completely in
    record.abs as well as biblio-koha-indexdefs.xml.
    Rerun koha-indexdefs-to-zebra.xsl on index defs.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 84f51549c94a5f5fdc227e6febb472946ca2b71c
Author: Barton Chittenden <barton@bywatersolutions.com>
Date:   Thu Jul 10 09:54:56 2014 -0400

    Bug 6499: Add Zebra index "Other-control-number" covering MARC21 035$a, 035$z and 035 (entire tag)
    
    1) Apply patch
    2) Make sure that you have a bib that has MARC21 035$a (and possibly also 035$z) populated.
    
    pre 3) Replace all modified zebra files and restart zebra server
    
    3) Rebuild zebra: misc/migration_tools/rebuild_zebra.pl -x -b -z
    4) Add the following to the intranetuserjs syspref:
    
    $(document).ready(function(){
        // Add Other Control Number to advanced search
        if (window.location.href.indexOf("catalogue/search.pl") > -1) {
            $(".advsearch").append('<option value="Other-control-number">Other Control Number</option>');
        }
    });
    
    5) Do an advanced search, select "Other Control Number" from the search menu, then add the Other Control Number in 035$a for the bib specified in step 1.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Works, no koha-qa errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7f50e9f686a319a4857f595e46c405f8bc85b48e
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Sat Aug 6 11:05:04 2016 +0200

    Bug 17062 - debian/control.in update: change maintainer
    
    Changing the package maintainer and removing a whitespace in debian/control.in.
    Regenerated debian/control from that, which also adds libhtml-parser-perl because of bug 16971.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8102098fa6adea43e71c06641b2705c5b23f29be
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Tue Aug 2 15:41:12 2016 +0200

    Bug 17019 - debian/changelog update
    
    This has not been updated for a while. I plan to add the stable
    releases.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3c9eace41acfea9e76731cc987cab8df284e7423
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Wed Aug 3 19:31:16 2016 +0200

    Bug 17043 - Readonly deps
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fd2f15c486bcbba448cf6bf5b75c74eaf3a11695
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Wed Aug 3 19:40:09 2016 +0200

    Bug 17043 - master control file
    
    latest control file update
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 347c3b68d7a45cd0f3a66fb662ab5f4a0a8f9cf2
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Wed Aug 3 19:11:15 2016 +0200

    Bug 17043 - debian/list-deps fixes, master edition
    
    This makes debian/list-deps ready for Debian Jessie
    and adds small fixes I already use for package releases.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e4bb70a447c7a6ea5e7498250adbe0e152259974
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Aug 4 11:47:16 2016 -0300

    Bug 17030: Make REST api available on packages with plack enabled
    
    This patch is the starting point for making the REST api available
    on Plack.
    
    What it does:
    - It creates the /api/v1/app.pl mount point in plack.psgi
    - It enables the ProxyPass and ProxyPassReverse directives so it
      is reached through Plack.
    - It sets rewrite rules so we can use the 'pretty' urls (i.e.
      /api/v1/patrons instead of /api/v1/app.pl/api/v1/patrons).
    
    To test:
    - Grab the following files, and put them in /etc/koha (overwrite the existing ones)
      debian/templates/apache-shared-intranet-plack.conf
      debian/templates/apache-shared-opac-plack.conf
    - Tweak your /etc/koha/sites/kohadev/plack.psgi file so the API-related stuff
      is present on your file.
    - Make sure Plack is enabled for the instance:
      $ sudo koha-plack --enable kohadev
      $ sudo koha-plack --restart kohadev
      $ sudo service apache2 restart
    - Follow the previous patch test plan, but use this URLs (no pretty URL):
    
      http://localhost:8080/api/v1/app.pl/api/v1/patrons/50
      http://localhost:8081/api/v1/app.pl/api/v1/patrons/50
    => SUCCESS: You get a JSON response from the API [1]
    - Not use this URLs:
      http://localhost:8080/api/v1/patrons/50
      http://localhost:8081/api/v1/patrons/50
    => SUCCESS: You get a JSON response from the API [1]
    - Sign off :-D
    
    [1] this patch made a bug visible (the session is lost when accessing the API through
    Plack) but it shouldn't prevent its inclusion because the API right now is not even available
    as default for developers to test or fix it.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6e38b8b60f118c0721a52fdaa332446063657dd3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Aug 4 11:39:25 2016 -0300

    Bug 17030: Enable REST api on packages
    
    This patch enables access to the REST API endpoint on packages setup.
    It does so, by patching the shared apache-shared-intranet.conf and
    apache-shared-opac.conf.
    
    You can build your own master packages with this patch applied, or just:
    
    - Grab
      debian/templates/apache-shared-intranet.conf
      debian/templates/apache-shared-opac.conf
    and overwrite their counterparts in /etc/koha on a packages setup. For example
    in kohadevbox.
    - Have Koha loaded with all default data
    - Create a superlibrarian user for you
    - Login to the intranet and the OPAC
    - Point your browser to:
      http://localhost:8080/api/v1/patrons/51
    => SUCCESS: You get JSON data, for the patron you requested
      http://localhost:8081/api/v1/patrons/51
    => SUCCESS: You get JSON data, for the patron you requested
    - Sign off :-D
    
    Note: I use the HTTPRequester addon for Firefox, re-using the CGISESSID value from the
    browser session cookie, in the headers.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 30474a321575ffecfd4e2578dce59385267ec8d7
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Sat Aug 6 13:52:26 2016 +0200

    Bug 17065 - Rename C4/Auth_cas_servers.yaml.orig
    
    C4/Auth_cas_servers.yaml.orig gets cleaned away after every package build because
    of the .orig extension. This patch moves it.
    
    It is only a sample file, there is no functionality to test. Just verify that the
    file is there with the new name after you applied the patch.
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3964fac311e59ade5fc79f4884626969716ae57f
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Sat Aug 6 13:42:18 2016 +0200

    Bug 17064 - Delete backup marc21_framework_DEFAULT.sql~ file
    
    This .sql~ backup file should not have been committed.
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bbaaabd1da97312e66e81b7ecfc37a5f5d2f828e
Author: Mirko Tietgen <mirko@abunchofthings.net>
Date:   Mon Aug 1 17:13:55 2016 +0200

    Bug 17013 - build-git-snapshot: add basetgz parameter and update master version number
    
    This adds a basetgz parameter to specify a pbuilder image.
    I use this to build against different distributions.
    
    This also updates the version number for master builds to 16.06.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 17a5ef51199736235f0c3fd35c84be124ecc166e
Author: Eric Phetteplace <phette23@gmail.com>
Date:   Sat Aug 6 10:44:53 2016 -0700

    Bug 17068: empty <li> in opac-reserve.tt
    
    empty HTML list item on 'holds' page, to test:
    - sign in as user
    - attempt to place hold
    - view source in between 'holds note' textarea & <!-- ITEM HOLDS --> comment
    - note empty <li>
    - apply patch
    - repeat process above up until patch
    - no more empty <li>
    
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit d0f2bad12e0f49bcedda3bdbc909642b93984d0b
Author: Zeno Tajoli <z.tajoli@cineca.it>
Date:   Wed May 25 14:41:01 2016 +0200

    Bug 16585: Update Italian installer sample files for 16.05
    
    With this patch all sample/defintions .sql files are updated and translated into Italian
    (if you select italian during web installation).
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 6b3a04da6a2f137ad87e0d39e9cc2c5ab7958850
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue May 31 12:01:46 2016 -0400

    Bug 16622: some tests triggered by prove t fail for unset KOHA_CONF
    
    TEST PLAN
    ---------
    1) unset KOHA_CONF
    2) prove t
       -- 00-load.t dies miserably
    3) prove t/Creators.t
       -- fails
    4) apply patch
    5) prove t
       -- noisy, but all tests successful
    6) prove -v t/Creators.t
       -- 2 skipped tests
    7) run koha qa test tools
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 92b36fb717bec8df875027185b210257e7bb9e31
Author: Lari Taskula <larit@student.uef.fi>
Date:   Wed Aug 3 18:38:42 2016 +0300

    Bug 17041: Fix missing properties in patron.json
    
    Swagger definition for patron was missing two properties.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 2ea99517ae9cb081e6f15c786e0163368d25bfbd
Author: Lari Taskula <larit@student.uef.fi>
Date:   Wed Aug 3 18:42:25 2016 +0300

    Bug 17042: Fix missing column in hold.json
    
    Swagger definition for hold was missing a property.
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 72d92be918eae8a9bc3c6723c155d1b0c6ba25e4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Aug 3 14:34:12 2016 -0300

    Bug 17044: Fix wrong destination for 'api' directory
    
    The original Makefile.PL tweak missed to trim the directory name thus
    repeating the 'api' directory like in 'api/api'.
    
    To test:
    - Make a standard install (for example in /usr/share/koha
    => FAIL: check /usr/share/koha/api/api exists
    - Make a single install (for example in /home/tcohen/koha-single)
    => FAIL: check /home/tcohen/koha-single/api/api exists
    - Apply the patch
    - Make a standard install (for example in /usr/share/koha
    => SUCCESS: check /usr/share/koha/api exists and doesn't contain a nested 'api' dir
    - Make a single install (for example in /home/tcohen/koha-single)
    => SUCCESS: check /home/tcohen/koha-single/api exists and doesn't contain a nested 'api' dir
    - Sign off :-D
    
    Note: this affects the packages too, as the standard install is used as a basis.
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ebaa3543d6278fe31886310cda5b10c807e6ad8a
Author: Nicole C. Engard <nicole@bywatersolutions.com>
Date:   Wed Jul 27 13:27:37 2016 +0000

    Bug 16727: Clarify upload category note
    
    This patch clarifies the note on the upload tool
    that states that no categories are defined.
    
    To test:
    
    * Log in to Koha
    * Confirm that you have no values set for the UPLOAD
      authorized value category
    * Visit Tools > Upload
    * Check the warning note for typos
    * Add a authorized value category for UPLOAD
    * Visit Tools > Upload
    * Confirm that note is replaced
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit e8d4c634b407584dc6828548ceff1f2dbb59a236
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Thu Jul 7 12:07:33 2016 -0600

    Bug 16861: (followup)Translatability: remove fa-hand-o-down icon
    
    Remove fa-hand-o-down icon accoring with QA comment 5
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 5f3baecf42e0408f7ff49ab52b1afe8dcf3805fb
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Wed Jul 6 10:00:55 2016 -0600

    Bug 16861: Translatability: Fix separated "below" in circulation.tt
    
    This patch propose to fix this two entries in PO files:
    
    "See highlighted items" and "below"
    
    Also add some Font Awesome Icons
    
    To test:
    -Apply patch 16810 on top and this patch
    -Go to a patron who has overdues
    -See the link "See highlighted items below" with a hand down icon
    -Look the new plus icon to "Add a new message" to the patron.
    -Add a few messages and notice about the trash icon in "Delete" links
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ef0738922005e4235b80e70663d7fa711a87556e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jul 6 14:17:20 2016 -0400

    Bug 16864: Silence warnings in t/db_dependent/ILSDI_Services.t
    
    prove t/db_dependent/ILSDI_Services.t
    generates noisy output as a result of the ambiguous context
    of two $cgi->param() calls.
    
    By storing into scalar variables, and then using the scalar
    variables, the code maintains readability and fixes the problem.
    
    TEST PLAN
    ---------
    1) prove t/db_dependent/ILSDI_Services.t
       -- noisy.
    2) apply patch
    3) prove t/db_dependent/ILSDI_Services.t
       -- not noisy
    4) run koha qa test tools
    
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 1be7fb5e12f0dd3911bb182ef2c0740c481337ec
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jul 6 21:37:21 2016 -0400

    Bug 16868: Silence error t/db_dependent/Linker_FirstMatch.t
    
    When the auth_header table has records which exclude 1xx and
    2xx tags, the $bibfield doesn't match anything. This in turn
    sets it to undef, which triggers an error on the next line
    killing the test.
    
    This was completely refactored to provide the data necessary
    for the tests to pass, and to be more comprehensive (both MARC
    and UNIMARC are tested). The tests are then run.
    
    C4::Headings::authorities is mocked, so that this test is not
    dependent on a search engine.
    
    TEST PLAN
    ---------
    1) back up DB
    2) DELETE FROM auth_header;
    3) SOURCE auth_header.sql;
       -- the provided file
    4) prove t/db_dependent/Linker_FirstMatch.t
       -- should barf before running all the tests
    5) apply all patches
    6) prove t/db_dependent/Linker_FirstMatch.t
       -- should work happy
    7) run koha qa test tools
    8) restore your backup
    
    Followed test plan, behaves as expected.
    Signed-off-by: Marc <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 13004a8c649f1098f1ddd3be5a02b75bad27f3d8
Author: Marc Véron <veron@veron.ch>
Date:   Tue Jul 5 07:14:26 2016 +0200

    Bug 16871: Translatability: Avoid [%%-problem and fix related sentence splitting in catalogue/detail.tt
    
    In koha-tmpl/intranet-tmpl/prog/en/modules/catalogue/detail.tt,
    fix line splitted TT directives and sentence splitting leading
    to translatability problems. (See first comment).
    
    To test:
    - Apply patch
    - Go to detail pages of biblios with waiting holds
    - Verify that messages in column 'Status' are OK
    - Examine code in patch to make sure that the simplification in logic
      makes sense and that no TT directive is splitted
    - Bonus test:
      - Go to folder misc/translator. Run perl translate create xx-XX
      - Verify that monster mentioned in first comment no longer exists
        (in po/xx-XX-staff-prog.po)
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Amended for wording (comment #5) 2016-07-26 mv
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 92626f55c88661d1e5b8dea57bdca412df004123
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 22 11:48:21 2016 +0200

    Bug 16971: Missing dependency for HTML::Entities
    
    This module is already used in opac-password-recovery.pl.
    It is loaded in Acquisition, but not used (anymore?).
    It is not yet listed in PerlDependencies.
    
    Note: The module is packaged for Debian Wheezy and Jessie.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit d475dae77313e8f0ee11146ce824d019351cbc5f
Author: Jesse Weaver <jweaver@bywatersolutions.com>
Date:   Fri Jul 8 16:01:19 2016 -0600

    Bug 16818: External auth redirect broken under Plack
    
    Test plan:
    
    0) Have either CAS or Shibboleth authentication enabled under Plack.
    1) Hover over the authentication link on the staff client or OPAC, and
       notice that it has either '.../opac/...' or '.../intranet/...' instead
       of '.../cgi-bin/koha/...'. (This will be a complete dealbreaker for CAS
       authentication.)
    2) Apply patch.
    3) Check links again; they should now have the correct paths.
    
    Signed-off-by: Matthias Meusburger <matthias.meusburger@biblibre.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Did not test CAS or Shibboleth, but no regression found.
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 6122b8fe6ee73b9e0a26312507912d947c6d58f7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 28 19:44:30 2016 -0300

    Bug 16830: (followup) Remove weird character from warning in rebuild_zebra.pl
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 87bcaa7df3fa8beca0dabed42c80930e70c3ece8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 28 19:41:54 2016 -0300

    Bug 16830: Remove -x usage on koha-indexer
    
    This patch just does that, and removes it from the comment on /etc/default/koha-common
    
    To test:
    - Apply the patch
    - Run:
      $ vagrant ssh ; cd kohaclone
      $ sudo debian/scripts/koha-indexer --stop kohadev
      $ sudo debian/scripts/koha-indexer --start kohadev
    => SUCCESS: Verify no warning is shown on the indexer-output.log file
    - Sign off
    
    https://bugs.koha-community.org/show_bug.cgi?id=16830
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 28eae42d2d09c14d0bb1bd3e1655714b33711ab3
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Tue Jul 26 08:57:50 2016 +1200

    Bug 16975 : @INC should not have '.' as its last entry
    
    To Test
    1/ Try using a plugin
    2/ Apply patch
    3/ Test plugin still works
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 9bdea2e3691fd62e777cc974f89b867a69eec9a8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 22 08:30:54 2016 +0100

    Bug 16878: Fix XSS in opac-memberentry
    
    The vars are gotten from the url and sent to the template as it. They
    must be escaped.
    
    Test plan:
    I have not managed to create the original issue, so there is no test
    plan for the XSS fix, but you can confirm there is no regression.
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 91bc9451d0378d65100c828776b09395e4c88199
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jul 27 18:00:53 2016 +0000

    Bug 16988 - Suspending a hold with AutoResumeSuspendedHolds disabled results in error
    
    iUnless AutoResumeSuspendedHolds is enabled, attempting to suspend a
    hold from reserve/request.pl results in the following error:
    
    The given date (undefined) does not match the date format (us) at
    /home/vagrant/kohaclone/Koha/DateUtils.pm line 152.
    
    Test Plan:
    1) Enable SuspendHoldsIntranet
    2) Disable AutoResumeSuspendedHolds
    3) Attempt to suspend or unsuspend a hold
    4) Note the error
    5) Apply this patch
    6) Repeat step 3
    7) The hold should suspend or resume correctly
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Megan Wianecki <mwianecki@mtpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit c63d0b311b5e7ba882d19b9b8a71838256de98cf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 14:00:02 2016 +0100

    Bug 17022: Fix XSS in circ/branchtransfers.pl
    
    Test plan:
    Enter the following in the barcode input:
        <script>alert('XSS')</script>
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit eb543a90848b97d35aa15052c8881134926a3ed0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 14:15:09 2016 +0100

    Bug 17023: Fix XSS in acqui/z3950_search.pl
    
    Test plan:
    Enter the following in the different inputs:
    <script>alert('XSS')</script>
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f6e0a619d974fe002ec6a920206c7bc2808bce26
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 14:06:41 2016 +0100

    Bug 17023: Fix XSS in cataloguing/z3950_search.pl
    
    Test plan:
    Enter the following in the different inputs:
    <script>alert('XSS')</script>
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f563ba795e4863328ff4930e7877caae9458206c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 14:32:46 2016 +0100

    Bug 17024: Fix XSS in tools/viewlog.pl
    
    Test plan:
        Hit /tools/viewlog.pl?do_it=1&modules=CATALOGUING&action=MODIFY&object=<script>alert("XSS")</script>
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 9d00353a92487dcde654d88206fd5458448fff1b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 14:51:49 2016 +0100

    Bug 17026: Fix XSS in serials/checkexpiration.pl
    
    Test plan:
    Hit:
     /serials/checkexpiration.pl?title="><script>alert("XSS")</script>&date=12/02/2002
     /serials/checkexpiration.pl?issn="><script>alert("XSS")</script>&date=12/02/2002
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 66f81fc2101f194d39592bc28f3e2ff69764bc00
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 2 15:41:49 2016 +0100

    Bug 17028: Fix XSS in reserve/request.pl
    
    Test plan:
    Hit
      /cgi-bin/koha/reserve/request.pl?biblionumber=1"><script type="text/javascript">alert("XSS")</script>
    
    => Without this patch you will see the alert
    => With this patch, no more alert
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit c6d3e5a50b0c3fa104cae61211f3d2259dc60f52
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 1 11:13:53 2016 +0100

    Bug 16715: Use Sereal::Decoder and Sereal::Encoder instead of Sereal
    
    Sereal is not packaged for jessie, so let's use Sereal::Encoder and
    Sereal::Decoder instead.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bcf7268f4f37ead02db8bc2da457ddfc9ce425c0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jul 6 12:50:08 2016 +0000

    Bug 16436 [QA Followup] - Use debug instead of info
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ce8c55fba055e856af406587894c6d67c68bc681
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 3 18:58:57 2016 +0000

    Bug 16436 - Allow action logs to be logged to the koha log file
    
    Test Plan:
    1) Ensure that your Koha::Logger configuration is in good working order
    2) Apply this patch
    3) Modify the first line of your log4perl.conf file from:
        log4perl.logger.intranet = WARN, INTRANET
       to
        log4perl.logger.intranet = INFO, INTRANET
    4) Change a system preference setting
    5) Note the new line in your log file!
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fcd139b22239206142809993cf9e328a3cdce38d
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Apr 20 10:29:03 2016 -0400

    Bug 16310 - Remove the use of "onclick" from audio alerts template
    
    This patch removes one use of "onclick" in favor of defining events in
    the JavaScript.
    
    This patch also makes changes to the style of some buttons to make the
    interface a little more consistent with current practices.
    
    To test, apply the patch and go to Administration -> Audio alerts.
    
    - In the list of existing audio alerts, click the "Edit" button for any
      alert. The correct data should be loaded in the edit form.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 537adde2d2f65ed9bb9a03a127b9906930d46353
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu May 19 13:28:02 2016 +0000

    Bug 15397 - Pay selected does not works as expected
    
    When patron has more fees (account lines) and you wan't to pay just some
    of them, you select wanted lines a click on "pay selected" button. But
    the fine isn't paid, the "amountoutstandig" is not modified, but it is
    added new line with "pay" code an with amountoutstanding below zero.
    Paying one or all fine works as expected. Paying selected worked some
    time ago, but I don't know when it stopped working, we realize it after
    upgrade to 3.22.
    
    Test Plan:
    1) Apply this patch
    2) Pay fines using "Pay selected"
    3) Note the payment and the fees outstanding balances are reduced!
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e8b54cb3be3c15287b88869550d5fde2221f5d94
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Aug 1 09:54:30 2016 +0000

    Bug 16573 - DBRev 16.06.00.012
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 44785935bd45291a2ae36a5c9ab65b1e6cf69c5b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 22 09:51:00 2016 +0100

    Bug 16573: Define virtualshelves.created_on as datetime for existing installs
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 162b9015d9bfb23200d1bddff69be9384a33463b
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue May 24 18:12:11 2016 -0300

    Bug 16573: change created_on type - atomic update
    
    This patch change 'created_on' virtualshelves column to
    datetime type
    
    To test:
    1) Apply the patch
    2) Run updatedatabase.pl
    3) Verify type of 'created_on' column
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 36b2b288a7b8a39530f0a1ba7a00396206640533
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Mon May 23 17:06:01 2016 -0300

    Bug 16573: fix structure and sample data for MySQL 5.7
    
    Web install on Ubuntu 16.04/Mysql 5.7 fails.
    
    This patch makes small changes to make installation
    possible to kohastructure.sql and some sample files.
    
    Sample values for quotes table can't have '0000-00-00 ...' values
    nor NULL values, now() is perhaps an option.
    
    Depends on Bug 16572
    
    To test:
    1) System with MySQL 5.7, for example Ubuntu 16.05
    2) Apply 16572
    3) Try web install, it fails
    4) Apply this and next patch
    5) Try again, now it succeed
    
    This is only for English install, i18n files needs revision
    I can do that if this is accepted.
    
    Perphaps a change is needed to updatedatabase.pl
    
    Ammended patch, 'created_on' field on virtualshelves
    can't be timestamp default null, mysql 5.5 complains
    that only one timestamp column can be defined as
    default not null. Changed to 'datetime' type.
    
    Can provide followup with updatedabase change,
    but need an opinion if this type change makes sense.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d00d46112df2dc1c3f823fbc2a8c347deb69cdb7
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Mon May 23 16:58:03 2016 -0300

    Bug 16573: fix linkid value on marc_subfield_structure
    
    followup to previous patch.
    
    This patch fixes linkid value. It was set to '', but
    declared as tinyint.
    Mysql < 5.7 replaced this with nearest right value, i.e 0
    Mysql 5.7 gives error here.
    
    Also some normalization, all lines with data begins with two tabs
    
    To test:
    On top of Bug 16572 and previous patch
    
    1) Run webinstaller
    2) Add mandatory values
    3) There must be no problems on MySQL 5.7
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ed61bd9bba8925373241abd9f582c240695f8ce5
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Tue Sep 8 11:32:27 2015 +0200

    Bug 14793: New cataloguing plugin unimarc_field_225a_bis
    
    It is similar to unimarc_field_210c_bis, but searches in
    biblioitems.collectiontitle instead of biblioitems.publishercode
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 856f4426b33ad498bfeed3a58097276e85850bab
Author: Marc Véron <veron@veron.ch>
Date:   Wed Jul 20 16:54:34 2016 +0200

    Bug 16945: PatronSelfRegistration: Add note about setting PatronSelfRegistrationDefaultCategory
    
    In OPAC, patron self registration works only when
    PatronSelfRegistrationDefaultCategory is set to a valid patron category.
    
    This patch adds a note for
    PatronSelfRegistration on Home > Administration > System preferences.
    
    To test:
    - Apply patch
    - In staff client, search system preferences for PatronSelfRegistration
    - Verify that note appears with PatronSelfRegistration
    
    (Amended to fix typo, see comment #3, 2016-07-21 mv)
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 278eb01bbabad1f30cf4a15e09f9360d20ea4718
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jul 20 15:18:18 2016 +0100

    Bug 16906: Simply remove the sDom definition to use the default one
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1614787d0210d55ab77b9ee2500ac16da2bf6854
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jul 12 14:07:18 2016 -0400

    Bug 16906 - Add DataTables pagination and filter to top of saved SQL reports table
    
    This patch adds a DataTables toolbar to the top of the saved SQL reports
    table so that pagination and filtering controls are at the top as well
    as the bottom.
    
    To test, apply the patch and go to Reports -> Saved reports. There
    should be controls at the top of the table of saved reports for setting
    number of results, pagination, and searching.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1766b10d525819629219ee5f34a1201a6dadc7fa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 15:06:18 2016 +0100

    Bug 16847: Add empty option to Salutation/title
    
    At the OPAC there is no way to empty this value.
    I think it should be allowed to empty it.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 131002e6230f2b69f0d6007b75fbc90444745b68
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 15:03:18 2016 +0100

    Bug 16847: Remove C4::Members::GetTitles
    
    This subroutine just reads the content of a pref, split it, add an
    empty string and returns.
    It is not really useful and the code in the script (memberentry.pl) uses
    the only occurrence of CGI::popup_menu
    Let's remove it and build the dropdown list in the template.
    
    Test plan:
    1/ Empty BorrowersTitles, edit a patron and confirm that the "Salutation"
    does not appear
    2/ Fill BorrowersTitles with "Mr|Mrs|Miss|Ms", edit a patron and confirm
    that the "Salutation" dropdown list is correctly filled.
    The default option should be selected if you are editing a patron with a
    title defined.
    This should also be tested at the OPAC.
    
    Followed test pan, works as expected in Staff and OPAC
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6ac4b20d3ab548621d6ffc8a931b947fdb3eb6f2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jul 22 17:21:42 2016 +0000

    Bug 11606 - DBRev 16.06.00.011
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ec2271227c6f7beaf0016b618daebd31ee42d515
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 22 10:26:12 2016 +0100

    Bug 15451: Better error handling
    
    1/ If a librarian edit (add_validate) a non-existing csv profile, we
    explicitely die
    2/ If you try to delete a non-existing csv profile, you will now get a
    nice alert box
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 00eeb41162066f80053e29a728a1510a8626eb24
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Apr 27 22:28:08 2016 -0300

    Bug 15451: (followup) fix filename extension for csv file
    
    This patch does the same as basket/downloadcart.pl
    to set '.csv' as filename extension for downloadshelf.pl
    
    To test:
    1) Define a CSV MARC profile
    2) On staff download a list, extension is '.NN'
    with 'NN' the CSV profile id.
    3) Apply the patch
    4) Download again, check extension is now '.csv'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0e9c3d446d999b00558611746f433cf193669adf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 6 08:58:13 2016 +0000

    Bug 15451: Do not considered a Resultset as a Result
    
    The previous calls were wrong, but there is something bad with the DB
    structure: export_format.profile should be a unique key.
    This patch fixes the previous calls and add a FIXME not to forget to fix
    the DB structure.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Previous test where done with all patches applied,
    including this one, and all worked.
    No errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f3d7f271078f10837b5d1877e2cdfee209c98381
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 30 18:28:55 2015 +0000

    Bug 15451: Koha::CsvProfiles - Remove the residue
    
    This patch erase all traces of C4::Csv since it's not used anymore.
    All occurrences have been replaced by previous patches to use
    Koha::CsvProfiles.
    
    Note that GetMarcFieldsForCsv was not used prior this patch set.
    
    Test plan:
      git grep 'C4::Csv'
    should not return any result.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    No more traces of the file.
    This produces a koha-qa fail, due to the missing file.
    No other errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0e80c75aee02157b1fc4121ecf3b039f6f797b7b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 30 18:26:17 2015 +0000

    Bug 15451: Koha::CsvProfiles - Remove GetCsvProfile
    
    This subroutine just returned a csv profile for a given id.
    It is replaced in this patch by a call to Koha::CsvProfiles->find.
    
    There is nothing to test here, these changes have been tested in
    previous patches.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bea95dace6d6e3d4eb99c1985f7f80e50cc6beb5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 30 18:23:24 2015 +0000

    Bug 15451: Koha::CsvProfiles - Remove GetCsvProfileId
    
    This subroutine returned the export_format_id for a given profile name.
    This can be done easily with the Koha::CsvProfiles->search method.
    
    Test plan:
    Export records using the misc/export_records.pl script and the
    export tool.
    If you are exporting using the MARC format, the profile filled in the pref
    ExportWithCsvProfile will be used (or the one passed in parameter of
    misc/export_records.pl).
    If you are exporting using the CSV format, you can choose a profile in
    the dropdown list.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Exported using tool & cmd, marc & csv. Pref is used.
    No errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 04c7a8a845fb780c72d412133a4b97056c35301e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 30 18:16:01 2015 +0000

    Bug 15451: Koha::CsvProfiles - Remove GetCsvProfiles
    
    This subroutine did the same job as GetCsvProfilesLoop, so this patch
    applies the same changes as the previous patch.
    
    Test plan:
    1/ Claim some serials, sql profiles should be listed
    2/ Export records using the export tool. MARC profiles should be listed.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Listed sql & marc profiles
    No errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 814a1d4231c8e71613ce58a72b30a539654c34ee
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 31 10:32:35 2015 +0000

    Bug 15451: Koha::CsvProfiles - Remove GetCsvProfilesLoop
    
    This subroutine returned the csv profiles for a given type.
    This could be done easily with the new Koha::CsvProfiles->search method.
    
    Test plan:
    To do at the OPAC and staff interface!
    1/ Export a list using a CSV profile
    2/ Export your CART using a CSV profile
    Note that only MARC profiles should be available.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Tested on staff/opac & cart/list
    Small problem on filename extension fixed in followup.
    No errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6d75e385c818212cc10a9832b5a5525cbef6e6b2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 31 10:23:24 2015 +0000

    Bug 15451: Rewrite the csv profile tool script
    
    This page was inconsistent with the other admin and tool pages.
    The 2 tabs 'New profile' and 'Edit existing profile' were useless, the
    ergonomic needs to be revisited.
    This patch applies the same script/page structure as others: by default
    a table containing all csv profiles is displayed with 2 action links:
    edit and delete.
    
    Test plan:
    1/ Create 1+ CSV profiles, with different types (marc and sql)
    2/ Update some values using the Edit link
    3/ Delete a CSV profile
    
    Note: When deleting a CSV profile, it would be great to warn the user if it is
    used.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    No problems on create, update and delete.
    No errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9deb1ace53a16d245a7dfbefd8df016822dae850
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 31 10:22:47 2015 +0000

    Bug 15451: Add the 2 new modules Koha::CsvProfile[s]
    
    There are based on Koha::Objets. Tests provided.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Test pass, no errors.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 66a8c9655079f141c9185aea329435e3a63bbd0a
Author: Jesse Weaver <jweaver@bywatersolutions.com>
Date:   Wed Jun 8 11:31:54 2016 -0600

    Bug 16715: Proposed followup to use Sereal for serialization
    
    This manages to eke out a bit more performance on my machine.
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b7afd4218867ce362f3c140d6dd7ffbceb2eb687
Author: Jesse Weaver <jweaver@bywatersolutions.com>
Date:   Tue Jun 14 09:39:09 2016 -0600

    Bug 11606: (followup) minor typos
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>
    Internal signoff.
    
    Signed-off-by: Alexis Rodegerdts <arodegerdts@wallawallawa.gov>
    
    Signed-off-by: Dwayne Nance <dnance@ebsco.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ca4f4c6680b053f49d448b01d3088842aacd20a4
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri May 27 16:51:56 2016 -0400

    Bug 11606: Add Novelist client to staff
    
    To test:
    1 - Apply patches
    2 - Update database
    3 - View detail pages for some records and ensure no changes have been made
    4 - Enable NovelistSelectStaffEnabled (and enter or have info in the
            Profile and password)
    5 - Set NovelistSelectStaffView to 'above'
    6 - View detail pages for some records, verify that if novelist info is
    available it is displyaed and nothign is displayed if not
    7 - Repeat with all staff view options
    
    Sponsored by:
       Walla Walla Public Library (http://www.wallawallapubliclibrary.org/)
       Los Gatos Library (http://www.losgatosca.gov/42/Los-Gatos-Library)
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>
    Internal signoff.
    
    Signed-off-by: Alexis Rodegerdts <arodegerdts@wallawallawa.gov>
    
    Signed-off-by: Dwayne Nance <dnance@ebsco.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a975fb1b2ab3d57cdadee3cefdba2a9d1a882713
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Tue Jul 5 09:12:24 2016 +1200

    Bug 7143 : More new devs
    
    confirmed dates against emails and downloads.koha-community.org
    Two names added correctly.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5c0485c918679d8adb1be5597f9b8d7a28072e45
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Tue Jun 21 08:39:34 2016 +1200

    Bug 7143 : Adding new developers
    
    Claire Gravely seemed to be a cut and paste error.
    June 3 better matches git log.
    Three other names in history are in about as well.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 75caa1bef4e90f9b40fe4ae06fc49abfe0b933cf
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jun 13 08:36:48 2016 +0200

    Bug 7143: [QA Follow-up] Adjusting developer information
    
    For consistency we should not only add firstnames to the list of
    developers in about.tt and history.txt.
    
    Adding some surnames with the help of git log and Bugzilla. Also
    corrected a closing li tag.
    Note that I did not find one surname: Natasha of Catalyst Academy.
    Probably Chris could add that missing piece.
    
    NOTE: Natasha piece still needs clean up.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7adb8861aa352afdfd300bc50d03af450e26468f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 21 18:23:00 2016 +0100

    Bug 16934: Add test for ModOrder
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7cc6f6eb45333e1f2041e53dcfdc31532880bd9f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jul 18 11:02:14 2016 +0000

    Bug 16934 - Cannot add notes to canceled and deleted order line
    
    Some librarians would like to be able to add notes to deleted order
    lines to keep track of data such as what title the order line was for.
    For some reason ModOrder dies if a biblionumber is passed in, even
    though it does not use biblionumber and does not need it to exist in any
    fashion! This limitation should be removed.
    
    Test Plan:
    1) Create a basket with an orderline
    2) Cancel the order / delete the record
    3) Click the "Add internal note" link for that order line
    4) Fill in a note and click "Save"
    5) Note the error
    6) Apply this patch
    7) Repeat steps 3-4
    8) Note this time the note is saved!
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 65918b146cd88f38a9d894be8175d049ea70d05f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 22 08:14:27 2016 +0100

    Bug 16958: Fix XSS in opac-imageviewer.pl
    
    Test plan:
    Trigger
    /opac-imageviewer.pl?biblionumber=14&imagenumber=7"><sCrIpT>alert(42)<%2fsCrIpT>
    
    => Without this patch you will see the JS alert
    => With this patch applied you won't see it
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87d96b973aa19e0808070d4b0fdd6485e5c83181
Author: Marc Véron <veron@veron.ch>
Date:   Thu Jul 21 10:22:57 2016 +0200

    Bug 16947: Can not modify patron messaging preferences
    
    To verify:
    - Set syspref 'EnhancedMessagingPreferences' to 'Allow'
    - In staff client, go to a patron's detail page
    - Edit Patron messaging preferences (using link below table)
    - Save
    Result: Form does not save, stays open
    JavaScript error in intranet-tmpl/prog/js/members.js line 107
    TypeError: document.form.password is undefined
    
    To test:
    - Apply patch
    - Repeat steps above
    - Verify that messaging preferences save as expected
    - Verify that other patron modifications work as before
    
    NOTE: remember to force reload of the javascripts.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 52ac9a1ca3990102c3c635e3d9af06aae29f73e1
Author: Srdjan Janković <srdjan@catalyst.net.nz>
Date:   Mon Jun 13 15:35:56 2016 +1200

    Bug 16716: Replaced wrong GROUP BY with DISTINCT
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b01aa596abb91f8679c64e89197fbb2b3d9309cc
Author: Jesse Weaver <jweaver@bywatersolutions.com>
Date:   Wed Jul 20 16:51:45 2016 -0600

    Bug 15974: Rancor: Correctly select existing authorized value
    
    Test plan:
      1) Open up a record in Rancor with an itemtype besides the first in
         the list ('BK' in the sample itemtypes).
      2) It will show "Book" instead of the correct itemtype.
      3) Apply patch, reload the page.
      4) The correct itemtype should now show.
    
    NOTE: The scope is only 942$c. This corrects that.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d7754b70a21d0cfef933a54e24f212ed04e3a0e5
Author: Marc Véron <veron@veron.ch>
Date:   Thu Jul 14 15:50:22 2016 +0200

    Bug 16941: Can not add new patron in staff client
    
    To reproduce:
    - Go to staff client Home > Patron
    - New patron
    - Choose a category and fill form, submit
    Result: Form reloads, patron data are not saved.
    
    To test:
    - Apply patch
    - Repeat steps above
    - Verify that patron data are saved and the new patron's
      detail page displays
    - Try to enter a duplicate patron (e.g. same surname, firstname
      and birthday as above)
    - Verify that a duplicate message appears
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 358010afa525c26067ef69a8077d95ab5fc016d2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 12 08:37:33 2016 +0100

    Bug 16913: Koha::Patrons - Remove GetBorrowersNamesAndLatestIssue
    
    This subroutine has been added by
      commit 5904681faca77c87ff8071414d66e123a2d3baa9
      Date:   Wed Mar 19 10:11:12 2008 -0500
        CleanBorrowers fixing.
    but has never been used.
    It can be removed safely.
    
    Test plan:
      git grep GetBorrowersNamesAndLatestIssue
    should not return any results.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1c61729e840655bfea7123d0c826a0cffa9bd1bc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 11 23:07:34 2016 +0100

    Bug 16909: Koha::Patrons - Remove checkuniquemember
    
    C4::Members::checkuniquemember was not really nicely written, was only
    used once and was not covered by tests.
    I think it does not make sense to keep such complexity and have this
    code in the subroutine/method.
    Looking at this patch it seems that what this subroutine did can be done
    easily in the pl script in few lines.
    
    Test plan:
    1/ Create 2 organisations with the same "surname": you should get a
    warning.
    2/ Create 2 patrons (non-organisation) with the same
    surname/firstname/date of birth, you should get a warning
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dc78583de113bb9d24e29c2ca1c7d4033951fd59
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jul 9 14:37:46 2016 +0100

    Bug 16889: Remove C4::Items::biblioitems_columns and use Koha::Biblioitems->columns instead
    
    Test plan:
    Add new rule to the "Automatic item modifications by age" tools
    (tools/automatic_item_modification_by_age.pl) and make sure the columns
    of the biblioitems table are correctly displayed in the 'Conditions'
    dropdown list.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e6aa7d65dab9bfbe2dc616e3a1180f647888ceff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jul 9 14:35:02 2016 +0100

    Bug 16889: Remove C4::Items::columns and use Koha::Items->columns instead
    
    Test plan:
    Add new rule to the "Automatic item modifications by age" tools
    (tools/automatic_item_modification_by_age.pl) and make sure the columns
    of the items table are correctly displayed.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c97e04e8e79261a5dc2ac78f92a5b331ad6a8b30
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jul 9 14:35:08 2016 +0100

    Bug 16889: Remove C4::Members::columns and use Koha::Patrons->columns instead
    
    Test plan:
    Import some patrons (tools/import_borrowers.pl) and make sure it imports
    the patrons correctly.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5eba0ab027b7cb7c7bc9f3973c0700d4d64e5b12
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jul 9 14:32:40 2016 +0100

    Bug 16889: Add Koha::Objects->columns
    
    Currently we have 3 subroutines to retrieve the columns of tables:
    C4::Members::columns, C4::Items::columns and
    C4::Items::biblioitems_columns.
    It is easier to have a Koha::Objects->columns method to provide the
    different classes to retrieve their related column names.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 59d8f3f8617070ec29159ee3c2e0400e9214e4d4
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Jul 7 23:40:29 2016 +0000

    Bug 16876: Remove Full Heading column from OPAC Auth search results
    
    To test:
    
    1) Go to Authority Search and do a search
    2) Notice that there is a Full Heading column that has 'View full
       heading' links. These take up a lot of space and don't mean a lot to
       the user
    3) Apply patch and refresh
    4) Notice that the the Full Heading column is gone and there is now a
       Details column next to the authorities. Confirm the link takes you to
       the expected authority detail page.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit afc008b2fa8cf5b409407b4d46585800467b39d3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 14:00:58 2016 +0100

    Bug 16853: Move changepassword to Koha::Patron->update_password
    
    This patch moves the code from C4::Members::changepassword to
    Koha::Patron->update_password
    
    Test plan:
    Change your password at the OPAC and the staff interface
    This should work as before
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    I rebased this on top of 16849 because they were conflicting.
    Tests pass, code looks good (as usual) and I checked both OPAC
    and staff password change work as expected.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e1e38896bb6a6cb5bcc9fd4b6fc129f143d7406a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 11:29:16 2016 +0100

    Bug 16849: Move IsDebarred to Koha::Patron->is_debarred
    
    In order to move IsMemberBlocked to Koha::Patron it makes sense to move
    the code from Koha::Patron::Debarments::IsDebarred to
    Koha::Patron->is_debarred.
    
    Test plan:
    1/ Add a restriction to a patron
    2/ make sure he is not able to checkout items any more
    3/ Make sure he cannot get a discharge
    4/ Put a hold and make sure you get "Patron has restrictions"
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 81a9e7c88ee44fdfdd2f4f19b52150ce7176b1b7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jul 14 11:45:54 2016 -0400

    Bug 16681 - Allow update of opacnote via batch patron modification tool
    
    To test:
    1 - Select a batch of patrons (via list, saved file, and cardnumber
            entry)
    2 - Verify you cannot edit 'opacnotes' field, nor can you see
    'borrowernotes' field in table, though you can edit it
    3 - Verify editing works as expected
    4 - Apply patch
    5 - Select a batch via each method as above
    6 - Note both note columns display in table
    7 - Note that you can edit or clear the opacnotes field as expected
    8 - Verify other feautres work as previously
    
    Sponsored by:
       Lancaster Theological Seminary (https://lancasterseminary.edu/)
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 65b2da08c9edaa6d2afe83ca7a5b72000128ecbe
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 17 11:18:14 2016 -0400

    Bug 16538: Improve the style of progress bars
    
    This patch updates the style of progress bars to make them a little
    nicer. Progress bars in the staff client are not built in a consisten
    way. Some have been updated to use the <progress> element and some have
    not. This patch improves some styling common to both kinds.
    
    Other changes:
    
    - Redundant in-page CSS has been removed from many pages.
    - An invalid "min" attribute has been removed from several instances of
      <progress>.
    - Corrected capitalization.
    - Fixed incorrectly quoted attributes.
    - Added missing form "action" attributes.
    
    To test, clear your browser cache if necessary. Apply the patch and
    test uploads on the following pages:
    
    - Circulation -> Offline circulation file upload
    - Tools -> Batch item modification
    - Tools -> Batch record modification
    - Tools -> Stage MARC records for import
    - Tools -> Manage staged MARC records
    - Tools -> Upload local cover image
    - Tools -> Upload
    
    In all cases, progress bars should look improved and work correctly.
    
    Test Tools -> Batch item deletion. Unused background job handling markup
    has been removed. Deletion processing should work correctly.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b7c61a5d128cc3580ea3ee67bc29e02571923dd3
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue May 17 04:46:31 2016 +0000

    Bug 16531: Circ overdue report is showing an empty table if no overdues
    
    EDIT: Comment 2
    EDIT2: using noreport variable (Comment 5)
    
    To test:
    1) Ensure you have no items overdue
    2) Go to Circ -> Circulation reports -> Overdues
    3) Notice empty table, '0 items overdue' heading
    4) Ensure syspref FilterBeforeOverdueReport is set to 'Don't require'
    5) Apply patch and refresh page
    6) Notice empty table is no longer showing and page says "There are no
       overdues"
    7) Apply a filter to search
    8) Page now says "There are no overdues matching your search" with a
       link to reset filter.
    9) Click Reset filter -> confirm any filters you applied are cleared.
    10) Set FilterBeforeOverdueReport to 'Require' and refresh overdue
        report
    11) Page should say "Please choose one or more filters to proceed"
    12) Check out an item to a member, ensure due date is a date that has
        passed (i.e. yesterday)
    13) Refresh overdue report page
    14) Page should still say "Please choose one or more filters to proceed"
    15) Set FilterBeforeOverdueReport to 'Don't require'
    16) Confirm table now shows correctly with '1 items overdue' heading
        etc.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b89a601e5742b3067fa6ed508313acfce4e73e73
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 3 14:49:25 2016 -0400

    Bug 15853 - Add author and link columns to opac course reserves table
    
    To test:
    1 - Add some course reserves
    2 - View the table in staff and opac, there is no column for author or
    link
    3 - Apply patch
    4 - You shoudl see these columns
    5 - Link should contain item uri if present, fallback to title 856$u,
      then be blank if niether
    
    Sponsored by:
        Southeastern Wisconsin Information Technology Exchange, Inc (SWITCH)
        (http://caspian.switchinc.org/)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Might be good to add this table to the column visibility tool if you
    plan to add more columns.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dba6cfe441a3ee14183287795c0c4293c74b2989
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Mon Jul 11 08:34:38 2016 -0600

    Bug 16888: (follow-up)Add Font Awesome Icons to Members
    
    Remove fa-ban according with QA comment 4
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ae4195207726fb01cebad0d809addaefffe37975
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Fri Jul 8 15:52:06 2016 -0600

    Bug 16888: Add Font Awesome Icons to Members
    
    Add Font Awesome Icons to:
    - "Select/Clear all" links to pay.tt (Pay fines tab)
    - "Filter icon" in "filter paid transactions" to Accout tab (boraccount.tt)
    - "Trash icon" to Remove option in "Manual restrictions"
    (borrower_debarments.inc) also add "Ban and plus icon" to "Add manual restriction"
    
    To test:
    -Apply patch
    -Select a patron who has fines
    -Go to "Fines->Pay fines" tabs and see the icons in "Select/Clear all"
    -Choose the "Account" tab and sse the icon in "Filter paid transactions"
    -Select the "Check out" tab and go to "Restrictions"
    -Add a manual restriction and notice about the two new icons fa-plus and fa-band
    -See the new button btn-mini and the fa-trash icon
    -Verify that all works as expected
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f240a91640234bf0f4e3bf6162c8fe3389db4ec2
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Fri Jun 24 15:55:40 2016 -0600

    Bug 16812: Revise JS script for z3950_search.tts and remove onclick events
    
    Modify JS script to all templates for z3950_search.tt and reduce the
    redundant code
    
    This patch propose:
    -z3950_auth_search.tt has various onclick events used in links.
     Also fix: acqui/z3950_search.tt and cataloguing/z3950_search.tt
    -Trigger onclick events via JQuery .on()
    -Make a separate .js and .inc file
    -Reduce the number of line and redundant code
    -Also add Font Awesome Icons to "Select/Clear all" and "Clear search
     form" links
    
    To test:
    1-Apply bug 16600 on top
    2-Apply patch
    3-Go to Authorities > click New from Z39.50
    4-Fill some fields and click in "Clear search form" link
    5-Search under "Dalton" or another author that launch too many headings
    6-Clic in some heading and notice the dialog open, test: "Preview MARC",
      ISBD (when showed), "Import" and close the dialog "X". Use the
      "Import" from table too.
    7-Use the "next/previous page" button, change "Go to page" to number in and
      out of the range presented, also test whit a letter, etc.
    
    Go to Cataloging > New from Z39.50/SRU
    Repeat steps 3 to 6. But this time with bib records.
    
    Go to Adquisition > Open or Create a basket and choose to "Add to basket"
    button. A modal appear, chose the option "Order from external source"
    Repeat steps 3 to 6. But this thime with bib records.
    
    NOTE: The icon trash for "Clear search form" has been selected according
    with module "Advanced search" there is an icon trash with link "Clear
    fields" that has the same fuctionality.
    For some reason the image loading-small.gif does not charge all times
    when the code is get out of the template. (Fixed with this new patch)
    DataTable it is specific for each template
    
    Sponsored-by: Universidad de El Salvador
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3fe6abc9d57fc1dc9968af0b25644f4cdb2289e0
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jun 20 14:57:25 2016 +0200

    Bug 16777: Correct intranet search alias
    
    A long-standing typo in our apache config files:
    [intranet]/search refers to search.pl (which does not exist)
    
    This patch refers it to catalogue/search.pl
    
    Test plan:
    Run an install or copy the change from apache-shared-intranet.conf or
    koha-httpd.conf to your apache config. Restart Apache and check
    if http://[your staff client]/search works.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Tested by making manual changes according to the patch. Did not test a
    new installation.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4f2dba105e45446448f250356b5ec1cb74085dfd
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Thu Jul 7 09:13:30 2016 -0600

    Bug 16701: (follow-up) improve some changes
    
    Add missing quote in line 152
    Modify title of the page and breadcrumbs section wrong "searchfield" used
    should be instead "currency.currency"
    
    To test
    -Try to delete the active and used currency, for example, my case
     USD, look that appear USD' with the initial single quote missing in
     message Confirm deletion of currency USD'
    -Notice about the breadcrumbs section appear:
         Confirm deletion of currency ''
     Should appear the currency
    -Try to delete another currency see the pharese look the same
    -Notice about the title in both cases, there is missing the currency name
    -Apply follow-up and re-test
    
    Sing-off on followup
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a83d75b6f2d59c3c2ac8d1b549b364fa79f52efe
Author: Marc Véron <veron@veron.ch>
Date:   Tue Jun 21 09:08:06 2016 +0200

    Bug 16701: Translatability: Fix problem with isolated ' in currency.tt
    
    This patch moves markup <span class="ex"> into template variables to
    avoid sentence splitting.
    
    To test:
    - Apply patch
    - Verify that currency administration works as before
      (Home > Administration > Currencies & Exchange rates > Currencies)
    - Examine code changes
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dc1ff4efff70cabfad5b8e2e69e7a9448cc61e16
Author: Marc Véron <veron@veron.ch>
Date:   Fri Jun 10 10:25:54 2016 +0200

    Bug 16621: Translatability: Issues in opac-user.tt (sentence splitting)
    
    This patch fixes issues due to sentence splitting in
    koha-tmpl/opac-tmpl/bootstrap/en/modules/opac-user.tt
    
    Note: This is a string patch. It does not add or change functionallity.
    
    To test:
    - Examine code and verify that the text changes remove sentence splitting
      and that the changes make sense.
    - Log in to OPAC and verify that messages look correct
      - with blocked /debarred user (with and without comment and date)
      - with user who has to much fines (needs syspref OpacRenewalAllowed
        and syspref OPACFineNoRenewals)
      - with user who has his card marked as lost
      - with user with an account that is about to expire
      - with user with expired account
      - with user with uncertain address information (with and without
        syspref OPACPatronDetails set to Allow)
    
    Note: Amended to make patch apply 2016-07-10 mv
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6c711e6cda36ab339fc52d63ec1fd99d1f39fe99
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jul 11 15:03:37 2016 -0400

    Bug 16900 - Hold suspend button incorrectly styled in patron holds list
    
    This patch updates the style of the suspend/resume button in the list of
    holds displayed on the checkout page and on the patron detail page. The
    button is now a Bootstrap-styled button with a Font Awesome icon.
    
    To test, apply the patch and locate a patron who has holds.
    
    - On the checkout page, view the 'Holds' tab and confirm that there is a
      correctly-styled 'Suspend' button for each hold.
    - Verify that the button works correctly and looks correct when a hold
      has been suspended.
    
    Signed-off-by: Arslan Farooq <arslanone@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fcf2e1325e6cf056b5b7e5e95545adcd322d1b52
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Jul 11 16:31:18 2016 +0200

    Bug 16897 - Re-focus on "Add item" in Lists
    
    Bug 11325 add solved a focus on "Add item" missing in Lists page.
    Since revamping of this page, the add item form exists both in page.
    The one corrected by Bug 11325 is not visible because it checks a bad
    var allowaddingitem instead of can_add_biblios.
    
    This patch removes the first form and corrects the second form.
    It moves the form at left part of page so that it is always shown
    (usefull when there are a lot of items). It does not add the list name
    after "Add item" besause it whould be huggly for long names and because
    listname already exists in breadscrumbs and on top of the table.
    It also adds autocomplete="off" on barcode input because there can be
    problems with a scanning device.
    
    Test instructions:
    1. Create a list
    2. Make sure you have an object with an assigned barcode
    3. Go to the list
       => The barcode entry interface should be at left and has the focus
    4. Enter the barcode and press enter (or use a scanner)
       => The item is added to the list
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    This is a nice improvement, thanks!
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 93aff1fe37f7a9142958f11b45cfbcb62d646f62
Author: Katrin Fischer <Katrin.Fischer.83@web.de>
Date:   Mon Jul 11 22:56:11 2016 +0200

    Bug 16893 - Missing closing tag disrupts patron checkouts page style
    
    Same fix as for the details page: checkouts page is very italic
    when there is a restriction with a comment on the patron
    account.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 27a7cdef1a6187fe7814a75e4fc5cee636ed77fa
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jul 11 08:51:12 2016 -0400

    Bug 16893: Missing closing tag disrupts patron detail page style
    
    A missing closing </i> causes the the patron detail page to be in all
    italics if the patron has a restriction message. This patch corrects it.
    
    To test, apply the patch and locate a patron who has a restriction
    message. The restriction message should be in italics but the rest of
    the page should display normally.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Rest of the page displayed normally
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 24a32e975c964caa99bc9f8ebe31f7bd53cdd13e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 12:25:16 2016 +0100

    Bug 16844: (follow-up of 15656) Remove export of GetMemberRelatives from C4::Members
    
    Bug 15656 removed the C4::Members::GetMemberRelatives subroutine but the
    module still exports it.
    
    Test plan:
      git grep GetMemberRelatives
    should not return any results.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e9b6a5e31e1bc225a6e620dcefbd9545bb6d98bf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 27 13:32:31 2016 +0100

    Bug 16813: Allow empty string for OPACBaseURL
    
    The pref is prefixed by 'http://', but it should not when the pref is
    set to an empty string.
    This will fix the bug raised on bug 14790 comment 14.
    
    Test plan:
    Empty OPACBaseURL and confirm that it's save as it in DB
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    OPACBaseURL is saved up empty. Prefix http:// is not saved anymore
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b51f2baa7c1035657594f90d17c7c9eeedf4ea84
Author: Marc Véron <veron@veron.ch>
Date:   Tue Jul 5 19:23:59 2016 +0200

    Bug 14138: Patroncard: Warn user if PDF creation fails
    
    Change patroncards/create-pdf.pl to redirect with an error message
    instead of writing an invalid pdf that does not open in pdf viewer.
    
    To test:
    - Apply patch
    
    - Test that pdf creator behaves as before (with valid batches and
      patron lists)
    
    - While testing, copy pdf link address from window with title 'Click
      the following link(s) to download...'
    
    - Open another staff client browser tab
    
    - Paste link to browser address field, change batch id rsp. patron
      list id to an invalid value and submit
    
    - The window should redirect to cgi-bin/koha/patroncards/create-pdf.pl
      and display an error message
    
    - Bonus test 1: Create an empty patron list and test patron card
      creation. You should get an error message as appropriate.
    
    - Bonus test 2: Use a link with params like the following:
      ...create-pdf.pl?borrower_number=61&template_id=2&layout_id=1&start_card=1
      Verify that you can create a pdf with a valid borrower_number and that
      you get the error message with an invalid borrower number
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 06fa67d75a10adcc5ac8cbefad498f0e0d254b03
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jul 9 15:56:32 2016 +0100

    Bug 16890: Make TestBuilder generate date for date columns (and not datetime)
    
    TestBuilder should not generate datetime for date columns, but only for
    datetime and timestamp columns.
    
    Test plan:
    Make sure the change in t/db_dependent/TestBuilder.t are consistent.
    Before this patch, 1 of the 2 tests should fail.
    After this patch applied, they both should pass.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 58138e93d709b953f00cc126318d2cc4a9e102f4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 4 13:22:18 2016 +0100

    Bug 16845: Remove unused C4::Members::ModPrivacy
    
    This subroutine is no longer in used and can be removed safely
    
    Test plan:
      git grep ModPrivacy
    should not return any occurrences.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a353fe5d988d64f52d0a530b1d507f8f8eab2a5a
Author: Marc Véron <veron@veron.ch>
Date:   Mon Jul 4 14:30:24 2016 +0200

    Bug 16810: Fines note not showing on checkout
    
    Fines did not show on patron checkout and detail pages unless amout
    was greater than syspref NoIssueCharges.
    
    This patch fixes the logic in
    koha-tmpl/intranet-tmpl/prog/en/includes/blocked-fines.inc
    
    Additionally, it changes links to buttons and makes some small
    text changes to ease translation.
    
    To test:
    - Apply patch
    - Display checkout or detail page and verify proper display for
       a patron who has
       - no fines (no message)
       - fines not exceeding syspref NoissueCharges (message)
       - fines exceeding syspref NoIssueCharges (message)
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5a1f3acaabf235733a3e7a98d16d0395df1980b8
Author: Marc Véron <veron@veron.ch>
Date:   Wed Jul 6 00:27:30 2016 +0200

    Bug 16682: (followup) Fix display if Batch patron modification tool does not get any patrons
    
    Format message as proposed in comment #8
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c0d420f42a293e68228bbe7fa95545a08fd2c964
Author: Marc Véron <veron@veron.ch>
Date:   Tue Jul 5 02:10:55 2016 +0200

    Bug 16682: Fix display if Batch patron modification tool does not get any patrons
    
    To reproduce:
    - Go to Tools->Batch patron modification
    - Submit without filling any of  "Use a file", "Or use a patron list",
      "Or list card numbers..." or use a patron lists with zero members
    Result: Screen without any information
    
    To test:
    - Apply patch
    - Repeat steps above
    - Verify that you get a nice message
    - Verify that the tool works as before
      - with invalid card numbers only
      - with valid and invalid card numbers
      - with valid card numbers only
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e465d1aa4b16d7392950b2b682f99eb0c58c1ffd
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jul 13 11:59:28 2016 +0200

    Bug 15006: [QA Follow-up] Only handle login requests in raw_transport
    
    Although mainly hypothetical, it would still be possible to get
    response from the server for an acs resend request. (This exception
    is allowed in MsgType::handle.)
    I also noticed that the response may well be a message from an older
    session still.
    This patch just removes that exception by only passing login requests
    to sub handle in the raw_transport loop.
    
    Test plan:
    [1] Verify normal login procedure for raw.
    [2] Check a few acs resend requests in raw. They should terminate without
        a response.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 64fe6e350074db48cf337dcf1794b40a58d7e606
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jul 12 15:48:34 2016 +0200

    Bug 15006: [QA Follow-up] Satisfy qa tools with one tab less
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4ad4ab6396af26bed9dceb442adf4aad6687f362
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Wed Jul 6 15:25:21 2016 +0100

    Bug 15006 Correct indentation of EXPORTs in Sip.pm
    
    Removed tabs and used spaces consistently
    Used 'use base' to remove unnecessary BEGIN sub and
    explicit setting of ISA at application level
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eb8666357ce72e910569843f8acce674a332f4b0
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jul 6 15:14:45 2016 +0100

    Bug 15006: Centralize timeout logic and allow zero client timeout
    
    Moving timeout logic to one routine (with unit test).
    
    This further implements two suggestions from Kyle and Larry:
    
    [1] You could use a client_timeout of 0 to specify no timeout at all.
    [2] Have the client_timeout default to the timeout if not defined.
    
    Test plan:
    [1] Run t/db_dependent/SIP/SIPServer.t.
    [2] Test login timeout for raw and telnet.
    [3] Check ACS status message for timeout value. Should match policy
        timeout from institution.
    [4] Test client timeout (zero and non-zero).
    [5] Remove client timeout. Test fallback to service.
    [6] Remove service timeout too. Test fallback to 30 at login.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Amended to incorporate Srdjan's suggestion to move get_timeout to
    SIPServer.pm; this requires some additional mocking in the unit test.
    And even makes the test db dependent, as documented.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b27da7e0ce25c806612743100609255ace48257c
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Fri Nov 20 12:12:48 2015 +0000

    Bug 15006: Introduce client_timeout in SIPconfig.xml
    
    Most selfchecks have persistent connections and send a
    periodic status request at intervals (approx every 5mins appears
    the norm) The timeout was dropping connections by default every 30secs
    which for the client appears as a very flakey network.
    
    This patch adds a separate parameter client_timeout that can be
    used if you do want to force a disconnect if the client sends
    no requests for a period. The sample config sets it to 600, but you
    can also define a 0 value meaning no timeout. If the parameter is not
    defined, it will fallback to service timeout.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Restored this patch from Colin in order to separate it from the
    get_timeout patch. Adjusted the commit message slightly.
    The original value of 600 from Colin's earlier patch may give less
    discussion than setting to 0 (no timeout) in a later proposal.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2b725b6728ea4156562aa6225b2323861f616885
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Tue Jul 5 10:36:31 2016 +0100

    Bug 15006 Remove tabs from sip_protocol_loop
    
    Remove the tabs causing inconsistent indentation
    of sip_protocol_loop and replace with spaces
    
    Reimplements the renaining parts of Marcel de Rooy's
    original QA patch
    
    No logic changes in this patch - layout only
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4f0fd3db556652f961710c64b9806512a491a7d3
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Mon Jul 4 16:13:16 2016 +0100

    Bug 15006 Drop raw connection if login fails
    
    raw_connection was not behaving correctly if an invalid string was
    passed or a login failed.
    It was not checking that the login succeeded ( it checked that account
    existed not that it contained data and it existed even if login failed)
    and so failed logins instead of aborting immediately fell through into
    the sip_protocol_loop, forcing that to timeout invalid connections.
    It now checks that account has id set and returns if not.
    
    The timeout alarm is now set on the while loop, in normal running this
    should not be triggered as the socket is opened and the first data
    should be a login message and the while loop should only iterate once,
    but lets not go into an infinite loop due to unforeseen circumstances.
    
    I have reindented the routine as the flow was not clear (the while was
    not indented at all.
    
    Also if using Net::Server::PreFork when a new connection comes in you
    may be handed the the successful login parameters from a preceding call.
    Because of this you could successfully transmit transactions and Koha
    would carry them out without having received a valid login ( and
    possibly with the wrong account details!) We now delete any existing
    account for new connections.
    
    NB: This patch requires that the patch for bug 13807 has been applied
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e75d9befca13c2f74706e5eb7874a27bdc1928f1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 21 12:31:40 2016 +0100

    Bug 12178: Fix tests not to depend on dateformat syspref
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c765d105096ac8c0bc5afd51eb212db54c7901e0
Author: Florent Mara <florent.mara@gmail.com>
Date:   Tue May 24 14:10:32 2016 +1200

    Bug 12178: Tests for changes to claimed serial status
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Amended patch: Remove trailing spaces
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b416ac16b5c67d902444041882c31a99e0525fa0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 17:00:44 2015 +0200

    Bug 12178: Update serial status to "claimed" when exporting to CSV
    
    On the same way as late issues, the serial status should be updated to
    'claimed' when the issues as exported as csv.
    
    QA note: The updateClaim and UpdateClaimdateIssues subroutine did almost the
    same thing, I kick the second on off to centralize the code.
    
    Test plan:
    1/ Export some late issues as CSV (serials/claims.pl).
    2/ Refresh the page (the export does not do it) and confirm that the
    status, the claim date and the claim count have been updated.
    3/ Select some others issues, select a notice and send the notification.
    Confirm that the behavior is the same.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 199c00c7ba4edb78bcf0d022cfedc4e891316071
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jun 9 16:42:27 2016 +0100

    Bug 2735: CSS changes
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit de2df0dfe85bc8ac33375ad5b436ac247c3875d6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jun 9 16:39:56 2016 +0100

    Bug 2735: Fix authority search pagination at the OPAC
    
    The authority search pagination displays only 15 pages, even when there
    are more.
    To fix that, this patch mimic the authorities-home.pl intranet script to
    manage the pagination.
    
    Test plan:
    Without this patch, do some authority search and click on different
    pages.
    Apply this patch, redo the same search and make sure the same records
    are displayed (i.e. confirm that the pagination still works as before).
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bfac6c29e4d3ea16919bb1f7319f50b23e8faad2
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jul 13 22:46:17 2016 -0400

    Bug 16920: sysprefs.sql - missing comma for MaxOpenSuggestions
    
    TEST PLAN
    ---------
    1) back up DB
    2) drop database koha_library;
    3) create database koha_library;
    4) run web browser install, choose ALL defaults
       -- notice the SQL syntax warning.
    5) apply patch
    6) repeat steps 2-4
       -- notice SQL syntax warning is gone.
    7) run koha qa test tools
    8) restore db
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f8eb5e7f0e4afea791d17692561fb10162aee78c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jul 13 15:41:30 2016 +0000

    Bug 16917 - Error when importing patrons, Column 'checkprevcheckout' cannot be null
    
    Error:
    DBIx::Class::Storage::DBI::_dbh_execute(): Column 'checkprevcheckout'
    cannot be null at C4/Members.pm line 697
    
    Test Plan:
    1) Attempt to import a patron via csv
    2) Note the error
    3) Apply this patch
    4) Repeat the import
    5) No error!
    
    NOTE: Given that all the other tests ran (comment #2), except
          those in comment #3, I resorted to following the test plan
          above using the attachment provided in comment #5. I
          believe the issues in comment #3 constitute other bugs
          which need fixing and are unrelated this bug. Applying the
          patch does resolve the error triggered, and the code is
          good.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62f4e6bed2b74f1bc66a8aa0a32ba80263ae30f8
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Tue Apr 26 09:04:17 2016 +0200

    Bug 16166: Fix t/Cache.t tests
    
    Thou shalt not forget to include changes made in the t/Cache.t
    in the patch set.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit 2b39cc7fffbc0376190bf4b53fd70085dc5df03f
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Tue Apr 26 08:43:12 2016 +0200

    Bug 16166: Improve L1 cache performance and safety
    
    Bug 16044 introduced two-level caching mechanism to Koha::Cache. By
    default, get_from_cache() returns a deep copy of the data structures
    stored in L1 cache (aka "safe mode"). For extremely big and/or complex
    data structures (like MARC framework hash-of-hashes-of-hashes returned
    by GetMarcStructure() ), deep-cloning is currently sub-optimal;
    this patch addresses that particular issue. It also provides an
    ability to intermix "safe" and "unsafe" cache feches, in such
    way that they don't interfere with each other (i.e., eliminating
    the risk involved with "unsafe" calls possibly compromising
    further "safe" calls).
    
    Test plan:
    
    1) apply patch
    2) flush L2 cache if necessary (restart memcached daemon)
    3) profile GetMarcStructure() calls before / after patch, e.g. by
    running some script which calls it often (like catalogue search
    w/ XSLT processing turned on, etc.) - GetMarcStructure() should be
    faster than before, in all possible circumstances (eg. 18 msec
    per call -> 10 msec p/call)
    4) after testing, before returning to the master branch, flush L2 cache
    again (restart memcached daemon) - otherwise all system preferences
    returned from L2 cache would be suffixed with '-CF0'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit fa70b5b4c705aa671e1ec57a3509f6372917f808
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 25 17:04:14 2016 +0000

    Bug 13691: Add changes for 3.22
    
    To test:
    Run the tests
    t/db_dependent/selenium/basic_workflow.t
    
    After you have set up selenium following the tests in the previous patch
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 4e415da44c546ba1aae21b40b8c7fb0054a7e0d2
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Tue Feb 10 16:07:31 2015 +0100

    Bug 13691: Add basic selenium script
    
    This script has been used to compare 3.16.x and 3.18.x performances on
    bug 13690.
    
    What it does:
    - Go on the mainpage and process a log in
    - Create a patron category
    - Create a patron
    - Add 3 items
    - check the 3 items out to the patron
    - check the 3 items in
    
    How to use it?
    
    $ wget https://selenium-release.storage.googleapis.com/2.53/selenium-server-standalone-2.53.0.jar
    
    $ vim /etc/apt/sources.list.d/firefox.list
      deb http://packages.linuxmint.com debian import
    $ apt-get update
    $ apt-get install firefox
    $ sudo apt-get install xvfb
    
    $ SELENIUM_PATH=/home/koha/tools/selenium-server-standalone-2.53.0.jar
    $ Xvfb :1 -screen 0 1024x768x24 2>&1 >/dev/null &
    $ DISPLAY=:1 java -jar $SELENIUM_PATH
    
    perl t/db_dependent/selenium/basic_workflow.t
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Note the pages have changed so the tests will not all pass.
    Also you need Selenium::Remote::Driver installed and staffClientBaseURL
    must be set
    
    I will change the tests in a follow up patch.
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 73ace7513b18c9b8b2d5b594614d5c251d06d1f2
Author: Jonathan Druart <jonathan.druart@biblibre.com>
Date:   Tue Feb 10 16:07:16 2015 +0100

    Bug 13691: Remove existing selenium scripts
    
    They are not usable.
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 94441be435d9be074fc0f93bbec2c2e9122a5d67
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Fri Mar 6 11:57:09 2015 +0000

    Bug 13807 Rework main input loop in SIPServer
    
    Debugging various problems in SIPServer and control of it, found it
    could loop on unread buffers (e.g. the LF of a CRLF if it was only
    expecting CR) making it unresponsive to signals.
    Reworked the input loop with an eye to removing unnecessary whiles
    and replacing the while(1) by a while( connection valid)
    Enhanced the timeout code by wapping in an eval.
    Moved the logic from SIP_read_packet into the server itself
    Hopefully this makes the already baroque code easier to navigate
    and it did seem the server was the logical place for this
    Removed no longer iused SIP_read_packet from Sip.pm
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 042e8cf24bf3de4192b4c7cf0ca4e5f1da6c3ce9
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jul 6 15:19:46 2016 -0400

    Bug 16866: Catch warning t/db_dependent/Languages.t
    
    TEST PLAN
    ---------
    1) prove t/db_dependent/Languages.t
       -- noisy output
    2) apply patch
    3) prove t/db_dependent/Languages.t
       -- no noise
    4) run koha qa test tools.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    No noisy output
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1aa9f7b92fa831c943f7bccf470dbed72eba3c17
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jul 3 15:58:16 2016 +0100

    Bug 16819: Remove use of map
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b7f15db41ae83654387a2191fa72bde60450b0b0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 28 10:18:48 2016 -0300

    Bug 16819: C4::Members::DelMember should use Koha::Holds to delete holds
    
    This patch makes C4::Members::DelMember proprely use Koha::Holds to delete
    holds. This is important as holds actions are started to be logged.
    
    To reproduce:
    - Apply the patch
    - Run:
      $ prove t/db_dependent/Members.t
    => SUCCESS: Tests pass
    - Sign off :-D
    
    Sponsored-by: NEKLS
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    All tests pass successfully
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 13bf3686c5d0fd3a3a192db961118535ece41a4c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 28 10:57:38 2016 -0300

    Bug 16819: Unit tests for C4::Members::DelMember
    
    The C4::Members::DelMember function actually deletes reserves, and it is
    not properly tested.
    
    To test:
    - Apply the patch
    - Run:
      $ prove  t/db_dependent/Members.t
    => SUCCESS: Tests pass
    - Sign off
    
    Sponsored-by: NEKLS
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dee29d9f0b2b43bc762cb82a2212cd8a3d243f45
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Jun 23 14:51:26 2016 -0400

    Bug 16805: Log in with database admin user breaks OPAC
    
    TEST PLAN
    ---------
    1) Apply Jonathan's test patch
    2) prove t/db_dependent/Letters.t
       -- dies before finishing tests
    3) Apply second test patch
    4) prove t/db_dependent/Letters.t
       -- dies before finishing tests
       -- 'addalert' is changed to 'getalert'
    5) Log into OPAC with database admin user.
       -- see error given in comment #0
    6) Apply this patch
    7) prove t/db_dependent/Letters.t
       -- says 'getalert'
       -- all tests pass.
    8) Log into OPAC with database admin user.
       -- logs in, but gives warning with a nice logout button.
    9) run koha qa test tools.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    No kaha qa errors
    In debian display diferent error:
    Can't use an undefined value as an ARRAY reference at /usr/lib/perl5/DBI.pm line 2054.
    Works as advertised
    
    NOTE: Revised test plan, as Jonathan added useful test case.
          Works as I've tested above.
          Hector tested older test plan which was steps
          5,6,8 and 9.
    
          Revised test plan again while tweaking to address comment #9.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c57655d4ad69f82831b7f1b54b31a69d0d8275ee
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Jun 24 12:28:27 2016 -0400

    Bug 16805: Tweak new test message to say getalert
    
    It said 'addalert', which is likely a cut-paste typo.
    Plus, let's keep running the other tests if that one
    goes bad.
    
    TEST PLAN
    ---------
    1) Apply Jonathan's test patch
    2) prove t/db_dependent/Letters.t
       -- dies before finishing tests
    3) Apply this test patch
    4) prove t/db_dependent/Letters.t
       -- still dies before finished tests,
          'addalert' now is 'getalert' in message.
    5) run koha qa test tools.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5821ff3867c5291558238e54686c6834caa266c6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jun 24 17:02:59 2016 +0100

    Bug 16805: Add test to getalert (no param passed)
    
    TEST PLAN
    ---------
    1) apply patch
    2) prove t/db_dependent/Letters.t
       -- fails
    3) run koha qa test tools
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c9bb9dc14064ddecf767145b7a2bb26794ca090e
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Wed Jun 22 11:11:03 2016 -0600

    Bug 16801 - Include Font Awesome Icons to check/unchek all in Administration > Library transfer limits
    
    For purpose to uniformity and leave just one entry in .po files,
    this patch change: Check all/Uncheck all -> to -> Select all/Clear all.
    Also added Font Awesome icons.
    
    To test:
    -Go to Administration > Library transfer limits
    -Notice about Check all/Uncheck all for "For all items types" and
     "Policy for:"
    -Apply patch and refresh the screen
    -Notice about the new Select all/Clear all links with their icons
    -Confirm that all links work as expected
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0716da922eb867603a500f6c6b67b1d00652d964
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jun 1 10:54:09 2016 -0400

    Bug 16778: Replace usage of Greybox modals with Bootstrap modals
    
    This patch is a proof-of-concept for replacing Greybox modals in
    situations where in-modal page transitions happen. This one addresses
    patron card export from the patron lists page.
    
    To test you must have at least one patron lists containing patrons.
    
    - Apply the patch and go to Patrons -> Patron lists.
    - In the 'Actions' menu associated with your list, choose 'Print patron
      cards.' A modal window should be triggered.
    - In the modal window, change settings as necessary and click the
      "Export" button.
    - The modal should reload and display a link to download a PDF. Confirm
      that the PDF download works correctly and that the correct patron
      batch was processed.
    - Repeat the process and confirm at each step that clicking the 'X'
      button or the 'Cancel' link dismisses the modal window.
    
    To confirm that changes to the patron card print template has not
    adversely affected printing patron cards from the patron card creator
    page:
    
    - Go to Tools -> Patron card creator.
    - Choose Manage -> Card batches.
    - Click 'Export' for any batch.
    - Confirm that the Greybox modal still works correctly for patron card
      export.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f542ce5a82a40b503b10c709b8b960ace2637f7d
Author: Marc Véron <veron@veron.ch>
Date:   Tue Jun 14 08:41:03 2016 +0200

    Bug 16730 - Use member-display-address-style*-includes in moremember-brief.tt
    
    To test:
    - Apply patch
    - Create a new patron with the same first and last name as an existing
      patron. This should trigger a duplicate warning message. Click the
      "View existing record" link to trigger a pop-up window with a patron
      detail brief view.
    - Verify that the address information displays the same way as on the
      patron details screen (moremember.pl).
    - Change syspref 'AddressFormat' and verify that the address displays
      as appropriate.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
      Works as described: AddressFormat is taken into account on 'view exiting
      record' dialog box.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b9e47f135e036232b00cd3b24bb25ea0c6a9291e
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Jun 7 09:27:15 2016 +0200

    Bug 16677 - Use abbr for authorities linked headings
    
    In authorities search results, UNIMARC flavour, linked headings are displayed
    with a link type : BT, NT, UF, RT.
    
    This patch adds a abbr tag around those acronyms to know there meaning :
    BT = Broader Term
    NT = Narrower Term
    UF = Used For
    RT = Related Term
    
    Acronyms are used because there can be a lot of linked headings, using abbr
    will display the complete text on mouse over.
    
    Test plan :
    
    - Use UNIMARC database
    - Create an authority with :
    250 $a Heading250a
    450 $a Heading450a
    550 $5 a $a Heading550a
    550 $5 g $a Heading550g
    550 $5 h $a Heading550h
    - Save an index zebraqueue
    - Go to intranet authorities search
    - Search for "Heading250a"
    - You see :
    Heading250a
    Heading250a
    UF: Heading450a
    RT: Heading550a ; BT: Heading550g ; NT: Heading550h
    - Move your mouse over the acronyms, you see a tip with the complete text
    - Same with opac authorities search
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
      Works as described. Translatable.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e29de9967b40bbdb959f8c0123db8974fff68cdc
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon May 23 11:03:48 2016 -0400

    Bug 16566 [Revised] 'Print slip' button formatting inconsistent
    
    This patch modifies the style of some "print slip" links on the checkin
    page to make them consistent with other buttons shown in dialogs.
    
    This patch also removes the use of "onclick" in some places in favor of
    defining events in the JavaScript.
    
    To test apply the patch and go to Circulation -> Check in.
    
    - Check in an item which belongs at another branch. You should see a
      dialog which asks the user to transfer the item. Confirm that the
      "Print slip" button looks correct and works correctly.
    
    - Check in the same item again. You should see a different dialog which
      has both a "Print transfer slip" and "Cancel transfer" button. The
      "Print transfer slip" button should look correct and work correctly.
    
    - Check in an item which is part of a rotating collection. (Or, if Bug
      16570 is still open, check in any item) You should see a dialog which
      notifies you that the item is part of a rotating collection. The
      "Print slip" button in this dialog should look correct and work
      correctly.
    
    Followed test plan. Buttons appear as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Revision following QA: Removed redundant class attribute from the print
    button tested in step 1.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 90b3241fb8d92a1217a001606b4f2bd23f3b0176
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Apr 21 22:49:29 2016 +0000

    Bug 16324: Move item search into header
    
    This patch makes the Search button in the header into a dropdown that holds the Advanced search and the Item search.
    I have rewritten this patch to be independent of Bug 16323 since that patch is so controversial.
    
    To test:
    1) Confirm that Advanced search and Item search are both under the 'Search' dropdown menu in the header and both links work as expected
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Note that the CAN_user_catalogue test is useless. If a librarian does
    not have it, (s)he cannot access to the staff interface.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 975be0aef051d1131c39a02cbf7b6efe2f67d113
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Apr 15 10:49:29 2016 +0200

    Bug 16271: Allow more filters on /api/v1/holds
    
    borrowernumber parameter is no longer required and you can filter on
    every column of reserves table
    
    Some example requests
    - GET /api/v1/holds
    - GET /api/v1/holds?biblionumber=123
    - GET /api/v1/holds?borrowernumber=456
    - GET /api/v1/holds?priority=0&found=W
    
    Signed-off-by: Benjamin Rokseth <benjamin.rokseth@kul.oslo.kommune.no>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 74ce643b89f3c49f163b9a553c74f45104c6130b
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Wed Dec 2 10:56:25 2015 -0600

    Bug 15172: (follow-up)Serial enumchron/sequence not visible when returning/checking in Items
    
    Display br and span tag only if the value enumchron exists.
    
    To test
    -Apply patches
    -Follow the previous test plan
    -Checkin whichever material (e.g., book) without sequence or enumchrom
    -Open up source code for checkin page, search under title and
    verify that b and span tags do not appear
    
    Signed-off-by: Alain et Aurélie <aurelie.berut@enssib.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1d6c235addcb290fcee091c3e2273b089631ad86
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Wed Nov 11 13:23:15 2015 +0200

    Bug 15172: Serial enumchron/sequence not visible when returning/checking in Items
    
    Displays the items.enumchron-column in returns.pl when checking in Items.
    
    Rewording commit
    
    To test:
    -Checkout a barcode for serial with items generated in
    Serials >  New subscription or item in DB with items.enumchron-column
    -Checkin the same barcode, the table Checked-in items will appear without
    information about "Publications details (Vol. 400, No. 32)"
    -Apply patch
    -Checkout and checkin another item of the same serial title
    -Notice about the Vol. 400, No. 32 below the serial title.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    items.enumchron-column display successful in returns.pl (Home>Circulation>
    Check in)
    NOTE: Patch rebased on master
    
    Signed-off-by: Alain et Aurélie <aurelie.berut@enssib.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d951ba620cafc132ea8a9f083c1f997f64148629
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jul 8 14:11:42 2016 +0000

    Bug 15128 - DBRev 15128
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1b89150d42548304d37fdb1def5ffd727d719f69
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 1 17:00:39 2016 +0100

    Bug 15128: Do not display "New suggestion" if limit has just been reached
    
    If limit is X and patrons has X-1 pending suggestions, when a new one is
    added, the "New suggestion" should not been added.
    to avoid another call to SearchSuggestions, we assume than the
    suggestion has been correctly added.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2c2efbf4a66fb3f8c0d1212d960d5d202518bc7b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 1 16:55:39 2016 +0100

    Bug 15128: Revert Display all purchase suggestions whether or not suggestion was added
    
    This does not work correctly and should be handle on another bug report.
    The behavior existed prior to this patchset.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7cde3e216bc4ca120ed1cfe983b690a4f3f6944c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jul 1 11:39:00 2016 -0400

    Bug 15128 - (QA Followup) Don't get patrons suggestions if limit not set
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 074a3ee3383b6038f29f8859cf6c96accc6fa072
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jul 1 11:36:02 2016 -0400

    Bug 15128 - (QA Followup) Fix use of 'my' variable causing loss of data
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b6a774028adb8c64dcf904e7fc76290fb82c569b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jun 30 10:20:39 2016 -0400

    Bug 15128 (QA Followup) Display all purchase suggestions whether or not suggestion was added Correct enforcement of 0 limit
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9ebeb9acb3f186969bccba95a88f72665e8769d7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jun 20 16:04:21 2016 -0400

    Bug 15128 - Followup
    
    Only check limit for signed in borrower
    Show all suggestions after a new one is added
    
    Signed-off-by: Barbara Walters <bwalters@ncrl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1bfe7c7512ca7979afc27dca520fba062543e34c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jun 20 19:25:12 2016 +0000

    Bug 15128 [QA Followup 2] - Only count pending suggestions for the limit
    
    Signed-off-by: Barbara Walters <bwalters@ncrl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5aa3313239840e43495e9355adf76feef8db737f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jun 20 16:44:38 2016 +0000

    Bug 15128 [QA Followup] - Make suggestion display after being added
    
    Also fixes the issue that the add suggestion link would sometimes
    show even if the patron could not make an additional suggestion.
    
    Signed-off-by: Barbara Walters <bwalters@ncrl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7445b8f897718306340aeac6cc4427b05f0eeaf1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jun 14 16:47:43 2016 -0400

    Bug 15128 - Add ability to limit patrons open purchase suggestions
    
    To test:
    1 - Define a number of MaxOpenSuggestions
    2 - Add some suggestions for a patron
    3 - Note they cannot add any more suggestions if limit is reached
    4 - Delete a suggestion and note you can add another
    5 - Add them to limit again
    6 - Accept a suggestion in the staff client and note user can add more
    7 - Repeat above with rejecting or deleting
    8 - Sign off.
    
    Sponsored by:
        North Central Regional Library (http://ncrl.org/)
    
    Signed-off-by: Barbara Walters <bwalters@ncrl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f65cf574d0ad0aa1264dd78bdb7b5baeb09e5e95
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jul 8 14:01:41 2016 +0000

    Bug 14902 - Fix issues with updatedatabase.pl
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 80921b10f547ceb7491178b9e9233867e43e2429
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jul 8 13:59:37 2016 +0000

    Bug 14902 - DBRev 16.06.00.009
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 99acd38edb0ab7efea33aa206ec62bd04a8f1570
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 3 12:52:01 2016 -0400

    Bug 14902 - Add qualifier menu to staff side "Search the Catalog"
    
    To test:
    1 - Apply patch and update dabase
    2 - Check that Search the Catalog links throughout the staff interface
    have not changed
    3 - Set "IntranetCatalogSearchPulldown" to 'Show'
    4 - Verify that 'Search the catalog' links through staff client now have
    a dropdwon to  select search index
    
    I think viewing one file each that includes updated header should be
    sufficient, but please check as many as you can:
    
    cgi-bin/koha/admin/aqbudgetperiods.pl
    cgi-bin/koha/admin/admin-home.pl
    cgi-bin/koha/cataloguing/addbooks.pl
    cgi-bin/koha/circ/returns.pl
    cgi-bin/koha/circ/circulation-home.pl
    cgi-bin/koha/admin/cities.pl
    cgi-bin/koha/admin/aqcontract.pl
    cgi-bin/koha/admin/currency.pl
    cgi-bin/koha/mainpage.pl
    cgi-bin/koha/tools/letter.pl
    cgi-bin/koha/members/members-home.pl
    cgi-bin/koha/admin/categories.pl
    cgi-bin/koha/admin/preferences.pl
    cgi-bin/koha/admin/printers.pl
    cgi-bin/koha/serials/serials-home.pl
    cgi-bin/koha/acqui/newordersuggestion.pl
    cgi-bin/koha/admin/z3950servers.pl
    
    Sponsored by:
      Northeast Kansas Library System (http://nekls.org/)
    
    Signed-off-by: Heather Braum <hbraum@nekls.org>
    
    Signed-off-by: Barton Chittenden <barton@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e68f620188b792a4ed5bfe13e0fce7f22f6a81d5
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 23 14:45:34 2016 +0000

    Bug 14790 [QA Followup] - Don't show links unless OPACBaseURL is set
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 600786e7f1d0577a50f154ffead7b89f3505c977
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jun 15 14:30:18 2016 +0000

    Bug 14790 - Add OPAC view link to Serials detail
    
    Test Plan:
    1) Apply this patch
    2) Browse to subscription-detail.pl for a given serial
    3) Note the new "OPAC view" link
    4) Click the link, a new tab should open up showing the record
       details for that record in the OPAC
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1fcdef312be42c673d4ae017e3abe7722aba6048
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jun 15 13:55:28 2016 +0000

    Bug 14790 - Add OPAC view link to items editor
    
    Test Plan:
    1) Apply this patch
    2) Find a record and open the items editor for it
    3) Click the "Actions" button for an item
    4) Choose the option "OPAC view"
    5) A new browser tab should open to the OPAC details page for the record
       whose items you are editing.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2cc6e67204cfc8c4864e7a4ad938b3859ae57fbe
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jun 15 12:27:40 2016 +0000

    Bug 14790 - Add Opac view link to search results
    
    Test Plan:
    1) Apply this patch
    2) Perform a staff catalog search
    3) Note the new "OPAC view" link
    4) Click the link, it should open a new tab to the OPAC details for that
       record.
    
    This works fine except that it doesn't open in a new tab. I don't think
    it's the fault of the patch, but of browser.js messing with links again
    (See Bug 11937).
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0527388924b20bb63f38a2a4eccf9cf794faaac7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 28 14:37:57 2016 +0100

    Bug 14757: Remove obsolete occurrence of is_tt
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 32b1d0386acac268fb65d81a66ffe1561f830c2d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jun 27 13:43:59 2016 +0000

    Bug 14757 [QA Followup] - Don't overload new for Modifications
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e82e4bfc073be6c419fe79f3653bb01c72bd2135
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jun 24 15:28:43 2016 +0100

    Bug 14757: Add tests for new modules
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fd622dc73d5b0d37aa588fbcaa0e5ed6e84610f0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jan 22 12:43:12 2016 +0000

    Bug 14757 [QA Followup] - Add Unit Tests
    
    Signed-off-by: Sean McGarvey <seanm@pascolibraries.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7276a38c2b67b7ef48b85f544527648b358efa6d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Dec 2 13:32:44 2015 +0000

    Bug 14757 - Allow the use of Template Toolkit syntax for slips and notices
    
    This bug is the beginning of a conversion from our current bespoke
    syntax for slips and notices to Template Toolkit syntax.
    
    This patch is the initial seed which will evolve over time.
    With this addition, we can take advantage of our Koha Objects
    to greatly simplify the processing of Slips and Notices over time.
    
    Test Plan:
    1) Apply this patch
    2) Ensure you have the default CHECKOUT notice
    3) Check out and return an item for a patron
    4) Note the text of the CHECKOUT notice
    5) Replace your CHECKOUT notice with the following:
    
    The following items have been checked out:
    ----
    [% biblio.title %]
    ----
    Thank you for visiting [% branch.branchname %].
    
    6) Repeat step 3
    7) Note the CHECKOUT notice text matches the previous CHECKOUT notice text
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    New notice syntax works, no koha-qa errors
    
    Signed-off-by: Sean McGarvey <seanm@pascolibraries.org>
    
    Bug 14757 [QA Followup] - Change method type() to _type() for Koha objects
    
    Signed-off-by: Sean McGarvey <seanm@pascolibraries.org>
    
    Bug 14757 [QA Followup] - Change all references to Koha::Borrower to Koha::Patron
    
    Signed-off-by: Sean McGarvey <seanm@pascolibraries.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9e1542eb84a0c8b02eae6ca3ff3616d0a5d412da
Author: Marc Véron <veron@veron.ch>
Date:   Mon Jun 20 14:59:11 2016 +0200

    Bug 10760: (followup) Move street type after address
    
    As of comment #7
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 03795b65d59d1e0bed9e6860e0309643b3bb13a6
Author: Marc Véron <veron@veron.ch>
Date:   Tue Jun 14 10:57:52 2016 +0200

    Bug 10760: Alternate Address: Display street number and street type
    
    This patch displays alternate streetnumber and street type on patron's
    detail page.
    
    To test:
    - Apply patch
    - Verify that the alternate address information displays follwing the
      setting in syspref AddressFormat and contains street type and
      street number (as appropriate)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3e576f65b2dff4616d8b57d8f31dea1a3a402ffc
Author: Marc Véron <veron@veron.ch>
Date:   Tue Jun 14 10:14:29 2016 +0200

    Bug 10760: Alternate Address: Make street number and street type editable
    
    Table 'borrowers' contain columns B_streetnumber and B_streettype.
    This patch makes them editable for alternate address.
    
    To test:
    - Apply patch
    - Edit a patron's details
    - Verify that in edit mode for Alternate address, the fields 'street type' and 'street number' appear
      and follow the settings in sysprefs AddressFormat, BorrowerMandatoryField, BorrowerUnwantedField
    - Verify that the values are saved correctly.
    
    Note: A second patch will follow to manage the display of street number and street type
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit df57c8e864aefe0e90b49aa15fc95b6dcaafda7b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jul 6 16:57:05 2016 +0100

    Bug 9259: Use is instead of is_deeply
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 08e448ee4bfbd7a85dfbfd6d0d77f8d59dd93b8e
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Mar 29 00:04:36 2016 +0000

    Bug 9259: Ability to delete a staged file once it has been cleaned
    
    To test:
    1) Go to Tools -> Staged MARC Management and clean a file. If you have no files to clean, go to 'Stage MARC for import' and upload one to clean following the necessary steps.
    2) Confirm that once the file has been cleaned, the Action column now shows a Delete button. Confirm this button only shows for cleaned files.
    3) Click the Delete button.
    4) Confirm that clicking Cancel exits the pop-up message and does not delete the file.
    5) Confirm that clicking OK refreshes the list of staged records and the one you just deleted is no longer on it (has been deleted). You can confirm this by checking for the file in mysql (SELECT * FROM import_batches WHERE import_batch_id = X;)
    6) Run prove -v t/db_dependent/ImportBatch.t (have written unit tests for CleanBatch and DeleteBatch)
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    Catalyst sign off, so needs another one but YAY this is great.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 46b7d5e4c66d5eff732187dd25c5d3bc79305c8b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jul 8 13:36:32 2016 +0000

    Bug 6906 - DBRev 16.06.00.008
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ffc4adcfb94d0932c159e1cb8af0a7903a1f728c
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Mon Jul 4 19:22:51 2016 +0200

    Bug 6906: Follow coding guidelines in terminology.
    
    * Koha/Patron.pm (wantsCheckPrevCheckout, doCheckPrevCheckout): Rename
      to...
      (wants_check_for_previous_checkout, do_check_for_previous_checkout):
      ...this.
    * C4/Circulation.pm: Use new names.
    * t/db_dependent/Patron/CheckPrevCheckout.t: Renamed to...
    * t/db_dependent/Patron/Borrower_PrevCheckout.t: ...this.
    
    Bug 6906: Fix POD reference to old method name.
    
    * Koha/Patron.pm (wants_check_for_previous_checkout): Fix POD.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit da8123326ef82e35c3369b700c62f6747618eced
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jun 12 11:42:48 2016 +0100

    Bug 6906: Add the warning message to the batch checkout
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 58501eb4d451ca73fc2cab50db4077cdb63ef625
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jun 12 11:41:41 2016 +0100

    Bug 6906: Tests - Do not assume CPL exists
    
    Since bug 14878, tests must create the data they need to pass and not
    assume they exist.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6a493842cf85e025aa215391b4ef4166e4491546
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Fri Mar 11 15:00:01 2016 +0100

    Bug 6906 - show 'Borrower has previously issued...
    
    New feature: provide granular means to configure warnings about items
    that have been issued to a particular borrower before, according to
    their checkout history.
    
    - Global syspref ('CheckPrevCheckout'), set to 'hardno' by default,
      allows users to enable this feature library wide.
    - Per patron category pref allows libraries to create overrides per
      category, falling back on the global setting by default.
    - Per patron pref allows switching the functionality on at the level
      of patron. Fall-back to category settings by default.
    
    * Koha/Patron (wantsCheckPrevCheckout, doCheckPrevCheckout): New
      methods.
    * C4/Circulation.pm (CanBookBeIssued): Introduce CheckPrevCheckout
      check.
    * admin/categories.pl: Pass along checkprevcheckout.
    * koha-tmpl/intranet-tmpl/prog/en/modules/admin/categories.tt: Expose
      CheckPrevCheckout per category setting.
    * koha-tmpl/intranet-tmpl/prog/en/modules/preferences/patrons.pref:
      Expose CheckPrevCheckout syspref.
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/memberentrygen.tt:
      Expose per patron CheckPrevCheckout preference.
    * koha-tmpl/intranet-tmpl/prog/en/modules/members/moremember.tt: Expose
      per patron CheckPrevCheckout preference.
    * koha-tmpl/intranet-tmpl/prog/en/modules/circ/circulation.tt: Add
      'CHECKPREVCHECKOUT' confirmation message.
    * installer/data/mysql/kohastructure.sql: Modify structure of
      'categories', 'borrowers', 'oldborrowers'.
    * installer/data/mysql/sysprefs.sql: Add 'CheckPrevCheckout'.
    * installer/data/mysql/atomicupdate/checkPrevCheckout.sql: New file.
    * t/db_dependent/Patron/CheckPrevCheckout.t: New file with unit tests.
    
    Test plan:
    - Apply patch.
    - Run updatedatabase.
    - Regenerate Koha Schema files.
    - Run the unit tests.
    - Verify 'CheckPrevCheckout' is visible in Patrons sysprefs and can be
      switched to 'hardyes', 'softyes', 'softno' and 'hardno'.
      + Check out previously checked out items to a patron, checking the
        message appears as expected.
    - Verify no 'Check previous checkouts' setting appears on the borrower
      category pages if the syspref is set to a 'hard' option.
    - Verify 'Check previous checkouts' setting appears on the borrower
      category pages and can be modified per borrower category.
      + Issue previously issued items to a borrower, checking the message
        appears as expected (This setting should override the default
        setting if that is set to a 'soft' option).
    - Verify no 'Check previous checkouts' setting appears on the individual
      borrower pages if the syspref is set to a 'hard' option.
    - Verify 'Check previous checkouts' setting appears on individual
      borrower pages and can be modified.
      + Issue previously issued items to a borrower, checking the message
        appears as expected (This setting should override the category
        setting and the default setting if the latter is set to a 'soft'
        option).
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c19f342bb1a8eaae25db979e94dc23efa4bc8a26
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 7 16:52:10 2016 +0100

    Bug 16860: Remove the comment about the warning
    
    It is no longer necessary.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b80318f1b7441328d818dfe67a4cb8cd345f585e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jul 6 11:51:40 2016 -0400

    Bug 16860: Catch warning t/db_dependent/ClassSource.t
    
    $ prove t/db_dependent/ClassSource.t
    t/db_dependent/ClassSource.t .. 3/24 attempting to use non-existent class sorting routine routine1
    t/db_dependent/ClassSource.t .. ok
    All tests successful.
    Files=1, Tests=24,  1 wallclock secs ( 0.02 usr  0.00 sys +  0.66 cusr  0.02 csys =  0.70 CPU)
    Result: PASS
    
    The above warning might be scary to those unfamiliar with the test.
    Add a test to catch the warning.
    
    TEST PLAN
    ---------
    1) prove t/db_dependent/ClassSource.t
       -- as above
    2) apply patch
    3) prove t/db_dependent/ClassSource.t
       -- no message
    4) prove -v t/db_dependent/ClassSource.t
       -- test 13 is the new test
    5) run koha qa test tools
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Workas as advertised
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f38bcf5505e1196c3ae4d2e9d5df523bb07ef281
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 7 16:40:47 2016 +0100

    Bug 16857: Check on item.branches makes more sense
    
    The test should be on the existence of the item.branches
    method/attribute
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit abb7980004ad75de4a51d06815f5e98e1cbb0f6d
Author: Marc Véron <veron@veron.ch>
Date:   Mon Jul 4 11:37:33 2016 +0200

    Bug 16857 - patron-attr-types.tt: Get rid of warnings "Argument "" isn't numeric"
    
    To vrify:
    - Go to Home > Administration > Patron attribute types
    - Make sure you have some patron attribute types with no branches limitation
    - For each attribute type you get a warning in intranet-error.log:
    patron-attr-types.pl: Argument "" isn't numeric in numeric gt (>) at (...)/koha-tmpl/intranet-tmpl/prog/en/modules/admin/patron-attr-types.tt line 284.
    
    To test:
    - Appy patch
    - Verify that warnings no longer appear in intranet-error.log
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 666397446f1af6a5fb2f71ed590c55c2fc7d84d1
Author: Magnus Enger <magnus@libriotech.no>
Date:   Tue Jun 28 10:45:08 2016 +0200

    Bug 16823 - Comment out koha-rebuild-zebra in koha-common.cron.d
    
    Bug 16190 enabled the indexer daemon by default for package installations.
    This means that it is no longer necessary to set up koha-rebuild-zebra as
    a cron job. This patch comments it out, so that people who might run into
    bug 16814 can easily activate the cronjob again after de-activating the
    indexer daemon.
    
    To test:
    Just read the diff and check that it makes sense.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3c80818f680278e595cf2a890b311db7866766a6
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Thu Jun 23 10:35:24 2016 -0600

    Bug 16803: Add Font Awesome Icons to "Select/Clear all" links to shelves.tt
    
    Add Font Awesome Icons to "Select/Clear all" links to shelves.tt
    (Public and private lists)
    
    To test:
    -Apply patch
    -Go to More -> Lists
    -Create some Public and Private Lists
    -See the contents of the list and notice about the new icons in
     "Select/Clear  all"
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e3002eea202a50b68e96650f37bcacc37843872e
Author: Marc Véron <veron@veron.ch>
Date:   Wed Jun 22 07:57:06 2016 +0200

    Bug 16795 - Patron categories: Accept integers only for enrolment period and age limits
    
    To test:
    - Apply patch
    - Clear browser cache
    - Go to Home > Administration > Patron categories
    - Create or edit a category
    - Verify that field 'In months', 'Age required' and 'Upperage limit'
      accept digits only
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9b399a806100eb9568ae43d71b257f0801185072
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jul 3 16:07:33 2016 +0100

    Bug 16794: Group the 2 action buttons into the same column
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a50eb52a425dbe8ec774e2664fe9df179d32ceaa
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Wed Jun 22 09:22:11 2016 -0600

    Bug 16794: Revise layout for Admistration > Patron categories
    
    Add Bootstrap buttons and Font Awesome Icons to "Delete" and "Edit" links
    
    To test
    - Go to Administration -> Patron categories
     - Confirm that two button appear instead of links for "Edit" and "Delete"
     - Edit an existing category and confirm that works as expected
     - Delete a category and confirm that works properly.
    
    Patch fix it according with QA comment 3
    Fix copy and paste according with QA comment 6
    Fix column "Default privacy" to be sorted again according with comment 8
    Patch set squashed
    
    Buttons appear now as requested in comment #3 (2 buttons, no action menu)
    
    Re-tested, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 68c0c94b94227a9d73456a50f08a735ee9746af7
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Mon Jun 20 13:12:22 2016 -0600

    Bug 16781: Add Font Awesome Icons to "Select/Clear all" links to modborrows.tt and result.tt
    
    Add Font Awesome Icons to "Select/Clear all" links to:
    modborrows.tt (Batch patron modification) and result.tt (Search results)
    
    To test:
    
    -Apply on top bugs 16469 and 16494
    -Goto Batch patron modification
    -Create a new batch patron or select one patron list
    -See the new icons for "Select all" and "Clear all"
    -Do a search and see the new icons in Search results page
    
    Followed test plan, icons display as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 90da601783e9f368939d41affb250289dd10204b
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Tue Jun 21 15:19:40 2016 -0600

    Bug 16793: Use Font Awesome for arrows instead of images in audio_alerts.tt
    
    This changes fit with bug 16148 for marc modification template management
    
    To test
    -Apply patch
    -Goto Admin->Audio alerts
    -Verify that green arrows have disappeared now
     in blue Awesome Icons
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=16794
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eb77861750cb3a2720e4a3a8003d526fa7d61552
Author: Marc Véron <veron@veron.ch>
Date:   Mon Jun 20 15:27:39 2016 +0200

    Bug 16779: Move road type after address in US style address formatting (main address)
    
    To verify:
    - Create a patron with address, streettype, streetnumber defined
    - Set syspref 'AddressFormat' to US style
    - Go to patron's detail page (in staff client)
    - In main address, road type preceeds address (e.g. 25 Drive Euclid)
    
    To test:
    - Apply patch
    - Refrexh patron's detail page
    - Verify that main address displays correctly (e.g. 25 Euclid Drive)
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cae7e29cf27b3a751211dc71e1aeebe723153433
Author: Claire Gravely <c.gravely@arts.ac.uk>
Date:   Tue Jun 14 00:25:03 2016 +0200

    Bug 15929 - typo in explanation for MaxSearchResultsItemsPerRecordStatusCheck
    
    There's a typo in the explanation for the new MaxSearchResultsItemsPerRecordStatusCheck  sys pref that was added in 3.22.2.
    
    "If a record has more than this number of items, they availability statuses ..."
    
    I have re-worded the description so it reads a bit better.
    
    Test plan:
    1. Check the description for syspref MaxSearchResultsItemsPerRecordStatusCheck.
    2. Apply patch
    3. Check syspref MaxSearchResultsItemsPerRecordStatusCheck description
     to make sure it makes sense.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5ec641fbbb67501e2a71be64b12c9224caee1b55
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Jul 7 02:34:28 2016 -0400

    Bug 16869: Silence and catch warnings in t/db_dependent/SuggestionEngine_ExplodedTerms.t
    
    By properly defining a opachtdocs (intranethtdocs was done too)
    in the mock function, uninitialized variable warnings are
    eliminated. Given that we can check if $KOHA_CONF is defined or
    not, we can catch the warning as part of testing, so the output
    of the test is cleaner.
    
    TEST PLAN
    ---------
    1) unset KOHA_CONF
    2) prove t/db_dependent/SuggestionEngine_ExplodedTerms.t
       -- lots of noise
    3) apply patch
    4) prove t/db_dependent/SuggestionEngine_ExplodedTerms.t
       -- no noise
    5) prove -v t/db_dependent/SuggestionEngine_ExplodedTerms.t
       -- see the warnings were caught and not just ignored.
    6) run koha qa test tools
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    No warnings. Works as advertised
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5f147cc6bb8a018fd0af8b23789e795bf57ede72
Author: Marc Véron <veron@veron.ch>
Date:   Sun Jun 19 16:40:09 2016 +0200

    Bug 16562 - Translatability: Issue in opac-user.tt (separated word 'item')
    
    Alternate patch with wording as proposed in comment #12
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 10d4d2fd3139c74a1dcc0c643ca00be264e1a526
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 24 12:04:43 2016 -0400

    Bug 16807 - Use Koha::BiblioFrameworks instead of GetFrameWorkLoop
    
    Refactor code to use work from 14889
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d17085ea0361f8581a796e5f17d0413b37b7b598
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 24 09:57:07 2016 -0400

    Bug 16807: Frameworks unordered in dropdown when adding/editing a biblio
    
    To test:
    Start to add or edit a biblio
    Open the dropdown to change framework
    Notice the order
    Refresh the page - notice the order changes
    Apply patch
    Order is alphabetical
    Refresh the page
    Order does not change
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as described
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 11dc97cfae96676ff1cc242e8a43ad513c36c6ef
Author: Marc Véron <veron@veron.ch>
Date:   Sun Jun 19 17:43:19 2016 +0200

    Bug 16774: Format date on 'Transfers to receive' page to dateformat system preference
    
    To test:
    - Apply patch
    - Go to Home > Circulation > Transfers to receive
    - Verify that in title (Transfer made to your library as of...) is
      is formatted as defined in syspref dateformat
    
    Additionaly, the patch changes page title and breadcrumb from:
    Home > Circulation > Transfers to your library
    to:
    Home > Circulation > Transfers to receive
    ...to make them consistent with the link text on the Circulation home page
       (Transfers to receive)
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b6ccd8366dca9fc17d381d5fdf487bd8e2e1e045
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 26 09:35:26 2016 -0400

    Bug 16600 - Remove some obsolete references to Greybox in some templates
    
    This patch removes unused Greybox markup from two templates.
    
    To test, apply the patch and go to Authorities.
    
    - Perform an authority search which will return multiple results.
    - Select two records to merge.
    - On the "merging records" page, an earlier version used Greybox to show
      a preview of the selected authority records. Confirm that authority
      number link for the two records triggers a pop-up window instead.
    
    - From the authorities home page, choose 'New from Z39.50'
    - Perform a search which will return multiple results.
    - Confirm that there is only a 'MARC' preview link. A
      forever-commented-out 'Card' link has been removed.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised. Obsolete comment on 'Card' removed
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a12d3d1bfa00499a0b16d39f01136050de537449
Author: Bouzid Fergani <bouzid.fergani@inlibro.com>
Date:   Tue Apr 12 09:27:18 2016 -0400

    Bug 15636 - DataTables Warning: Requested unknown parameter from opac-detail.tt
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    This patch adds the same tests in the aoColumns DT definition than the
    ones in the creation of the table. That's sound good.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 00960f196482bb8dda3ddac8d9361ca1ffc5af93
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jul 6 15:52:54 2016 +0200

    Bug 16859: Fix wrong item field name in export.pl
    
    Field callnumber should be itemcallnumber.
    For completeness, prefixing the joined fields with items table prefix.
    
    Note: You should expect Tools/Export to export only the items within a
    given itemcallnumber range, but if the biblio has one item in that
    range, the biblionumber is selected for export with ALL items. The script
    is designed that way (first select biblio numbers based on criteria, and
    run export with those biblio numbers).
    
    Test plan:
    [1] Select a biblio N with one item with say itemcallnumber X.
    [2] Goto Tools/Export. Select biblio range N,N and no itemcallnumber
        range. The biblio should be exported.
    [3] Select biblio range N,N and itemcallnumber range A,B. No output.
    [4] Select biblio range N,N and itemcallnumber range A,<empty>. Output.
    [5] Select biblio range N,N and itemcallnumber range <empty>,X. Output.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a44bb07b88ba9d5049a64f88610a8bb8e82efe3a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 5 14:49:35 2016 -0400

    Bug 16855 - Poor performance due to high overhead of SQL call in export.pl
    
    This patch eliminates all columns retrieved in the biblioitems query
    except for biblionumber.
    
    To test:
    1 - Go to tools->Export data
    2 - Export using various filters and note you get expected records
    3 - Apply patch
    4 - Ensure exported results match results before patch
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 44092cbafd1641ef865497183b8368db83bb62a7
Author: Marc Véron <veron@veron.ch>
Date:   Mon Jul 4 03:48:40 2016 +0200

    Bug 16854: request.tt: Logic to display messages broken
    
    This patch fixes broken logic in
    koha-tmpl/intranet-tmpl/prog/en/modules/reserve/request.tt
    
    To verify, see initial comment.
    
    To test:
    - Apply patch
    - Have a patron with a restricion and with outstanding fines
      greater than defined in syspref 'maxoutstanding'
    - Place a hold for this patron and verify, that messages
      'Patron has restrictions' and 'Patron has outstanding fines...'
      appear
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7c89f78f3bef1cdebb51dcb41fdda7a8dc252b94
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 24 10:35:25 2016 +0000

    Bug 16780 - Specify due date always sets time as AM when using 12 hour time format
    
    This regression is occurs because the time format for the checkout
    date/time widget is only meant to be given in 24 hour format. The time
    due should not be converted to 12 hr time even if the library has 12
    hour set as their preferred time format.
    
    Test Plan:
    1) Performat a backdated checkout with a date due that has a PM time
    2) Note the date/time picker on the confirmition screen shows the time
       in AM/PM
    2) Note the time is not stored correctly
    3) Apply this patch
    4) Repeate step 1
    5) Note the confirmation date/time picker now show the time in 24hr
       format
    6) Note the time was stored correctly
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ffcb360321f6abe111c3352606b4c641ac48950a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jun 17 11:33:41 2016 -0400

    Bug 16762: Record matching rules: Remove match check link removes too much
    
    My patch for Bug 5006 introduced a lot of markup changes to the record
    matching rules template. I missed a change in one are though, which
    caused a bug with the way the 'Remove match check' link works.
    
    To reproduce:
    
    - Go to Administration -> Record matching rules.
    - Edit a matching rule which includes at least one match check.
    - Click a 'Remove match check' link. The entire "Required match checks"
      block is removed.
    
    To test, apply the patch and repeat the steps above. Clicking any
    'Remove match check' link should remove only the corresponding rule.
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8ca55a7fb37ac50103de978f82408776fc06b7bb
Author: Galen Charlton <gmcharlt@gmail.com>
Date:   Tue Jul 5 16:22:39 2016 +0000

    Bug 16760: fix Circulation Statistics wizard under Plack
    
    This patch fixes some variable scoping problems when running
    the circulation statistics wizard under Plack.  For example,
    when using the item type as a row header, with this patch the
    item type description is displayed rather than "UKNOWN VALUE".
    
    This patch also enables warnings and fixes a couple variable
    initialization issues. (Note that turning on warnings across
    the board would make it easier to identify Plack variable scoping
    issues, as "Variable "$foo" is not available at' errors would
    be recorded in the Plack error log).
    
    To test
    -------
    [1] Run the staff interface under Plack.
    [2] Go to the Circulation Statistics Wizard and run a report
        using item type as the row. Note that the row labels
        display as "UNKNOWN VALUE" rather than the item type.
    [3] Apply the patch and restart Plack.
    [4] Run step #2 again; this time, the item type descriptions should
        be used as the row labels.
    
    Signed-off-by: Galen Charlton <gmcharlt@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c7596a489473bc294e04690f21b7a9d612f34abd
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Jun 28 15:21:53 2016 +0200

    Bug 16671: [QA Follow-up] Replace remaining itemtype lines
    
    Instead of relying on existing data, we use new TestBuilder recs.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit eddc0a0e0a72264151e39f8a5d87d638a4208369
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jun 27 09:24:14 2016 +0200

    Bug 16671: [QA Follow-up] Add new itemtype and remove bailout
    
    No need to bail out, if we are using TestBuilder.
    Somehow, this test passes with me if we add a new record, and if
    we do not, it fails (using BK as the first itemtype with notforloan
    is 0).
    
    Looking further, we should imo remove the Koha::ItemTypes searches
    here and not depend on existing data. Just add some item types.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8f42c681b0208ace7ed7858cafdd8c9777debd96
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 6 14:00:56 2016 +0100

    Bug 16671: (bug 14828 follow-up) Pick the right itemtypes
    
    Looking at commit aafe73eefb5151454fa8957bf188768324d23955
      Bug 14828: Use Koha::ItemType[s] everywhere C4::ItemType was used
    -my @item_types = C4::ItemType->all;
    -my @for_loan = grep { $_->{notforloan} == 0 } @item_types
    -  or BAIL_OUT("No adequate itemtype");
    -my $itemtype = $for_loan[0]->{itemtype};
    +my $itemtype = Koha::ItemTypes->search({ notforloan => 1 })->next;
    +$itemtype or BAIL_OUT("No adequate itemtype"); #FIXME Should be $itemtype = $itemtype->itemtype
    
    It seems that the tests expect itemtypes for loan.
    
    Test plan:
      prove t/db_dependent/HoldsQueue.t
    should still return green
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised. No qa test tool errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Adding follow-up.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3bb51d038639c7b197022a2c7c6ae864c834060f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 6 15:55:31 2016 +0100

    Bug 16459: Add patron to a patron card requires catalogue permission
    
    Currently, serials => 'routing' is required, which does not make any
    sense.
    It's a copy/paste error when this file has been created (you can blame
    me).
    
    Note that I am not sure catalogue is the correct permission, but it's
    the one used almost everywhere in this module
    
    Test plan:
    Confirm that catalogue is enough to search for patrons to add to a
    patron card.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 172ebfe520d34f8106ec011b7d707c0560d65760
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 3 14:34:33 2016 +0100

    Bug 16431: Use Koha::Cache to cache marc subfield structure
    
    The marc subfield structure is currently cached using a global variable
    of C4::Context. The infos are retrieved every time a new context is
    created.
    This patch suggests to use Koha::Cache instead.
    
    To achieve this goal, a new subroutine is created
    C4::Biblio::GetMarcSubfieldStructure, it will be called from code which
    needs to get the marc subfield structure. GetMarcFromKohaField,
    GetMarcSubfieldStructureFromKohaField, TransformKohaToMarc and
    _get_inverted_marc_field_map are modified accordingly and the cache is cleared
    when the table is updated (from the 3 pl scripts modified by this patch).
    
    The caching done in C4::Context (marcfromkohafield) is removed.
    
    Test plan:
    Play with the marc subfield structure (in the administration module),
    then add and edit records and make sure everything went fine.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Everything works as expected on my functional tests. I'm really happy to see the
    patch introduces relevant tests for previously untested functions.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1509322c9a813809ca453b476ea1163bbc9303ca
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Jun 15 16:11:07 2016 +0200

    Bug 14968 - Provides unit test
    
    Signed-off-by: Broust <jean-manuel.broust@univ-lyon2.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 83328c1061af0ae82d8a2086e298375875e2dfa9
Author: Lyon 3 Team <koha@univ-lyon3.fr>
Date:   Tue Oct 6 15:42:15 2015 +0200

    Bug 14968 - found shouldn't be set to null when cancelling holds
    
    Signed-off-by: JM Broust <jean-manuel.broust@univ-lyon2.fr>
    
    Signed-off-by: Broust <jean-manuel.broust@univ-lyon2.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a1285ba9c0f9a7020ba5f6e982dd2a5891ab9f63
Author: Morgane Alonso <morgane.alonso@biblibre.com>
Date:   Mon Jun 6 12:24:56 2016 +0000

    Bug 12509 - Fix Untranslatable Restriction added by overdues process
    
    Changes the value of the "comment" column in "borrower_debarments" table
    from "Restriction added by overdues process yyyy-mm-dd hh:mm:ss" to
    "OVERDUE_PROCESS yyyy-mm-dd hh:mm:ss" in the overdue_notices.pl. Then in
    the templates "moremember.tt", "circulation.tt", "memberentrygen.tt",
    "opac-reserve.tt" and "opac-user.tt" the value of "comment" is
    check, if it's an automatical comment due to overdue process it'll
    write "Restriction added by overdues process yyyy-mm-dd hh:mm:ss",
    then if there is a customizable comment it will be written without
    modification. Like this, the comment "Restriction added by overdues
    process" is written in the po files and can be translated later.
    
    To test:
    1) create a patron with automatical restriction due to overdue process;
    2) apply patch;
    3) run misc/cronjobs/overdue_notices.pl;
    4) verify if the comment "Restriction added by overdues process" is well
       written and translatable on the following page :
        - opac patron home page (opac-user.tt);
        - opac item reservation page (opac-reserve.tt);
        - pro patron page (moremember.tt);
        - reservation item for a patron (circulation.tt, memberentrygen.tt);
    5) try to translate the comment in po files;
    6) sign off.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6398d1b24216b07cb424e4b084ecf60329e0db86
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jul 7 18:36:25 2016 +0000

    Bug 3534 - DBRev 16.06.00.007
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit da083863ee813b8303f6d8181b935aa0f3f15b86
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 7 15:36:47 2016 +0100

    Bug 3534: Force margin-left: 0 for second button
    
    When quick adding a new patron, both button are in the DOM and the
    second button has a margin-left (from .btn-toolbar > .btn + .btn).
    This patch force the margin-left to 0 to avoid the button to move when
    toggling them.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5595e92ec723c4437f1549cbea7e9e1215cb4211
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jun 28 12:57:00 2016 -0400

    Bug 3534 (QA Followup) Rebase and change floating save
    
    Bug 3534 - (QA Followup) Use single toolbar for regular/quickadd forms
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a8ebff202dfe23b848a05f81060f436f1ea6bc60
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jun 8 13:39:02 2016 -0400

    Bug 3534 (QA Followup) Fix indentation, show guarantor form, ignore bad data in pref
    
    Switch incorrect == to != when checking skipped fields
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 486758d1361ffcd9b70de14e009bcf3363c4220f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed May 11 11:17:12 2016 -0400

    Bug 3534 - QA Followup - use floating save
    
    I am not sure if this is desired, it makes sense for consistency but
    floats in a wierd place for a short form.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 71d1e1727c5fd7671bbbce6e6085b829b957253d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Mar 4 21:34:07 2016 +0000

    Bug 3534 - Patron quick add form
    
    This patch adds a new system preference:
        PatronQuickAddFields
    
    When either this pref or BorrowerMandatoryField is populated this will add a new dropdown to the bew patron toolbar.
    When a category is chosen from this dropdown the fields in PatronQuickAddFields and BorrowerMandatoryField will be displayed.
    There will be a button allowing a user to switch from the quickadd to the full form and fields will be copied between the forms when toggling.
    
    The Quick add will only be displayed on add of a new patron, future edits should display the full form.
    
    Test plan:
     1 - Apply patch
     2 - run updatedatabase.pl
     3 - Add a new patron and ensure nothing has changed
     4 - Populate either PatronQuickAddFields or BorrowerMandatory fields
     and note the new button for adding a patron
     5 - Click the Quick add and choose a type
     6 - Only required or quick add fields should be displayed
     7 - Verify toggling forms copies information
     8 - Ensure you cannot save patron without filling required fields
     (quick add fields should be optional)
     9 - Ensure you can save patron with fields filled out
    10 - Ensure that a duplicate patron brings up the duplicate/add new
    buttons with full form displayed
    11 - Verify that subsequent edits use only full form
    12 - Verify that data on form submitted is the data saved to patron
    13 - Test with various values in both MandatoryBorrowerFields and PatronQuickAddFields
    
    Sponsored by: VOKAL (Vermont Organization of Koha Automated Libraries)
    
    Followed test plan, works as expected.
    Re-tested together with followup, works as expected (2016-06-02)
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0fda22b824a2e7c13e9b633325748d422e98e2a3
Author: Jesse Weaver <jweaver@bywatersolutions.com>
Date:   Thu Jul 7 11:02:53 2016 -0600

    Bug 14048: (RM followup) DB version 16.06.00.006
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit 0bb144bbaf578ef7e4a131d640b3866bfe05fdf5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 27 10:17:20 2016 -0300

    Bug 14048: (QA followup) Default to 1 if no default rule
    
    This patch answers Jonathan's request to simplify this patchset a bit.
    
    It removes the need for the .sql file, as _default_rule now defaults to
    a fixed value (1, which was set by the removed .sql file).
    This allowed to remove the overloaded ->delete method.
    
    The tests have been adjusted to reflect this changes, including tests for
    the new 'default'-if-absent situation.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit 1887b7ab3ea50f9721eba070bc156c7f268d966a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jun 26 08:19:12 2016 +0100

    Bug 14048: Use mock_preference in tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit c24fc83eee88771c36a0475165619c96fe54ebf2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Sat Jun 25 12:37:15 2016 -0300

    Bug 14048: (QA folloup) C4::Context->preference should be used
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit e657345fd7493816f1713fd825fac1e1f2f757a7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 21 15:18:51 2016 -0300

    Bug 14048: (followup) Use the original holding branch
    
    This patch picks the item's holding branch *before* it gets fixed
    by using the checkin library instead. This way the RefundLostOnReturnControl
    syspref set to ItemHoldingBranch is respected (otherwise, as Nick explained
    this behaves just like if CheckinLibrary was set)
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit 22f727f30e33227be449bef6d73861ae36b31ad5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 17 10:33:22 2016 -0300

    Bug 14048: (QA followup) Fix typo on syspref value
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit 86e998cc418e01e115054c1da3912680b38847cf
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jun 15 16:18:38 2016 -0300

    Bug 14048: (QA followup) Update syspref name for HEA
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit d4d550237a654257f0cf7932a74098cec11781f7
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jun 13 11:17:42 2016 +0000

    Bug 14048 [QA Followup] - Delete only the removed system preference
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit d8e186a7a932869c7d6766aa7d9c5066518d128d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 3 11:24:07 2016 -0300

    Bug 14048: Add syspref and atomic update
    
    This patch introduces the changes to the sysprefs and the atomic update
    that creates the new table.
    
    It picks the syspref value for RefundLostItemFeeOnReturn and uses it to
    create a default (branchcode='*') rule on the new table.
    
    Sponsored-by: DoverNet
    Sponsored-by: South-East Kansas Library System
    Sponsored-by: SWITCH Library Consortium
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit 523cdcee044c87dd886e3364f65fac5b2a2c294a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 9 16:48:07 2016 +0000

    Bug 14048: [QA Followup]
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit b1b61c60735a4afaec48da2e199cf673942d2683
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 3 11:26:42 2016 -0300

    Bug 14048: Hook new rules into C4::Circulation
    
    This patch makes AddIssue and AddReturn use the new implementation
    
    The behaviour should respect the specification.
    
    Sponsored-by: DoverNet
    Sponsored-by: South-East Kansas Library System
    Sponsored-by: SWITCH Library Consortium
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit e85b2e4f94ccbcc62bbe516d6ce1fdab9e626cfa
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 3 11:26:11 2016 -0300

    Bug 14048: Add a refund rules setting form in smart-rules
    
    This patch introduces the CRUD UI for managing the refund lost item fee
    rules on the general 'Circulation and fines rules' page.
    
    Verify that rules can be added and changed.
    
    Rules are correctly associated to the chosen branch (or the
    general default rule).
    
    To test:
    - Apply the patch
    - Open smart-rules.pl
    => SUCCESS: The text and refund rules section correctly refers to default global rules.
       The policy can be set to Yes and No, and works as expected.
    - Pick a specific branch
    => SUCCESS: The rule refers to the specific branch
    => SUCCESS: It detects the default rule is picked
    => SUCCESS: On changing the rules values are correctly retrieved if entering
       again to the page.
    => SUCCESS: The 'Use default' text is suffixed with the correct value set by the user
       in the 'All libraries' scenario.
    => Sign off :-D
    
    Sponsored-by: DoverNet
    Sponsored-by: South-East Kansas Library System
    Sponsored-by: SWITCH Library Consortium
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit 262b9344cd395dd9209a0aabd457b63a0207523e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 3 11:25:15 2016 -0300

    Bug 14048: Unit tests
    
    This patch introduces unit tests for the feature.
    To test:
    - Have all patches from this bug applied
    - Run:
      $ prove -v t/db_dependent/RefundLostItemFeeRule.t
    => SUCCESS: All tests pass!
    
    Sponsored-by: DoverNet
    Sponsored-by: South-East Kansas Library System
    Sponsored-by: SWITCH Library Consortium
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit 65558f20801dc7245de385af29fc7c650a8211f3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 3 11:23:20 2016 -0300

    Bug 14048: Add RefundLostItemFeeRule table and classes
    
    This patch introduces new classes for handling refund lost item fee
    rules. It introduces a new table for storing this rules.
    
    It is designed so it is possible to define a global rule, and then
    branch-specific ones. The specific is prefered if available.
    
    This behaviour is fully tested by unit tests introduced by the following patches.
    
    This cannot be tested on its own.
    
    Sponsored-by: DoverNet
    Sponsored-by: South-East Kansas Library System
    Sponsored-by: SWITCH Library Consortium
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jason Robb <jrobb@sekls.org>
    Signed-off-by: Jennifer Schmidt <jschmidt@switchinc.org>
    Signed-off-by: Margaret Thrasher <p.thrasher@dover.nh.gov>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>

commit 4747e6155efc9902003ae3ae4c14535fc7ece015
Author: Marc Véron <veron@veron.ch>
Date:   Sun Jun 19 18:10:06 2016 +0200

    Bug 16772 - Change label from 'For:' to 'Library:' to ease translation
    
    This patch changes the label from "For:" to "Library:" in the
    acquisition information filter on the suggestions page in staff client.
    
    To test:
    - Apply patch
    - Go to Home > Acquisitions > Suggestions management
    - Verify that label reads as appropriate (in filter
      Acquisition information)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 735789d71aa802385b282c79edad43d2a6fb58d6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 21 12:36:38 2016 +0100

    Bug 16770: Remove 2 other occurrences of libmemoize-memcached-perl
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 67e6efab5d2da2c55d138153060c70cba342db7e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 18 15:22:35 2016 +0100

    Bug 16770: Remove Memoize::Memcached dependency
    
    This module is no longer in use and can be removed.
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    
    This part involves some changes in a bunch of mysterious debian|ubuntu
    related files, not quite sure if I know what I'm doing
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 44fb6e72254391d38b7a66fa395bb9874a6d716c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 18 15:21:28 2016 +0100

    Bug 16770: Remove wrong caching of 3 subroutines in C4::Lancuages
    
    ooking at this code, you might think these subroutines are cached, but
    actually they are not.
    
    The eval surrounding the code hides a bug, if you remove it, you will
    get:
      Invalid memcached argument (expected a hash)
    
    Test plan:
    Do not apply this patch and confirm that the code does not work
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 40598f8e4fb7a0f772a2fc960df0e67440f4e0a6
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 24 14:03:41 2016 +0000

    Bug 16768 - DBRev 16.06.00.005
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1c114997887484e0db79913a8471b6f928202f78
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jun 19 11:43:18 2016 +0100

    Bug 16768: Update options in sysprefs.sql
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8b9bbeaac470838e7caf330ceef25a67d96dd2d1
Author: Marc Véron <veron@veron.ch>
Date:   Sat Jun 18 16:38:39 2016 +0200

    Bug 16768: (followup) Add Swiss format for datatables (format_price.inc)
    
    This patch adds CH price format to:
    koha-tmpl/intranet-tmpl/prog/en/includes/format_price.inc
    (as of comment #6)
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0673dc08565d05dd20dd2ba89d31dfb771ef92b8
Author: Marc Véron <veron@veron.ch>
Date:   Sat Jun 18 16:15:25 2016 +0200

    Bug 16768: Update systempreferences.options (additional value CH)
    
    As of comment #5, adding file
    installer/data/mysql/atomicupdate/bug_Bug_16768_official_number_format_switzerland.sql
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 85271cabc718ad01989a7ac0a99fc5b35085bae1
Author: Marc Véron <veron@veron.ch>
Date:   Sat Jun 18 09:16:58 2016 +0200

    Bug 16768: Add tests for Swiss number format
    
    Testplan:
    - Apply patch
    - Run t/Number/Price.t
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3586d1504b7302dd1ce28940c393d0a1cc2c6457
Author: Marc Véron <veron@veron.ch>
Date:   Sat Jun 18 08:17:03 2016 +0200

    Bug 16768 - Add official number format for Switzerland: 1'234'567.89
    
    This patch adds the official number format for Switzerland (CH) and makes
    it selectable in syspref 'CurrencyFormat'
    
    To test:
    - Apply patch
    - Set syspref 'CurrencyFormat' to '360'000.00 (CH)'
    - Go to Home > Administration > Budgets administration
    - Create or edit a budget with Total amount of 1234567.89
    - Verify that the amount appears properly formated as 1'234'567.89
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit db52dfed0168a5a120d07e4599af688269162461
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jun 15 12:21:26 2016 +0000

    Bug 16745 - Add edit catalog and edit items links to serials toolbar
    
    It would be very helpful for librarians to have links directly to the
    record and items editor from a serial. Right now moving from the serial
    to those editors requires jumping through a number of pages.
    
    Test Plan:
    1) Apply this patch
    2) Browse subscription-detail.pl for a given serial
    3) Under the Edit button, note the "Edit record" link
    4) Verify the link takes you to the marc editor for that record
    5) Create or find a serial that is set to create items on receiving
    6) Under the Edit button, note the new "Edit items" link
    7) Verify the link takes you to the items editor for that record
    8) Create of find a serial that is *not* set to create items on receiving
    9) Verify the "Edit items" link does not exists for that serial
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 62508428cdf3a4c3da975ef5f88c8ece9cf50537
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jun 6 11:28:39 2016 -0400

    Bug 16651: Notes field blank for 952$z in opac-course-details.pl
    
    This patch changes course reserves to check for item notes form the
    course reserve and fallback to itemlevel notes if they are empty
    
    To test:
    1 - Enabvle course reserves
    2 - Add some items
    3 - Make sure the items have notes at the item level and not at course
    reserves
    4 - Notes don't display in staff or opac
    5 - Apply patch
    6 - Notes display in staff and opac
    7 - Add notes at course reserves level
    8 - These override the item level notes
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    Works as advertised
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 458ce34a1dbfff9a5c5a696560ffdc5b8afa041a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed May 11 08:56:15 2016 -0400

    Bug 16602 - Remove the use of "onclick" from several templates
    
    This patch removes the use of "onclick" from several templates, instead
    defining click events in JavaScript.
    
    Also changed: Some markup corrections.
    
    To test, apply the patch and:
    
    - Go to Circulation -> Upload offline circulation file
      - Browse for an offline circulation file.
      - Clicking the 'Upload file' button should work correctly.
        - After uploading a file, both the 'Add to offline circulation
          queue' and 'Apply directly' buttons should work to trigger their
          corresponding processes (keeping Bug 16603 in mind).
    
    - Go to Patrons -> Patron lists.
      - For any patron list containing patrons, click the 'Print patron
        cards' menu item. This should trigger a modal window which exports
        the correct list.
    
    - Go to Tools -> Batch item modification.
      - Submit a batch of items for modification.
      - Clicking the 'Save' button should trigger the background job and the
        items should be successfully modified.
    
    - Go to Tools -> Batch item deletion.
      - Submit a batch of items for deletion.
      - Clicking the 'Delete' button should trigger the background job and
        the items should be successfully deleted.
    
    - Go to Tools -> Calendar.
      - Trigger the 'Add new holiday' panel by clicking a day on the
        calendar which has no holiday defined.
      - Clicking the 'Cancel' link should hide the panel.
      - Trigger the 'Edit this holiday' panel by clicking a day which has a
        holiday defined.
      - Clicking the 'Cancel' link should hide the panel.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
      Everything works as previously.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 718a0a7d143a1291021836b570e597cb564fa7c2
Author: Zeno Tajoli <z.tajoli@cineca.it>
Date:   Thu May 26 15:34:56 2016 +0200

    Bug 16601: Update of italian MARC21 files
    
    This is the update for April 2016 changes of Library of Congress
    The basic creation of the files is done in http://translate.koha-community.org/files/it/mandatory/
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Both files load without problems.
    No errors
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0c476f15082893cb2ee66271009fb09d3f698c23
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 19 09:41:24 2016 -0400

    Bug 16557 - Remove the use of "onclick" from several include files
    
    This patch modifies several include files, removing "onclick" attributes
    in favor of defining events in JavaScript.
    
    A reusable "toggle" function has been added to the global JS file so
    that clicking elements with the class "toggle_element" will toggle the
    display of elements as defined in the click target's "data-element"
    attribute.
    
    Also changed: In subtypes_unimarc.inc some capitalization errors have
    been fixed and label/id pairs corrected.
    
    To test, apply the patch and clear your browser cache if necessary.
    
    - On the Acquisitions home page, click the "Orders search" header search
      tab. Clicking the [+] link should expand and collapse the additional
      search fields.
    
    - On the checkout or patron detail page, view the "Restrictions" tab.
      Click to add a restriction and use the datepicker to select a date.
      Clicking the "Clear date" link should clear the date.
    
    - Trigger the help window on any page. Clicking the "close window"
      button should work correctly.
    
    - Go to Administration -> Patron categories -> Edit. Checking and
      unchecking messaging preference options should work correctly. The "do
      not notify" checkbox should clear other checkboxes in that row and
      vice versa.
    
    - In Serials, from a subscription detail page, clicking the "Renew"
      button should trigger the renew popup.
    
    - Go to Acquisitions -> Vendor -> Add to basket -> From a subscription.
      Clicking the "Advanced search" link in the left hand sidebar should
      toggle the sidebar search form.
    
    - In a UNIMARC system, view the advanced search page. Clicking the "Show
      coded information filters" link should show additional search fields.
      (I tested in my MARC21 system by temporarily moving line 174 of
      advsearch.tt to line 172).
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6524e6d95726c70b7ff6088b31692216a1956110
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed May 18 21:23:14 2016 -0400

    Bug 16549 - Remove the use of "onclick" from header search forms
    
    This patch removes the use of "onclick" from all header search forms for
    the purpose of triggering the "keep_text" function. This behavior is now
    handled in the globally-included JS file.
    
    To test, apply the patch and clear your cache if necessary.
    
    - Enter text in any header search form field. Click to each other tab
      in the header and confirm that your text is copied to each.
    - Test the behavior of the header search form on at least one page where
      each is included:
    
      - The staff client home page
      - The advanced search page
      - The authorities home page
      - The administration home page
      - The cataloging home page
      - The checkin page
      - The circulation home page
      - The patrons home page
      - Acquisitions -> Vendor -> Contracts
      - Administration -> Cities
      - Administration -> Currencies and exchange rates
      - Administration -> Patron categories
      - Administration -> Printers (why is this page still around?)
      - Administration -> System preferences
      - Administration -> Z39.50/SRU servers
      - Tools -> Notices & slips
    
    This patch modifies does not fix the existing (unreported) bug which
    prevents the keep text function from working in the include file used on
    these pages:
    
      - Acquisitions -> Vendor -> Basket -> New order from suggestion
      - Administration -> Budgets
      - The serials home page
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 90a1d98e068e38e1c0655d608d98d7d88f344429
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 13 09:59:53 2016 -0400

    Bug 16513 - Improvements and fixes for quote upload process
    
    This patch fixes some minor bugs and adds a small enhancement to the
    quotes editor and quotes upload pages.
    
    To test, apply the patch and go to Tools -> Quote editor
    
    - In the table of quotes, clicking the "ID" table header should trigger
      an alert, "Click on the quote's ide to select..."
    - Go to "Import quotes" and select a file to upload.
    - On the upload preview page you should see a new "Cancel import"
      button. Clicking it should return you to the quotes upload page after
      asking for confirmation.
    - Test the upload cancel button:
      - If you have fast reflexes or are uploading a file large enough, you
        should be able to see a "Cancel upload" button during the upload
        process.
      - Clicking this button should cancel the upload and return you to the
        quote upload page.
    
    Tested on top of Bug 16589, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0336f32b6592fa4a714eeb9c217bf7150e2fc90f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 10 14:56:14 2016 -0400

    Bug 16494 - Remove the use of "onclick" from some patron pages
    
    This patch removes the use of "onclick" attributes from some patron
    pages.
    
    To test, apply the patch and:
    
    - In Patrons, perform any search which will return multiple results.
      Confirm that the "select all" and "clear all" links work as expected.
      Font Awesome icons have been added to these links.
    
      In the left-hand sidebar, change any of the filters and click the
      "Clear" button. The form (and your search results) should reset.
    
    - Open the 'Set permissions' page for any patron. Checking any
      permission with sub-permissions should correctly expand the tree and
      select all sub-permissions. The reverse should also work.
    
      Also changed in this file: The "Inconsistency detected" alert has been
      reformatted to make it translatable.
    
    - View the detail page for a patron with one or more restrictions.
      Clicking the "View restrictions" link at the top of the page should
      jump you to and activate the restrictions tab.
    
    - View the 'Notices' tab for a patron who has been sent one or more
      notices. Click any notice title to expand the notice. Clicking the
      "resend" button should resend the notice.
    
    - Create a new patron with the same first and last name as an existing
      patron. This should trigger a duplicate warning message. Click the
      "View existing record" link to trigger a pop-up window with a patron
      detail brief view.
    
      In this window an "email" class has been added to the primary and
      secondary email lines so that long email addresses don't overlap the
      second column of data.
    
      Confirm that clicking the "close" button in this window closes the
      window. The changes to staff-global.css are included in this patch to
      prevent the close button from having an incorrect color change on
      hover.
    
    Signed-off-by: FILIPPOS KOLOVOS <f.kolovos@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f9282eca291e44da795cc62bc8ff5593107c5cb5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 18 16:39:45 2016 +0100

    Bug 16490: Tidy updateLink and updateAllLinks
    
    Went through test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 480a445991b587f6bf8573861d113159c0fd4a3b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon May 9 21:14:17 2016 -0400

    Bug 16490 - Add an "add to cart" link for each search results in the staff client
    
    This patch adds an "add to cart" link to each line of search results in
    the staff client.
    
    To test, apply the patch and clear your browser cache if necessary.
    
    - Enable the intranetbookbag system preference.
    - Perform a search which will return multiple search results.
    - Each result should have an "Add to cart" link.
      - Clicking the "Add to cart" link should add the title to the cart,
        triggering the correct pop-up message and changing the link to read
        "In your cart (remove)."
      - Clicking the "remove" link should remove the title from your cart
        and trigger the correct messages.
    - Add multiple titles to your cart and perform the same search again.
      Each result should correctly indicate which titles are already in your
      cart.
    - Open the cart popup window.
      - Check the checkbox for one or more titles in your cart and choose
        "Remove." The titles should be removed, and the "In your cart" label
        in the search results page should reflect that the titles are no
        longer in the cart.
      - Choose "Empty and close." All titles in the parent page should now
        indicate that they are not in the cart.
    - Disable the intranetbookbag preference and confirm that the "Add to
      cart" links are no longer there.
    
    Followed test plan. Works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 24729ff8f99e3e96cb5fd1b3cd9af0616cc38e55
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon May 9 11:15:28 2016 -0400

    Bug 16477 - Improve staff client cart JavaScript and template
    
    This patch makes several changes to the cart JavaScript and template. In
    the template:
    
    - Remove "onclick" attributes in favor of defining events in the
      JavaScript.
    - Add a [% BLOCK %] section for some repeated markup.
    - Add some Font Awesome icons (I didn't add icons to all controls
      because I thought it looked cluttered).
    - Move the batch modification control out of the toolbar and into the
      group of controls which affects selected records. I think this is a
      logical grouping, and makes more sense than having a drop-down menu in
      the toolbar with a single menu item.
    
    JavaScript:
    
    - Created separate "cart.js" file so that JS could be moved out of the
      template without loading up basket.js with event functions which are
      not needed on every page in the staff client.
    - Fix JSHint errors.
    
    To test, apply the patch and clear your browser cache if necessary.
    
    - Add multiple items to the cart in the staff client and open the cart.
    - Confirm correct functionality of these toolbar buttons:
      - "More details" (and the corresponding "Show less")
      - "Send"
      - "Print"
      - "Empty and close"
    - Confirm the correct functionality of all the selection controls:
      Select all, clear all, Remove, Add to a list, Place hold, Batch
      modify, and Batch delete.
    - Confirm that clicking any title in the cart opens the correct detail
      page in the parent window.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=1647
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7a3b5ee04b801a5d7bfaf190c6cbc5bb53359fff
Author: Katrin Fischer <Katrin.Fischer.83@web.de>
Date:   Mon May 9 23:26:51 2016 +0200

    Bug 16472: Update MARC21 de-DE frameworks to update 22 (April 2016)
    
    To test:
    1) Start with a fresh database
    2) Check mandatory bibliographic and authority files
       load without problem using the German web installer
    3) Check new fields/subfields are ok
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Not a german speaker but seems right :)
    File loads without problem.
    No errors
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9cb7244433cf446232cfcc8a22f333cdcd8db1db
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 6 11:40:00 2016 -0400

    Bug 16469 - Remove the use of "onclick" from some catalog pages
    
    This patch removes the use of "onclick" attributes from two
    catalog-related templates: The local cover image viewer and the search
    results page. Events are now defined in JavaScript.
    
    To test:
    
    On the search results page:
    
    - Perform a catalog search which will return multiple results.
    - On the search results page, confirm that the "Select all" and "Clear
      all" links at the top of the results table work correctly.
    
    In the local cover image viewer:
    
    - The LocalCoverImages and AllowMultipleCovers system preferences must
      enabled, and at least one catalog record must have at least two local
      cover images attached.
    - Locate that record in the catalog and view the detail page for it.
    - Click the cover image in the "Images" tab to go to the image viewer
      page.
    - Clicking each local cover image thumnail should correctly display the
      larger version of each image.
    
    Signed-off-by: Nikos Chatzakis, Afrodite Malliari <nchatzakis@datascouting.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dd867b10b81ff34020fb036549bceb815238bea2
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 6 12:15:33 2016 -0400

    Bug 16468 - Remove last "onclick" from the stage MARC records template
    
    This patch reviseds the stage MARC records template, removing
    one more "onclick" attribute from the markup and defining that event in
    the script.
    
    This patch also corrects a missing quotation mark in the HTML. I have
    done some reindentation to that section.
    
    To test, apply the patch and go to Tools -> Stage MARC records for
    import.
    
    - Select a MARC file for import.
    - Click the "Upload file" button.
    - Click the "Stage for import" button. Your import should be correctly
      staged.
    
    Signed-off-by: Claire Gravely <c.gravely@arts.ac.uk>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b77bd31fbf9c3a1b1feaa29a61e9d0805a1dec2d
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon May 16 14:01:34 2016 -0400

    Bug 16400 [Follow-up] Proposal to uniform the placement of submit buttons
    
    This follow-up makes some corrections to the markup of the cancel
    button:
    
    - Use <a> instead of <button> to eliminate the need for an "onclick"
      attribute.
    - Remove the "cancel" class which adds unwanted padding.
    - Correct the destination of the cancel button when cancelling during an
      edit (should redirect to the patron detail page).
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f9d239dabad5459bf08dbf135f57d8186ff11e3c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 16 11:56:04 2016 +0100

    Bug 16400: Use the fa-times icon for Cancel
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 82dbf05f542d7bc9cf5c8607b0ecf182b8c2c076
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 13 15:04:47 2016 +0100

    Bug 16400: Restore the previous stack order behavior
    
    When updating the plugin, the stack order behavior has changed. This
    patch restores the prevous behavior (not always z-index: 1000)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3fe6398c22cd578af99bba6d821a01e6ca5193fe
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 3 15:03:38 2016 +0100

    Bug 16400: Reintroduce the floating class
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c1f101e86c717ceaccf781de0f1c05dc23c8272a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 29 19:01:10 2016 +0100

    Bug 16400: Let's hack the fixFloat plugin to fix our needs
    
    On comment bug 11088 comment 2, Owen explained the problem with the
    fixFloat toolbar. Since we have a hidden div, the plugin does not manage
    to place the toolbar correctly.
    In order to make it work, this patch adds some changes to the plugin to
    add the ability to define our own offset.
    When the div is extended (+, filteraction_on), the offset should be
    updated to move the toolbar. Same when the div is folded (-,
    filteraction_off)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0d6ff551741ee3f9242b1a4e917376817771d5d0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 29 18:17:01 2016 +0100

    Bug 16400: Update the fixFloat plugin
    
    I have updated it just in case it fixed the issue.
    I don't think there are big changes between our current version and this
    one, so keep it up-to-date
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 54451b66a15e7b1808001c8a8fdaef10194ed685
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 24 13:32:35 2016 +0000

    Bug 15485 - DBRev 16.06.00.004
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 609f5371288d2876b52cd086aeabf5e07ae08537
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jun 22 14:52:03 2016 -0300

    Bug 15485: (QA followup) Simplify logic and use *ResultsDisplay value during upgrade
    
    This patch makes the new sysprefs work as the previously defined. Instead of falling back
    to what *ResultsDisplay is set, it now has its own 'default' (that still defaults to the
    *Results*.xslt).
    
    The default values are set to 'default' as the rest of XSLT-related sysprefs, and the upgrade
    picks whatever is set in OPACXSLTResultsDisplay and XSLTResultsDisplay so current behaviour
    is preserved.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    New XSLTs for Lists work as advertised
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit add61ef614d171dbc4ecda95ec8cfb70a1ad40a0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 14 13:16:13 2016 -0300

    Bug 15485: (QA followup) Fix behaviour and default values
    
    Jonathan noticed the current behaviour is that the lists rendering
    falls back to the XSLTResults, and if not defined (i.e. != 'default' and
    != some_path) it falls back to a legacy display (non-XSLT).
    
    The patchset changed this behaviour because 'default' is not a valid value
    for the lists. So it should fallback to the current behaivour (i.e. Results
    XSLT configuration) if not defined. This patch fixes this by adding
     || C4::Context->preference('XSLTResultsDisplay')
    (and the OPAC counterpart).
    
    It also fixes minor glitches on the update message (oops) and bad default value
    in sysprefs.sql  for 'XSLTListsDisplay'.
    
    Thanks Jonathan!
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 04143f6a9cf2247d8c3db9da2f492f311dc753ec
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 7 23:58:38 2016 -0300

    Bug 15485: Use lists-specific XSLT sysprefs
    
    This patch makes the shelves.pl (staff) and opac-shelves.pl scripts
    use the new sysprefs for specifying custom XSLTs for lists display.
    
    XSLT.pm is patched so it defaults to the corresponding *Results.xsl
    files if none is specified.
    
    To test:
    - Create a list
    - Open the list in the staff interface
    - On a new tab, open the list in the OPAC.
    - Apply this patches
    === default behaviour
    - Open the list (both opac and staff) on new tabs
    => SUCCESS: They look exactly the same (hint: the syspref is set to ''
       so it should fallback to using the one we were using.
    === using the new functionality
    - Create custom XSLTs for lists, for example:
      $ cd /home/vagrant/kohaclone/koha-tmpl/opac-tmpl/bootstrap/en/xslt
      $ cp MARC21slim2OPACResults.xsl MARC21slim2OPACLists.xsl
    - Edit your sysprefs, setting OPACXSLTListsDisplay to:
      /home/vagrant/kohaclone/koha-tmpl/opac-tmpl/bootstrap/{langcode}/xslt/MARC21slim2OPACLists.xsl
    - Reload the OPAC list view
    => SUCCESS: Looks exactly as before
    - Make some minor tweak (for example in line 423 replace
      <xsl:text> </xsl:text>
    for
      <xsl:text> BLAH </xsl:text>
    - Reload the list
    => SUCCESS: BLAH shows in several places on the title.
    - Repeat for the staff interface
    - Sign off :-D
    
    So we can now set custom XSLTs for lists.
    
    Sponsored-by: Carnegie Stout Library
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Deb Stephenson <DStephen@dubuque.lib.ia.us>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e0911b0c4c11e894bb7303c4afb8324942887af1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 7 23:55:25 2016 -0300

    Bug 15485: Introduce new sysprefs for lists XSLTs
    
    This patch introduces two new sysprefs, allowing the users to
    set custom XSLTs for lists display. This is done almost the usual
    way.
    
    If none is specified (value='') it defaults to the current behaviour:
    using the *Results.xsl file for the corresponding interface.
    
    Sponsored-by: Carnegie Stout Library
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Deb Stephenson <DStephen@dubuque.lib.ia.us>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 602246306a1b33f73e22556f3744d7f72cac377a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 24 13:26:51 2016 +0000

    Bug 3669 [QA Followup] - Give the text area some breathing room
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 71ea7e2ba5b8a44f1a8fb292b66f9ed3a6a0eb45
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jun 12 11:08:44 2016 +0100

    Bug 3669: Remove parameters passed to action of form
    
    Sounds weird to pass parameters to the action of a POST form.
    This patch adds a workaround.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 573f1ac474d6c3d4eaba0422f30981aca02a3e8b
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Mar 24 00:28:42 2016 +0000

    Bug 3669: Moving 'Add a new message' into a pop up box and adding to patron toolbar
    
    This patch moves all the code into an include which can be accessed from the 'Add a new message' link or the patron toolbar.
    
    EDIT: Ensuring modal opens on all pages
    EDIT2: Once the form has been submitted the page will redirect to where you submitted the form from.
    EDIT3: Fixing indentation of member-add-message.inc
           Ensuring messages save on every page
           Fill branch
           Ensure predefined notes appear
           Form redirects to where it was submitted from, or just the circulation page.
    EDIT4: Removing the new include file and moving it all into the modal in the toolbar
    EDIT5: Removing swp file and unnecessary code duplication by utilising plugins
    EDIT6: Batch checkout fixes
    EDIT7: Ensure you do not get JS error from Comment 24 (Batch checkout syspref must be turned on)
    
    To test:
    1) Go to a patron circ page (circ/circulation.pl?borrowernumber=X)
    2) Click 'Add a new message' under Messages
    3) Confirm this brings up the modal to add a message. Confirm clicking Save saves your message. If it is an OPAC message (for the user), confirm it shows as expected on the OPAC.
    4) Click Cancel. Confirm this closes the modal.
    5) Click 'Add message' button in toolbar. Complete steps 3 and 4.
    6) Confirm the modal opens from all other pages with the members toolbar. Confirm predefined notes shows.
            circ/circulation.pl
            members/moremember.pl
            members/routing-lists.pl
            members/statistics.pl
            members/boraccount.pl
            members/pay.pl
            members/maninvoice.pl
            members/mancredit.pl
            members/readingrec.pl
            members/notices.pl
            members/member-flags.pl
            members/member-password.pl
            members/paycollect.pl
            members/files.pl
            turn on BatchCheckouts syspref and put in appropriate patron category
            circ/circulation.pl?borrowernumber=X&batch=1
    7) Confirm that the page redirects to where you submitted the form from once you have submitted it.
    8) Go to Check Out tab and confirm your message saved (or OPAC, wherever you saved it)
    
    Sponsored-by: Catalyst IT
    
    Followed test plan, works as expected. (Re-tested for comment #24)
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3e566de51fe6f2e966158f97682f9a5aaecab974
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jun 16 13:03:30 2016 +0200

    Bug 16751: What is sitemaper?
    
    s/sitemaper/sitemapper/
    
    Test plan:
    Run t/db_dependent/Sitemapper.t
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0712048030c44ba731780916935f6d9d352d4c0b
Author: Marc Véron <veron@veron.ch>
Date:   Mon Jun 13 14:21:47 2016 +0200

    Bug 16718 - Translatability: Fix problems with sentence splitting by <strong> in about.tt
    
    This patch removes sentence splitting by <strong> tags in
    koha-tmpl/intranet-tmpl/prog/en/modules/about.tt for better translatability.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2289c8c93014b7d9c14444d121651277bcee6232
Author: Marc Véron <veron@veron.ch>
Date:   Thu Jun 9 15:34:54 2016 +0200

    Bug 16697: Translatability: Fix problem with isolated "'s"in request.tt
    
    This patch fixes translation problems with tag-isolated 's in
    koha-tmpl/intranet-tmpl/prog/en/modules/reserve/request.tt
    
    The patch fixes it at two places. In consequence, some other texts
    ares sigthly changed to make them look similar.
    
    To test:
    - Inspect code changes and verify that the new wording makes sense.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a4f80ab223adc8bb3145a921153c578219e91f5d
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Thu Jun 16 09:54:29 2016 -0600

    Bug 16742: (follow-up)Remove unused template subject.tt
    
    Delete extra useless comment line:
    "# if its a subject we need to use the subject.tt"
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit cf441013a5b1f525c9be38e5f3a76e47925a3703
Author: Marc Véron <veron@veron.ch>
Date:   Wed Jun 15 14:28:31 2016 +0200

    Bug 16742: Remove unused template subject.tt
    
    The template koha-tmpl/intranet-tmpl/prog/en/modules/catalogue/subject.tt
    is not used and can be removed.
    
    To test:
    - Apply patch
    - Verify that catalogue/moredetail.pl works as before (go to a
      biblio with items and click 'Items' in left hand menu)
    
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0c1fa2f93c30a363b8b6cf9eaf2a93979b61adf9
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Jun 14 17:05:58 2016 +0200

    Bug 16736 - Keep branch filter when changing suggestion
    
    When changing suggestion, the selected tab is kept.
    The same should be done with the selected branch.
    
    Test plan:
    - Go to suggestions table : /cgi-bin/koha/suggestion/suggestion.pl
    - Select a branch in Acquisition information > For
    - Select a pending suggestion
    - Change status as accepted
    - Click on Submit
    => without patch, the table is no longer filtered by branch
    => with patch, the table is filtered by branch
    
    Works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d69d874a3f749687c2ff9a8d2a400378dfc94ff6
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jun 3 11:31:44 2016 +0200

    Bug 16644: Plack: Use to_app to remove warning about Plack::App::CGIBin instance
    
    Using Plack with the debian psgi file, I get lots of warnings like:
    WARNING: Automatically converting Plack::App::CGIBin instance to a PSGI code reference. If you see this warning for each request, you probably need to explicitly call to_app() i.e. Plack::App::CGIBin->new(...)->to_app in your PSGI file.
    
    This patch is aimed to eliminate the warns.
    
    Test plan:
    Run Plack with plack.psgi or koha.psgi and verify if you do not see these
    warnings anymore.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    I tested on Jessie and I see no regressions.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 38d1a1862dcc26e284953fd383150816a183a7d5
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed May 25 11:57:25 2016 -0400

    Bug 16462 - Change default sorting of circulation patron search results to patron name
    
    This patch changes the default sort of patron quick search results from
    the circulation header search or when searching for a patron during the
    hold process.
    
    To test:
    
    In Circulation:
    - Perform a search by name for a patron which will
      return multiple search results.
    - Confirm that the results are sorted by patron name.
    
    In the catalog:
    - Locate and place a hold on a title.
    - When prompted to select a patron to place the hold for, perform a
      search by name which will return multiple results.
    - Confirm that the results are sorted by patron name.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1f2dcfd2e93dc444cc92e62cd8be2dbb29f7cb08
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jun 14 18:05:53 2016 +0000

    Bug 16737 - Error when deleting EDIFACT message
    
    If you try to delete an EDIFACT message it triggers an error:
    
    Can't use string ("2") as a subroutine ref while "strict refs" in use at
    /acqui/edifactmsgs.pl line 43.
    
    Test Plan:
    1) Attempt to delete an EDIFACT message
    2) Note the error
    3) Apply this patch
    4) Attempt to delete an EDIFACT message again
    5) Note it succeeds
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e5bb0fac3f9953379b80752cd9df2120ccc0612f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 14 11:36:30 2016 +0100

    Bug 16731: Use INSERT IGNORE when inserting a syspref
    
    IGNORE should be used to allow backporting (and local patch)
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 27de2ece61f68c60602eec1a179be9e19b0bdd46
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 13 18:19:46 2016 +0100

    Bug 16724: Fix link to the online documentation links
    
    Since the numbering changes, the online doc links are broken.
    
    Test plan:
    Make sure the online doc links work on the help pages.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4491780ecc53eba9f038da786060927197e0ecad
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jun 22 11:06:10 2016 -0400

    Bug 16708 - (QA followup) Fix pod copy/paste error
    
    Change Koha::Authority to Koha::MetadataRecord::Authority
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1e39ecc7f15f493f96bb1e65e9791e5a9ea320d8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jun 10 14:23:08 2016 +0100

    Bug 16708: Fix authority reindex for ElasticSearch
    
    The changes made to Koha::Authority has not been correctly fixed.
    The code of Koha::Authority has been moved bo
    Koha::MetadataRecord::Authority by bug 15380.
    
    Test plan:
      perl misc/search_tools/rebuild_elastic_search.pl -a -v
    should success
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e1d6974bff1cc7290d792a4e6ac81e7d32b0c375
Author: Nguyen Duy Tinh <duy-tinh.nguyen@biblibre.com>
Date:   Fri Jun 10 10:14:12 2016 +0000

    Bug 16705 - Add missing status to serials history in OPAC
    
    The bug is related to 10851. Due to add of status in 10851, status added were
    missing in opac-detail.tt and opac-full-serial-issues.tt. The patch just added
    these missing status.
    
    To test:
    1) Create New subscription in Serials, in Intranet
    2) Do a search of the new subscription by Title
    3) Take Serial receive as Actions to edit the status to Missing (<something>)
    4) Go to Opac and Search the subscription created, by its title and See missing status
    5) Apply patch, status must be showed.
    6) Sign off
    
    Followed test plan, works as expected.
    Amended to format commit title and message.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6f0ce92543319d243cf185e3df9f91a9cf7f6d87
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 7 12:02:06 2016 +0100

    Bug 16624: Fix regression displaying a letter with hours
    
    Bug 13622 has introduced a bug, if pref TimeFormat is 12hr and a date is
    displayed in both title and content of the letter.
    
    Test plan:
    1 - Checkout an item (with default time 11:59:00 PM)
    2 - Generate a quickslip
    3 - Notice the time is 'AM'
    4 - Apply patch
    5 - Generate quickslip
    6 - Note time is correct
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 47e41ea1c28a2aa265950e0645e402a3ac4c39d8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 7 12:00:59 2016 +0100

    Bug 16624: Add regression tests
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2af028bb13273d2b13f6e5cf417436fc0c8764f7
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri May 27 14:12:20 2016 +0000

    Bug 16612 - Cannot set "Until date" for "Enrollment period" for Patron Categories
    
    Attempting to set an "Until date" date for "Enrollment period" will
    result in the date being accepted but not saved.
    
    Test Plan:
    1) Attempt to set an enrollment period until date for a new patron category
    2) Note the period is not saved
    3) Apply this patch
    4) Attempt to set the enrollment period date again
    5) This time it should save!
    
    Signed-off-by: Andrew Brenza <abrenza@audubonlibrary.org>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 779fa7c6da03fd3173de4a5c21d5615b83ac3ee4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 26 12:33:13 2016 +0100

    Bug 16591: Fix CSRF in opac-memberentry
    
    If an attacker can get an authenticated Koha user to visit their page
    with the code below, they can update the victim's details to arbitrary
    values.
    
    Test plan:
    
    Trigger
    /cgi-bin/koha/opac-memberentry.pl?action=update&borrower_B_city=HACKED&borrower_firstname=KOHA&borrower_surname=test
    
    => Without this patch, the update will be done (or modification
    request)
    => With this patch applied you will get a crash "Wrong CSRF token" (no
    need to stylish)
    
    Do some regression tests with this patch applied (Update patron infos)
    
    QA note: I am not sure it's useful to create a digest of the DB pass,
    but just in case...
    
    Reported by Alex Middleton at Dionach.
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2279a2fea05bc4d6e27b239f45c5d5733a37eef2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 24 11:53:02 2016 +0000

    Bug 11490 - DBRev 16.06.00.003
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b2c55ecdd7ad128c7ec923e70b13b1f287c7d00
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 11 14:10:49 2016 +0100

    Bug 11490: Split MaxItemsForBatch into 2 prefs to clarify things
    
    Prior to this patch, a single pref (MaxItemsForBatch) was used to
    restrict the use of the batch item modification and deletion.
    
    On the batch modification tool, the pref is used to limit the number of
    items a librarian is allowed to modify in a batch, but on the batch
    deletion tool the pref is used to limit the number of items to display.
    
    To clarify things, this patch split the pref into 2 new prefs:
    MaxItemsToDisplayForBatchDel and MaxItemsToProcessForBatchMod.
    
    Later we could add a MaxItemsToProcessForBatchDel if needed.
    Note that this patch should not introduce any changes in the current behaviors.
    
    Test plan:
    0/ Do not execute the update DB entry
    1/ Set a value != 1000 for MaxItemsForBatch
    2/ Execute the update DB entry and confirm that the 2 new prefs are
    initially set with the value of MaxItemsForBatch and that
    MaxItemsForBatch has been deleted
    3/ Set different values for these 2 prefs (2 and 3 for instance to ease
    the next steps)
    4/ Try to delete less than MaxItemsToDisplayForBatchDel items
    => You must see the items details
    5/ Try to delete more than MaxItemsToDisplayForBatchDel items
    => You must not see the items details but are allowed to delete them
    6/ Try to modify less than MaxItemsToProcessForBatchMod items
    => You must see the items details
    7/ Try to modify more than MaxItemsToProcessForBatchMod items
    => You must be restricted and not allowed to process
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 20f42350488ccd2795af3863ab1954d22b92eeae
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 11 14:10:41 2016 +0100

    Bug 11490: Add prefs MaxItemsToProcessForBatchMod and MaxItemsToDisplayForBatchDel
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0d690ca383f49d62b1b040004e960596e1a39b2d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 11 15:27:04 2016 +0100

    Bug 16707: Fix software error in OPAC password recovery when leaving form fields empty
    
    The $search_results is considered as an arrayref but is not defined if
    no patron matches the recovery infos.
    
    Test plan:
    - Set syspref OpacResetPassword to "Allow"
    - Go to OPAC
    - Click link "Forgot your password?
    - On the following screen "Forgotten password recovery", do not fill in
      form fields, click "Submit"
    => Without this patch you got the software error
    => With this patch apply, you will get "No account was found with the
    provided information."
    
    Sign-off on counter patch.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 574bff5c6f2472eda5da58eeec84018abe4e4711
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 7 10:45:35 2016 +0100

    Bug 16680: (bug 13918 follow-up) Display library names for holds in transit
    
    Regression introduced by bug 13918: the library names are not displayed
    anymore for holds in transit.
    They are 2 warns in the logs:
    No method wbrname! at
    /home/koha/src/koha-tmpl/opac-tmpl/bootstrap/en/modules/opac-user.tt
    line 603.
    No method wbrcd! at
    /home/koha/src/koha-tmpl/opac-tmpl/bootstrap/en/modules/opac-user.tt
    line 603.
    
    Test plan:
    Make sure you have holds in transit and go the opac-user.pl
    In the "Holds" tab, you should see "Item in transit to LIBRARY NAME"
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f01720808a574af9872ef3f562a8f3cee7f81060
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 26 11:52:19 2016 +0100

    Bug 16593: Do not allow patrons to delete search history of others patrons
    
    A malicious user can delete the search history of all other users by
    correctly guessing the ID value assigned to the victim's search. As
    searches are assigned values sequentially, an attacker could quickly
    remove the searches belonging to all of the application's users.
    
    To reproduce:
    Login with patron A
    launch a search
    Note the id generated for this search history:
    select id from search_history order by id desc limit 1;
    Login with patron B
    Hit /cgi-bin/koha/opac-search-history.pl?action=delete&id=<ID>
    Note that the row is deleted in the DB
    
    Test plan
    Confirm that this patch fixes the issue.
    The same test can be made at the staff interface
    
    Reported by Alex Middleton at Dionach
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 33f1354b7b50390b43e5a2f66e1abe58817e6d4d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 21 09:10:46 2016 +0100

    Bug 16527: Restore sticky due date behavior
    
    Bug 10067 has introduced a regression on the sticky due date behavior:
    If "remember for session" is checked and the due date is changed from 1
    checkout to another, the old due date will be used.
    
    The code added by bug 10067 is really confusing and it's hard to say
    this patch won't introduce another regression.
    The manipulation of $restoreduedatespec, $duedatespec and $stickyduedate
    is not easy to follow.
    
    Test plan:
    Confirm that the regression is fixed and that this patch will not
    introduced a regression on bug 10067 (good luck!)
    
    Signed-off-by: Eivin Giske Skaaren <eivin@sysmystic.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f1fa65f6375b73b8e2aff3139885971f08bb27a3
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 17 16:29:33 2016 +0000

    Bug 16534: (followup) - Tidy AddIssue
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fe02c9fdf0550caf0b9a7e0f4b1138260c94abc9
Author: Marc Véron <veron@veron.ch>
Date:   Mon May 23 07:48:10 2016 +0200

    Bug 16534: (followup) Correct tiny typo
    
    This patch corrects "...must be return..." to "must be returned..."
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1a9674fd3a8d8c898d8dc208d6e3d0296daeca40
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun May 22 10:01:56 2016 +0100

    Bug 16534: Block AddIssue from issuing if the return is not possible
    
    To make sure the return can be done, AddIssue must not trust callers (they
    should have done their job, but we are not sure) and check that the issue can
    be returned before issuing to the patron.
    
    There is no test plan here, this should not be possible from the Koha
    interface.
    However, looking at the code, it may be possible using SIP.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a879efb574028be78f0706f36bd5e1e11d54dfc2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun May 22 10:03:11 2016 +0100

    Bug 16534: Add tests for AddIssue
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9427d44568e6d52fde3960bda3ad957ca6a5b7fe
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun May 22 10:01:48 2016 +0100

    Bug 16534: Make CanBookBeIssued test if the issue can be returned
    
    If an issue is already checked out, CanBookBeIssued must check if the
    issue can be checked in before processing the return.
    In such cases (depending of the AllowReturnToBranch pref), the issue
    should not be allowed.
    
    Prior to this patch, the checkin was not done and the checkout failed
    with "Duplicate entry '1204321' for key 'itemnumber'". Indeed since bug
    14978, there is an uniq key on issues.itemnumber. Before bug 14978 the
    issue existed but was hidden (and some weird behaviors certainly
    happened!).
    
    To avoid Koha to crash, a check is added to CanBookBeIssued (call to
    CanBookBeReturned) and the librarian is not able to process the
    checkout.
    
    Test plan:
    
    - Set AllowReturnToBranch to anywhere
    - Check an item (homebranch Library 1, holding branch Library 1) out from Library 1
    - Check the item out from Library 2
    => Confirm the checkout (should work with and without this patch)
    
    - Set AllowReturnToBranch to holdinbranch ("only the library the item
      was checked out from").
    - Check an item (homebranch Library 1, holding branch Library 1) out from Library 1
    - Check the item out from Library 2
    => Without this patch, Koha crashed
    => With this patch, you will be warned that the checkin is not possible.
    
    Try other combinations of the AllowReturnToBranch syspref
    
    Followed test plan, works as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2c88538946e05feb65aa5b0f9007882a0ce6ac73
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun May 22 10:02:44 2016 +0100

    Bug 16534: Add tests for CanBookBeIssued & AllowReturnToBranch
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 87dbed0abd67e88ae85f633d9f4c63c38a2f7e24
Author: Marc Véron <veron@veron.ch>
Date:   Thu Jun 16 09:27:55 2016 +0200

    Bug 16747 - Patron card creator broken with version 16.05
    
    To reproduce:
    - Prepare a patron car layout with Image 1 using Patron Image
    - Create a patron card for a patron without patron image
    Result: OK, PDF can be opened wit PDF viewer
    - Try to create a patron card with a patron who has a patron image
    Result: The PDF file is corrupt (contains text only with error message)
            intranet error log contains: create-pdf.pl: Illegal division
            by zero at /usr/share/kohaclone/patroncards/create-pdf.pl line 200
    To test:
    - Apply patch
    - Create a patron card with a patron who has a patron image
    Result: PDF is OK and contains the image
    
    Bonus test: Do the same with a card layout with an additional image
    (Image 2: Image source: Other image)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Test and bonus test pass: PDF generated without errors.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a96d496c9b8860e493f2d6993ba033b13b8b8b80
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 17 15:37:24 2016 +0000

    Bug 16148 [Follow-up] - Use Font Awesome for arrows instead of images
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8fd3170296aec71d9a3d97937d27c93c299033ee
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 14 16:16:13 2016 +0100

    Bug 16148: Fix submit button text
    
    The text of the submit button should be init getting the val(), and not
    the text().
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fe32cc2a309b39930c42c9be73f372a80aac54ba
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jun 14 10:26:25 2016 -0400

    Bug 16148 [Follow-up] Revised layout and behavior of marc modification template management
    
    This follow-up corrects a JavaScript error by using jQuery, which is is
    more forgiving when selecting elements which may not exist on the page.
    
    Also changed: Corrected a duplicate class attribute and fixed a jshint
    error.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2d15bc5355cb53780e5cdbf410c787a5d6ac16a7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 6 14:43:37 2016 +0100

    Bug 16148: Add preventDefault to avoid the scrollbar to move to the top
    
    .. when click on buttons
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f75befdbedd2dd8540c8c3fcfa81c12af45c438e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Mar 25 09:47:11 2016 -0400

    Bug 16148 - Revised layout and behavior of marc modification template management
    
    This patch makes changes to the layout and behavior of the marc
    modification template management page to make it adhere better to common
    interaction patterns in Koha.
    
    - The initial view shows a list of templates rather than pre-selecting
      the first available template for editing.
    
    - A toolbar has been added with a "New template" button.
    
    - The initial view of existing templates has an actions menu containing
      menu items for 'Edit actions,' 'Duplicate,' and 'Delete.' It doesn't
      appear to be possible to edit an existing template's name.
    
    - The "Create template" form is no longer shown all the time.
      - Clicking the "New template" toolbar button triggers a modal with the
        form for creating a template. An existing template can be chosen to
        duplicate.
      - Choosing "Duplicate" from one of the template menus triggers the
        "New template" modal and preselects the corresponding template in
        the "duplicate" <select>.
    
    - When editing actions for a template:
      - The breadcrumbs menu now reflects that a template is being modified.
      - The template name has been added as a heading.
      - A "New action" button appears in the toolbar
      - The "Edit" and "Delete" links now have a Bootstrap button style.
      - The add/edit form is now hidden by default.
      - Clicking "New action" or "edit" shows the add or edit form.
      - Clicking "Cancel" in the add/edit form hides the form.
    
    To test, apply the patch and clear your cache if necessary.
    
    - Got to Tools ->  MARC modification templates
    - Test the "New template" button.
      - Confirm that new template creation works.
      - Confirm that duplicating a template works.
    - Test the menu items in the "Actions" menu:
      - "Duplicate" should trigger the new template modal and preselect the
        template you chose to duplicate. Confirm that the template is
        successfully duplicated.
      - "Delete" should prompt you to confirm the deletion. Test both
        cancelling and confirming this operation.
      - "Edit actions" should load the page for adding or editing actions to
        a template. Test the operations on this page: New action, edit,
        delete, changing action order.
    
        Note that this patch does not fix Bug 15814, so action descriptions
        must still not contain single quotes.
    
    Signed-off-by: Filippos Kolovos <f.kolovos@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 555f40626ab34eccadec66091e54e203a9be4440
Author: Marc Véron <veron@veron.ch>
Date:   Tue Jun 14 07:07:05 2016 +0200

    Bug 16729: Use member-display-address-style*-includes when printing user summary
    
    This patch replaces the address part in moremember-print.tt to print identical
    address information as displayed on the screen (including street numer, formatted as required by syspref 'AddressFormat'
    
    To test:
    - Apply patch
    - Search for a user with all address information filled
    - Verify that 'Print summmary' displays the same information
      as displayed on the screen.
    - Change value of syspref 'AdressFormat'
    - Verify that address format on 'Print summary' changes
      as appropriate
    
    Signed-off-by: mehdi <mehdi@inlibro.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c92d0823f8b79c1bb8f01b4a429961e5f3e5574c
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Jun 8 13:47:58 2016 +0200

    Bug 16693: Remove reserve/renewscript.pl
    
    It is not used since bug 11703
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8fac12d7f1ecfd44f9288aea6cf54efecc883b84
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 14 10:15:58 2016 +0100

    Bug 16672: Fix typo unqiue vs unique
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a98a3bea2a5e98eda794e0ed25ab03fa57f9d85f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jun 13 18:26:22 2016 +0000

    Bug 16672 [QA Followup] - Convert negative days to positive days
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bf6300975889c65cd2e9e867fe2a261ff973bbaf
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jun 6 13:52:45 2016 +0000

    Bug 16672 - Add ability to remove expired holidays from special_holidays
    
    It would be very helpful if the cleanup_database.pl script had the
    ability to delete holidays from the special_holidays table there were
    older than a given number of days in the past.
    
    Test Plan:
    1) Apply this patch
    2) Create some unique holidays in the past of varying ages
    3) Test the new switch '--unique-holidays DAYS' for cleanup_database.pl
    4) Verify only holidays older then the specified number of days are removed
    
    NOTE: The language 'unique holdays' is used in the interface to match
          it's use in the staff web interface.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ae4be45444dd8e6a65dc7170cfc43c60de328f38
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed May 25 10:49:26 2016 -0400

    Bug 16543 - Make edit and delete links styled buttons in patron attribute types administration
    
    This patch modifies the Patron attribute types page, converting edit and
    delete links to Bootstrap buttons with Font Awesome icons.
    
    To test, apply the patch and go to Administration -> Patron attribute
    types. The 'Edit' and 'Delete' buttons should look correct and work
    correctly.
    
    Signed-off-by: Jan Kissig <jkissig@th-wildau.de>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 51a11d279457f97ac1b30e99d1af38a344d01725
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed May 25 10:56:13 2016 -0400

    Bug 16541 - Make edit and delete links styled buttons in cities administration
    
    This patch modifies the cities administration page, converting edit and
    delete links to Bootstrap buttons with Font Awesome icons.
    
    To test, apply the patch and go to Administration -> Cities and towns.
    The 'Edit' and 'Delete' buttons should look correct and work correctly.
    
    Signed-off-by: rainer <archiv@a-bibliothek.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 45fbcb9fda8776dc78556efd99076ce8fc8b4f97
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 14 11:09:42 2016 +0100

    Bug 16456: Reintroduce wording "Delete tag"
    
    "Delete tag" seems more appropriate than "Delete" on this tag, but I may
    be wrong.
    
    This patch also removes an extra space.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2a6a3de7c407724d2778be8bf422b1222910e4a7
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Fri May 13 23:40:25 2016 -0600

    Bug 16456: Add Font Awesome icons to some buttons in Tools module, section Patrons and circulation
    
    Add Font Awesome Icons to section Patrons and circulation in Tools module.
    Also correct a error dialog in JQuery functions
    
    To test:
    -Apply patch
    -Goto Tools -> Patron list -> my_list_saved -> Add patrons -> Remove selected patrons,
     Clear all, Select all.
    -Add new patron list and add some patrons, notice about the trash icon.
    -Make some comments in some bib records and goto Tools->Comments
     you will presented with two tabs "Approved comments" and
     "Comments awaiting moderation".
     See the three new buttons: Approve, Delete, Unapprove.
    -Set syspref TagsModeration to Require. This will show all pending tags to review.
    -Make some tags in bib records and goto Tools -> Tags.
    -Notice about the new look.
    -In the new screen look the icons in buttons "Apply filter(s)", "Test", "Approved",
     "Reject". Notice about the new header bar above the DataTable with options: Select all,
      Clear all, Select all pending.
    -Play with filters; Check if terms exist or not in appoved/rejected lists
    -Play with Terms summary and see if DataTable is working as expected
    -Click in some term tag with multiple titles
    -A table with titles tagged with the term is presented
    -See the new button 'Remove'
    -Verify if you can remove tag from a selected title.
    -Verify that all tools work as expected
    
    NOTE: The Tag and Comments tools has been revised to fit with others
    interfaces in Koha.
    Bug ammended according with QA comment 5
    Bug rebased because bug 16005
    Test plan amended for clarity
    Clock icon for "Select all pending" removed (QA comment 23).
    Fix some forbidden patterns (tab char) in review.tt according by IRC comment
    by Marc Veron
    
    Followed test plan, looks and works as expected
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 981302a47322857b080107a71c47db2345ef5286
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 31 10:08:03 2016 -0400

    Bug 16127 - Add discharge menu item to patron toolbar
    
    This patch changes the "Discharge" menu in the patron sidebar to read
    "Discharges," and adds a "Discharge" menu item to the patron toolbar.
    
    This adds some redunancy, but fits with the pattern of including "views"
    in the sidebar and "actions" in the menu. The discharge feature can be
    thought of either way.
    
    To test you must have the 'useDischarge' system preference enabled.
    
    - View the detail page for any patron.
    - Confirm that the sidebar menu reads "Discharges."
    - Confirm that the "More" menu contains a "Discharge" link which works
      correctly.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 64efee0b5cc975b3b80db1841321355eeb39fb48
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 11 14:32:05 2016 +0100

    Bug 16594: Fix obvious QA issues from bug 11371
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d4394d88eaeff5df6bf0a28ec3e6faed853b202b
Author: Héctor Eduardo Castro Avalos <hector.hecaxmmx@gmail.com>
Date:   Thu May 26 08:41:08 2016 -0600

    Bug 16594: Orders by fund report has wrong link to css and other issues
    
    Orders by fund has wrong link to css and other issues
    -> The example in the wiki is wrong: <https://wiki.koha-community.org/wiki/DataTables_HowTo>
    <link rel="stylesheet" type="text/css" href="[% themelang %]/css/datatables.css" />
      [% INCLUDE 'datatables.inc' %]
    -> Must be:
    <link rel="stylesheet" type="text/css" href="[% interface %]/[% theme %]/css/datatables.css" />
    -> Missing <th></th> in <tfoot> tag
    -> Wrong word used "Date deceived" should be "Date received"
    
    NOTE: Wiki needs to be updated
    
    To test:
    -Look the code and notice about if else cluase without curly brackets
    -Go to Reports > Orders by fund
    -Play with: in filters 'All fund' Output: 'to screen into the browser'
    -You will see a DataTable displayed in screen clutter
    -Notice about 'Date deceived' and the foot of table
    -Apply patch
    -Refresh or execute again the report
    
    Signed-off-by: Sinziana <s.paltineanu@berlin.bard.edu>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f8b73deaec5c7f55d66d52c2ca05d419f4a7c178
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 14 11:18:32 2016 +0100

    Bug 16717: Improve variable naming
    
    $category was a categorycode, to help the readability it's better to
    name it $categorycode or assign a Category to $category
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a4690353d9a20a7c991787a1ffe3040eb3834a5a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 27 13:48:10 2016 +0200

    Bug 16717: Remove hardcoded category from Holds.t
    
    There is actually no need to use the hardcoded patron category S in
    this test.
    
    Test plan:
    Run t/db_dependent/Holds.t.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Test passes OK
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2d9c270886b547c1c4973cef3c20f18e6998530a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 27 08:35:57 2016 +0200

    Bug 16607: Remove CPL/MPL from two unit tests
    
    Test t/db_dependent/Accounts.t:
    This test created a MPL branch, but did not use it any more.
    
    Test t/db_dependent/Items/AutomaticItemModificationByAge.t:
    This test still used CPL/MPL branches. Now it uses two new branches.
    
    Test plan:
    [1] Run t/db_dependent/Accounts.t.
    [2] Run t/db_dependent/Items/AutomaticItemModificationByAge.t.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Both tests pass OK
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 63fbb336bd90991a8b86ca6fe54d5a069c129373
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu May 26 21:56:50 2016 +0200

    Bug 16500: [QA Follow-up] Catch warning if branch MPL already exists
    
    The current test had no warnings, when you have no MPL branch, and only
    catches the warn from the second build on line 57. If you do have MPL,
    a warning comes from line 56.
    
    This patch fixes it by removing MPL from the test. A new branch is created
    first and then we try to create it again.
    
    Test plan:
    Run the test.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 395ac8835a582a2bb38aaa3259c4196b81142dd4
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed May 11 14:49:07 2016 +0200

    Bug 16500: Catch two warns in TestBuilder.t with warning_like
    
    When testing a wrong case in TestBuilder.t, two warns show up.
    We can catch them with warning_like.
    
    Test plan:
    Run t/db_dependent/TestBuilder.t
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b8c950a4c1b1ead8a58686b27c95f9891cdccbae
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 13 13:04:25 2016 -0300

    Bug 16720: Remove DBIx ActionLogs.pm
    
    The update_dbix_class_files.pl script generates ActionLog.pm instead, which is
    already on the source tree.
    
    To test:
    - Apply the patch
    => SUCCESS: Koha/Schema/Result/ActionLogs.pm is removed
    - Run:
      $ mysql -uroot
      > CREATE DATABASE dbic; \q
      $ mysql -uroot dbic < kohaclone/installer/data/mysql/kohastructure.sql
      $ misc/devel/update_dbix_class_files.pl --db_name dbic --db_user root
    => SUCCESS: Koha/Schema/Result/ActionLogs.pm is not re-generated
    - Run:
      $ git grep ActionLogs
    => SUCCESS: There's no code using it
    - Sign off
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 557a5989093982f41173df8267658cb1d90e76cd
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jun 8 10:24:56 2016 +0000

    Bug 16692 - Error "No method update!" when creating new serial issue
    
    An improper method call was left over in C4::Serials::NewIssue from the
    switch from DBIx::Class to Koha::Object.
    
    Test Plan:
    1) prove t/db_dependent/Serials.t
    2) Note the errors
    3) Apply this patch
    4) prove t/db_dependent/Serials.t
    5) No errors!
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 58207446755cb2533fac48252c3b70154b164feb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 6 13:31:29 2016 +0100

    Bug 16670: (bug 15823 follow-up) CGI->param should not be called in list context
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8204024f1c21102c0649dec70d10398131aab953
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon May 23 09:03:23 2016 +0200

    Bug 16502: Replace a few other ok-calls by is-calls
    
    Trivial changes that speak for themselves..
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6ad5770786c6646ce68ffdfec9080645fc25772e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon May 23 08:58:02 2016 +0200

    Bug 16502: Adjust test for GetPlugins
    
    The current test assumes that GetPlugins will return the test plugin
    as the first one in the array. This is not correct.
    This patch adjusts the test to a grep.
    
    Test plan:
    Run the test.
    Bonus: Add additional plugins. Run the test again.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 959d69fa0107423ed31e20f4a6afb46d1e5c771c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon May 16 19:00:16 2016 +0200

    Bug 16502: Add additional test to Plugins.t
    
    In order to verify if the delete now really works, we add one test
    in Plugins.t.
    
    Test plan:
    [1] Run the test.
    [2] Bonus: Comment line 63 in Plugins.t where delete is called.
        Run the test again. It should fail now.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4263ac2b92737024d8d620a751babf72b904b73a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon May 16 17:19:54 2016 +0200

    Bug 16502: Table koha_plugin_com_bywatersolutions_kitchensink_mytable not always dropped after running Plugin.t
    
    If you run Plugin.t, the above table will still be present (when you
    did not enable UseKohaPlugins). This would trigger a warning when
    running the test a second time.
    
    Why? The uninstall call does its work not completely due to a small
    inconsistency in Koha::Plugins::Handler::delete when calling run
    without the enable_plugins parameter.
    
    This patch resolves that inconsistency and also removes an unneeded skip
    in Plugin.t in case the KitchenSink module already exists.
    Note: This is a small fix. But I wonder if the Handler routines run and
    delete should not have been implemented in Koha::Plugins::Base.
    Also note that plugins/plugins-uninstall.pl will not be affacted by this
    change, since it checks whether the pref is enabled before calling the
    delete method.
    
    Test plan:
    [1] Do not yet install this patch.
    [2] Verify that plugins are enabled in koha-conf.xml.
    [3] Disable UseKohaPlugins in System Preferences!
    [4] Run t/db_dependent/Plugins.t.
    [5] Verify that table koha_plugin_com_bywatersolutions_kitchensink_mytable
        still exists. (It should have been deleted.) Remove it manually.
    [6] Apply this patch.
    [7] Run the test again.
    [8] Verify that the table does not exist.
    [9] Run the test again (without warnings).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit de6c1375f76b562970d7515192a002af8babc740
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 9 11:13:38 2016 -0300

    Bug 13074: (followup) remove useless diag
    
    On running all Items-related tests some useless diag showed up. Removing it.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8c14c25521eac92a2cb62ab5330deac2e2d5343d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 3 11:08:47 2016 +0100

    Bug 13074: Use Koha::Cache to cache the defaults values of a MARC record
    
    With the global %default_values_for_mod_from_marc variable, the changes
    made to the marc_subfield_structure table and especially the links
    between MARC and DB fields are not safe and might be outdated (if a
    field is linked/unlinked)
    
    Test plan:
    Under Plack:
    - Link the barcode field, edit a record and set a barcode.
    - Remove the mapping for the barcode field and then update again the
      barcode of the record.
    The items.barcode DB field must not have been updated.
    
    Without this patch, the field should have been updated.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 30946eff3cda31d0cc97c6c1c4f1e757dbc4c366
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 14 10:49:41 2016 +0100

    Bug 12748: findSerialByStatus has been renamed with findSerialsByStatus
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 44062c07b7703190b46701a3fa31665d998eadfb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 14 10:43:14 2016 +0100

    Bug 12748: Code tidy
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 273d5e53289536797281ca5eb323d5c373d9ea41
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 14 10:39:08 2016 +0100

    Bug 12748: Remove warning 'masks earlier declaration in same scope'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1bd5a177d0870332a959e9c773aaec80beeba74b
Author: Remi Mayrand-Provencher <remi.mayrand-provencher@inLibro.com>
Date:   Mon Feb 8 15:04:07 2016 -0500

    Bug 12748 - Add test for step 7 and 8 and rename findSerialByStatus
    
    https://bugs.koha-community.org/show_bug.cgi?id=12478
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 10fd9f5ec0d5faa7b54b0bfaf5a7b8fccd665f0a
Author: Remi Mayrand-Provencher <remi.mayrand-provencher@inLibro.com>
Date:   Tue Aug 11 11:10:45 2015 -0400

    Bug 12748 - Fixes duplicate serials with an "expected" status bug
    
    Added a new sub to Serials.pm to be able to get serials with their statuses.
    Now the sub ModSerialStatus checks for other serials with an "expected" status before doing anything.
    
    Also modified Serials.t to be able to test those changes.
    
    Test Plan
    1) Apply patch
    2) Run ./t/db_dependent/Serials.t
    3) Validate that there are no errors
    4) Go on "Serial collection information" page for a serial of your choice
    5) Click on "Generate next"
    6) Change the status of the original serial from "late" to "expected"
    7) Change the newly generated serial from "expected" to "delete"
    8) Validate that there are no new serials created by instruction 7 and that the serial was deleted
    9) Run ./t/db_dependent/Serials.t
    
    With QA Fixes
    
    - Use the constant instead of the code (1 vs EXPECTED)
    - Avoid interpolation in query
    - use selectall_arrayref instead of fetchall_arrayref
    
    Signed-off-by: Liz Rea <liz@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 42cd9ca1447f4d576d9f1ad51e275e70c8bf9249
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jun 14 16:35:49 2016 +0000

    Bug 10459 - Update Schema
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 71aa7d9ecfa5c5fa07e02dbb479c78f304338988
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 26 07:26:33 2016 -0400

    Bug 16592 - Use Bootstrap modal for MARC and Card preview on acquisitions receipt summary page
    
    This patch replaces Greybox modals on the acquisitions receipt summary
    page with Bootstrap modals.
    
    To test, apply the patch and go to Acquisitions -> Invoices -> View an
    invoice ->  Go to receipt page.
    
    - In the list of pending orders, test the "MARC" and "Card" links for
      various titles. Each should trigger a Bootstrap modal with the correct
      content.
    - Repeat the same tests in the list of already received orders.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit dde0e0150344cecfcad5c81df3d00f216dbecbbb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 6 20:46:01 2016 +0100

    Bug 16289: Refactore code and add tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit d753644c2f09f6500b3c1690593f1e41922f0677
Author: Karl Holten <kholten@switchinc.org>
Date:   Mon Apr 18 14:17:40 2016 -0500

    Bug 16289: Abbreviated formatting for numbering patterns
    
    To test:
    
    1) Go to Serials -> Manage numbering patterns
    2) Create .New Numbering Pattern.
    3) Type in a name of 'Day, Month, Season' and a numbering formula of '{X} {Y} {Z}'.
    4) Set up the X field as following: add 1, every 1, set back to 1, when more than 30.
    5) Select the formatting for X. There should be six options available instead of the original three. Use the formatting 'Name of Day (abbreviated)'.
    5) Set up the Y field to add 1 every 30 reset back to 1 when more than 12. Use the formatting option 'Name of month (abbreviated)'.
    6) Set up the Z field to add 1 every 90 reset back to 1 when more than 4. Use the formatting option 'Name of season (abbreviated)'.
    8) Select a frequency of 1/day.
    9) Select a first issue publication date of Jan 1, 2016.
    10) Set X to begin with 5 and have an inner counter of 5. Set Z to begin with 3 and have an inner counter of 10.
    11) Click the 'Test Pattern' button.
    12) Abbreviated versions of the day, month and season should appear in the test pattern.
    
    Signed-off-by: sonia bouis <sonia.bouis@univ-lyon3.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 9066ae153b15ae49b7d5832b331eed31c32ed583
Author: Claire Gravely <c.gravely@arts.ac.uk>
Date:   Sat Jun 4 13:30:30 2016 +0200

    Bug 16165 - Include link to ILS-DI documentation page in ILS-DI system preference
    
    There is no clue in the system preference about the nice ILS-DI documentation
    once you turn it on. We should include a note and the link, similar to how we
    do it for the web self checkout.
    
    Test plan:
    Syspreference ILS-DI should now include URL in description.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 0427dfe8ee65e87e9442af16d4069afdfcde2801
Author: Liz Rea <liz@catalyst.net.nz>
Date:   Fri Nov 20 11:29:44 2015 +1300

    Bug 15213 - Fix tools sidebar to highlight Patron lists when in that module
    
    To test:
    
    Add some patron lists, navigate through the lists interface and make
    sure that while you are in the module, that Patron lists is highlighted
    on the sidebar.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Amended patch: fix alignement
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c91b16bd9e82588c7625f69e37d6435dd378915e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Sat Jun 4 11:11:00 2016 -0400

    Bug 16637: Dependency for C4::Tags not listed
    
    Added optional dependency, so as to explain why testing
    explodes when the Enhanced Content system preference
    TagsExternalDictionary is set. It is optional, because not only
    does TagsExternalDictionary have to be set, but TagsEnabled
    must be 'Allow'.
    
    Also tweaked C4/Tags.pm to ignore TagsExternalDictionary,
    if Lingua::Ispell is not installed. A warning is given.
    
    TEST PLAN
    ---------
     1) Set the Enhanced Content system preference
        TagsExternalDictionary to /usr/bin/ispell
    
     2) sudo apt-get install liblingua-ispell-perl
        -- should be a new install
    
     3) prove t/db_dependent/Tags.t
        -- should work fine
    
     4) sudo apt-get remove liblingua-ispell-perl
    
     5) prove t/db_dependent/Tags.t
        -- should explode
    
     6) Clear the Enhanced Content system preference
        TagsExternalDictionary
    
     7) prove t/db_dependent/Tags.t
        -- should work fine
    
     8) apply patch
    
     9) prove t/db_dependent/Tags.t
        -- should work fine
    
    10) Set the Enhanced Content system preference
        TagsExternalDictionary to /usr/bin/ispell
    
    11) prove t/db_dependent/Tags.t
        -- should work, with warning.
    
    12) sudo apt-get install liblingua-ispell-perl
    
    13) prove t/db_dependent/Tags.t
        -- should work fine
    
    14) run koha qa test tools.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Post-hackfest hotel Olympia lobby signoff. Kalimera!
    Works as expected.
    At this moment the Tags.t test does not need the database btw,
    but the module should have much more test coverage.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 1fda4105a8a0f1e2165e27cea8314b578196dba2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 10 18:02:14 2016 +0000

    Bug 16636 [QA Followup] - Move tests to t/External
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7f4682df0dfa460c0e2ef9117e032165a45d6e79
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jun 10 10:31:34 2016 +0200

    Bug 16636: [QA Follow-up] Move External_BakerTaylor.t to t
    
    When we mock the preferences completely now, we do not need
    db access anymore.
    
    Test plan:
    Run the test without exporting KOHA_CONF.
    The test passes with some warns about koha-conf.xml.
    If you point KOHA_CONF to etc/koha-conf.xml, you have no warns.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5361440f6538127c8c3ec61d963d5f0692c64a71
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jun 10 09:30:51 2016 +0200

    Bug 16636: [QA Follow-up] Make BakerTaylor plack safe
    
    Initialize file level lexicals each call. Do not call _initialize
    outside the module.
    Adjust test by mocking preferences.
    
    Test plan:
    Run t/db_dependent/External_BakerTaylor.t.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested module with trivial script under Plack/memcached by toggling
    the associated preferences.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b4479624de2010fff8851732e94d086b2cca6921
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jun 1 20:43:30 2016 -0400

    Bug 16636: t/00-load.t warning from C4/External/BakerTaylor.pm
    
    Since the tests are expecting an initialize function, the
    initialize call was just moved outside of the INIT block.
    
    TEST PLAN
    ---------
    1) prove t/00-load.t
       -- warnings about INIT for BakerTaylor
    2) prove `git grep -l BakerTaylor | grep [.]t$`
       -- should all run okay
    3) apply patch
    4) repeat steps 1 and 2
       -- warning should be gone, and everything else run okay
    5) run koha qa test tools
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Florent Mara <florent.mara@gmail.com>
    
    NOTE: Tweaked test plan based on comment #4,
          Added sign off based on comment #6.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4fc8b3d6cf6453f7ff550b9fbde1a7f6315dd066
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jun 6 10:49:06 2016 +0200

    Bug 16635: [QA Follow-up] Eliminate some global package vars
    
    [1] $branch is only related to line 123 as fallback.
    [2] $width moved to a constant; sub width is not used.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested the corresponding plugin in item editor.
    Test t/db_dependent/Barcodes.t and Barcodes_ValueBuilder.t still pass.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit fd152d9e95a2236a00f3cb0284bdd2aa7cca6da2
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jun 1 20:41:27 2016 -0400

    Bug 16635: t/00-load.t warning from C4/Barcodes/hbyymmincr.pm
    
    According to http://perldoc.perl.org/vars.html, "our" should
    be a reasonable substitute for the "use vars". By declaring as
    "our", and removing the INIT, prove t/00-load will no longer
    generate a warning about INIT for the C4/Barcodes/hbyymmincr.pm
    module.
    
    TEST PLAN
    ---------
    1) prove t/00-load.t
       -- warnings about INIT for hbyymmincr
    2) prove `git grep -l hbyymmincr | grep [.]t$`
       -- should all run okay
    3) apply patch
    4) repeat steps 1 and 2
       -- warning should be gone, and everything else run okay
    5) run koha qa test tools
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 45dce0ac795357f5111db8cd81473317613bdcc1
Author: Marc Véron <veron@veron.ch>
Date:   Wed Jun 1 22:28:51 2016 +0200

    Bug 16634: Translatability: Fix issue in memberentrygen.tt
    
    This patch fixes a small translatability issue in
    koha-tmpl/intranet-tmpl/prog/en/modules/members/memberentrygen.tt
    The sentence following sentence was splitted by HTML tags:
    "Attribute value xxxxx is already in use by another patron record."
    
    To test:
    - Review code
    - Apply patch
    - In Admin, create a unique patron attribute type and try to give
      two patrons the same value for this attribute type.
    
    Signed-off-by: Rocio Dressler <rocio@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 203d34a3ca821e409cf612c29b918745a3ea8ddb
Author: Marc Véron <veron@veron.ch>
Date:   Wed Jun 1 21:26:55 2016 +0200

    Bug 16633: Translatability: Issues in tags/review.tt (sentence splitting)
    
    This patch fixes translatability issues in
    koha-tmpl/intranet-tmpl/prog/en/modules/tags/review.tt
    (isolated words by sentence splitting).
    
    To test:
    - Review code and verify that changes make sense.
    
    Signed-off-by: Rocio Dressler <rocio@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b0ba45058ab0221838f7563f761d283c377b829d
Author: Marc Véron <veron@veron.ch>
Date:   Tue May 31 10:17:13 2016 +0200

    Bug 16620: Translatability: Fix problem with isolated word "please" in auth.tt
    
    This patch fixes a translatability problem (syntax in different languages) with a tag-isolated word "please"
    in koha-tmpl/intranet-tmpl/prog/en/modules/auth.tt
    
    To test:
    - Verify in code that there is no sentence spliting by a-tags (lines 80/84).
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ec66ff457b6f1b682f7ad7d0e4f2df6656815848
Author: Eric Phetteplace <phette23@gmail.com>
Date:   Fri May 27 10:13:14 2016 -0700

    Bug 16613: fix MARC 09X help links
    
    The 09X MARC fields, such as 099 local call number or 090
    locally-assigned Library of Congress call number, all point to
    non-existent pages on the LC website, e.g.
    http://www.loc.gov/marc/bibliographic/bd090.html
    
    Test plan:
    - enter the advanced cataloging editor
    - begin to input any MARC tag of form 09X
    - click the help link at the bottom of the browser window
    => Without this patch, taken to a URL of form `'http://www.loc.gov/marc/bibliographic/bd' +
      tag + '.html'` which is broken because the only documentation for
      these tags is at https://www.loc.gov/marc/bibliographic/bd09x.html
    => With this patch applied, the link is correct
    
    Signed-off-by: Nicole C Engard <nengard@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b6979db41057e5a9770789fdaf43a793b69601e6
Author: Marc Véron <veron@veron.ch>
Date:   Mon May 23 11:20:10 2016 +0200

    Bug 16563: Translatability: Issues in opac-account.tt (sentence splitting)
    
    This patch removes splitting by <i>-tags from 2 sentences.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    No errors
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6b432d2b213101d2e8d0bf41fbc4a0e5b4ecb4e1
Author: Marc Véron <veron@veron.ch>
Date:   Wed Jun 1 16:41:55 2016 +0200

    Bug 16540 - Clean up opac-auth.tt for translatability
    
    This patch fixes translatability issues in opac-auth.tt (ugly
    translations caused by sentence splitting).
    
    It was necessary to change indentation to make the the file more
    readable and to make sure that changes have no side effects.
    
    The changes do not touch the overall functionallity.
    
    To test:
    - Review code to verify that no functionality change is introduced
      and to verify that the text changes make sense.
    - Apply patch, verify that OPAC login page behaves as before.
    
    UPDATE: Amended for comment #10 / mv
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 2bff91eb4e733a5c658e17fb93f13497768ba2e6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Sun Jun 5 08:46:06 2016 -0300

    Bug 16667: Unused variable and function call in circulation.pl
    
    This patch removes an unused occurence of the $branches variable. Probably a
    leftover from a recent rewrite.
    
    To test:
    - Run:
      $ git grep '$branches' circ/circulation.pl
    => FAIL: Only on occurence of the variable
    - Apply the patch
    - Run:
      $ git grep '$branches' circ/circulation.pl
    => SUCCESS: The variable has been removed
    - Sign off :-D
    
    Regards
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 740cb37e94d80a8beb41710f5e57d6e4a46fc17a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 27 14:02:42 2016 +0200

    Bug 16609: Catch warning from Koha::Hold in Hold.t
    
    Before this patch, the suspend step triggers a warn from Koha::Hold.
    Now we catch it.
    
    Test plan:
    Run the test. Do not see the warning about unable to suspend.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    NOTE: Nice clean up!
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f38a9927a3d27709173564848bda4a4a61abeadb
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri May 27 10:50:00 2016 +0200

    Bug 16608 - Missing entity nbsp in some XML files
    
    The special character "non breaking space" &nbsp; is not contained in XML syntax by default.
    So we add it in the file header :
    <!DOCTYPE stylesheet [<!ENTITY nbsp "&#160;" >]>
    
    Even if the source code files do no contain this character, it can be that translated files contain it.
    French for example "Titre&nbsp;:".
    
    This entity is missing in all files in koha-tmpl/intranet-tmpl/prog/en/data/ and in some files of koha-tmpl/intranet-tmpl/prog/en/xslt.
    
    Test plan :
      - generate French templates:
        cd misc/translator
        ./translate install fr-FR
        cd ../..
      - run test:
        prove -v t/00-valid-xml.t
        you get failing error message
      - apply this patch
      - translate again
      - run test again: it passes
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Works as described following test plan
    Tes pass, no errors.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ce979300168fc7a885463a1a2be519562319844a
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri May 27 10:46:44 2016 +0200

    Bug 16608 - Add xsd extension to t/00-valid-xml.t
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8631ebaf9f634976b076958707af355baf78cc2f
Author: Marc Véron <veron@veron.ch>
Date:   Sat May 28 09:44:40 2016 +0200

    Bug 16589 - Quote of the day: Fix upload with csv files associated to LibreOffice Calc
    
    To reproduce:
    - Install LibreOffice and make sure that csv files are associated to Calc
      (Note: tested with Firefox 46.0.1 on Windows 8)
    - Go to Home > Tools > Quote editor > Quote uploader
    - Try to upload a valid CSV (e.g. Example from Bug 15684)
    Result: File can not be uploaded
            (Incorrect filetype: application/vnd.sun.xml.calc)
    To test:
    - Apply patch
    - Try to upload again
    Expected result: Quotes are imported.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
      Can't reproduce on a Mac but get it fails on a Windows Box: fixed with this
      patch.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Can't recreate on debian but the fix looks safe.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 593dee4ea02971f8932d15fe1ba4dc157a379bac
Author: Marc Véron <veron@veron.ch>
Date:   Mon May 23 14:16:02 2016 +0200

    Bug 16560: Translatability: Issues with "The entered " in opac-memberentry.tt
    
    This patch fixes two splitted sentences to avoid translation issues:
    
    The entered <a href="#borrower_cardnumber">card number</a> is the wrong length.
    The entered <a href="#borrower_cardnumber">card number</a> is already in use.
    
    To test:
    Apply patch and verify that html in the 2 that are changed is correct and that
    they are not splitted by a-tags.
    
    Note: I could not figure out under which conditions this code displays in
          the OPAC self registration form.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit e9d6ac9478606d9d123a22635719b99d985b9538
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 26 12:29:38 2016 -0400

    Bug 15676 - Actions in pending offline circulation actions are not translatable
    
    This patch modifies the offline circulation transaction processing page
    so that English strings describing actions are processed in the template
    rather than being output directly from the script.
    
    To test, apply the patch and create an offline circulation file
    containing at least one checkout, one check-in, and one payment.
    
    - Upload the file and choose 'Add to offline circulation queue.'
    - View pending offline circulation actions
    - In the list of pending actions, the actions column should show "Check
      out" instead of "issue," "Check in" instead of "return," and "Payment"
      instead of "payment."
    
    Strings appear as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 43d77fdcf01906fa535482691e5eade47287ab2f
Author: Dimitris Antonakis <dimantonak@gmail.com>
Date:   Sat Jun 4 16:00:47 2016 +0300

    Bug 14897 - Header name mismatch in ./modules/catalogue/detail.tt
    
    We changed the detail.tt file for staff interface from Publication details to
    "Serial enumeration / chronology" to match the cataloguing editor.
    
    Signed-off-by: Joy Nelson <joy@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 63041c19c98b90c934ef89634dfdaf2d6abeb762
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Mon Jul 27 16:24:46 2015 -0400

    Bug 14605 - Corrects the individual fine's description
    
    When paying a fine, the description is built out of the borrower's type and title, instead of the actual fine's description.
    
    STEPS:
    1) in the staff, go to a user with a fine to pay.
       a) if none, go to a user and Fines>>"Create manual invoice" with a distinctive description.
    2) In Fines>>Pay fines, click the "Pay" button on the line of the fine.
    3) This will take you a "Pay an individual fine" screen, where the description will look like "Staff Mrs", for the category and title of the borrower.
    
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 4f3067184d7dd3666d404a2165d72755cb0b227d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 8 15:32:31 2016 +0100

    Bug 16492: Add a FIXME to explain the possible problem with no_set_userenv
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit bb6e70fe7d4ba530fe64179fe6fde4d6b4ec5e35
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 25 17:33:00 2016 +0100

    Bug 16492: Test that no_set_userenv will not set userenv if not exist yet
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 90307bcbfaf4c2c8907be94eabca249ac173442e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 10 16:36:03 2016 +0000

    Bug 16492 - Checkouts ( and possibly checkins and other actions ) will use the patron home branch as the logged in library
    
    Bug 14507 introduced the use of checkpw in C4::SIP::ILS::Patron so that
    non-Koha internal authentication processes would be able to function via
    SIP ( LDAP et al ).
    
    The problem is that checkpw changes the userenv to that of the patron!
    This is not usually an issue in Koha because most of the time that
    patron running through checkpw is the one to be logged in.
    
    Aside from SIP2 the only other area where this may be an issue is in SCO
    when using SelfCheckoutByLogin.
    
    Test Plan:
    1) On master, check out an item to a patron via SIP2
    2) Note the checkout lists the item as having been checked out
       from the patron's home library not matter which library is was
       supposed to be checked out from.
    3) Apply this patch
    4) Re-checkout the item
    5) The item should now be checked out as if it was checked out from
       the library as defined in the SIP configuration file.
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f17897fb105fccb7edbf60b24c7d6e5362351cb2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 10 17:15:21 2016 +0000

    Bug 10459 - DBRev 16.06.00.002
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit ff9de4138a7544f08f835acae93aca124c8efa89
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 7 10:20:53 2016 +0100

    Bug 10459: Add tests for borrowers.updated_on
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f863e478b994f2631d79821473c773099dc78172
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed May 25 21:57:34 2016 -0400

    Bug 10459 renamed timestamp to updated_on
    
    Signed-off-by: Joy Nelson <joy@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 255596ae6c483caf5746745f3656b56e0ea011b4
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Nov 10 14:17:40 2014 +0100

    Bug 10459: Borrowers should have a timestamp
    
    This patch adds a timestamp column to the borrowers table in kohastructure
    and updatedatabase. (And also to the deletedborrowers table.)
    A timestamp may be useful in synchronizing with external systems (among other
    reasons).
    
    Test plan:
    Run updatestructure on an existing database, or install a new one.
    Verify that the borrowers table has a timestamp now.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested updatestructure and running kohastructure.sql.
    Passed t/db_dependent/Members.t.
    
    updatedatabase.pl did not apply. I edited and then run it. Columns were added as expected.
    Signed-off-by: Marc Veron <veron@veron.ch>
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Joy Nelson <joy@bywatersolutions.com>
    
    Bug 10459: Follow up to update to atomic update methodology
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    New column created, no errors.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Joy Nelson <joy@bywatersolutions.com>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit a4c44b9f643ab9a31c4025f6001a823fdcbb8101
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 8 14:52:04 2016 +0100

    Bug 16695: Require Exception::Class 1.38 instead of 1.39
    
    Looking at
    http://cpansearch.perl.org/src/DROLSKY/Exception-Class-1.40/Changes
    there is no need to require 1.39
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 40f3d43f46cccb5bb8077aae64684c5c5a0ed781
Author: Galen Charlton <gmcharlt@gmail.com>
Date:   Tue Jun 7 00:44:07 2016 +0000

    Bug 16647: update debian/control for 16.*
    
    This patch updates debian/control* to match what
    was used for building the 16.05.00 packages, and includes
    changes to:
    
    - specify a floor for the Swagger2 version
    - add dep on libio-socket-ip-perl, which is needed
      for the package to work on Debian Wheezy
    - suggest libwww-youtube-download-perl
    
    Signed-off-by: Galen Charlton <gmcharlt@gmail.com>
    Signed-off-by: Hector Castro <hector.hecaxmmx@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit f97626271ecf7ea90724cd7b131cf4eabb883c23
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 4 12:26:27 2016 +0100

    Bug 16649: Make OpenLibrarySearch test pass even if launches offline
    
    Test plan:
      prove t/OpenLibrarySearch.t
    should return green even if you are offline
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Mirko Tietgen <mirko@abunchofthings.net>
    Signed-off-by: Galen Charlton <gmcharlt@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit b9b4eeb849dcb52053a98440e1d8fb02011a9005
Author: Galen Charlton <gmcharlt@gmail.com>
Date:   Tue Jun 7 01:42:59 2016 +0000

    Bug 16675: fix breakage of t/Languages.t
    
    This patch fixes test breakage introduced by the patch for bug 16088,
    which added caching of getlanguages().  Upon inspection, it looks like
    the patch for 16088 does not introduce a regression on bug 10560,
    so this patch adds a couple cache-clearings.
    
    To test
    -------
    [1] Verify that t/Languages.t passes.
    
    Signed-off-by: Galen Charlton <gmcharlt@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 023384811f54f18fbe585431c49b80cfc20e58dd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 7 12:29:33 2016 +0100

    Bug 16668: Fix t/Ris.t tests
    
    Caused by bug 16442.
    Now we need to mock the marcflavour pref
    
    Test plan:
      prove t/Ris.t
    should return green
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 5e6da05b101e014d2b2ecc80b4fc4474c54503bc
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon May 30 12:16:36 2016 -0400

    Bug 16618: 00-load.t prematurely stops all testing
    
    Rather than add/remove regular expressions to skip modules (like bug 9054), encapsulate the decision logic into a separate function.
    
    Currently there are three libraries which trigger halts:
    Koha::NorwegianDB (which was already there)
    Koha::ElasticSearch::Indexer
    Koha::SearchEngine::Elasticsearch::Search
    
    TEST PLAN
    ---------
    1) prove t/00-load.t
       -- should barf horribly on Catmandu stuff
          if not: sudo apt-get remove libcatmandu-marc-perl
          then repeat step.
    2) apply patch
    3) prove t/00-load.t
       -- should not barf horribly
    4) run koha qa test tools
    
    NOTE: The four optional modules for Koha::NorwegianDB are
          listed in the PerlDependencies.pm, while there is
          no mention of Catmandu libraries at all there.
          This may be another bug which needs fixing.
    
    TECH NOTES (for ideas of how to tinker around):
    These three things should trigger the three module cases:
    sudo apt-get remove libcatmandu-marc-perl
    sudo apt-get remove libcatmandu-store-elasticsearch-perl
    sudo apt-get remove libconvert-basen-perl
    
    You probably had koha-perldeps installed before, so the following wil mostly fix:
    sudo apt-get install koha-perldeps libcatmandu-marc-perl
    
    And in case you didn't have elastic search stuff installed:
    echo deb http://packages.elastic.co/elasticsearch/1.7/debian stable main | sudo tee /etc/apt/sources.list.d/elasticsearch.list
    wget -O- https://packages.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
    sudo apt-get update
    
    cd ~
    wget http://debian.koha-community.org/koha/otherthings/elasticsearch_deps.tar.gz
    tar xvf elasticsearch_deps.tar.gz
    cd es_deps
    sudo dpkg i lib*
    sudo apt-get install -f
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Galen Charlton <gmcharlt@gmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 04e5c2630c6e3b2962498b932bd8967478c940e5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 26 10:55:09 2016 +0100

    Bug 16596: Display library and patron category descriptions instead of their code
    
    Test plan:
    On circ/circulation-home.pl and reserve/request.pl, search for patrons
    The descriptions for the libraries and patron categories should be
    displayed.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    
    On top of Bug 13336
    Works as described, now descriptions instead of codes.
    No errors
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    https://bugs.koha-community.org/show_bug.cgi?id=16455
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 3948102f2ad6e5382a31a00df0c8f52def3daf58
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 25 18:09:27 2016 +0100

    Bug 16578: Same fix for the staff interface
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Works as first patch
    No errors
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7d4844e171b1319b90e7bd73510bd97c2acbf635
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue May 24 14:28:44 2016 -0300

    Bug 16578: Fix wide character errors in opac-export.pl
    
    This simple patch fixes wide character warning raised by opac-export.pl when
    'MARC (Unicode/UTF-8)' and 'MARC (Unicode/UTF-8, Standard)' formats are chosen for downloading records.
    
    To test:
    - Have records indexed
    - Open your OPAC logs:
      $ tail -f /var/log/koha/kohadev/opac-error.log
    - Open the detail page in the opac for a record
    - Choose Save record > MARC (Unicode/UTF-8)
    => FAIL: opac-export.pl: Wide character in print at /home/vagrant/kohaclone/opac/opac-export.pl line 116., referer: http://localh...
    - Choose Save record > MARC (Unicode/UTF-8, Standard)
    => FAILE opac-export.pl: Wide character in print...
    - Apply the patch
    - Choose Save record > MARC (Unicode/UTF-8)
    => SUCCESS: No warnings raised.
    - Choose Save record > MARC (Unicode/UTF-8, Standard)
    => SUCCESS: No warnings raised.
    - Sign off :-D
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit af59b669413539606f10652230e5f96d43337cb5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 11 13:04:38 2016 +0100

    Bug 16465: Fix typo issues vs checkouts
    
    Test plan:
    Confirm the wording is correct
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 27254de06d8ae6682b395be48d6ba02b69f9e917
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 11 12:57:47 2016 +0100

    Bug 16465: discharge - Add a title tag at the OPAC
    
    Test plan:
    Confirm that the opac-discharge.pl has now a title
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 6a706b86a273672b1e1ca3f1456fde08dd7a0da2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed May 11 15:47:46 2016 +0200

    Bug 16428: [QA Follow-up] Useless call to GetMarcStructure in _build_default_values_for_mod_marc
    
    The routine calls GetMarcStructure and does not use its return value
    after all.
    
    Test plan:
    Run t/db_dependent/Items.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 52b1b8eae1136af1e901560214a641494acaf577
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 3 11:03:52 2016 +0100

    Bug 16428: Use the biblio framework to know if a field is mapped
    
    The subroutine _build_default_values_for_mod_marc takes the
    frameworkcode in parameter, but ModItemFromMarc did not pass it.
    It uses it to know if a field is mapped or not to a Koha field
    (C4::Koha::IsKohaFieldLinked).
    Consequently the default framework ("") was always used.
    
    This bug has been found working on bug 13074 and has been put on a
    separate bug report to ease the backport.
    
    Test plan:
    Without this change, the tests added by bug 16428 won't pass
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 687a7e22b6c630c3bbc06e1845854514f6fea5b0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 7 11:48:46 2016 +0100

    Bug 16441: Fix Letters.t
    
    These tests were wrong, but the package variable used to cache the
    letters hid the problem.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit c4f388f64966f2202e9f3e3c16dad5cef3dbe0ac
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 4 19:43:43 2016 +0100

    Bug 16441: Do not use a package variable to cache C4::Letters::getletter
    
    C4::Letters::getletter use a package variable (%letter) to cache letter
    returned by the subroutine.
    I have not found any direct issues caused by that but it is safer to
    remove it.
    It won't be a big deal to hit the DBMS to get a valid letter when
    needed.
    
    No test plan here, just confirm that the changes make sense.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Confirm that performance loss is just a millisecond or so per
    subsequent call of getletter.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 113adf68e56b6233b44a2b7a9b5dc60f6c4de0b7
Author: Jacek Ablewicz <abl@biblos.pk.edu.pl>
Date:   Wed Jun 8 10:46:18 2016 +0200

    Bug 16678: updatedatabase.pl 3.23.00.006 DB upgrade crashes if subscription_numberpatterns.numberingmethod contains parentheses
    
    It seems that if subscription_numberpatterns.numberingmethod contains parentheses, updatedatabase.pl crashes when running the 3.23.00.006 DB upgrade snippet, with the following error:
    
    [Mon Jun 6 09:06:54 2016] updatedatabase.pl: Unmatched ( in regex; marked by <-- HERE in m/ ( <-- HERE / at /home/koha/kohaclone/installer/data/mysql/updatedatabase.pl line 11498.
    
    Steps to reproduce:
    1/ Have a Koha DB version<3.23.00.006
    2/ Create a subscription numbering with parentheses in it:
       ie "Vol. (Month, Year)" with pattern
           Vol. {X} ({Y}, {Z})
    3/ Add some serials using that numbering method so that serialseq is filled in DB:
       ie  "Vol. 16 (February, 2015)"
    4/ Run the updatedatabase.pl script either from the cli or just start the webinstaller
    5/ The error is produced
    
    To test:
    1/ apply patch
    2/ try to reproduce this issue once again, should be fixed now
    3/ have a look at the code, make sure the changes are consistent
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Note: I have not tested the patch, but the diff looks good.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 8794348ccbb156ddd1ec53702b5afebea1747976
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 24 19:57:16 2016 +0100

    Bug 16570: Do not tell all checked-in items are part of a rotating collection
    
    When an item is checked-in a message will tell you it's part of a
    rotating collection, even if it's not true.
    
    Test plan:
    Make sure the message appears only when needed.
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 30cf9ee277481b54ed75e500c38f328f2d82b831
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jun 10 11:49:45 2016 +0200

    Bug 16443: [QA Follow-up] Add two tests for get_fields
    
    Adds t/db_dependent/Members/Statistics.t.
    
    Test plan:
    Run the test.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 29e402d398f567e2526c89695384bce7f4e4b737
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 4 20:08:53 2016 +0100

    Bug 16443: Make C4::Members::Statistics plack safe
    
    If the prefs is updated, the fields won't be.
    To make sure we already fetch updated values, we should remove the
    package variable and define it in the subroutine.
    
    There is not test plan, just make sure the changes are consistent.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>

commit 7d916c380a03904c47035f189d1ee666f00d9a11
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 5 16:58:06 2016 +0100

    Bug 16455: Remove the "Too late to run INIT block" from C4::Tags
    
    The pref TagsExternalDictionary is used to tell Lingua::Ispell to use an
    other dictionary, different from the default one (/usr/bin/ispell).
    
    To do so we need to set $Lingua::Ispell::path to the expected path.
    It's currently done in the INIT block.
    
    If you try to use C4::Tags, you will get the famous "Too late to run
    INIT block at C4/Tags.pm line 74." warning. Plack use the INIT block to
    load functions at run time, when we are using C4::Tags when hitting a pl
    script, the compilation phase is finished and it's "too late to run INIT
    block" from C4::Tags.
    
    I do not really know if it has an impact on the behavior of
    Lingua::Ispell (i.e. is the path redefined?), but I know that this INIT
    block is not executed when we want.
    
    Test plan:
    under Plack,
    - hit /cgi-bin/koha/opac-search.pl and confirm that the warning does no
    longer appears
    - Use another dictionnary (??), fill TagsExternalDictionary with its
      path and confirm that it is used by the tags approval system
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f2fe433cf9afce98957826bf2ade457557fe4eff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 17 14:38:04 2016 +0100

    Bug 16508: Updating a syspref requires parameters_remaining_permissions
    
    And not all of parameters flags.
    
    Test plan:
    1/ Create a staff user.
    2/ Go to details, select more->set permissions.
    3/ Set catalogue, Manage Koha system settings (Administration panel),
    manage circulation rules, and Remaining system parameters permissions.
    4/ Log in as the new staff user, go to administration > system
    preferences. Change a syspref and save it... it will save correctly.
    5/ Log back in as superlibrarian
    6/ On the 'set permissions' screen, un-check 'manage circulation rules'
    and save.
    7/ Log back in to the new staff user, and try to change the same
    systemprefrence and save.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Veron <veron@veron.ch>
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ab1beed06f249d1e7d0be5bb1b584e62f5b48783
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 13 20:46:42 2016 +0100

    Bug 16518: Fix Plack variable scoping problem in opac-addbybiblionumber.pl
    
    The script opac/opac-addbybiblionumber.pl is not plack safe because the
    variable @biblios is declared with our and is not assigned to an empty
    array (so not reset).
    
    The issue:
    When trying to add items to a list (virtualshelf), the biblionumbers are
    added to the @biblios variable and the list is not reset between each
    run.
    
    Test plan:
    Check from records from the result list and add them
    to a list.
    Cancel or save and re-add them (or others) to a list (same or
    different).
    => Without this patch, the list of records will never stop growing, the
    previous items added are still listed when adding new ones.
    => With this patch, the behavior is the one expected.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit d9ef98b9b66440240ae9a3baadbf9b1f665e8aab
Author: Brendan Gallagher <brendan@bywatersolutions.com>
Date:   Sat Jun 4 15:42:52 2016 +0300

    Revert "Bug 7143 - Bug for tracking changes to the about page"
    
    This reverts commit 6dc7401f2f631763ccae0db5bf52bb7731268fbc.

commit 5ae16fa243f9e6843799f23437726d386f3e600b
Author: Brendan Gallagher <brendan@bywatersolutions.com>
Date:   Sat Jun 4 09:57:39 2016 +0000

    Bug 7143 - Bug for tracking changes to the about page
    
    Adjusting the history file for new developers

commit 6b7f4a3a9ec18b550d011a7eee9e7108b7042059
Author: Aliki Pavlidou <pavlidoualiki@gmail.com>
Date:   Sat Jun 4 12:10:38 2016 +0000

    Bug 15641 - Typo in explanation for MembershipExpiryDaysNotice
    
    There's an extra period after the word "in" in the MembershipExpiryDaysNotice sys
    
    "Send an account expiration notice when a patron's card will expire in. [value box
    
    Bug fixed!
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a589879f495aeb25200119cb4f1bf76c28dce660
Author: Rocio Dressler <rocio@bwstest.bywatersolutions.com>
Date:   Sat Jun 4 02:24:45 2016 -0700

    Bug 16537 - Overdue and Status triggers grammar
    
    Test plan:
    
    1) Go to the staff client
    2) Click on Tools - Overdue notice/status triggers
    3) Confirm that the first sentence reads "a" checkout rather than "an" checkout
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit fff754a7fc7a99dad6a35129b8a7dd170684f2bf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 4 20:20:51 2016 +0100

    Bug 16444: Make C4::Tags plack safe
    
    C4::Tags use a package variable to cache the pref
    TagsExternalDictionary, it's not needed and not safe.
    
    There is not test plan, just make sure the changes are consistent.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit b37d7c993542f54a1821c99899c4f0772f5846b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 11 13:13:38 2016 +0100

    Bug 16088: Fix the number of tests to skip
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit f01a07a25e0503d9dbed3a4226cb51a155bcacd4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 9 17:27:51 2016 +0100

    Bug 16088: Introduce Koha::Cache::Memory::Lite to cache the language
    
    The goal of this patch is to avoid unecessary flush of the L1 cache on
    creating a new CGI object each time C4::Languages::getlanguage is called
    without a CGI object.
    
    The new class Koha::Cache::Memory::Lite must be flushed by the CGI
    constructor overide done in the psgi file. This new class will ease
    caching of specific stuffs used by running script.
    
    Test plan:
    At the OPAC and the intranet interfaces:
    Open 2 different browser session to simulate several users
    - Clear the cookies of the browsers
    - User 1 (U1) an User 2 (U2) should be set to the default language
      (depending on the browser settings)
    - U1 chooses another language
    - U2 refreshes and the language used must be the default one
    - U2 chooses a third language
    - U1 refreshes and must be still using the one he has choosen.
    
    Try to use a language which is not defined:
    Add &language=es-ES (if es-ES is not translated) to the url, you should
    not see the Spanish interface.
    
    Signed-off-by: Jacek Ablewicz <abl@biblos.pk.edu.pl>
    
    Signed-off-by: Jesse Weaver <jweaver@bywatersolutions.com>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit fc35a5099f613c08d12be1d67fd027d4a5eaf99c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 11 12:00:01 2016 +0100

    Bug 16458: Update library when a guarantor is set
    
    If you edit a patron from the Edit link of the patron information block
    (step 1 of the memberentry script), the branchcode is not displayed. If
    you set a guarantor to a child from this form, a JavaScript error will
    be raised:
      JavaScript error form.branchcode is undefined
    
    It happens because there is the branchcode is not displayed and there is
    no element with a branchcode name.
    
    To avoid this issue, a branchcode hidden input is added to the form and
    it will be updated when a guarantor is selected (same behavior as when
    you edit a patron using the complete form).
    
    Test plan:
    Edit a patron using the Edit link of the patron info block (not the Edit
    button in the toolbar)
    Set a guarantor
    => Notice that the branchcode of the patron has been updated with the
    branchcode of the guarantor
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 6cd592ba3b18236a3c0f82873d4444c1f884f37c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon May 16 10:52:17 2016 -0400

    Bug 16529 - Clean up and improve upload template
    
    This patch makes some fixes and improvements to the template for Tools
    -> Upload, including markup corrections, removal of 'onclick,' and
    conversion of some links to styled buttons.
    
    To test, apply the patch and go to Tools -> Upload.
    
    - Confirm that uploading a file works correctly.
    - Confirm that clicking 'Cancel' during a file upload works correctly.
    - Search existing uploads.
      - Confirm that the 'Download' and 'Delete' buttons look correct and
        work correctly.
    - In Administration -> MARC bibliographic framework, choose a
      framework and configure a tag subfield to use the upload plugin.
    - Create or edit a bibliographic record using the framework you
      modified.
    - Click the tag editor icon next to your modified subfield to trigger
      the pop-up window with the upload form.
      - Confirm that this window has a layout which is adjusted for the size
        of the window.
      - Confirm that uploading and selecting files from this window works
        correctly.
    
    Signed-off-by: Rocio Dressler <rocio@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 87b181c6d40e7a811fee511648ddd3cb7d44c4e4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 4 19:53:46 2016 +0100

    Bug 16442: Make C4::Ris plack safe
    
    C4::Ris incorrectly uses 4 package variables:
    - $utf: not used, can be removed
    - $intype: set to marcflavour once, but later it assumes that it is
      usmarc if not defined
    - $marcprint: always 0, so set it to 0
    - $protoyear: only used in 1 subroutine, let's define it at this
      level
    
    Test plan:
    Just make sure the RIS export works as before this patch
    
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 7e30240e694c65bb635a495820cce8883d26baa5
Author: Chris Cormack <chris@bigballofwax.co.nz>
Date:   Fri Jun 3 12:09:33 2016 +0000

    Bug 7143 : Ooops double counted a developer
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit e1b5adec83febdb93e0045b711a19b84e5d06a4a
Author: Chris Cormack <chris@bigballofwax.co.nz>
Date:   Fri Jun 3 12:07:02 2016 +0000

    Bug 7143: Updating about page for new developers
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 84f7f1608553e3cd4610e96325eecff177da1d49
Author: Chris Cormack <chris@bigballofwax.co.nz>
Date:   Fri Jun 3 11:59:18 2016 +0000

    Bug 7143 Updating the history.txt
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 78b2fde34831a4840f6b89df054a5307f1ead54b
Author: Claire Gravely <c.gravely@arts.ac.uk>
Date:   Fri Jun 3 10:38:25 2016 +0200

    Bug 16642 - Fix capitalisation for upload patron image
    
    To fix capitalisation on the staff interface when patronimages is turned on.
    
    Test plan:
    1. In staff interface. Turn on patronimages sys preference.
    2. Go to a patron without an image and check that the "Upload
     patron image" box heading now has correct capitalisation.
    3. Go to a patron with an image already uploaded and check the
     "Manage patron image" box heading has correct capitalisation.
    
    Signed-off-by: Sofia <szapoun@lib.auth.gr>
    
    Signed-off-by: Katrin Fischer  <katrin.fischer@bsz-bw.de>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit a01cd77e19f810bf61c8d26ebb97f7c49f1d1f32
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 23 12:19:46 2016 +0100

    Bug 16565: Drop additional_fields and additional_field_values before creating them
    
    These 2 tables should be dropped before trying to create them
    
    Test plan:
    From the SQL CLI, source the kohastructure.sql file
    source it again
    => Without this patch you get 2 warnings
    ERROR 1050 (42S01) at line 3580 in file:
    'installer/data/mysql/kohastructure.sql': Table
    'additional_fields' already exi
    sts
    ERROR 1050 (42S01) at line 3596 in file:
    'installer/data/mysql/kohastructure.sql': Table
    'additional_field_values' alrea
    dy exists
    
    => With this patch, you won't get them
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit edec5921b11afcbda44fbb6c45f26174768b1708
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 20 16:29:01 2016 +0100

    Bug 9543: Separate MTT with commas
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 9c339f5941a3a628645e3f13c8fdbc92077ea4fc
Author: Marc Véron <veron@veron.ch>
Date:   Fri May 20 11:01:18 2016 +0200

    Bug 9543 - (Follow-up) Show patrons messaging subscription on holds notification
    
    As of comment #19
    - Code de-duplicated to a BLOCK statement
    - Variable renamed
    - Wording slightly changed. I like it that way, but feel free to change it
      in a follow-up
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 481fb09701b83a460f0eb93c0a11c48759aba5c1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 6 00:51:15 2016 +0000

    Bug 9543 - Show patrons messaging subscription on holds notification not already waiting
    
    Same plan as previous patch, but this one should show the message for a
    hold not already waiting but not requiring a transfer (hold-found2 alert
            box)
    
    Signed-off-by: Chris Kirby <christopherlawrencekirby@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 46607f1098153008698023b538ab1391e782a6fc
Author: Marc Véron <veron@veron.ch>
Date:   Thu Mar 24 16:06:30 2016 +0100

    Bug 9543 - Show patrons messaging subscription on holds notification
    
    Display an information about a patron's messaging preferences if an item
    is checked in where the patron has put a hold.
    
    To test:
    
    - Apply patch
    - Make sure that SMS driver and TalkingTech sysprefs are defined to
      enable SMS and Phone preferences for users (SMS driver can be a dummy
      value)
    - Place a hold for a patron
    - Set patron's messaging preferences to different choices (including none)
    - Check in the item that is on hold (it has not to be checked out for the
      test
    - Verify that below the message "Hold found (item is already waiting") an
      information appears about the patron's messaging preferences.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Chris Kirby <christopherlawrencekirby@gmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 6c733b2fda7cd94ae2997c1a058d229dd7819692
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu May 12 04:41:09 2016 +0000

    Bug 12402: Show patron category on pending patron modifications
    
    To test:
    1) Go to OPAC and make a modification to user
    2) Go to Staff Client and go to pending patron modifications
    3) Notice that we have the user's surname, first name, branch and
       cardnumber
    4) Apply patch and refresh page
    5) Notice that patron category now shows after user's name
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit ed449a5b5be4da03443d214de5806f4a0273227b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 19 12:28:08 2016 -0400

    Bug 16005 - Standardize use of icons for delete and cancel operations
    
    This patch makes changes to Font Awesome icons in order to make icon
    choice consistent for common actions.
    
    <i class="fa fa-trash"></i> where something is deleted, removed, or
    emptied.
    
    <i class="fa fa-remove"></i> where an operation is cancelled (also where
    selections are cancelled, as in checkboxes).
    
    <i class="fa fa-times-circle"></i> for "close," as in baskets and
    windows.
    
    To test, apply the patch and view the following pages to confirm that
    the correct icon is used:
    
    - Acquisitions -> Vendor -> Vendor delete button.
    - Acquisitions -> Vendor -> Edit -> Delete contact button.
    - Acquisitions -> Invoices ->  Delete menu item.
    - Cataloging -> Edit record -> Authority search pop-up (triggered from
      the tag editor for a tag linked to an authority) -> Clear field button
    - Authorities -> Authority detail -> Delete button.
    - Tools -> Quotes editor -> Quotes delete button.
    - Reports -> View saved report -> Delete button.
    - Reports -> Saved reports -> Delete menu item.
    - Serials -> Subscription details -> Subscription close button.
    - Administration -> Budgets -> Delete menu item.
    - Administration -> Item search fields -> Delete button.
    - Administration -> Z39.50/SRU servers -> Delete menu item.
    - Catalog -> Advanced search -> Clear fields link.
    - Cataloging -> Advanced editor -> Macros -> Delete macro button.
    - Circulation -> Checkout -> Check out an item which is on hold for
      another patron. "Cancel checkout and place hold" button now uses the
      icon used elsewhere for holds.
    - Course reserves -> Course -> Delete course button.
    - Patrons -> Patron lists -> Add patrons -> Remove selected button.
    - Acquisitions -> Suggestions -> Suggestion details -> Delete button.
    - Lists -> List contents -> Remove selected button.
    
    Followed test plan, works as expected.
    Signed-off-by: Marc Véron <veron@veron.ch>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 4c04f6f8e0068a7cce256c3cd8ffcf5acf682fe0
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Apr 25 09:12:05 2016 -0400

    Bug 16336 [Revised] UX of holds patron search with long lists of results
    
    Bug 15793 made a change to an interface which is also found in the place
    hold template. This patch creates a new include file to be used by both
    circulation.tt and request.tt so that these pages do not diverge.
    
    In the process, this patch removes some markup and JavaScript which was
    made obsolete by Bug 15793 and should have been removed.
    
    This patch also revises the sorting of the results table so that the
    patron name is sortable (Bug 16334) and the default sort is on card
    number (matching 3.20.x and 3.22.x).
    
    To test:
    
    In Circulation:
    - Perform a search by name for a patron which will
      return multiple search results.
    - The table of results which displays should look correct and work
      correctly, including DataTables sorting.
    - Clicking any table row should forward you to the checkout page for
      that patron.
    
    In the catalog:
    - Locate and place a hold on a title.
    - When prompted to select a patron to place the hold for, perform a
      search by name which will return multiple results.
    - Confirm that the table of patron results looks correct and works
      correctly.
    - Clicking any table row should forward you to the place hold page for
      that patron and the title you selected.
    
    Revision: Although the table row was clickable, you couldn't
    middle-click it to open the link in a new tab. The patron name is now a
    real link you can middle-click or right-click. The row is still
    clickable as well.
    
    Signed-off-by: Aleisha <aleishaamohia@hotmail.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit c2f53bd039aa2ce52c2ddc3a2314e32b44ae4ee8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 13 15:28:50 2016 +0100

    Bug 16388: Use existing 'execute' parameter instead of creating a new one
    
    An existing 'execute' parameter is already passed to the template when
    we need to display the 'Download' button, so let's use it instead of
    creating a new one.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit e7ac7abf16c76a00a5dcd8e8cd1e62522675b8ee
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Fri Apr 29 02:47:06 2016 +0000

    Bug 16388: Move option to download report into reports toolbar
    
    To test:
    
    1) Create a new SQL report or edit a report
    2) Ensure that the download option does NOT show in the toolbar
    3) Save and run the report
    4) Confirm that download option DOES show in toolbar as a dropdown with
       the 3 options (csv, tab and ods)
    5) Confirm that downloading all 3 file types works as expected
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 5ba5f9e0c5958b518bd648f08146329e355f3a7e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue May 24 22:31:15 2016 -0400

    Bug 16582 t/Price.t test should pass if Test::DBIx::Class is not available
    
    TEST PLAN
    ---------
    1) prove t/Prices.t
       -- failure
    2) apply patch
    3) prove t/Prices.t
       -- nicely skipped when Test::DBIx::Class is not available.
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 71f0370ddde0d8b8e2a666a091081186fb6531e8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri May 27 12:42:17 2016 +0000

    Bug 16610 - Regression in SIP2 user password handling
    
    Previous to bug 14507, SIP2 only did internal authentication. A change
    to the way we check empty passwords has caused any empty password to
    send back a CQ of Y. Previous to that patch set, a CQ of Y would only be
    sent back of the patron password column was NULL. Now, an empty AD field
    *always* returns a CQ of Y.
    
    Test Plan:
    1) Send a patron information request with an empty AD field
       Note: You must send the AD field or you won't get back a CQ field
    2) Note you get back a CQ of Y
    3) Apply this patch
    4) Repeat step 1
    5) Note you now get back a CQ of N
    
    Signed-off-by: Trent Roby <troby@bclib.info>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit cbdd9194eb3359d517fbda9a50a02fbc375bf5dd
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jun 1 15:34:56 2016 +0200

    Bug 16610: [QA Follow-up] Add a test
    
    To verify the original patch, this test shows that before applying
    it the Patron Info request did not return CQ==N for an empty
    password. Note that the Patron Status did btw.
    
    After applying the original patch, the test passes for patron
    info as well as status.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 567a1a9021aaea3bf42b19f493b79f682ed9042b
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue May 31 14:16:07 2016 +0200

    Bug 16504: [QA Follow-up] Make koha-qa happy with two newlines
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit da94410ab5022c3bd97fba1878673149802db584
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 13 14:43:52 2016 +0100

    Bug 16504: (follow-up for bug 15163) Do not remove attributes of other patrons
    
    Simple patch for a silly error, this single line is going to fix a
    critical bug.
    If a patron attribute is limited to a library, all the values for that attributes
    for every patrons will be deleted.
    
    Test plan:
    Create a patron attribute limited to a library
    Set the the attribute for a patron
    Set the the attribute for another patron
    => Without this patch applied, the attribute's value for the first
    patron is deleted
    => With this patch applied, the 2 values exist in the DB after the
    second edition
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>

commit 72bd06e3a88f62fcfe8710773091447ebafebcb3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 13 14:42:52 2016 +0100

    Bug 16504: Add regression tests
    
    Signed-off-by: Srdjan <srdjan@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
